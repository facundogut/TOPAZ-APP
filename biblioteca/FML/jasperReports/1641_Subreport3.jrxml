<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.1.1.final using JasperReports Library version 6.1.1  -->
<!-- 2024-10-04T12:36:31 -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="1641_Subreport3" pageWidth="555" pageHeight="842" whenNoDataType="NoDataSection" columnWidth="555" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="67d1e7d5-6888-4cab-967d-0c0439c2754c">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<property name="net.sf.jasperreports.export.xls.remove.empty.space.between.rows" value="true"/>
	<property name="net.sf.jasperreports.export.xls.remove.empty.space.between.columns" value="true"/>
	<property name="net.sf.jasperreports.export.xls.white.page.background" value="false"/>
	<property name="net.sf.jasperreports.export.xls.detect.cell.type" value="true"/>
	<property name="net.sf.jasperreports.export.xls.ignore.graphics" value="true"/>
	<property name="net.sf.jasperreports.export.xls.exclude.origin.band.2" value="pageFooter"/>
	<property name="net.sf.jasperreports.export.xls.exclude.origin.keep.first.band.1" value="pageHeader"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="329"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="660"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="NBCH"/>
	<style name="Titulo1" forecolor="#000000" backcolor="#FFFFFF" hTextAlign="Center" hImageAlign="Center" vTextAlign="Middle" vImageAlign="Middle" isBlankWhenNull="true" fontSize="14" isBold="true" isItalic="true" isUnderline="false" isStrikeThrough="false"/>
	<style name="Titulo2" forecolor="#000000" backcolor="#FFFFFF" hTextAlign="Center" hImageAlign="Center" vTextAlign="Middle" vImageAlign="Middle" isBlankWhenNull="true" fontSize="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false"/>
	<style name="Titulo3" forecolor="#000000" backcolor="#FFFFFF" hTextAlign="Center" hImageAlign="Center" vTextAlign="Middle" vImageAlign="Middle" isBlankWhenNull="true" fontSize="10" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false"/>
	<style name="Column Header" hTextAlign="Left" hImageAlign="Left" vTextAlign="Middle" vImageAlign="Middle" isBlankWhenNull="true" fontSize="8" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false"/>
	<style name="Text" forecolor="#000000" backcolor="#FFFFFF" hTextAlign="Left" hImageAlign="Left" vTextAlign="Middle" vImageAlign="Middle" isBlankWhenNull="true" fontSize="8" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false">
		<box rightPadding="5"/>
	</style>
	<style name="Special Text" forecolor="#000000" backcolor="#FFFFFF" hTextAlign="Left" hImageAlign="Left" vTextAlign="Middle" vImageAlign="Middle" isBlankWhenNull="true" fontSize="8" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false">
		<box rightPadding="5"/>
	</style>
	<style name="Integer" forecolor="#000000" backcolor="#FFFFFF" hTextAlign="Right" hImageAlign="Right" vTextAlign="Middle" vImageAlign="Middle" pattern="#,##0;-#,##0" isBlankWhenNull="true" fontSize="8" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false">
		<box rightPadding="5"/>
	</style>
	<style name="Special Integer" forecolor="#000000" backcolor="#FFFFFF" hTextAlign="Right" hImageAlign="Right" vTextAlign="Middle" vImageAlign="Middle" pattern="#,##0;-#,##0" isBlankWhenNull="true" fontSize="8" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false">
		<box rightPadding="5"/>
	</style>
	<style name="Decimal" forecolor="#000000" backcolor="#FFFFFF" hTextAlign="Right" hImageAlign="Right" vTextAlign="Middle" vImageAlign="Middle" pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true" fontSize="8" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false">
		<box rightPadding="5"/>
	</style>
	<style name="Special Decimal" forecolor="#000000" backcolor="#FFFFFF" hTextAlign="Right" hImageAlign="Right" vTextAlign="Middle" vImageAlign="Middle" pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true" fontSize="8" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false">
		<box rightPadding="5"/>
	</style>
	<style name="Percentage" forecolor="#000000" backcolor="#FFFFFF" hTextAlign="Right" hImageAlign="Right" vTextAlign="Middle" vImageAlign="Middle" pattern="#,##0.00 %" isBlankWhenNull="true" fontSize="8" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false">
		<box rightPadding="5"/>
	</style>
	<style name="Special Percentage" forecolor="#000000" backcolor="#FFFFFF" hTextAlign="Right" hImageAlign="Right" vTextAlign="Middle" vImageAlign="Middle" pattern="#,##0.00 %" isBlankWhenNull="true" fontSize="8" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false">
		<box rightPadding="5"/>
	</style>
	<parameter name="TOPAZ_FECHA_SISTEMA" class="java.util.Date" isForPrompting="false">
		<defaultValueExpression><![CDATA[new java.util.Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="TOPAZ_HORA_ACTUAL" class="java.sql.Time" isForPrompting="false">
		<defaultValueExpression><![CDATA[new java.sql.Time(new java.util.Date().getTime())]]></defaultValueExpression>
	</parameter>
	<parameter name="TOPAZ_TITULO1" class="java.lang.String" isForPrompting="false">
		<parameterDescription><![CDATA[Título cargado en la tabla parámetros]]></parameterDescription>
		<defaultValueExpression><![CDATA["Institución TOP"]]></defaultValueExpression>
	</parameter>
	<parameter name="TOPAZ_INICIALES_USUARIO" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["HAOH"]]></defaultValueExpression>
	</parameter>
	<parameter name="FECHA_COMPENSACION" class="java.util.Date" isForPrompting="false">
		<parameterDescription><![CDATA[Fecha de Compensación:]]></parameterDescription>
	</parameter>
	<parameter name="SUCURSAL" class="java.lang.Integer" isForPrompting="false">
		<parameterDescription><![CDATA[Sucursal (-1 Todas):]]></parameterDescription>
		<defaultValueExpression><![CDATA[-1]]></defaultValueExpression>
	</parameter>
	<parameter name="MONEDA" class="java.lang.Integer" isForPrompting="false">
		<parameterDescription><![CDATA[Moneda:]]></parameterDescription>
		<defaultValueExpression><![CDATA[1]]></defaultValueExpression>
	</parameter>
	<queryString language="SQL">
		<![CDATA[SELECT
	A.SUCURSAL,
	A.FECHA_COMPENSACION,
	A.MONEDA,
	A.ESTADO_DEV_DESC,
	SUM(A.TOTAL_IMPORTE) AS TOTAL_IMPORTE,
	COUNT(A.CANTIDAD_CHEQUES) AS CANTIDAD_CHEQUES
FROM (

SELECT
	CR.SUCURSAL,
	CC.FECHA_VALOR AS FECHA_COMPENSACION,
	CR.MONEDA,
	CR.ESTADO_DEVOLUCION,
	CASE
		WHEN CR.ESTADO_DEVOLUCION IN (1,2,3) THEN 'RECHAZADO'
		ELSE 'ACEPTADO'
	END AS ESTADO_DEV_DESC,
	CR.IMPORTE_CHEQUE AS TOTAL_IMPORTE,
	1 AS CANTIDAD_CHEQUES
FROM 
	CLE_CHEQUES_CLEARING_RECIBIDO AS CR WITH (nolock)
INNER JOIN CLE_CHEQUES_CLEARING AS CC WITH (nolock) ON
	CR.NUMERO_CHEQUE = CC.NUMERO_CHEQUE
	AND CR.NUMERO_SERIE = CC.SERIE_CHEQUE
	AND CR.CUENTA = CC.CUENTA
	AND CR.SUCURSAL = CC.NUMERO_DEPENDENCIA
	AND CR.MONEDA = CC.MONEDA
	AND CR.CAMARA_COMPENSADORA = CC.CAMARA_COMPENSADORA
	AND CR.FECHA = CC.FECHA_VALOR
	AND CC.ESTADO = 1
	AND ((CC.TZ_LOCK < 100000000000000 OR CC.TZ_LOCK >= 200000000000000)
		AND (CC.TZ_LOCK < 300000000000000 OR CC.TZ_LOCK >= 400000000000000)
	)
LEFT JOIN SALDOS AS S WITH (nolock) ON 
	S.PRODUCTO = CR.PRODUCTO
	AND S.SUCURSAL = CR.SUCURSAL
	AND S.MONEDA = CR.MONEDA
	AND S.CUENTA = CR.CUENTA
	AND S.OPERACION = CR.OPERACION
	AND ((S.TZ_LOCK < 100000000000000 OR S.TZ_LOCK >= 200000000000000)
		AND (S.TZ_LOCK < 300000000000000 OR S.TZ_LOCK >= 400000000000000)
	)
WHERE
	CR.CAMARA_COMPENSADORA = 1
	AND ((CR.TZ_LOCK < 100000000000000 OR CR.TZ_LOCK >= 200000000000000)
		AND (CR.TZ_LOCK < 300000000000000 OR CR.TZ_LOCK >= 400000000000000)
	)

UNION ALL

SELECT
	CAST(RIGHT(CR.ENTIDAD_DEBITAR, 4) AS NUMERIC (5)) AS SUCURSAL,
	CR.FECHA_VENCIMIENTO AS FECHA_COMPENSACION,
	CASE LEFT(ISNULL(INFO_ADICIONAL, 0), 1) 
		WHEN 1 THEN 2
		ELSE 1
	END AS MONEDA,
	1 AS ESTADO_DEVOLUCION,
	'RECHAZADO' AS ESTADO_DEV_DESC,
	CR.IMPORTE AS TOTAL_IMPORTE,
	1 AS CANTIDAD_CHEQUES
FROM ITF_COELSA_CHEQUES_RECHAZO AS CR WITH (nolock)
WHERE
	CR.TIPO = 'C'

) AS A
WHERE
	A.FECHA_COMPENSACION = $P{FECHA_COMPENSACION}
	AND ($P{SUCURSAL} = A.SUCURSAL OR $P{SUCURSAL} = -1)
	AND (A.MONEDA = $P{MONEDA})
GROUP BY 
	A.SUCURSAL,
	A.FECHA_COMPENSACION,
	A.MONEDA,
	A.ESTADO_DEV_DESC]]>
	</queryString>
	<field name="SUCURSAL" class="java.math.BigDecimal"/>
	<field name="FECHA_COMPENSACION" class="java.sql.Timestamp"/>
	<field name="MONEDA" class="java.math.BigDecimal"/>
	<field name="ESTADO_DEV_DESC" class="java.lang.String"/>
	<field name="TOTAL_IMPORTE" class="java.math.BigDecimal"/>
	<field name="CANTIDAD_CHEQUES" class="java.lang.Integer"/>
	<variable name="TotalEnviadoCheque" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[($F{ESTADO_DEV_DESC}.equalsIgnoreCase("RECHAZADO") || $F{ESTADO_DEV_DESC}.equalsIgnoreCase("ACEPTADO") ? $F{TOTAL_IMPORTE} : 0)]]></variableExpression>
		<initialValueExpression><![CDATA[(0)]]></initialValueExpression>
	</variable>
	<variable name="TotalRechazadoCheque" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{ESTADO_DEV_DESC}.equalsIgnoreCase("RECHAZADO") ? $F{TOTAL_IMPORTE} : 0]]></variableExpression>
		<initialValueExpression><![CDATA[new BigDecimal(0)]]></initialValueExpression>
	</variable>
	<variable name="CantidadEnviadoCheque" class="java.lang.Integer">
		<variableExpression><![CDATA[$V{CantidadEnviadoCheque} + ($F{ESTADO_DEV_DESC}.equalsIgnoreCase("RECHAZADO") ? $F{CANTIDAD_CHEQUES} : 0) + ($F{ESTADO_DEV_DESC}.equalsIgnoreCase("ACEPTADO") ?  + $F{CANTIDAD_CHEQUES} : 0)]]></variableExpression>
		<initialValueExpression><![CDATA[0]]></initialValueExpression>
	</variable>
	<variable name="CantidadRechazadoCheque" class="java.lang.Integer">
		<variableExpression><![CDATA[$V{CantidadRechazadoCheque} + ($F{ESTADO_DEV_DESC}.equalsIgnoreCase("RECHAZADO") ? $F{CANTIDAD_CHEQUES} : 0)]]></variableExpression>
		<initialValueExpression><![CDATA[0]]></initialValueExpression>
	</variable>
	<variable name="CantidadDebitadaCheque" class="java.lang.Integer">
		<variableExpression><![CDATA[$V{CantidadDebitadaCheque} + ($F{ESTADO_DEV_DESC}.equalsIgnoreCase("ACEPTADO") ?  + $F{CANTIDAD_CHEQUES} : 0)]]></variableExpression>
		<initialValueExpression><![CDATA[0]]></initialValueExpression>
	</variable>
	<variable name="TotalDebitadoCheque" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{ESTADO_DEV_DESC}.equalsIgnoreCase("ACEPTADO") ? $F{TOTAL_IMPORTE} : 0]]></variableExpression>
		<initialValueExpression><![CDATA[new BigDecimal(0)]]></initialValueExpression>
	</variable>
	<detail>
		<band height="20">
			<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
			<printWhenExpression><![CDATA[Boolean.FALSE]]></printWhenExpression>
			<textField>
				<reportElement x="220" y="0" width="170" height="20" uuid="b2de9ad9-53fb-43ba-a5d5-441f729c02de"/>
				<textFieldExpression><![CDATA[$F{TOTAL_IMPORTE}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="0" y="0" width="130" height="20" uuid="8f502c8f-fa0b-45c7-8912-198d211a559a"/>
				<textFieldExpression><![CDATA[$F{ESTADO_DEV_DESC}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="391" y="0" width="155" height="20" uuid="075a1ed7-ed4f-456b-9482-89787164726d">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<textFieldExpression><![CDATA[$F{TOTAL_IMPORTE}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="14">
			<staticText>
				<reportElement style="Column Header" x="0" y="0" width="110" height="14" uuid="972250c8-c999-436d-b2b3-868a70a85078">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
					<paragraph leftIndent="10"/>
				</textElement>
				<text><![CDATA[Cheques]]></text>
			</staticText>
			<textField pattern="#,##0.00#" isBlankWhenNull="true">
				<reportElement x="110" y="0" width="110" height="14" uuid="fb2ce9ce-d7e2-464b-a199-6547c826bfa5"/>
				<textElement textAlignment="Right">
					<font size="8"/>
					<paragraph leftIndent="0" rightIndent="0"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{TotalEnviadoCheque}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="220" y="0" width="50" height="14" uuid="b57464c9-ef00-4a29-858d-772affddfb08">
					<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
				</reportElement>
				<textElement textAlignment="Right">
					<font size="8"/>
					<paragraph leftIndent="0" rightIndent="0"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{CantidadEnviadoCheque}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00#" isBlankWhenNull="true">
				<reportElement x="415" y="0" width="100" height="14" uuid="0c0dce3c-b423-4bbf-a53f-fc7b915c7245">
					<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
				</reportElement>
				<textElement textAlignment="Right">
					<font size="8"/>
					<paragraph leftIndent="0" rightIndent="0"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{TotalRechazadoCheque}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="515" y="0" width="40" height="14" uuid="c9f07378-b30e-4775-ad3b-5d8868a139d4">
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
				</reportElement>
				<textElement textAlignment="Right">
					<font size="8"/>
					<paragraph leftIndent="0" rightIndent="0"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{CantidadRechazadoCheque}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00#" isBlankWhenNull="true">
				<reportElement x="270" y="0" width="100" height="14" uuid="353064a8-a264-4500-aea4-5ba96870bfec">
					<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
				</reportElement>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{TotalDebitadoCheque}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="370" y="0" width="45" height="14" uuid="e2db24e2-ff15-467e-a048-04eb6a368b10">
					<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
				</reportElement>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{CantidadDebitadaCheque}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
	<noData>
		<band height="15">
			<staticText>
				<reportElement style="Column Header" x="0" y="0" width="110" height="14" uuid="e74e1498-4446-4756-97fa-c5df965aebfd">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
					<paragraph leftIndent="10"/>
				</textElement>
				<text><![CDATA[Cheques]]></text>
			</staticText>
			<staticText>
				<reportElement x="110" y="0" width="110" height="14" uuid="424393b6-d0f1-4802-9aac-7e9789d06fee"/>
				<textElement textAlignment="Right">
					<font size="8"/>
					<paragraph leftIndent="0" rightIndent="0"/>
				</textElement>
				<text><![CDATA[0.00]]></text>
			</staticText>
			<staticText>
				<reportElement x="220" y="0" width="50" height="14" uuid="629d7390-4388-4ece-88b6-8dfaf5573740"/>
				<textElement textAlignment="Right">
					<font size="8"/>
					<paragraph leftIndent="0" rightIndent="0"/>
				</textElement>
				<text><![CDATA[0]]></text>
			</staticText>
			<staticText>
				<reportElement x="515" y="0" width="40" height="14" uuid="52e547ef-a403-40bf-9a6c-f65a492d049b">
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
				</reportElement>
				<textElement textAlignment="Right">
					<font size="8"/>
					<paragraph leftIndent="0" rightIndent="0"/>
				</textElement>
				<text><![CDATA[0]]></text>
			</staticText>
			<staticText>
				<reportElement x="270" y="0" width="100" height="14" uuid="51505395-05cf-4103-9448-c7f5ae12aa00">
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
				</reportElement>
				<textElement textAlignment="Right">
					<font size="8"/>
					<paragraph leftIndent="0" rightIndent="0"/>
				</textElement>
				<text><![CDATA[0.00]]></text>
			</staticText>
			<staticText>
				<reportElement x="415" y="0" width="100" height="14" uuid="ccbc8fb4-5dbd-400b-bfe8-7494657c7729">
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
				</reportElement>
				<textElement textAlignment="Right">
					<font size="8"/>
					<paragraph leftIndent="0" rightIndent="0"/>
				</textElement>
				<text><![CDATA[0.00]]></text>
			</staticText>
			<staticText>
				<reportElement x="370" y="0" width="45" height="14" uuid="82f2b4c6-108c-4250-a72d-44b9512cc766">
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
				</reportElement>
				<textElement textAlignment="Right">
					<font size="8"/>
					<paragraph leftIndent="0" rightIndent="0"/>
				</textElement>
				<text><![CDATA[0]]></text>
			</staticText>
		</band>
	</noData>
</jasperReport>
