<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="8519" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="table">
		<box>
			<pen lineWidth="1.0" lineColor="#FFFFFF"/>
		</box>
	</style>
	<style name="table_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#FFFFFF"/>
		</box>
	</style>
	<style name="table_CH" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#FFFFFF"/>
		</box>
	</style>
	<style name="table_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#FFFFFF"/>
		</box>
	</style>
	<subDataset name="DataSucursal">
		<parameter name="CODSUC" class="java.lang.String"/>
		<queryString>
			<![CDATA[SELECT C6020 AS NOMSUC FROM TC_SUCURSALES WHERE C6021=$P{CODSUC}]]>
		</queryString>
		<field name="NOMSUC" class="java.lang.String"/>
	</subDataset>
	<parameter name="FechaIni" class="java.util.Date">
		<parameterDescription><![CDATA[Fecha Inicio]]></parameterDescription>
	</parameter>
	<parameter name="FechaFin" class="java.util.Date">
		<parameterDescription><![CDATA[Fecha Fin]]></parameterDescription>
	</parameter>
	<parameter name="codFuncionario" class="java.math.BigDecimal">
		<parameterDescription><![CDATA[Cod.Funcionario]]></parameterDescription>
	</parameter>
	<parameter name="SUCURSAL" class="java.math.BigDecimal">
		<parameterDescription><![CDATA[Cod. Sucursal]]></parameterDescription>
	</parameter>
	<queryString>
		<![CDATA[SELECT  tc.TC_CODIGO, s.MONEDA as moneda, m.C6400 AS nomM, m.C6401 AS SimM, tc.tc_varchar2 AS Estrato,sum(C1601) AS desembolsos ,count(*) AS NoCreditos
FROM SALDOS s,tc_parametros tc ,CO_MONEDAS m
WHERE s.C9314=5 AND s.C1728<>'C' AND ((s.C1601 BETWEEN tc.TC_FLOAT AND tc.TC_INTEGER AND
	                     tc.TC_CODIGO IN (7503,7504,7505,7506,7507,7508,7509,75010,7511))
	                     OR (--caso de mas de
	                     s.C1601 > tc.TC_INTEGER AND tc.TC_CODIGO=7512 )
	                     ) AND (s.tz_lock < 300000000000000 OR s.tz_lock >= 400000000000000) AND (s.tz_lock < 100000000000000 OR s.tz_lock >= 200000000000000)
	                     AND s.C1621 BETWEEN $P{FechaIni} AND $P{FechaFin} AND C1670=$P{codFuncionario} AND s.MONEDA=m.C6399
	                     AND s.SUCURSAL=$P{SUCURSAL}
GROUP BY tc.TC_CODIGO, s.moneda,m.C6400,m.C6401,tc.tc_varchar2
ORDER BY moneda, tc.tc_codigo]]>
	</queryString>
	<field name="TC_CODIGO" class="java.math.BigDecimal"/>
	<field name="moneda" class="java.math.BigDecimal"/>
	<field name="nomM" class="java.lang.String"/>
	<field name="SimM" class="java.lang.String"/>
	<field name="Estrato" class="java.lang.String"/>
	<field name="desembolsos" class="java.math.BigDecimal"/>
	<field name="NoCreditos" class="java.lang.Integer"/>
	<variable name="desembolsos_1" class="java.math.BigDecimal" resetType="Column" calculation="Sum">
		<variableExpression><![CDATA[$F{desembolsos}]]></variableExpression>
	</variable>
	<variable name="NoCreditos_1" class="java.lang.Integer" resetType="Column" calculation="Sum">
		<variableExpression><![CDATA[$F{NoCreditos}]]></variableExpression>
	</variable>
	<variable name="desembolsos_2" class="java.math.BigDecimal" resetType="Group" resetGroup="Moneda" calculation="Sum">
		<variableExpression><![CDATA[$F{desembolsos}]]></variableExpression>
	</variable>
	<variable name="NoCreditos_2" class="java.lang.Integer" resetType="Group" resetGroup="Moneda" calculation="Sum">
		<variableExpression><![CDATA[$F{NoCreditos}]]></variableExpression>
	</variable>
	<group name="Moneda" isStartNewPage="true">
		<groupExpression><![CDATA[$F{moneda}]]></groupExpression>
		<groupHeader>
			<band height="69">
				<rectangle>
					<reportElement x="0" y="0" width="555" height="20" backcolor="#CCCCCC"/>
				</rectangle>
				<staticText>
					<reportElement x="234" y="35" width="100" height="20"/>
					<textElement textAlignment="Center">
						<font size="12" isBold="true"/>
					</textElement>
					<text><![CDATA[Desembolsos	]]></text>
				</staticText>
				<staticText>
					<reportElement x="428" y="35" width="100" height="20"/>
					<textElement textAlignment="Center">
						<font size="12" isBold="true"/>
					</textElement>
					<text><![CDATA[No. CrÃ©ditos]]></text>
				</staticText>
				<line>
					<reportElement x="0" y="61" width="555" height="1"/>
				</line>
				<textField>
					<reportElement x="0" y="0" width="555" height="20"/>
					<textElement textAlignment="Center">
						<font size="12" isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{nomM}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="11" y="35" width="100" height="20"/>
					<textElement>
						<font size="12" isBold="true"/>
					</textElement>
					<text><![CDATA[Estrato]]></text>
				</staticText>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="56">
				<rectangle>
					<reportElement x="0" y="12" width="555" height="44" backcolor="#CCCCCC"/>
				</rectangle>
				<textField>
					<reportElement x="234" y="29" width="100" height="20"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{desembolsos_2}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="428" y="29" width="100" height="20"/>
					<textElement textAlignment="Center">
						<font isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.Integer"><![CDATA[$V{NoCreditos_2}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="11" y="29" width="100" height="20"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<text><![CDATA[Totales]]></text>
				</staticText>
				<textField>
					<reportElement x="174" y="29" width="57" height="20"/>
					<textElement textAlignment="Right">
						<font isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{SimM}]]></textFieldExpression>
				</textField>
				<line>
					<reportElement x="0" y="11" width="555" height="1"/>
				</line>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="71" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="10" width="555" height="29"/>
				<textElement textAlignment="Center">
					<font size="16" isBold="true"/>
				</textElement>
				<text><![CDATA[FUNDESER]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="39" width="555" height="20"/>
				<textElement textAlignment="Center">
					<font size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[Montos Desembolsados por Rangos]]></text>
			</staticText>
		</band>
	</title>
	<pageHeader>
		<band height="6" splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="58" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="45" height="20"/>
				<textElement/>
				<text><![CDATA[Sucursal:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="28" width="72" height="20"/>
				<textElement/>
				<text><![CDATA[PERIODO DEL]]></text>
			</staticText>
			<staticText>
				<reportElement x="129" y="28" width="15" height="20"/>
				<textElement/>
				<text><![CDATA[AL]]></text>
			</staticText>
			<componentElement>
				<reportElement key="table" style="table" x="45" y="0" width="358" height="20"/>
				<jr:table xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd">
					<datasetRun subDataset="DataSucursal">
						<datasetParameter name="CODSUC">
							<datasetParameterExpression><![CDATA[$P{SUCURSAL}]]></datasetParameterExpression>
						</datasetParameter>
						<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					</datasetRun>
					<jr:column width="90">
						<jr:detailCell style="table_TD" height="20">
							<textField>
								<reportElement x="0" y="0" width="90" height="20"/>
								<textElement/>
								<textFieldExpression class="java.lang.String"><![CDATA[$F{NOMSUC}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
				</jr:table>
			</componentElement>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="73" y="28" width="56" height="20"/>
				<textElement/>
				<textFieldExpression class="java.util.Date"><![CDATA[$P{FechaIni}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="144" y="28" width="100" height="20"/>
				<textElement/>
				<textFieldExpression class="java.util.Date"><![CDATA[$P{FechaFin}]]></textFieldExpression>
			</textField>
		</band>
	</columnHeader>
	<detail>
		<band height="30" splitType="Stretch">
			<textField>
				<reportElement x="11" y="10" width="100" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{Estrato}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="234" y="10" width="100" height="20"/>
				<textElement textAlignment="Center"/>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{desembolsos}=="null"?
0:
$F{desembolsos}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="428" y="10" width="100" height="20"/>
				<textElement textAlignment="Center"/>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{NoCreditos}=="null"?
0:
$F{NoCreditos}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band height="10" splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="10" splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="9" splitType="Stretch"/>
	</summary>
</jasperReport>
