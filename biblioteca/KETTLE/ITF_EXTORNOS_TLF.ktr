<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>ITF_EXTORNOS_TLF</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/</directory>
    <parameters>
      <parameter>
        <name>ID_TICKET</name>
        <default_value>0</default_value>
        <description/>
      </parameter>
      <parameter>
        <name>RUTA</name>
        <default_value/>
        <description/>
      </parameter>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2023/10/19 15:47:56.312</created_date>
    <modified_user>-</modified_user>
    <modified_date>2023/10/19 15:47:56.312</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
    <notepad>
      <note>+FechaProcesoTopaz</note>
      <xloc>4048</xloc>
      <yloc>192</yloc>
      <width>123</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
  </notepads>
  <connection>
    <name>TopazDS</name>
    <server/>
    <type>MSSQL</type>
    <access>JNDI</access>
    <database>TopazDS</database>
    <port>1521</port>
    <username/>
    <password>Encrypted </password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1521</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>TLF_COD_TRANSACCIONES</from>
      <to>Parse Transacciones</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Parse Transacciones</from>
      <to>Obtengo Transacciones</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Obtengo Transacciones</from>
      <to>Descartar registros</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Fixed file input</from>
      <to>Strings</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Fixed file input</from>
      <to>Flujo vacio?</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Flujo vacio?</from>
      <to>Flujo vacio</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get variables</from>
      <to>Parseo campos especificos</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Descartar registros</from>
      <to>Parse PreInstert</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Parseo campos especificos</from>
      <to>Obtengo Transacciones</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Descartar registros</from>
      <to>Dummy (do nothing)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Suma Impactos-Reversas</from>
      <to>Unico idTLF</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>TLF_CONCILIACION_CABECERA</from>
      <to>Select ID_CABECERA</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select ID_CABECERA</from>
      <to>Ordena ID_CABECERA</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Ordena ID_CABECERA</from>
      <to>Stream lookup</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Recupera ESTADO_TLF</from>
      <to>keyTLF</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>lastRowOperacion</from>
      <to>ESTADO_TLF</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>ESTADO_TLF</from>
      <to>Recupera ESTADO_TLF</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Configura Detalle</from>
      <to>Descartar Asiento en 0</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Tipo impacto online</from>
      <to>Ordena idTLF</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Stream lookup</from>
      <to>Filter rows</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Filter rows</from>
      <to>No encuentra cabecera</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Db join</from>
      <to>Descartar Asiento nulo</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Descartar Asiento nulo</from>
      <to>Tipo impacto online</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Ordena idTLF</from>
      <to>Suma Impactos-Reversas</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Ordena idTLF</from>
      <to>Configura Detalle</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Parse PreInstert</from>
      <to>Actualizar nulo</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Actualizar nulo</from>
      <to>Buscar desde 420</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Actualizar (ID_CABECERA)</from>
      <to>descarta actualizar_id_cabecera</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Actualizar nulo</from>
      <to>Unir</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Buscar desde 420</from>
      <to>Existe Msg anterior?</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>keyTLF</from>
      <to>Importe TLF</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Unir</from>
      <to>Ordena TLF</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>ESTADO_CONCILIACION</from>
      <to>Actualizar</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Descartar Asiento en 0</from>
      <to>numeroDetalle</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Unico idTLF</from>
      <to>ESTADO_CONCILIACION</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>numeroDetalle</from>
      <to>Sincroniza</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sincroniza</from>
      <to>Stream lookup</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Importe TLF</from>
      <to>Db join</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Actualizar</from>
      <to>REVERSA_DIA_ANTERIOR</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>REVERSA_DIA_ANTERIOR</from>
      <to>TLF_CONCILIACION_CABECERA [update]</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>TLF_CONCILIACION_CABECERA [update]</from>
      <to>ID_CABECERA</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>TLF_CONCILIACION_DETALLE</from>
      <to>Dummy (do nothing) 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>ID_CABECERA</from>
      <to>Select ID_CABECERA 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select ID_CABECERA 2</from>
      <to>Ordena ID_CABECERA</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Existe Msg anterior?</from>
      <to>DETALLE [Delete]</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>DETALLE [Delete]</from>
      <to>Actualizar (ID_CABECERA)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Actualizar</from>
      <to>CANT_OK_CAB</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>CANT_OK_CAB</from>
      <to>TLF_CONCILIACION_CABECERA</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Strings</from>
      <to>CANT_REG_IN</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>CANT_REG_IN</from>
      <to>Get variables</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Parseo campos especificos</from>
      <to>CANT_INVALIDOS</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Filter rows</from>
      <to>CANT_OK_DET</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>CANT_OK_DET</from>
      <to>TLF_CONCILIACION_DETALLE</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>keyTLF</from>
      <to>CANT_DUPLICADO</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>descarta actualizar_id_cabecera</from>
      <to>Unir</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sospechoso</from>
      <to>DescartaSospechoso</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>DescartaSospechoso</from>
      <to>lastRowOperacion</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>DescartaSospechoso</from>
      <to>CANT_REVERSA_SOSPECHOSA</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Ordena TLF</from>
      <to>idSospechoso</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>idSospechoso</from>
      <to>Sospechoso</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>Actualizar</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>CANT_OK_CAB</send_true_to>
    <send_false_to>REVERSA_DIA_ANTERIOR</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>ACTUALIZAR</leftvalue>
        <function>IS NULL</function>
        <rightvalue/>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>3008</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Actualizar (ID_CABECERA)</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here

// Actualizar datos de mensaje APROBADO, obtenido.
ACTUALIZAR = ACTUALIZAR_CABECERA;
LKTYP=210;
LKRES2='00'
writeToLog('b',
			 '* * * * * * * * * * * * * * * * \n'
			+'Se obtuvo mensaje [Aprobado] con id_cabecera: '+ACTUALIZAR+'\n'
			+'* * * * * * * * * * * * * * * * \n'
		);</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>ACTUALIZAR</name>
        <rename>ACTUALIZAR</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>LKTYP</name>
        <rename>LKTYP</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>LKRES2</name>
        <rename>LKRES2</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1184</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Actualizar nulo</name>
    <type>Constant</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ACTUALIZAR</name>
        <type>Integer</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1040</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Buscar desde 420</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>Existe Msg anterior?</send_true_to>
    <send_false_to/>
    <compare>
      <condition>
        <negated>N</negated>
        <conditions>
          <condition>
            <negated>N</negated>
            <leftvalue>LKTYP</leftvalue>
            <function>=</function>
            <rightvalue/>
            <value>
              <name>constant</name>
              <type>Integer</type>
              <text>420</text>
              <length>-1</length>
              <precision>0</precision>
              <isnull>N</isnull>
              <mask>####0;-####0</mask>
            </value>
          </condition>
          <condition>
            <negated>N</negated>
            <operator>AND</operator>
            <leftvalue>sospechoso</leftvalue>
            <function>IS NULL</function>
            <rightvalue/>
          </condition>
        </conditions>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1040</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>CANT_DUPLICADO</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>count++</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>1</jsScript_type>
        <jsScript_name>Item_0</jsScript_name>
        <jsScript_script>var count = 0;</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>2</jsScript_type>
        <jsScript_name>Item_1</jsScript_name>
        <jsScript_script>setVariable(_step_.getStepname(), count, 'r');</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2032</xloc>
      <yloc>400</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>CANT_INVALIDOS</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>count++</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>1</jsScript_type>
        <jsScript_name>Item_0</jsScript_name>
        <jsScript_script>var count = 0;</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>2</jsScript_type>
        <jsScript_name>Item_1</jsScript_name>
        <jsScript_script>setVariable(_step_.getStepname(), count, 'r');</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>528</xloc>
      <yloc>416</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>CANT_OK_CAB</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>count++</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>1</jsScript_type>
        <jsScript_name>Item_0</jsScript_name>
        <jsScript_script>var count = 0;</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>2</jsScript_type>
        <jsScript_name>Item_1</jsScript_name>
        <jsScript_script>setVariable(_step_.getStepname(), count, 'r');</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>3200</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>CANT_OK_DET</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>count++</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>1</jsScript_type>
        <jsScript_name>Item_0</jsScript_name>
        <jsScript_script>var count = 0;</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>2</jsScript_type>
        <jsScript_name>Item_1</jsScript_name>
        <jsScript_script>setVariable(_step_.getStepname(), count, 'r');</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>3904</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>CANT_REG_IN</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>count++</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>1</jsScript_type>
        <jsScript_name>Item_0</jsScript_name>
        <jsScript_script>var count = 0;</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>2</jsScript_type>
        <jsScript_name>Item_1</jsScript_name>
        <jsScript_script>setVariable(_step_.getStepname(), count, 'r');</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>288</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>CANT_REVERSA_SOSPECHOSA</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>count++</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>1</jsScript_type>
        <jsScript_name>Item_0</jsScript_name>
        <jsScript_script>var count = 0;</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>2</jsScript_type>
        <jsScript_name>Item_1</jsScript_name>
        <jsScript_script>setVariable(_step_.getStepname(), count, 'r');</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1600</xloc>
      <yloc>416</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Configura Detalle</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>var detalleImporte = convertirBigDecimalMenosDos(element4);</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>1</jsScript_type>
        <jsScript_name>Item_0</jsScript_name>
        <jsScript_script>var convertirBigDecimalMenosDos = function(numberToConvert) {

	var importe =  java.math.BigDecimal.ZERO	

	if (numberToConvert != null) {
		importe = new java.math.BigDecimal(numberToConvert);
		importe = importe.scaleByPowerOfTen(-2);
	}

	return importe;
}</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>detalleImporte</name>
        <rename>detalleImporte</rename>
        <type>BigNumber</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2640</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>DETALLE [Delete]</name>
    <type>ExecSQL</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazDS</connection>
    <execute_each_row>Y</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>Y</replace_variables>
    <quoteString>N</quoteString>
    <sql>DELETE FROM dbo.TLF_CONCILIACION_DETALLE
WHERE ID_CABECERA = ?</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
      <argument>
        <name>ACTUALIZAR_CABECERA</name>
      </argument>
    </arguments>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1184</xloc>
      <yloc>560</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Db join</name>
    <type>SimpleMapping</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>6</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <specification_method>filename</specification_method>
    <trans_object_id/>
    <trans_name/>
    <filename>${Top.Repository}ITF_EXTORNOS_TLF_CONSULTA.ktr</filename>
    <directory_path/>
    <mappings>
      <input>
        <mapping>
          <input_step/>
          <output_step/>
          <main_path>Y</main_path>
          <rename_on_output>Y</rename_on_output>
          <description/>
          <connector>
            <parent>O_LKTRAD</parent>
            <child>O_LKTRAD</child>
          </connector>
          <connector>
            <parent>O_LKTRAT</parent>
            <child>O_LKTRAT</child>
          </connector>
          <connector>
            <parent>LKSEQN</parent>
            <child>LKSEQN</child>
          </connector>
          <connector>
            <parent>LKTERM</parent>
            <child>LKTERM</child>
          </connector>
          <connector>
            <parent>LKFROM</parent>
            <child>LKFROM</child>
          </connector>
          <connector>
            <parent>LKTOAC</parent>
            <child>LKTOAC</child>
          </connector>
          <connector>
            <parent>COD_MSJ_H2H</parent>
            <child>COD_MSJ_H2H</child>
          </connector>
        </mapping>
      </input>
      <output>
        <mapping>
          <input_step/>
          <output_step/>
          <main_path>Y</main_path>
          <rename_on_output>N</rename_on_output>
          <description/>
        </mapping>
      </output>
      <parameters>
        <inherit_all_vars>Y</inherit_all_vars>
      </parameters>
    </mappings>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2192</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>DescartaSospechoso</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>lastRowOperacion</send_true_to>
    <send_false_to>CANT_REVERSA_SOSPECHOSA</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>sospechoso</leftvalue>
        <function>IS NULL</function>
        <rightvalue/>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1600</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Descartar Asiento en 0</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>trans_Status = CONTINUE_TRANSFORMATION;

if (parseInt(ASIENTO_NUMERO,10) == 0 || ASIENTO_NUMERO == null || ELEMENT39 == '05') {
	trans_Status = SKIP_TRANSFORMATION;
} 
//else if ( validarElemento(LKTYP, ELEMENT0) != true) {
//	trans_Status = SKIP_TRANSFORMATION;
//};

</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>1</jsScript_type>
        <jsScript_name>Item_0</jsScript_name>
        <jsScript_script>//Script here
var validarElemento = function(lktyp, element0) {
  lktyp = String(lktyp);
  element0 = String(element0);

  var validos = {
    '210': ['0210', '0230'],
    '220': ['0230'],
    '420': ['0430']
  };

  if (validos.hasOwnProperty(lktyp)) {
    var permitidos = validos[lktyp];
    return permitidos.indexOf(element0) !== -1;
  }
	
  return false;

}</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2768</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Descartar Asiento nulo</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>trans_Status = CONTINUE_TRANSFORMATION;

if (ASIENTO_NUMERO == null) {
	REG_ASIENTO_NULO++
	trans_Status = SKIP_TRANSFORMATION;
} 
</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>1</jsScript_type>
        <jsScript_name>Item_0</jsScript_name>
        <jsScript_script>//Script here

var REG_ASIENTO_NULO = 0</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>2</jsScript_type>
        <jsScript_name>Item_1</jsScript_name>
        <jsScript_script>//Script here

setVariable('REG_ASIENTO_NULO', REG_ASIENTO_NULO, 'r');</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2288</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Descartar registros</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>trans_Status = CONTINUE_TRANSFORMATION;

// Bandera marca descarte
var d = false;
var sospechoso = null;

// Codigo de transacción válido
if (COD_MSJ_TLF != null) {

	// Estado Transacción Válido
	if (!(LKTYP=='0210' || LKTYP == '0220' || LKTYP == '0420')) {
		CANT_ESTADO_INVAL++;
		setError(100, 'Estado de transacción inválido');
	}
	else {
		
		if (parseInt(LKFROM, 10) == 0) {
			LKFROM = rpad('', ' ', 28);
		};

		if (parseInt(LKTOAC, 10) == 0) {
			LKTOAC = rpad('', ' ', 28);
		};

		O_LKTRAD = substr(LKTRAD, 2, 4);
		O_LKTRAT = substr(LKTRAT, 0, 6);		

		if ( String(LKRVSL)=='20' &amp;&amp; String(LKTCDE)=='10' ) {
			//CANT_REVERSA_SOSPECHOSA++;
			//setError(120, 'Reversa sospechosa');
			sospechoso = 'LKRVSL: '+LKRVSL+' - '+'LKTCDE: '+LKTCDE;
		};

		ordinal++;

	};


} else {
	//trans_Status = SKIP_TRANSFORMATION;
	CANT_NO_PARAM++;
	setError(110, 'Registros no parametrizados.');
}
</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>1</jsScript_type>
        <jsScript_name>Item_0</jsScript_name>
        <jsScript_script>var ordinal = 0;
var CANT_NO_PARAM = 0;
var CANT_ESTADO_INVAL = 0;
//var CANT_REVERSA_SOSPECHOSA = 0;

const setError = function(codigo, descripcion) {
	CODIGO = codigo!=null ? parseInt(codigo, 10) : 99;
	ERROR = String(descripcion);
//	writeToLog('e', 
//		 '\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -'
//		+'\nSe encontró un error en validaciones de registro:'
//		+'\n - Código de error: ' + CODIGO
//		+'\n - Mensaje de error: ' + ERROR
//		+'\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -'
//	);
	_step_.putError( rowMeta, row, 1, ERROR, '', CODIGO);
	trans_Status = SKIP_TRANSFORMATION;
}</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>2</jsScript_type>
        <jsScript_name>Item_1</jsScript_name>
        <jsScript_script>//Script here

setVariable('CANT_ESTADO_INVAL', CANT_ESTADO_INVAL, 'r');
//setVariable('CANT_REVERSA_SOSPECHOSA', CANT_REVERSA_SOSPECHOSA, 'r');
setVariable('CANT_NO_PARAM', CANT_NO_PARAM, 'r');</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>LKFROM</name>
        <rename>LKFROM</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>LKTOAC</name>
        <rename>LKTOAC</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>O_LKTRAD</name>
        <rename>O_LKTRAD</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>O_LKTRAT</name>
        <rename>O_LKTRAT</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>sospechoso</name>
        <rename>sospechoso</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>832</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Dummy (do nothing)</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>832</xloc>
      <yloc>416</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Dummy (do nothing) 3</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>4048</xloc>
      <yloc>592</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>ESTADO_CONCILIACION</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>// Variables
// ESTADO_TLF = APROBADA, RECHAZADA, REVERSADA | DESCONOCIDA: No me importa.-
// IMPACTOS_ONLINE = Cantidad de impactos (0210, 0230)
// REVERSAS_ONLINE = Cantidad de reversas (0430)
// ESTADO_CONCILIACION = Valor a calcular según detalle

//ESTADO_CONCILIACION:
//Tendrá el valor 'OK':
//a. Si ESTADO_TLF = 'APROBADA' &amp; impactos_online = 1 &amp; reversas_online = 0;
//b. Si ESTADO_TLF = 'RECHAZADA' &amp; (impactos_online = 1 &amp; reversas_online = 1) ó (impactos_online = 0 &amp; reversas_online = 0)
//c. Si ESTADO_TLF = 'REVERSARDA' &amp; (impactos_online = 1 &amp; reversas_online = 1)


var ESTADO_CONCILIACION = "NO_OK";

var impactos = Number(IMPACTOS_ONLINE);
var reversas = Number(REVERSAS_ONLINE);

if (ESTADO_TLF == "APROBADA" &amp;&amp; (impactos - reversas) == 1) {
    ESTADO_CONCILIACION = "OK";
}

if ((ESTADO_TLF == "RECHAZADA" || ESTADO_TLF == "REVERSADA") &amp;&amp; impactos == reversas) {
    ESTADO_CONCILIACION = "OK";
}

if (ESTADO_TLF == "DESCONOCIDA") {
    ESTADO_CONCILIACION = null;
}

</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>ESTADO_CONCILIACION</name>
        <rename>ESTADO_CONCILIACION</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2896</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>ESTADO_TLF</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>// Inicialización de variables
var trans_Status = CONTINUE_TRANSFORMATION;
var ESTADO_MSG = '';
var actualKey = makeHash(O_LKTRAD, O_LKTRAT, LKSEQN, LKTERM, LKFROM, LKTOAC, COD_MSJ_H2H);
var idMensaje = 0;
var FECHA_NEGOCIO = parseDate(LKPOST, 'yyMMdd');

// Inicialización de estado
if (first != null || keyTLF != actualKey) {
    if (first != null) {
        first = null;
    }
    keyTLF = actualKey;
    idOperacion++;
    estado = new EstadoTLF();

	if (ACTUALIZAR != null) {
		esActualizacion = parseInt(ACTUALIZAR, 10);
	} else {
		esActualizacion = null;
	}
};

if (esActualizacion != null) {
	ACTUALIZAR = esActualizacion;
}

// Agregar mensaje
estado.agregarMensaje(LKTYP, LKRES2);

// Cantidad de mensajes
idMensaje = estado.cantidadMensajes();

// Determinar estado 
ESTADO_MSG = estado.determinarEstado();

// Si se han recibido más de dos mensajes, se marca el estado como desconocido y se registra el error
if (idMensaje > 2) {		
    ESTADO_MSG = 'DESCONOCIDA';
    logMensajesError('Se recibieron más de dos mensajes:', actualKey, estado.mensajes);
}

// En caso de que el estado final sea desconocido, se registra el error en el log
if (ESTADO_MSG == 'DESCONOCIDA') {
    logMensajesError('Error al determinar estado:', actualKey, estado.mensajes);
}
</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>1</jsScript_type>
        <jsScript_name>Item_1</jsScript_name>
        <jsScript_script>// Variables globales
var keyTLF = '';
var first = 'ok';
var idOperacion = 0;
var esActualizacion = 0;

// Scripts from tabs
LoadScriptFromTab("date");
LoadScriptFromTab("hash");
LoadScriptFromTab("EstadoTLF");
LoadScriptFromTab("logMsgError");


</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>-1</jsScript_type>
        <jsScript_name>EstadoTLF</jsScript_name>
        <jsScript_script>function EstadoTLF() {
    this.mensajes = [];
    this.statusDescription = '';

    this.agregarMensaje = function(lktyp, lkres) {
        this.mensajes.push({ tipo: lktyp, res: lkres });
    };
	
	this.cantidadMensajes = function() {
		return this.mensajes.length;
	}
	
    this.determinarEstado = function() {
        var esOk = { 
            '00': true,
            '01': true
        };

        var porTipo = {
            '210': [],
            '220': [],
            '420': []
        };

        for (var i = 0; i &lt; this.mensajes.length; i++) {
            var msg = this.mensajes[i];
            var tipo = String(msg.tipo);
            if (porTipo[tipo]) {
                porTipo[tipo].push(msg.res);
            }
        }

        // Variables de estado
        var tieneRechazo = false;
        var tieneAprobada = false;
        var tieneReversa = false;

        // Rechazos en 210
        for (var i = 0; i &lt; porTipo['210'].length; i++) {
            var res = porTipo['210'][i];
            if (!esOk[res]) {
                tieneRechazo = true;
                break;
            }
        }

        // Aprobadas en 210 o 220
        var aprobadas = porTipo['210'].concat(porTipo['220']);
        for (var i = 0; i &lt; aprobadas.length; i++) {
            var res = aprobadas[i];
            if (esOk[res]) {
                tieneAprobada = true;
                break;
            }
        }

        // Reversas en 420
        for (var i = 0; i &lt; porTipo['420'].length; i++) {
            var res = porTipo['420'][i];
            if (esOk[res]) {
                tieneReversa = true;
                break;
            }
        }

        // Asignar estado
        var estado = null;
        if (tieneAprobada &amp;&amp; tieneReversa) {
            estado = 'REVERSADA';
        } else if (tieneAprobada) {
            estado = 'APROBADA';
        } else if (tieneRechazo) {
            estado = 'RECHAZADA';
        }

        // Estado desconocido
        if (this.cantidadMensajes() > 0) {
            var primerRes = this.mensajes[0].res;
            if ((!esOk[primerRes] &amp;&amp; tieneReversa) || estado == null) {
                estado = 'DESCONOCIDA';
            }
        }

        this.statusDescription = estado;
        return this.statusDescription;
    };

}
</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>-1</jsScript_type>
        <jsScript_name>logMsgError</jsScript_name>
        <jsScript_script>// Loguear errores

function logMensajesError(prefix, key, mensajes) {
	var error = '\n' + prefix
		+ '\n - Clave (LKTRAD,LKTRAT,LKSEQN,LKTERM,LKFROM,LKTOAC,COD_MSJ_H2H): ' + key
		+ '\n - Mensajes: ';

	for (var x in mensajes) {
		var msg = mensajes[x];
		error += '\n  + lktyp: [' + msg.tipo + ']. lkres2: [' + msg.res + ']. ';
	}
	error += '\n';
	writeToLog('e', error);
}
</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>-1</jsScript_type>
        <jsScript_name>hash</jsScript_name>
        <jsScript_script>// Crear hash para detectar nuevo mensaje

var makeHash = function(LKTRAD, LKTRAT, LKSEQN, LKTERM, LKFROM, LKTOAC, COD_MSJ_H2H) {
	var hash = '';
	hash+=trim(LKTRAD)+'-'+trim(LKTRAT)+'-'+trim(LKSEQN)+'-'+trim(LKTERM)+'-'+trim(LKFROM)+'-'+trim(LKTOAC)+'-'+trim(COD_MSJ_H2H);
	return String(hash)
}

</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>-1</jsScript_type>
        <jsScript_name>date</jsScript_name>
        <jsScript_script>//Script here

//Parsear fecha
const parseDate = function (date, format) {
  // Convierte parámetros a strings de javascript, en caso de que se hayan recibido strings de java.
  date = String(date)
  format = String(format)
 
  // Intenta parsear el string en el formato especificado. Si no puede hacerlo, retorna nulo.
  var parsedDate;
  try {
    parsedDate = str2date( date, format);
  } catch (ex) {
    return null;
  }
 
  // Convierte la fecha parseada de nuevo a string
  var reversedDate = date2str( parsedDate, format);
 
  // Si la fecha parseada y el string generado a partir de la fecha parseada son iguales,
  // entonces la fecha no generó problemas en el parseo.
  if ( reversedDate == date) {
    return parsedDate;
  } else {
    return null;
  }
}

</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>ESTADO_MSG</name>
        <rename>ESTADO_MSG</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>idOperacion</name>
        <rename>idTLF</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>FECHA_NEGOCIO</name>
        <rename>FECHA_NEGOCIO</rename>
        <type>Date</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ACTUALIZAR</name>
        <rename>ACTUALIZAR</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1824</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Existe Msg anterior?</name>
    <type>SimpleMapping</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <specification_method>filename</specification_method>
    <trans_object_id/>
    <trans_name/>
    <filename>${Top.Repository}ITF_EXTORNOS_TLF_ANTERIOR.ktr</filename>
    <directory_path/>
    <mappings>
      <input>
        <mapping>
          <input_step/>
          <output_step/>
          <main_path>Y</main_path>
          <rename_on_output>Y</rename_on_output>
          <description/>
          <connector>
            <parent>O_LKTRAD</parent>
            <child>O_LKTRAD</child>
          </connector>
          <connector>
            <parent>O_LKTRAT</parent>
            <child>O_LKTRAT</child>
          </connector>
          <connector>
            <parent>LKSEQN</parent>
            <child>LKSEQN</child>
          </connector>
          <connector>
            <parent>LKTERM</parent>
            <child>LKTERM</child>
          </connector>
          <connector>
            <parent>LKFROM</parent>
            <child>LKFROM</child>
          </connector>
          <connector>
            <parent>LKTOAC</parent>
            <child>LKTOAC</child>
          </connector>
          <connector>
            <parent>COD_MSJ_H2H</parent>
            <child>COD_MSJ_H2H</child>
          </connector>
        </mapping>
      </input>
      <output>
        <mapping>
          <input_step/>
          <output_step/>
          <main_path>Y</main_path>
          <rename_on_output>N</rename_on_output>
          <description/>
        </mapping>
      </output>
      <parameters>
        <inherit_all_vars>Y</inherit_all_vars>
      </parameters>
    </mappings>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1040</xloc>
      <yloc>560</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Filter rows</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>CANT_OK_DET</send_true_to>
    <send_false_to>No encuentra cabecera</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>ID_CABECERA</leftvalue>
        <function>IS NOT NULL</function>
        <rightvalue/>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>3776</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Fixed file input</name>
    <type>FixedInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <filename>${RCI}${NA}</filename>
    <line_width>908</line_width>
    <header>N</header>
    <buffer_size>50000</buffer_size>
    <lazy_conversion>N</lazy_conversion>
    <line_feed>Y</line_feed>
    <parallel>N</parallel>
    <file_type>NONE</file_type>
    <encoding>UTF-8</encoding>
    <add_to_result_filenames>N</add_to_result_filenames>
    <fields>
      <field>
        <name>LKBYTE</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>6</width>
        <length>6</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKPREF</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>8</width>
        <length>8</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKDATT</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>19</width>
        <length>19</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKRECT</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>2</width>
        <length>2</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKAUTP</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>4</width>
        <length>4</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKLNAT</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>4</width>
        <length>4</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKFIIA</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>4</width>
        <length>4</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKTERM</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>16</width>
        <length>16</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKLNCA</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>4</width>
        <length>4</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKFIIC</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>4</width>
        <length>4</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKPANC</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>28</width>
        <length>28</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKMBRN</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>3</width>
        <length>3</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKBRCH</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>4</width>
        <length>4</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKREGN</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>4</width>
        <length>4</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKUSER</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>2</width>
        <length>2</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKTYPC</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>2</width>
        <length>2</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKTYP</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>4</width>
        <length>4</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKRTES</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>2</width>
        <length>2</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKFI01</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>59</width>
        <length>59</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKTRAD</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>6</width>
        <length>6</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKTRAT</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>8</width>
        <length>8</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKPOST</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>6</width>
        <length>6</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKFI02</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>12</width>
        <length>12</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKSEQN</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>12</width>
        <length>12</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKTERT</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>2</width>
        <length>2</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKFI03</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>27</width>
        <length>27</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKTCDE</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>2</width>
        <length>2</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKTFRO</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>2</width>
        <length>2</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKTTO</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>2</width>
        <length>2</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKFROM</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>28</width>
        <length>28</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKFI04</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>1</width>
        <length>1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKTOAC</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>28</width>
        <length>28</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKFI05</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>1</width>
        <length>1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKAMT1</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>19</width>
        <length>19</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKAMT2</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>19</width>
        <length>19</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKAMT3</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>19</width>
        <length>19</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKFI08</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>11</width>
        <length>11</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKRES1</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>1</width>
        <length>1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKRES2</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>2</width>
        <length>2</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKNOMB</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>25</width>
        <length>25</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKFI10</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>38</width>
        <length>38</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKTERC</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>2</width>
        <length>2</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKFI11</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>28</width>
        <length>28</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKORIG</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>3</width>
        <length>3</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKDATO</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>22</width>
        <length>22</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKTIPV</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>8</width>
        <length>8</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKFI14</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>11</width>
        <length>11</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKRVSL</name>
        <type>String</type>
        <format/>
        <trim_type>both</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>2</width>
        <length>2</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKPIN</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>16</width>
        <length>16</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKFILL</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>72</width>
        <length>72</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKTIPD</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>1</width>
        <length>1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKISSU</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>4</width>
        <length>4</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKINTE</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>6</width>
        <length>6</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKCASH</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>8</width>
        <length>8</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKFI15</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>250</width>
        <length>250</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>LKFI16</name>
        <type>String</type>
        <format/>
        <trim_type>none</trim_type>
        <currency/>
        <decimal/>
        <group/>
        <width>25</width>
        <length>25</length>
        <precision>-1</precision>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>80</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Flujo vacio</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>trans_Status = CONTINUE_TRANSFORMATION;

ERROR = 'Archivo vacío";

// Kaboom!
writeToLog('e' , ERROR);
setVariable('msg_err', ERROR, 'r');
trans_Status = ERROR_TRANSFORMATION;

</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>80</xloc>
      <yloc>512</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Flujo vacio?</name>
    <type>DetectEmptyStream</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>80</xloc>
      <yloc>416</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get variables</name>
    <type>GetVariable</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>FECHA_PROCESO</name>
        <variable>${FECHATOP}</variable>
        <type>Date</type>
        <format>yyyy-MM-dd</format>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
      </field>
      <field>
        <name>FECHA_RELOJ</name>
        <variable>${FYHACTRELOJ}</variable>
        <type>Date</type>
        <format>yyyy-MM-dd HH:mm:ss</format>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
      </field>
      <field>
        <name>TICKET</name>
        <variable>${ID_TICKET}</variable>
        <type>Integer</type>
        <format>0</format>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>ARCHIVO</name>
        <variable>${NA}</variable>
        <type>String</type>
        <format>#</format>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>400</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>ID_CABECERA</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here

var ID_CABECERA = ACTUALIZAR;</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>ID_CABECERA</name>
        <rename>ID_CABECERA</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>3360</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Importe TLF</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>var TLF_IMPORTE = java.math.BigDecimal.ZERO;

if (LKAMT1 != null) {
	TLF_IMPORTE = TLF_IMPORTE.add(calculaImporte(LKORIG, LKTFRO, LKTTO, LKAMT1, LKTIPV));
};</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>1</jsScript_type>
        <jsScript_name>Item_0</jsScript_name>
        <jsScript_script>//Script here

mapTipoCuenta = {
	'11' : true, // caja de ahorro en pesos
	'01' : true, // cc pesos
	'15' : true  // ca dolares
	//,'07' : true  // 07 cc dolares
}

mapTipoCuentaPesos = {
	'11': true,
	'01': true
}

var nuevoBigDecimal = function(numberToConvert) {
	return new java.math.BigDecimal( java.lang.String.valueOf(numberToConvert) )
}


var calculaImporte = function(moneda, tipoCuentaDesde, tipoCuentaHasta, importe, cotizacion) {

	var importe_tlf = nuevoBigDecimal(importe);
	
	if (mapTipoCuenta[tipoCuentaDesde]==true || mapTipoCuenta[tipoCuentaHasta]==true) {

		if (moneda == 840 &amp;&amp; mapTipoCuentaPesos[String(tipoCuentaHasta)]==true) {
			importe_tlf = importe_tlf.multiply( nuevoBigDecimal(cotizacion) );
		}
		
		else if (moneda == 840 &amp;&amp; mapTipoCuentaPesos[String(tipoCuentaDesde)]==true) {
			importe_tlf = importe_tlf.multiply( nuevoBigDecimal(cotizacion) );
		}
	}
	return importe_tlf;
};
</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>TLF_IMPORTE</name>
        <rename>TLF_IMPORTE</rename>
        <type>BigNumber</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2112</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>No encuentra cabecera</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>3776</xloc>
      <yloc>480</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Obtengo Transacciones</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>Parse Transacciones</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>Y</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>COD_TLF</name>
        <field>COD_MSJ_TLF</field>
      </key>
      <value>
        <name>COD_MSJ_TLF</name>
        <rename>COD_MSJ_TLF</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>COD_MSJ_H2H</name>
        <rename>COD_MSJ_H2H</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>DESC_COD_MSJ</name>
        <rename>DESC_COD_MSJ</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>688</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Ordena ID_CABECERA</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>cab_idTLF</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>3664</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Ordena TLF</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>O_LKTRAD</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>O_LKTRAT</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>LKSEQN</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>LKTERM</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>LKFROM</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>LKTOAC</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>COD_MSJ_H2H</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>LKTYP</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1280</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Ordena idTLF</name>
    <type>SortRows</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>idTLF</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2528</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Parse PreInstert</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>FECHA_PROCESO</name>
      </field>
      <field>
        <name>FECHA_RELOJ</name>
      </field>
      <field>
        <name>ARCHIVO</name>
      </field>
      <field>
        <name>DESC_COD_MSJ</name>
      </field>
      <field>
        <name>O_LKTRAD</name>
      </field>
      <field>
        <name>O_LKTRAT</name>
      </field>
      <field>
        <name>LKSEQN</name>
      </field>
      <field>
        <name>LKTERM</name>
      </field>
      <field>
        <name>LKFROM</name>
      </field>
      <field>
        <name>LKTOAC</name>
      </field>
      <field>
        <name>LKTYP</name>
      </field>
      <field>
        <name>COD_MSJ_TLF</name>
      </field>
      <field>
        <name>COD_MSJ_H2H</name>
      </field>
      <field>
        <name>LKAMT1</name>
      </field>
      <field>
        <name>LKORIG</name>
      </field>
      <field>
        <name>LKTIPV</name>
      </field>
      <field>
        <name>LKRES2</name>
      </field>
      <field>
        <name>LKPOST</name>
      </field>
      <field>
        <name>LKTTO</name>
      </field>
      <field>
        <name>LKTFRO</name>
      </field>
      <field>
        <name>LKFI04</name>
      </field>
      <field>
        <name>sospechoso</name>
      </field>
      <field>
        <name>LKRVSL</name>
      </field>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>LKTYP</name>
        <rename>LKTYP</rename>
        <type>Integer</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>0</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKPOST</name>
        <rename>LKPOST</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKSEQN</name>
        <rename>LKSEQN</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKFROM</name>
        <rename>LKFROM</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKAMT1</name>
        <rename>LKAMT1</rename>
        <type>BigNumber</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKRES2</name>
        <rename>LKRES2</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKORIG</name>
        <rename>LKORIG</rename>
        <type>Integer</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>0</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKTIPV</name>
        <rename>LKTIPV</rename>
        <type>BigNumber</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>0.000</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>COD_MSJ_H2H</name>
        <rename>COD_MSJ_H2H</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKTTO</name>
        <rename>LKTTO</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKTFRO</name>
        <rename>LKTFRO</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>944</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Parse Transacciones</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>COD_MSJ_TLF</name>
        <rename>COD_MSJ_TLF</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>COD_MSJ_H2H</name>
        <rename>COD_MSJ_H2H</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>DESC_COD_MSJ</name>
        <rename>DESC_COD_MSJ</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>688</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Parseo campos especificos</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>trans_Status = CONTINUE_TRANSFORMATION;

// Descartar registros no deseados

if (LKRECT == '01' &amp;&amp; ['0210','0220','0420'].indexOf(String(LKTYP)) !=-1) {

	LKFI03 = adecuarField(LKFI03);
	LKAMT1 = adecuarField(LKAMT1);
	LKAMT2 = adecuarField(LKAMT2);
	LKAMT3 = adecuarField(LKAMT3);
	LKFI08 = adecuarField(LKFI08);
	LKINTE = adecuarField(LKINTE);
	LKCASH = adecuarField(LKCASH);

	LKCASH = new java.math.BigDecimal(LKCASH);
	LKCASH = LKCASH.scaleByPowerOfTen(-2);

	LKINTE = str2num(LKINTE, '0.00');

	LKAMT1 = new java.math.BigDecimal(LKAMT1);
	LKAMT1 = LKAMT1.scaleByPowerOfTen(-2);

	LKAMT2 = new java.math.BigDecimal(LKAMT2);
	LKAMT2 = LKAMT2.scaleByPowerOfTen(-2);

	LKAMT3 = new java.math.BigDecimal(LKAMT3);
	LKAMT3 = LKAMT3.scaleByPowerOfTen(-2);

	LKORIG = parseInt(LKORIG, 10);
	LKTIPV = str2num(LKTIPV, '0.000')/1000;

	var COD_TLF = LKTCDE + LKTFRO + LKTTO;

} else {
	
//	trans_Status = SKIP_TRANSFORMATION;
	setError(500, 'Error en parseo de campos: LKRECT=['+LKRECT+'], LKTYP=['+String(LKTYP)+'].');

};



</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>1</jsScript_type>
        <jsScript_name>Item_0</jsScript_name>
        <jsScript_script>var sustituciones ={
  '{': '0',
  'A': '1',
  'B': '2',
  'C': '3',
  'D': '4',
  'E': '5',
  'F': '6',
  'G': '7',
  'H': '8',
  'I': '9'
};

var sustitucionesnegativas ={
  '}': '0',
  'J': '1',
  'K': '2',
  'L': '3',
  'M': '4',
  'N': '5',
  'O': '6',
  'P': '7',
  'Q': '8',
  'R': '9'
};

var adecuarField = function(field) {
	field = String(field);
	var x = "";
	for (var i = 0; i &lt; field.length; i++) {
		var cambio = field[i];
		if (cambio in sustituciones) {
			x += sustituciones[cambio];
		} 
		else if (cambio in sustitucionesnegativas) {
			x += sustitucionesnegativas[cambio];
			x = x * -1
		} 
		else {
			x += cambio;
		}
	};
	return x;
};

const setError = function(codigo, descripcion) {
	CODIGO = codigo!=null ? parseInt(codigo, 10) : 99;
	ERROR = String(descripcion);
//	setVariable('COD_RETORNO', CODIGO, 'r');
//	setVariable('DESC_MENSAJE', ERROR, 'r');
	//writeToLog('e', 
	//	 '\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -'
//		+'\nSe encontró un error en validaciones de registro:'
//		+'\n - Código de error: ' + CODIGO
//		+'\n - Mensaje de error: ' + ERROR
//		+'\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -'
//	);
	_step_.putError( rowMeta, row, 1, ERROR, '', CODIGO);
	trans_Status = SKIP_TRANSFORMATION;
}</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>LKFI03</name>
        <rename>LKFI03</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>LKAMT1</name>
        <rename>LKAMT1</rename>
        <type>BigNumber</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>LKAMT2</name>
        <rename>LKAMT2</rename>
        <type>BigNumber</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>LKAMT3</name>
        <rename>LKAMT3</rename>
        <type>BigNumber</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>LKFI08</name>
        <rename>LKFI08</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>LKINTE</name>
        <rename>LKINTE</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>LKCASH</name>
        <rename>LKCASH</rename>
        <type>Number</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>LKORIG</name>
        <rename>LKORIG</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>LKTIPV</name>
        <rename>LKTIPV</rename>
        <type>BigNumber</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>COD_TLF</name>
        <rename>COD_TLF</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>528</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>REVERSA_DIA_ANTERIOR</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>REVERSA_DIA_ANTERIOR</name>
        <type>Integer</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif>1</nullif>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>3008</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Recupera ESTADO_TLF</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>Y</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>idTLF</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>ESTADO_TLF</aggregate>
        <subject>ESTADO_MSG</subject>
        <type>LAST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1936</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Select ID_CABECERA</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ID_CABECERA</name>
      </field>
      <field>
        <name>idTLF</name>
        <rename>cab_idTLF</rename>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>3520</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Select ID_CABECERA 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ID_CABECERA</name>
      </field>
      <field>
        <name>idTLF</name>
        <rename>cab_idTLF</rename>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>3520</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sincroniza</name>
    <type>BlockingStep</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <pass_all_rows>Y</pass_all_rows>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>block</prefix>
    <cache_size>5000</cache_size>
    <compress>Y</compress>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>3520</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sospechoso</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>Y</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>Y</give_back_row>
    <group>
      <field>
        <name>idSospechoso</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>NEW_LKRVSL</aggregate>
        <subject>LKRVSL</subject>
        <type>LAST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1488</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Stream lookup</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>Ordena ID_CABECERA</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>Y</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>idTLF</name>
        <field>cab_idTLF</field>
      </key>
      <value>
        <name>ID_CABECERA</name>
        <rename>ID_CABECERA</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>3664</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Strings</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>LKBYTE</name>
        <rename>LKBYTE</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKPREF</name>
        <rename>LKPREF</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKDATT</name>
        <rename>LKDATT</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKRECT</name>
        <rename>LKRECT</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKAUTP</name>
        <rename>LKAUTP</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKLNAT</name>
        <rename>LKLNAT</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKFIIA</name>
        <rename>LKFIIA</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKTERM</name>
        <rename>LKTERM</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKLNCA</name>
        <rename>LKLNCA</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKFIIC</name>
        <rename>LKFIIC</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKPANC</name>
        <rename>LKPANC</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKMBRN</name>
        <rename>LKMBRN</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKBRCH</name>
        <rename>LKBRCH</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKREGN</name>
        <rename>LKREGN</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKUSER</name>
        <rename>LKUSER</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKTYPC</name>
        <rename>LKTYPC</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKTYP</name>
        <rename>LKTYP</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKRTES</name>
        <rename>LKRTES</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKFI01</name>
        <rename>LKFI01</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKTRAD</name>
        <rename>LKTRAD</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKTRAT</name>
        <rename>LKTRAT</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKPOST</name>
        <rename>LKPOST</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKFI02</name>
        <rename>LKFI02</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKSEQN</name>
        <rename>LKSEQN</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKTERT</name>
        <rename>LKTERT</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKFI03</name>
        <rename>LKFI03</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKTCDE</name>
        <rename>LKTCDE</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKTFRO</name>
        <rename>LKTFRO</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKTTO</name>
        <rename>LKTTO</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKFROM</name>
        <rename>LKFROM</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKFI04</name>
        <rename>LKFI04</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKTOAC</name>
        <rename>LKTOAC</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKFI05</name>
        <rename>LKFI05</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKAMT1</name>
        <rename>LKAMT1</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKAMT2</name>
        <rename>LKAMT2</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKAMT3</name>
        <rename>LKAMT3</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKFI08</name>
        <rename>LKFI08</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKRES1</name>
        <rename>LKRES1</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKRES2</name>
        <rename>LKRES2</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKNOMB</name>
        <rename>LKNOMB</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKFI10</name>
        <rename>LKFI10</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKTERC</name>
        <rename>LKTERC</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKFI11</name>
        <rename>LKFI11</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKORIG</name>
        <rename>LKORIG</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKDATO</name>
        <rename>LKDATO</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKTIPV</name>
        <rename>LKTIPV</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKFI14</name>
        <rename>LKFI14</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKRVSL</name>
        <rename>LKRVSL</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKPIN</name>
        <rename>LKPIN</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKFILL</name>
        <rename>LKFILL</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKTIPD</name>
        <rename>LKTIPD</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKISSU</name>
        <rename>LKISSU</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKINTE</name>
        <rename>LKINTE</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKCASH</name>
        <rename>LKCASH</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKFI15</name>
        <rename>LKFI15</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>LKFI16</name>
        <rename>LKFI16</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>#</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>192</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Suma Impactos-Reversas</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>Y</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>idTLF</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>IMPACTOS_ONLINE</aggregate>
        <subject>impacto</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>REVERSAS_ONLINE</aggregate>
        <subject>reversa</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2640</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>TLF_COD_TRANSACCIONES</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazDS</connection>
    <sql>SELECT
	COD_MSJ_TLF,	
	COD_MSJ_H2H,
	DESC_COD_MSJ
FROM TLF_COD_TRANSACCIONES 
WHERE TZ_LOCK = 0
ORDER BY COD_MSJ_TLF ASC</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>688</xloc>
      <yloc>128</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>TLF_CONCILIACION_CABECERA</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>4</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazDS</connection>
    <schema>dbo</schema>
    <table>TLF_CONCILIACION_CABECERA</table>
    <commit>8000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>Y</return_keys>
    <return_field>ID_CABECERA</return_field>
    <fields>
      <field>
        <column_name>LKTRAD</column_name>
        <stream_name>O_LKTRAD</stream_name>
      </field>
      <field>
        <column_name>LKTRAT</column_name>
        <stream_name>O_LKTRAT</stream_name>
      </field>
      <field>
        <column_name>LKSEQN</column_name>
        <stream_name>LKSEQN</stream_name>
      </field>
      <field>
        <column_name>LKTERM</column_name>
        <stream_name>LKTERM</stream_name>
      </field>
      <field>
        <column_name>LKFROM</column_name>
        <stream_name>LKFROM</stream_name>
      </field>
      <field>
        <column_name>LKTOAC</column_name>
        <stream_name>LKTOAC</stream_name>
      </field>
      <field>
        <column_name>LKORIG</column_name>
        <stream_name>LKORIG</stream_name>
      </field>
      <field>
        <column_name>LKAMT1</column_name>
        <stream_name>LKAMT1</stream_name>
      </field>
      <field>
        <column_name>LKTIPV</column_name>
        <stream_name>LKTIPV</stream_name>
      </field>
      <field>
        <column_name>LKPOST</column_name>
        <stream_name>FECHA_NEGOCIO</stream_name>
      </field>
      <field>
        <column_name>ESTADO_TLF</column_name>
        <stream_name>ESTADO_TLF</stream_name>
      </field>
      <field>
        <column_name>IMPACTOS_ONLINE</column_name>
        <stream_name>IMPACTOS_ONLINE</stream_name>
      </field>
      <field>
        <column_name>REVERSAS_ONLINE</column_name>
        <stream_name>REVERSAS_ONLINE</stream_name>
      </field>
      <field>
        <column_name>COD_MSJ_H2H</column_name>
        <stream_name>COD_MSJ_H2H</stream_name>
      </field>
      <field>
        <column_name>ESTADO_CONCILIACION</column_name>
        <stream_name>ESTADO_CONCILIACION</stream_name>
      </field>
      <field>
        <column_name>IMPORTE</column_name>
        <stream_name>TLF_IMPORTE</stream_name>
      </field>
      <field>
        <column_name>ARCHIVO</column_name>
        <stream_name>ARCHIVO</stream_name>
      </field>
      <field>
        <column_name>COD_MSJ_TLF</column_name>
        <stream_name>COD_MSJ_TLF</stream_name>
      </field>
      <field>
        <column_name>LKFI04</column_name>
        <stream_name>LKFI04</stream_name>
      </field>
      <field>
        <column_name>FECHA_PROCESO</column_name>
        <stream_name>FECHA_PROCESO</stream_name>
      </field>
      <field>
        <column_name>LKRVSL</column_name>
        <stream_name>NEW_LKRVSL</stream_name>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>3360</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>TLF_CONCILIACION_CABECERA [update]</name>
    <type>Update</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazDS</connection>
    <skip_lookup>N</skip_lookup>
    <commit>1000</commit>
    <use_batch>N</use_batch>
    <error_ignored>N</error_ignored>
    <ignore_flag_field/>
    <lookup>
      <schema>dbo</schema>
      <table>TLF_CONCILIACION_CABECERA</table>
      <key>
        <name>ACTUALIZAR</name>
        <field>ID_CABECERA</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>ESTADO_TLF</name>
        <rename>ESTADO_TLF</rename>
      </value>
      <value>
        <name>IMPACTOS_ONLINE</name>
        <rename>IMPACTOS_ONLINE</rename>
      </value>
      <value>
        <name>REVERSAS_ONLINE</name>
        <rename>REVERSAS_ONLINE</rename>
      </value>
      <value>
        <name>ESTADO_CONCILIACION</name>
        <rename>ESTADO_CONCILIACION</rename>
      </value>
      <value>
        <name>REVERSA_DIA_ANTERIOR</name>
        <rename>REVERSA_DIA_ANTERIOR</rename>
      </value>
      <value>
        <name>FECHA_PROCESO</name>
        <rename>FECHA_PROCESO</rename>
      </value>
    </lookup>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>3200</xloc>
      <yloc>112</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>TLF_CONCILIACION_DETALLE</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>4</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazDS</connection>
    <schema>dbo</schema>
    <table>TLF_CONCILIACION_DETALLE</table>
    <commit>10000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>ID_CABECERA</column_name>
        <stream_name>ID_CABECERA</stream_name>
      </field>
      <field>
        <column_name>ID_DETALLE</column_name>
        <stream_name>numeroDetalle</stream_name>
      </field>
      <field>
        <column_name>LKTRAD</column_name>
        <stream_name>O_LKTRAD</stream_name>
      </field>
      <field>
        <column_name>LKTRAT</column_name>
        <stream_name>O_LKTRAT</stream_name>
      </field>
      <field>
        <column_name>LKSEQN</column_name>
        <stream_name>LKSEQN</stream_name>
      </field>
      <field>
        <column_name>LKTERM</column_name>
        <stream_name>LKTERM</stream_name>
      </field>
      <field>
        <column_name>COD_MSJ_H2H</column_name>
        <stream_name>COD_MSJ_H2H</stream_name>
      </field>
      <field>
        <column_name>LKFROM</column_name>
        <stream_name>LKFROM</stream_name>
      </field>
      <field>
        <column_name>LKTOAC</column_name>
        <stream_name>LKTOAC</stream_name>
      </field>
      <field>
        <column_name>LKORIG</column_name>
        <stream_name>element49</stream_name>
      </field>
      <field>
        <column_name>IMPORTE</column_name>
        <stream_name>detalleImporte</stream_name>
      </field>
      <field>
        <column_name>LKTYP</column_name>
        <stream_name>ELEMENT0</stream_name>
      </field>
      <field>
        <column_name>ASIENTO_SUCURSAL</column_name>
        <stream_name>ASIENTO_SUCURSAL</stream_name>
      </field>
      <field>
        <column_name>ASIENTO_FECHA</column_name>
        <stream_name>ASIENTO_FECHA</stream_name>
      </field>
      <field>
        <column_name>ASIENTO_NUMERO</column_name>
        <stream_name>ASIENTO_NUMERO</stream_name>
      </field>
      <field>
        <column_name>JTS_OID_TP</column_name>
        <stream_name>JTS_OID_TP</stream_name>
      </field>
      <field>
        <column_name>LKAMT1</column_name>
        <stream_name>element4</stream_name>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>4048</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Tipo impacto online</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here
var impacto = 0;
var reversa = 0;

ELEMENT0 = String(ELEMENT0);

if (ASIENTO_NUMERO != 0 &amp;&amp; ELEMENT39=='00') {
	if (ELEMENT0 == '0430') {
		reversa = 1;
	};

	if (ELEMENT0 == '0210' || ELEMENT0 == '0230') {
		impacto = 1;
	};
};
</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>impacto</name>
        <rename>impacto</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>reversa</name>
        <rename>reversa</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2416</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Unico idTLF</name>
    <type>UniqueRowsByHashSet</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <store_values>N</store_values>
    <reject_duplicate_row>N</reject_duplicate_row>
    <error_description/>
    <fields>
      <field>
        <name>idTLF</name>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2768</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Unir</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1184</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>descarta actualizar_id_cabecera</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>FECHA_PROCESO</name>
      </field>
      <field>
        <name>FECHA_RELOJ</name>
      </field>
      <field>
        <name>ARCHIVO</name>
      </field>
      <field>
        <name>DESC_COD_MSJ</name>
      </field>
      <field>
        <name>O_LKTRAD</name>
      </field>
      <field>
        <name>O_LKTRAT</name>
      </field>
      <field>
        <name>LKSEQN</name>
      </field>
      <field>
        <name>LKTERM</name>
      </field>
      <field>
        <name>LKFROM</name>
      </field>
      <field>
        <name>LKTOAC</name>
      </field>
      <field>
        <name>LKTYP</name>
      </field>
      <field>
        <name>COD_MSJ_TLF</name>
      </field>
      <field>
        <name>COD_MSJ_H2H</name>
      </field>
      <field>
        <name>LKAMT1</name>
      </field>
      <field>
        <name>LKORIG</name>
      </field>
      <field>
        <name>LKTIPV</name>
      </field>
      <field>
        <name>LKRES2</name>
      </field>
      <field>
        <name>LKPOST</name>
      </field>
      <field>
        <name>LKTTO</name>
      </field>
      <field>
        <name>LKTFRO</name>
      </field>
      <field>
        <name>LKFI04</name>
      </field>
      <field>
        <name>sospechoso</name>
      </field>
      <field>
        <name>LKRVSL</name>
      </field>
      <field>
        <name>ACTUALIZAR</name>
      </field>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>ACTUALIZAR</name>
        <rename>ACTUALIZAR</rename>
        <type>Integer</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>0</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1184</xloc>
      <yloc>384</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>idSospechoso</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>var actualKey = makeHash(O_LKTRAD, O_LKTRAT, LKSEQN, LKTERM, LKFROM, LKTOAC, COD_MSJ_H2H);

// Inicialización de estado
if (first != null || keyTLF != actualKey) {
    if (first != null) {
        first = null;
    }
    keyTLF = actualKey;
    idSospechoso++;
};

</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>1</jsScript_type>
        <jsScript_name>Item_1</jsScript_name>
        <jsScript_script>// Variables globales
var keyTLF = '';
var first = 'ok';
var idSospechoso = 0;

// Scripts from tabs
LoadScriptFromTab("hash");


</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>-1</jsScript_type>
        <jsScript_name>hash</jsScript_name>
        <jsScript_script>// Crear hash para detectar nuevo mensaje

var makeHash = function(LKTRAD, LKTRAT, LKSEQN, LKTERM, LKFROM, LKTOAC, COD_MSJ_H2H) {
	var hash = '';
	hash+=trim(LKTRAD)+'-'+trim(LKTRAT)+'-'+trim(LKSEQN)+'-'+trim(LKTERM)+'-'+trim(LKFROM)+'-'+trim(LKTOAC)+'-'+trim(COD_MSJ_H2H);
	return String(hash)
}

</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>idSospechoso</name>
        <rename>idSospechoso</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1392</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>keyTLF</name>
    <type>UniqueRowsByHashSet</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <store_values>N</store_values>
    <reject_duplicate_row>Y</reject_duplicate_row>
    <error_description>UNICO MENSAJE TLF</error_description>
    <fields>
      <field>
        <name>idTLF</name>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2032</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>lastRowOperacion</name>
    <type>DetectLastRow</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <resultfieldname>lastRow</resultfieldname>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1728</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>numeroDetalle</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>var actualKey = String(idTLF);

// Inicialización de estado
if (first != null || keyTLF != actualKey) {
    if (first != null) {
        first = null;
    }
    keyTLF = actualKey;
    numeroDetalle = 1;
}
else {
	numeroDetalle++
}
</jsScript_script>
      </jsScript>
      <jsScript>
        <jsScript_type>1</jsScript_type>
        <jsScript_name>Item_1</jsScript_name>
        <jsScript_script>// Variables globales
var keyTLF = '';
var first = 'ok';
var numeroDetalle = 0;

// Scripts from tabs
LoadScriptFromTab("hash");


</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>numeroDetalle</name>
        <rename>numeroDetalle</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2896</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
    <error>
      <source_step>Descartar registros</source_step>
      <target_step>Dummy (do nothing)</target_step>
      <is_enabled>Y</is_enabled>
      <nr_valuename/>
      <descriptions_valuename>ERROR</descriptions_valuename>
      <fields_valuename>CODIGO</fields_valuename>
      <codes_valuename/>
      <max_errors/>
      <max_pct_errors/>
      <min_pct_rows/>
    </error>
    <error>
      <source_step>Parseo campos especificos</source_step>
      <target_step>CANT_INVALIDOS</target_step>
      <is_enabled>Y</is_enabled>
      <nr_valuename/>
      <descriptions_valuename>ERROR_DESCRIPTION</descriptions_valuename>
      <fields_valuename>ERROR_FIELDNAME</fields_valuename>
      <codes_valuename>ERROR_CODE</codes_valuename>
      <max_errors/>
      <max_pct_errors/>
      <min_pct_rows/>
    </error>
    <error>
      <source_step>TLF_CONCILIACION_DETALLE</source_step>
      <target_step>Dummy (do nothing) 3</target_step>
      <is_enabled>Y</is_enabled>
      <nr_valuename/>
      <descriptions_valuename>error_description</descriptions_valuename>
      <fields_valuename>error_fieldname</fields_valuename>
      <codes_valuename/>
      <max_errors/>
      <max_pct_errors/>
      <min_pct_rows/>
    </error>
    <error>
      <source_step>keyTLF</source_step>
      <target_step>CANT_DUPLICADO</target_step>
      <is_enabled>Y</is_enabled>
      <nr_valuename/>
      <descriptions_valuename>ERROR_DESCRIPTION</descriptions_valuename>
      <fields_valuename>ERROR_FIELDNAME</fields_valuename>
      <codes_valuename>ERROR_CODE</codes_valuename>
      <max_errors/>
      <max_pct_errors/>
      <min_pct_rows/>
    </error>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
  <attributes/>
</transformation>
