<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>RRII_Medicion_LCR</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/</directory>
    <parameters>
      <parameter>
        <name>fecha</name>
        <default_value>23/09/2024</default_value>
        <description/>
      </parameter>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2022/09/09 09:58:24.456</created_date>
    <modified_user>-</modified_user>
    <modified_date>2022/09/09 09:58:24.456</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>TopazConect</name>
    <server/>
    <type>MSSQL</type>
    <access>JNDI</access>
    <database>TopazDS</database>
    <port>1521</port>
    <username/>
    <password>Encrypted </password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1521</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>Campos para insertar</from>
      <to>RRII_ERRORES_VALIDACIONES</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Error fecha</from>
      <to>Campos para insertar</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>RRII_ERRORES_VALIDACIONES</from>
      <to>KTR</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>x</from>
      <to>211000/212100</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prep Val 211000</from>
      <to>211000</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>211000/212100</from>
      <to>Pers/Dep</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prep Val 212100</from>
      <to>212100</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>x</from>
      <to>212300</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>212300</from>
      <to>Pers/Dep/Moneda</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Pers/Dep/Moneda</from>
      <to>212300/x 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>212300/x 2</from>
      <to>Prep val 212300</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>212300/x 2</from>
      <to>x 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prep val 212300</from>
      <to>212300 </to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>212300 </from>
      <to>Sort Mon</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort Mon</from>
      <to>SET/CodPartida 212300</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Minoristas/x</from>
      <to>x 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prep Val 211000 2</from>
      <to>FDO_GTIA</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Pers/Dep</from>
      <to>Minoristas/x</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Minoristas/x</from>
      <to>Prep Val 211000 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>221000</from>
      <to>Pers/Dep 221000</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Pers/Dep 221000</from>
      <to>Minoristas/x 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Minoristas/x 4</from>
      <to>Prep Val 221000</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Minoristas/x 4</from>
      <to>x 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prep Val 221000</from>
      <to>221000 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>221000 2</from>
      <to>Sort Mon 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort Mon 2</from>
      <to>SET/CodPartida 221000</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>221100/221210</from>
      <to>Pers/Dep 221100</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Pers/Dep 221100</from>
      <to>Minoristas/x 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Minoristas/x 5</from>
      <to>x 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prep Val 221210</from>
      <to>221210</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>x</from>
      <to>PARTIDAS PARAMETRIZADAS</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>x</from>
      <to>221000</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>x</from>
      <to>221100/221210</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>SET/CodPartida 221100</from>
      <to>Insert / update</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>SET/CodPartida 212300</from>
      <to>Insert / update</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>SET/CodPartida 221000</from>
      <to>Insert / update</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Moneda/SET 221210</from>
      <to>Insert / update</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prep Val 221100</from>
      <to>221100 </to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>221100 </from>
      <to>Sort Mon 221100</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort Mon 221100</from>
      <to>SET/CodPartida 221100</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort Mon 221210</from>
      <to>Moneda/SET 221210</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>221210</from>
      <to>Sort Mon 221210</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>SET/CodPartida 212100</from>
      <to>Insert / update</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>212100</from>
      <to>Sort Mon 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort Mon 3</from>
      <to>SET/CodPartida 212100</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>211000</from>
      <to>Sort Mon 3 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort Mon 3 2</from>
      <to>SET/CodPartida 211000</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>SET/CodPartida 211000</from>
      <to>Insert / update</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>x</from>
      <to>221210 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>221210 2</from>
      <to>Pers/Dep 221210</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Pers/Dep 221210</from>
      <to>x/Minoristas</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>x/Minoristas</from>
      <to>x 6</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>x/Minoristas</from>
      <to>Prep Val 221210 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prep Val 221210 2</from>
      <to>221210 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>221210 4</from>
      <to>Sort Mon 2 2 2 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort Mon 2 2 2 2</from>
      <to>SET/CodPartida 221210 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>SET/CodPartida 221210 2</from>
      <to>Insert / update</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>x</from>
      <to>221220</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>221220</from>
      <to>Pers/Dep 221220</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Pers/Dep 221220</from>
      <to>Prep Val 221220</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prep Val 221220</from>
      <to>221220 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>221220 2</from>
      <to>Sort Mon 221220</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort Mon 221220</from>
      <to>SET/CodPartida 221220</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>SET/CodPartida 221220</from>
      <to>Insert / update</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prep Val</from>
      <to>FALAC/SENT</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>PARTIDAS PARAMETRIZADAS</from>
      <to>Prep Val</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>SORT MON 5</from>
      <to>FALAC/CodPartida</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>FALAC/SENT</from>
      <to>Prep Val FALAC</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prep Val FALAC</from>
      <to>SORT MON 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>FALAC/CodPartida</from>
      <to>Insert / update</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>FALAC/SENT</from>
      <to>Prep Val SET</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prep Val SET</from>
      <to>SORT MON 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>SORT MON 4</from>
      <to>SET/CodPartida 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>SET/CodPartida 3</from>
      <to>Insert / update</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prep Val 221100/221210</from>
      <to>Filtro Fdo_gtia</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Minoristas/x 5</from>
      <to>Prep Val 221100/221210</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Filtro Fdo_gtia</from>
      <to>x 7</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>x 7</from>
      <to>Prep Val 221100</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>x 7</from>
      <to>Estable 221210</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Estable 221210</from>
      <to>x 8</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Estable 221210</from>
      <to>Prep Val 221210</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>FDO_GTIA</from>
      <to>x 9</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>x 9</from>
      <to>FILTRO ESTABLE</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>x 9</from>
      <to>Prep Val 211000</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>FILTRO ESTABLE</from>
      <to>Prep Val 212100</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>FILTRO ESTABLE</from>
      <to>x 10</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>x</from>
      <to>221230</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>221230</from>
      <to>Pers/Dep 221230</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Pers/Dep 221230</from>
      <to>Prep Val 221230</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prep Val 221230</from>
      <to>221230 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>221230 2</from>
      <to>Sort Mon 221230</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort Mon 221230</from>
      <to>SET/CodPartida 221230</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>SET/CodPartida 221230</from>
      <to>Insert / update</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>x</from>
      <to>351000</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort Mon 351000</from>
      <to>FALAC/CodPartida 351000</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>351000 3</from>
      <to>Prep Val 351000</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prep Val 351000</from>
      <to>Sort Mon 351000</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>351000</from>
      <to>Prep Val 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prep Val 2</from>
      <to>351000 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>FALAC/CodPartida 351000</from>
      <to>Insert / update</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>x</from>
      <to>352000</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>352000</from>
      <to>Prep Val 2 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prep Val 2 2</from>
      <to>352000 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>352000 2</from>
      <to>Prep Val 352000</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort Mon 352000</from>
      <to>FALAC/CodPartida 352000</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prep Val 352000</from>
      <to>Sort Mon 352000</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>FALAC/CodPartida 352000</from>
      <to>Insert / update</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Date Sys</from>
      <to>Error fecha</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Error fecha</from>
      <to>x</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Data grid</from>
      <to>Leer fechaP</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Database join</from>
      <to>Feriados</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Filter rows</from>
      <to>Database join</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Leer fechaP</from>
      <to>ayer feriado</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>ayer feriado</from>
      <to>prep fechas</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>feriado</from>
      <to>Filter rows</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>prep fechas</from>
      <to>x 12</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>recursivo</from>
      <to>llamar fecha ayer</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>recursivo</from>
      <to>x 11</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>x 12</from>
      <to>feriado</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>x 12</from>
      <to>recursivo</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Filter rows</from>
      <to>Date Sys</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Feriados</from>
      <to>Insert / update</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>211000</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT
	CONVERT(DATETIME,?,103) AS FECHA_INFORME,

	'211000' AS CODIGOPART,
	
	? AS MONEDA,


	CASE 
		WHEN (?=0 AND (?>= (SELECT (MONTO_MAX)
    					FROM TASASFONDOGARANTIA
    						WHERE TIPOPRODUCTO  = 1
        					AND TZ_LOCK = 0
        					AND FECHA_VIGENCIA = (SELECT MAX(TF.FECHA_VIGENCIA)
                                				FROM TASASFONDOGARANTIA TF
                                				WHERE TF.FECHA_VIGENCIA &lt;= CONVERT(DATETIME,?,103)
                                    				AND TF.TZ_LOCK = 0
                                    				AND TF.TIPOPRODUCTO = 1))))
	THEN
		
	ROUND(ISNULL(((SELECT (MONTO_MAX)
    					FROM TASASFONDOGARANTIA
    					WHERE TIPOPRODUCTO  = 1
        					AND TZ_LOCK = 0
        					AND FECHA_VIGENCIA = (SELECT MAX(TF.FECHA_VIGENCIA)
                                					FROM TASASFONDOGARANTIA TF
                                					WHERE TF.FECHA_VIGENCIA &lt;= CONVERT(DATETIME,?,103)
                                    					AND TF.TZ_LOCK = 0
                                    					AND TF.TIPOPRODUCTO = 1))* 
																					(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
																						WHERE CODIGO = 106 
																							AND ID4 = '211000'
																							AND TZ_LOCK = 0 
																							AND ID2 = ?)),0),2)
	WHEN (?=0 AND (?&lt; (SELECT (MONTO_MAX)
    					FROM TASASFONDOGARANTIA
    						WHERE TIPOPRODUCTO  = 1
        					AND TZ_LOCK = 0
        					AND FECHA_VIGENCIA = (SELECT MAX(TF.FECHA_VIGENCIA)
                                				FROM TASASFONDOGARANTIA TF
                                				WHERE TF.FECHA_VIGENCIA &lt;= CONVERT(DATETIME,?,103)
                                    				AND TF.TZ_LOCK = 0
                                    				AND TF.TIPOPRODUCTO = 1))))
	THEN
		ROUND(ISNULL((?*
				(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
					WHERE CODIGO = 106 
						AND ID4 = '211000'
						AND TZ_LOCK = 0 
						AND ID2 = ?)),0),2)

	WHEN (?!=0 AND (? &lt; (SELECT (MONTO_MAX)
    					FROM TASASFONDOGARANTIA
    						WHERE TIPOPRODUCTO  = 2
        					AND TZ_LOCK = 0
        					AND FECHA_VIGENCIA = (SELECT MAX(TF.FECHA_VIGENCIA)
                                				FROM TASASFONDOGARANTIA TF
                                				WHERE TF.FECHA_VIGENCIA &lt;= CONVERT(DATETIME,?,103)
                                    				AND TF.TZ_LOCK = 0
                                    				AND TF.TIPOPRODUCTO = 2))))
	THEN 
		ROUND(ISNULL((?*
				(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
					WHERE CODIGO = 106 
						AND ID4 = '211000'
						AND TZ_LOCK = 0 
						AND ID2 = ?)),0),2)
	ELSE
		ROUND(ISNULL(((SELECT (MONTO_MAX)
    					FROM TASASFONDOGARANTIA
    					WHERE TIPOPRODUCTO  = 2
        					AND TZ_LOCK = 0
        					AND FECHA_VIGENCIA = (SELECT MAX(TF.FECHA_VIGENCIA)
                                					FROM TASASFONDOGARANTIA TF
                                					WHERE TF.FECHA_VIGENCIA &lt;= CONVERT(DATETIME,?,103)
                                    					AND TF.TZ_LOCK = 0
                                    					AND TF.TIPOPRODUCTO = 2))* 
																					(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
																						WHERE CODIGO = 106 
																							AND ID4 = '211000'
																							AND TZ_LOCK = 0 
																							AND ID2 = ?)),0),2)
		
	END SENT,
	
	ISNULL((SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=105 AND CHAR1='211000' AND TZ_LOCK=0),1) AS VALOR,
	
	0 AS SDO_FALAC,

	ISNULL((SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '211000'
				AND TZ_LOCK = 0 
				AND ID2 = ?),1) AS COEFICIENTE,

	0 AS LCR,

	0 AS IMPORTE_MES1,

	0 AS IMPORTE_MES2,
	
	0 AS IMPORTE_MES3
</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>MONNAC</name>
        <type>Integer</type>
      </field>
      <field>
        <name>PERS</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONTO_TOTAL</name>
        <type>Integer</type>
      </field>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>MONNAC</name>
        <type>Integer</type>
      </field>
      <field>
        <name>PERS</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONTO_TOTAL</name>
        <type>Integer</type>
      </field>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>MONTO_TOTAL</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONNAC</name>
        <type>Integer</type>
      </field>
      <field>
        <name>PERS</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONTO_TOTAL</name>
        <type>Integer</type>
      </field>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>MONTO_TOTAL</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONNAC</name>
        <type>Integer</type>
      </field>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>MONNAC</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONNAC</name>
        <type>Integer</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>912</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>211000/212100</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT 
	CONVERT(DATETIME,G.FECHA,103) AS FECHA_INF,
	
	CP.NUMEROPERSONA AS PERSONA,

	ROUND(((SELECT IMPORTE/3 FROM PARAMETROSGENERALES WITH (NOLOCK) WHERE CODIGO=737 AND TZ_LOCK=0)*
									(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 
											H.MONEDA = 5 AND
											H.FECHA_COTIZACION = (SELECT MAX (FECHA_COTIZACION) 
																	FROM HISTORICOTIPOSCAMBIO WITH (NOLOCK)
																	WHERE FECHA_COTIZACION &lt;= DBO.ULTIMODIAHABIL(CONVERT(DATETIME,DATEADD(MONTH,-1,CONVERT(DATETIME,G.FECHA,103)),103))))),2) AS MINORISTA,

	ROUND((SELECT MONTO_MAX 
	FROM TASASFONDOGARANTIA 
	WHERE TIPOPRODUCTO  = 2 
		AND TZ_LOCK = 0 
		AND FECHA_VIGENCIA = (SELECT MAX(TF.FECHA_VIGENCIA) 
								FROM TASASFONDOGARANTIA TF 
								WHERE TF.FECHA_VIGENCIA &lt;= CONVERT(DATETIME,G.FECHA,103)
								AND TF.TZ_LOCK = 0)),2) AS FDO_GTIA,

	G.SALDOS_JTS_OID AS JTS_OID,

	(SELECT NUM1 FROM RRI_PARAMETROS_INF WHERE CODIGO=1 AND ID1 = G.MONEDA) AS MONEDA,

	CP.TITULARIDAD AS CONDICION,

	ISNULL (((SELECT TOP 1 SALDO_AJUSTADO 
				FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
				WHERE SALDOS_JTS_OID = G.SALDOS_JTS_OID 
				AND MONEDA = G.MONEDA
				AND FECHA = G.FECHA
				AND TZ_LOCK = G.TZ_LOCK)/
	   		(SELECT COUNT(NUMEROPERSONA) 
	   		FROM CLI_ClientePersona WITH (NOLOCK)
	   		WHERE CODIGOCLIENTE = CP.CODIGOCLIENTE 
	   		AND TZ_LOCK = CP.TZ_LOCK)),0) AS MONTODEPOSITO

FROM CLI_ClientePersona CP
	INNER JOIN SALDOS S WITH (NOLOCK)
		ON CP.CODIGOCLIENTE = S.C1803
		AND CP.TZ_LOCK = S.TZ_LOCK
	INNER JOIN TOPESPRODUCTO TP WITH (NOLOCK)        
    	ON TP.CODPRODUCTO = S.PRODUCTO       
    	AND TP.TZ_LOCK = S.TZ_LOCK
    	AND TP.MONEDA = S.MONEDA
	INNER JOIN GRL_SALDOS_DIARIOS G WITH (NOLOCK)
		ON G.SALDOS_JTS_OID = S.JTS_OID
		AND G.MONEDA = S.MONEDA
		AND G.TZ_LOCK = S.TZ_LOCK
		
	LEFT JOIN CLI_PERSONASFISICAS CPF WITH (NOLOCK)
		ON CP.NUMEROPERSONA = CPF.NUMEROPERSONAFISICA
		AND S.TZ_LOCK = CPF.TZ_LOCK
		
	LEFT JOIN CLI_PERSONASJURIDICAS CPJ WITH (NOLOCK)
		ON CP.NUMEROPERSONA = CPJ.NUMEROPERSONAJURIDICA
		AND CPJ.SECTOR = CPF.SECTOR
		AND S.TZ_LOCK = CPJ.TZ_LOCK
WHERE S.C1785 = 4
	AND S.TZ_LOCK = 0
	AND S.MONEDA = (SELECT MONNAC FROM PARAMETROS WITH (NOLOCK))
	AND (DATEDIFF(day,S.C1621,S.C1627)&lt;=30 
    	OR (DATEDIFF(day,CONVERT(DATETIME,G.FECHA,103),S.C1627)>30 
    		AND TP.PermitePrecancelar='S'))
    AND G.FECHA = CONVERT(DATETIME,?,103)
    AND G.SALDO_AJUSTADO>0
    AND (CPF.SECTOR !=1 OR CPJ.SECTOR !=1)
GROUP BY 
	CP.NUMEROPERSONA,
	CP.CODIGOCLIENTE,
	G.SALDOS_JTS_OID,
	G.TZ_LOCK,
	G.MONEDA,
	CP.TZ_LOCK,
	TP.PermitePrecancelar,
	CP.TITULARIDAD,
	G.FECHA


UNION 

SELECT
	CONVERT(DATETIME,G.FECHA,103) AS FECHA_INF,
	0 AS PERSONA,
	ROUND(((SELECT IMPORTE/3 FROM PARAMETROSGENERALES WITH (NOLOCK) WHERE CODIGO=737 AND TZ_LOCK=0)*
									(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 
											H.MONEDA = 5 AND
											H.FECHA_COTIZACION = (SELECT MAX (FECHA_COTIZACION) 
																	FROM HISTORICOTIPOSCAMBIO WITH (NOLOCK)
																	WHERE FECHA_COTIZACION &lt;= DBO.ULTIMODIAHABIL(CONVERT(DATETIME,DATEADD(MONTH,-1,CONVERT(DATETIME,G.FECHA,103)),103))))),2) AS MINORISTA,
	ROUND((SELECT (MONTO_MAX)
			FROM TASASFONDOGARANTIA 
			WHERE TIPOPRODUCTO  = 1 
				AND TZ_LOCK = 0 
				AND FECHA_VIGENCIA = (SELECT MAX(TF.FECHA_VIGENCIA) 
										FROM TASASFONDOGARANTIA TF 
										WHERE TF.FECHA_VIGENCIA &lt;= CONVERT(DATETIME,G.FECHA,103)
											AND TF.TZ_LOCK = 0
											AND TF.TIPOPRODUCTO = 1)),2) AS FDO_GTIA,
	0 AS JTS_OID,
	G.MONEDA AS MONEDA,
	'N' AS CONDICION,
	SUM(G.SALDO_AJUSTADO) AS MONTODEPOSITO

    FROM GRL_SALDOS_DIARIOS G WITH (NOLOCK)
    INNER JOIN SALDOS S WITH (NOLOCK)
        ON G.MONEDA = S.MONEDA
        AND G.SALDOS_JTS_OID = S.JTS_OID
        AND G.TZ_LOCK = S.TZ_LOCK
    WHERE G.FECHA = CONVERT(DATETIME,?,103)
    AND G.TZ_LOCK = 0
    AND S.C1785 IN (2,3) 
    AND G.MONEDA = (SELECT MONNAC FROM PARAMETROS WITH (NOLOCK))
GROUP BY 
	G.MONEDA,
	G.FECHA</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>212100</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT
	CONVERT(DATETIME,?,103) AS FECHA_INFORME,

	'212100' AS CODIGOPART,
	
	? AS MONEDA,
	
	ABS(ROUND(ISNULL(?*(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '212100'
				AND TZ_LOCK = 0 
				AND ID2 = ?),0),2)) as SENT,
	
	ISNULL((SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=105 AND CHAR1='212100' AND TZ_LOCK=0),1) AS VALOR,
	
	0 AS SDO_FALAC,

	ISNULL((SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '212100'
				AND TZ_LOCK = 0 
				AND ID2 = ?),0) AS COEFICIENTE,

	0 AS LCR,

	0 AS IMPORTE_MES1,

	0 AS IMPORTE_MES2,
	
	0 AS IMPORTE_MES3</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>MONNAC</name>
        <type>Integer</type>
      </field>
      <field>
        <name>DIFERENCIA</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONNAC</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONNAC</name>
        <type>Integer</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>912</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>212300</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>-----------------------------------------------------
-------------DEPOSITOS 212300------------------------

SELECT 
	CONVERT(DATETIME,G.FECHA,103) AS FECHA_INF,

	CP.NUMEROPERSONA AS PERSONA,

	G.SALDOS_JTS_OID AS JTS_OID,

	(SELECT NUM1 FROM RRI_PARAMETROS_INF WHERE CODIGO=1 AND ID1 = G.MONEDA) AS MONEDA,

	CP.TITULARIDAD AS CONDICION,

	ROUND(((SELECT IMPORTE/3 FROM PARAMETROSGENERALES WITH (NOLOCK) WHERE CODIGO=737 AND TZ_LOCK=0)*
									(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 
											H.MONEDA = 5 AND
											H.FECHA_COTIZACION = (SELECT MAX (FECHA_COTIZACION) 
																	FROM HISTORICOTIPOSCAMBIO WITH (NOLOCK)
																	WHERE FECHA_COTIZACION &lt;= DBO.ULTIMODIAHABIL(CONVERT(DATETIME,DATEADD(MONTH,-1,CONVERT(DATETIME,G.FECHA,103)),103))))),2) AS PARAMETRO,

	CASE WHEN G.MONEDA = 2 THEN
		
		ISNULL(ROUND(((SELECT TOP 1 SALDO_AJUSTADO 
				FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
				WHERE SALDOS_JTS_OID = G.SALDOS_JTS_OID 
				AND MONEDA = G.MONEDA
				AND FECHA = G.FECHA
				AND TZ_LOCK = G.TZ_LOCK)/
	   		(SELECT COUNT(NUMEROPERSONA) 
	   		FROM CLI_ClientePersona WITH (NOLOCK)
	   		WHERE CODIGOCLIENTE = CP.CODIGOCLIENTE 
	   		AND TZ_LOCK = CP.TZ_LOCK)) *
									(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 
											H.MONEDA = 2 AND
											H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
																FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
																WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)))

		,2),0)
	
		ELSE 
		ISNULL(ROUND((SELECT TOP 1 SALDO_AJUSTADO 
				FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
				WHERE SALDOS_JTS_OID = G.SALDOS_JTS_OID 
				AND MONEDA = G.MONEDA
				AND TZ_LOCK = G.TZ_LOCK)/
	   		(SELECT COUNT(NUMEROPERSONA) 
	   		FROM CLI_ClientePersona WITH (NOLOCK)
	   		WHERE CODIGOCLIENTE = CP.CODIGOCLIENTE 
	   		AND TZ_LOCK = CP.TZ_LOCK)*

		(SELECT H.ARBITRAJE_COMPRA
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 
			H.MONEDA= G.MONEDA AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103))) *

		(SELECT TOP 1 H.TIPO_CAMBIO_OFICIAL
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 
			H.MONEDA = 2  AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)))
		,2),0)
		END AS MONTODEPOSITO

FROM CLI_ClientePersona CP
	INNER JOIN SALDOS S WITH (NOLOCK)
		ON CP.CODIGOCLIENTE = S.C1803
		AND CP.TZ_LOCK = S.TZ_LOCK
	INNER JOIN GRL_SALDOS_DIARIOS G WITH (NOLOCK)
		ON G.SALDOS_JTS_OID = S.JTS_OID
		AND G.MONEDA = S.MONEDA
		AND G.TZ_LOCK = S.TZ_LOCK
WHERE S.C1785 = 4
	AND S.TZ_LOCK = 0
	AND S.MONEDA NOT IN ((SELECT MONNAC FROM PARAMETROS WITH (NOLOCK)),998,999)
    AND DATEDIFF(day,CONVERT(DATETIME,G.FECHA,103),S.C1627)&lt;=30 
    AND G.FECHA = CONVERT(DATETIME,?,103)
    AND G.SALDO_AJUSTADO>0
	AND G.MONEDA IS NOT NULL 
GROUP BY 
	CP.NUMEROPERSONA,
	CP.CODIGOCLIENTE,
	G.SALDOS_JTS_OID,
	G.TZ_LOCK,
	G.MONEDA,
	CP.TZ_LOCK,
	CP.TITULARIDAD,
	G.FECHA
ORDER BY (CP.NUMEROPERSONA) ASC</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>480</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>212300 </name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT
	CONVERT(DATETIME,?,103) AS FECHA_INFORME,

	'212300' AS CODIGOPART,
	
	? AS MONEDA,
	
	ROUND(ISNULL(?*(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '212300'
				AND TZ_LOCK = 0 
				AND ID2 = ?),0),2) as SENT,
	
	ISNULL((SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=105 AND CHAR1='212300' AND TZ_LOCK=0),1) AS VALOR,
	
	0 AS SDO_FALAC,

	ISNULL((SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '212300'
				AND TZ_LOCK = 0 
				AND ID2 = ?),1) AS COEFICIENTE,

	0 AS LCR,

	0 AS IMPORTE_MES1,

	0 AS IMPORTE_MES2,
	
	0 AS IMPORTE_MES3
</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>FECHA_INF</name>
        <type>Timestamp</type>
      </field>
      <field>
        <name>MON</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONTO_TOTAL</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MON</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MON</name>
        <type>Integer</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>912</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>212300/x 2</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>Prep val 212300</send_true_to>
    <send_false_to>x 2</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <conditions>
          <condition>
            <negated>N</negated>
            <leftvalue>MONTO_TOTAL</leftvalue>
            <function>&lt;=</function>
            <rightvalue>PARAMETRO</rightvalue>
          </condition>
        </conditions>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>656</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>221000</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT 

	CONVERT(DATETIME,G.FECHA,103) AS FECHA_INF,
	
	CP.NUMEROPERSONA AS PERSONA, 
	
	ROUND((
			(SELECT IMPORTE FROM PARAMETROSGENERALES WITH (NOLOCK) WHERE CODIGO=737 AND TZ_LOCK=0)*
									(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 
											H.MONEDA = 5 AND
											H.FECHA_COTIZACION = (SELECT MAX (FECHA_COTIZACION) 
																	FROM HISTORICOTIPOSCAMBIO WITH (NOLOCK)
																	WHERE FECHA_COTIZACION &lt;= DBO.ULTIMODIAHABIL(CONVERT(DATETIME,DATEADD(MONTH,-1,CONVERT(DATETIME,G.FECHA,103)),103)))))

	,2) AS MINORISTA,

	G.SALDOS_JTS_OID AS JTS_OID,

	(SELECT NUM1 FROM RRI_PARAMETROS_INF WHERE CODIGO=1 AND ID1 = G.MONEDA) AS MONEDA,

	CP.TITULARIDAD AS CONDICION,

	CASE WHEN G.MONEDA = (SELECT MONNAC FROM PARAMETROS WITH (NOLOCK))
		THEN

			ROUND(ISNULL (((SELECT TOP 1 SALDO_AJUSTADO 
				FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
				WHERE SALDOS_JTS_OID = G.SALDOS_JTS_OID 
				AND MONEDA = G.MONEDA
				AND FECHA = G.FECHA
				AND TZ_LOCK = G.TZ_LOCK)/
	   		(SELECT COUNT(NUMEROPERSONA) 
	   		FROM CLI_ClientePersona WITH (NOLOCK)
	   		WHERE CODIGOCLIENTE = CP.CODIGOCLIENTE 
	   		AND TZ_LOCK = CP.TZ_LOCK)),0),2)

	WHEN G.MONEDA = 2 THEN
			
			ROUND(ISNULL (((SELECT TOP 1 SALDO_AJUSTADO 
				FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
				WHERE SALDOS_JTS_OID = G.SALDOS_JTS_OID 
				AND MONEDA = G.MONEDA
				AND FECHA = G.FECHA
				AND TZ_LOCK = G.TZ_LOCK)/
	   		(SELECT COUNT(NUMEROPERSONA) 
	   		FROM CLI_ClientePersona WITH (NOLOCK)
	   		WHERE CODIGOCLIENTE = CP.CODIGOCLIENTE 
	   		AND TZ_LOCK = CP.TZ_LOCK)) *
			(SELECT H.TIPO_CAMBIO_OFICIAL
				FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
				WHERE 	H.TZ_LOCK = 0 AND
						H.MONEDA = 2 AND
						H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
											FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
											WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)
														AND HTC.MONEDA = H.MONEDA
														AND HTC.TZ_LOCK = H.TZ_LOCK)),0),2)

	WHEN G.MONEDA = 998 THEN
			
		ROUND(ISNULL (((SELECT TOP 1 SALDO_AJUSTADO 
				FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
				WHERE SALDOS_JTS_OID = G.SALDOS_JTS_OID 
				AND MONEDA = G.MONEDA
				AND FECHA = G.FECHA
				AND TZ_LOCK = G.TZ_LOCK)/
	   		(SELECT COUNT(NUMEROPERSONA) 
	   		FROM CLI_ClientePersona WITH (NOLOCK)
	   		WHERE CODIGOCLIENTE = CP.CODIGOCLIENTE 
	   		AND TZ_LOCK = CP.TZ_LOCK)) *
			(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 	H.TZ_LOCK = 0 AND 
											H.MONEDA = 998 AND
											H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
																FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK) 
																WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)
																	AND HTC.MONEDA = H.MONEDA
																	AND HTC.TZ_LOCK = H.TZ_LOCK))

		,0),2)


	WHEN G.MONEDA = 999 THEN
			
		ROUND(ISNULL (((SELECT TOP 1 SALDO_AJUSTADO 
				FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
				WHERE SALDOS_JTS_OID = G.SALDOS_JTS_OID 
				AND MONEDA = G.MONEDA
				AND FECHA = G.FECHA
				AND TZ_LOCK = G.TZ_LOCK)/
	   		(SELECT COUNT(NUMEROPERSONA) 
	   		FROM CLI_ClientePersona WITH (NOLOCK)
	   		WHERE CODIGOCLIENTE = CP.CODIGOCLIENTE 
	   		AND TZ_LOCK = CP.TZ_LOCK)) *
			(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 	H.TZ_LOCK = 0 AND 
											H.MONEDA = 999 AND
											H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
																FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK) 
																WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)
																	AND HTC.MONEDA = H.MONEDA
																	AND HTC.TZ_LOCK = H.TZ_LOCK))

		,0),2)

	
		ELSE
		ROUND(ISNULL(((SELECT TOP 1 SALDO_AJUSTADO 
				FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
				WHERE SALDOS_JTS_OID = G.SALDOS_JTS_OID 
				AND MONEDA = G.MONEDA
				AND FECHA = G.FECHA
				AND TZ_LOCK = G.TZ_LOCK)/
	   		(SELECT COUNT(NUMEROPERSONA) 
	   		FROM CLI_ClientePersona WITH (NOLOCK)
	   		WHERE CODIGOCLIENTE = CP.CODIGOCLIENTE 
	   		AND TZ_LOCK = CP.TZ_LOCK))*

		(SELECT H.ARBITRAJE_COMPRA
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 	H.TZ_LOCK = 0 AND
				H.MONEDA= G.MONEDA AND
				H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
									FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
									WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)
									AND HTC.MONEDA = H.MONEDA
									AND HTC.TZ_LOCK = H.TZ_LOCK)) *

		(SELECT TOP 1 H.TIPO_CAMBIO_OFICIAL
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE	H.TZ_LOCK = 0 AND
			H.MONEDA = 2  AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)
									AND HTC.MONEDA = H.MONEDA
									AND HTC.TZ_LOCK = H.TZ_LOCK))
		,0),2)
END MONTODEPOSITO,

	S.C1785 AS PRODUCTO

	FROM CLI_ClientePersona CP WITH (NOLOCK)
	INNER JOIN SALDOS S WITH (NOLOCK)
		ON CP.CODIGOCLIENTE = S.C1803
		AND CP.TZ_LOCK = S.TZ_LOCK
	INNER JOIN GRL_SALDOS_DIARIOS G WITH (NOLOCK)
		ON G.SALDOS_JTS_OID = S.JTS_OID
		AND G.MONEDA = S.MONEDA
		AND G.TZ_LOCK = S.TZ_LOCK
	INNER JOIN TOPESPRODUCTO TP WITH (NOLOCK)
		ON S.PRODUCTO = TP.CODPRODUCTO
		AND TP.MONEDA = S.MONEDA
		AND TP.TZ_LOCK = S.TZ_LOCK
	INNER JOIN CRE_TAM_EMP_BITACORA CTE WITH (NOLOCK)
		ON CTE.CLIENTE = CP.CODIGOCLIENTE
		AND CTE.TZ_LOCK = S.TZ_LOCK
	WHERE 
	S.C1785 IN (2,3)
	AND S.TZ_LOCK = 0
	AND G.FECHA = CONVERT(DATETIME,?,103)
	AND G.SALDO_AJUSTADO != 0
GROUP BY 
	CODIGOCLIENTE,
	S.C1785,
	G.FECHA,
	G.MONEDA,
	G.TZ_LOCK,
	CP.TITULARIDAD,
	CP.NUMEROPERSONA,
	G.SALDO_AJUSTADO,
	G.SALDOS_JTS_OID,
	CP.TZ_LOCK
/*ORDER BY 
	CP.NUMEROPERSONA, PRODUCTO ASC*/

------221000-----------
------DPFS-------------
UNION ALL

SELECT

	CONVERT(DATETIME,G.FECHA,103) AS FECHA_INF,
	
	CP.NUMEROPERSONA AS PERSONA, 
	
	ROUND((
			(SELECT IMPORTE FROM PARAMETROSGENERALES WITH (NOLOCK) WHERE CODIGO=737 AND TZ_LOCK=0)*
									(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 
											H.MONEDA = 5 AND
											H.FECHA_COTIZACION = (SELECT MAX (FECHA_COTIZACION) 
																	FROM HISTORICOTIPOSCAMBIO WITH (NOLOCK)
																	WHERE FECHA_COTIZACION &lt;= DBO.ULTIMODIAHABIL(CONVERT(DATETIME,DATEADD(MONTH,-1,CONVERT(DATETIME,G.FECHA,103)),103)))))

	,2) AS MINORISTA,

	G.SALDOS_JTS_OID AS JTS_OID,

	(SELECT NUM1 FROM RRI_PARAMETROS_INF WHERE CODIGO=1 AND ID1 = G.MONEDA) AS MONEDA,

	CP.TITULARIDAD AS CONDICION,

	CASE WHEN G.MONEDA = (SELECT MONNAC FROM PARAMETROS WITH (NOLOCK))
		THEN

			ROUND(ISNULL (((SELECT TOP 1 SALDO_AJUSTADO 
				FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
				WHERE SALDOS_JTS_OID = G.SALDOS_JTS_OID 
				AND MONEDA = G.MONEDA
				AND FECHA = G.FECHA
				AND TZ_LOCK = G.TZ_LOCK)/
	   		(SELECT COUNT(NUMEROPERSONA) 
	   		FROM CLI_ClientePersona WITH (NOLOCK)
	   		WHERE CODIGOCLIENTE = CP.CODIGOCLIENTE 
	   		AND TZ_LOCK = CP.TZ_LOCK)),0),2)

	WHEN G.MONEDA = 2 THEN
			
			ROUND(ISNULL (((SELECT TOP 1 SALDO_AJUSTADO 
				FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
				WHERE SALDOS_JTS_OID = G.SALDOS_JTS_OID 
				AND MONEDA = G.MONEDA
				AND FECHA = G.FECHA
				AND TZ_LOCK = G.TZ_LOCK)/
	   		(SELECT COUNT(NUMEROPERSONA) 
	   		FROM CLI_ClientePersona WITH (NOLOCK)
	   		WHERE CODIGOCLIENTE = CP.CODIGOCLIENTE 
	   		AND TZ_LOCK = CP.TZ_LOCK)) *
			(SELECT H.TIPO_CAMBIO_OFICIAL
				FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
				WHERE 	H.TZ_LOCK = 0 AND
						H.MONEDA = 2 AND
						H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
											FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
											WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)
														AND HTC.MONEDA = H.MONEDA
														AND HTC.TZ_LOCK = H.TZ_LOCK)),0),2)

	WHEN G.MONEDA = 998 THEN
			
		ROUND(ISNULL (((SELECT TOP 1 SALDO_AJUSTADO 
				FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
				WHERE SALDOS_JTS_OID = G.SALDOS_JTS_OID 
				AND MONEDA = G.MONEDA
				AND FECHA = G.FECHA
				AND TZ_LOCK = G.TZ_LOCK)/
	   		(SELECT COUNT(NUMEROPERSONA) 
	   		FROM CLI_ClientePersona WITH (NOLOCK)
	   		WHERE CODIGOCLIENTE = CP.CODIGOCLIENTE 
	   		AND TZ_LOCK = CP.TZ_LOCK)) *
			(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 	H.TZ_LOCK = 0 AND 
											H.MONEDA = 998 AND
											H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
																FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK) 
																WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)
																	AND HTC.MONEDA = H.MONEDA
																	AND HTC.TZ_LOCK = H.TZ_LOCK))

		,0),2)


	WHEN G.MONEDA = 999 THEN
			
		ROUND(ISNULL (((SELECT TOP 1 SALDO_AJUSTADO 
				FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
				WHERE SALDOS_JTS_OID = G.SALDOS_JTS_OID 
				AND MONEDA = G.MONEDA
				AND FECHA = G.FECHA
				AND TZ_LOCK = G.TZ_LOCK)/
	   		(SELECT COUNT(NUMEROPERSONA) 
	   		FROM CLI_ClientePersona WITH (NOLOCK)
	   		WHERE CODIGOCLIENTE = CP.CODIGOCLIENTE 
	   		AND TZ_LOCK = CP.TZ_LOCK)) *
			(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 	H.TZ_LOCK = 0 AND 
											H.MONEDA = 999 AND
											H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
																FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
																WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)
																	AND HTC.MONEDA = H.MONEDA
																	AND HTC.TZ_LOCK = H.TZ_LOCK))

		,0),2)

	
		ELSE
		ROUND(ISNULL(((SELECT TOP 1 SALDO_AJUSTADO 
				FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
				WHERE SALDOS_JTS_OID = G.SALDOS_JTS_OID 
				AND MONEDA = G.MONEDA
				AND FECHA = G.FECHA
				AND TZ_LOCK = G.TZ_LOCK)/
	   		(SELECT COUNT(NUMEROPERSONA) 
	   		FROM CLI_ClientePersona WITH (NOLOCK)
	   		WHERE CODIGOCLIENTE = CP.CODIGOCLIENTE 
	   		AND TZ_LOCK = CP.TZ_LOCK))*

		(SELECT H.ARBITRAJE_COMPRA
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 	H.TZ_LOCK = 0 AND
				H.MONEDA= G.MONEDA AND
				H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
									FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
									WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)
									AND HTC.MONEDA = H.MONEDA
									AND HTC.TZ_LOCK = H.TZ_LOCK)) *

		(SELECT TOP 1 H.TIPO_CAMBIO_OFICIAL
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE	H.TZ_LOCK = 0 AND
			H.MONEDA = 2  AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)
									AND HTC.MONEDA = H.MONEDA
									AND HTC.TZ_LOCK = H.TZ_LOCK))
		,0),2)
	END MONTODEPOSITO,

	S.C1785 AS PRODUCTO

	FROM CLI_ClientePersona CP WITH (NOLOCK)
    INNER JOIN SALDOS S WITH (NOLOCK)
        ON CP.CODIGOCLIENTE = S.C1803
        AND CP.TZ_LOCK = S.TZ_LOCK
    INNER JOIN GRL_SALDOS_DIARIOS G WITH (NOLOCK)
        ON G.SALDOS_JTS_OID = S.JTS_OID
        AND G.MONEDA = S.MONEDA
        AND G.TZ_LOCK = S.TZ_LOCK
    INNER JOIN TOPESPRODUCTO TP WITH (NOLOCK)
        ON S.PRODUCTO = TP.CODPRODUCTO
        AND TP.MONEDA = S.MONEDA
        AND TP.TZ_LOCK = S.TZ_LOCK
	INNER JOIN CRE_TAM_EMP_BITACORA CTEB WITH (NOLOCK)
		ON CTEB.CLIENTE = CP.CODIGOCLIENTE
		AND CTEB.TZ_LOCK = S.TZ_LOCK
    WHERE S.C1785 = 4
    AND S.TZ_LOCK = 0
    AND G.FECHA = CONVERT(DATETIME,?,103)
	AND G.SALDO_AJUSTADO != 0
    AND ((TP.PermitePrecancelar='S'
    AND DATEDIFF(day,G.FECHA,S.C1627)&lt;=30)
    OR DATEDIFF(day,S.C1620,S.C1627)&lt;=30)
GROUP BY
	G.MONEDA,
	CP.TITULARIDAD,
	G.TZ_LOCK,
	CP.TZ_LOCK,
    CODIGOCLIENTE,
    S.C1785,
    G.FECHA,
    CP.NUMEROPERSONA,
    G.SALDO_AJUSTADO,
    G.SALDOS_JTS_OID
ORDER BY 
	CP.NUMEROPERSONA, PRODUCTO ASC</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>480</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>221000 2</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT
	CONVERT(DATETIME,?,103) AS FECHA_INFORME,

	'221000' AS CODIGOPART,
	
	? AS MONEDA,
	
	ABS(ROUND(ISNULL(?*(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '221000'
				AND TZ_LOCK = 0 
				AND ID2 = ?),0),2)) as SENT,
	
	ISNULL((SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=105 AND CHAR1='221000' AND TZ_LOCK=0),1) AS VALOR,
	
	0 AS SDO_FALAC,

	ISNULL((SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '221000'
				AND TZ_LOCK = 0 
				AND ID2 = ?),1) AS COEFICIENTE,

	0 AS LCR,

	0 AS IMPORTE_MES1,

	0 AS IMPORTE_MES2,
	
	0 AS IMPORTE_MES3
</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONTO_TOTAL</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>912</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>221100 </name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT
	CONVERT(DATETIME,?,103) AS FECHA_INFORME,

	'221100' AS CODIGOPART,
	
	? AS MONEDA,


	CASE WHEN ?>= (SELECT (MONTO_MAX)
    				FROM TASASFONDOGARANTIA
    				WHERE TIPOPRODUCTO  = 1
        				AND TZ_LOCK = 0
        				AND FECHA_VIGENCIA = (SELECT MAX(TF.FECHA_VIGENCIA)
                                				FROM TASASFONDOGARANTIA TF
                                				WHERE TF.FECHA_VIGENCIA &lt;= CONVERT(DATETIME,?,103)
                                    				AND TF.TZ_LOCK = 0
                                    				AND TF.TIPOPRODUCTO = 1))
	THEN
		
	ROUND(ISNULL(((SELECT (MONTO_MAX)
    					FROM TASASFONDOGARANTIA
    					WHERE TIPOPRODUCTO  = 1
        					AND TZ_LOCK = 0
        					AND FECHA_VIGENCIA = (SELECT MAX(TF.FECHA_VIGENCIA)
                                					FROM TASASFONDOGARANTIA TF
                                					WHERE TF.FECHA_VIGENCIA &lt;= CONVERT(DATETIME,?,103)
                                    					AND TF.TZ_LOCK = 0
                                    					AND TF.TIPOPRODUCTO = 1))* 
																					(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
																						WHERE CODIGO = 106 
																							AND ID4 = '221100'
																							AND TZ_LOCK = 0 
																							AND ID2 = ?)),0),2)
	ELSE
		ROUND(ISNULL((?*
				(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
					WHERE CODIGO = 106 
						AND ID4 = '221100'
						AND TZ_LOCK = 0 
						AND ID2 = ?)),0),2)
	END SENT,
	
	ISNULL((SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=105 AND CHAR1='221100' AND TZ_LOCK=0),1) AS VALOR,
	
	0 AS SDO_FALAC,

	ISNULL((SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '221100'
				AND TZ_LOCK = 0 
				AND ID2 = ?),1) AS COEFICIENTE,

	0 AS LCR,

	0 AS IMPORTE_MES1,

	0 AS IMPORTE_MES2,
	
	0 AS IMPORTE_MES3
</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONTO_TOTAL</name>
        <type>Integer</type>
      </field>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONTO_TOTAL</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1168</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>221100/221210</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT 

	CONVERT(DATETIME,G.FECHA,103) AS FECHA_INF,
	
	CP.NUMEROPERSONA AS PERSONA, 
	
	ROUND((
			(SELECT IMPORTE/3 FROM PARAMETROSGENERALES WITH (NOLOCK) WHERE CODIGO=737 AND TZ_LOCK=0)*
									(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 
											H.MONEDA = 5 AND
											H.FECHA_COTIZACION = (SELECT MAX (FECHA_COTIZACION) 
																	FROM HISTORICOTIPOSCAMBIO WITH (NOLOCK)
																	WHERE FECHA_COTIZACION &lt;= DBO.ULTIMODIAHABIL(CONVERT(DATETIME,DATEADD(MONTH,-1,CONVERT(DATETIME,G.FECHA,103)),103)))))

	,2) AS MINORISTA,

	G.SALDOS_JTS_OID AS JTS_OID,

	(SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=1 AND ID1 = G.MONEDA) AS MONEDA,

	CP.TITULARIDAD AS CONDICION,
	
	ROUND(ISNULL (((SELECT TOP 1 SALDO_AJUSTADO 
		FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
		WHERE SALDOS_JTS_OID = G.SALDOS_JTS_OID 
		AND MONEDA = G.MONEDA
		AND FECHA = G.FECHA
		AND TZ_LOCK = G.TZ_LOCK)/
	(SELECT COUNT(NUMEROPERSONA) 
	FROM CLI_ClientePersona WITH (NOLOCK)
	WHERE CODIGOCLIENTE = CP.CODIGOCLIENTE 
	AND TZ_LOCK = CP.TZ_LOCK)),0),2) AS MONTODEPOSITO,

	S.C1785 AS PRODUCTO

	FROM CLI_ClientePersona CP WITH (NOLOCK)
	
	INNER JOIN SALDOS S WITH (NOLOCK)
		ON CP.CODIGOCLIENTE = S.C1803
		AND CP.TZ_LOCK = S.TZ_LOCK
		
	LEFT JOIN CLI_PERSONASFISICAS CPF WITH (NOLOCK)
		ON CP.NUMEROPERSONA = CPF.NUMEROPERSONAFISICA
		AND S.TZ_LOCK = CPF.TZ_LOCK
		
	LEFT JOIN CLI_PERSONASJURIDICAS CPJ WITH (NOLOCK)
		ON CP.NUMEROPERSONA = CPJ.NUMEROPERSONAJURIDICA
		AND CPJ.SECTOR = CPF.SECTOR
		AND S.TZ_LOCK = CPJ.TZ_LOCK
		
	INNER JOIN GRL_SALDOS_DIARIOS G WITH (NOLOCK)
		ON G.SALDOS_JTS_OID = S.JTS_OID
		AND G.MONEDA = S.MONEDA
		AND G.TZ_LOCK = S.TZ_LOCK
		
	INNER JOIN TOPESPRODUCTO TP WITH (NOLOCK)
		ON S.PRODUCTO = TP.CODPRODUCTO
		AND TP.MONEDA = S.MONEDA
		AND TP.TZ_LOCK = S.TZ_LOCK
		
	INNER JOIN CRE_TAM_EMP_BITACORA CTE WITH (NOLOCK)
		ON CTE.CLIENTE = CP.CODIGOCLIENTE
		AND CTE.TZ_LOCK = S.TZ_LOCK
		
	WHERE 
	S.C1785 IN (2,3)
	AND (CPF.SECTOR != 1 OR CPJ.SECTOR != 1)
	AND G.MONEDA = (SELECT MONNAC FROM PARAMETROS WITH (NOLOCK))
	AND S.TZ_LOCK = 0
	AND G.FECHA = CONVERT(DATETIME,?,103)
	AND G.SALDO_AJUSTADO>0

GROUP BY 
	CODIGOCLIENTE,
	S.C1785,
	G.FECHA,
	G.MONEDA,
	G.TZ_LOCK,
	CP.TITULARIDAD,
	CP.NUMEROPERSONA,
	G.SALDO_AJUSTADO,
	G.SALDOS_JTS_OID,
	CP.TZ_LOCK
ORDER BY 
	CP.NUMEROPERSONA, PRODUCTO ASC
	</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>480</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>221210</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT
	CONVERT(DATETIME,?,103) AS FECHA_INFORME,

	'221210' AS CODIGOPART,
	
	? AS MONEDA,
	
	ABS(ROUND(ISNULL(?*(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '221210'
				AND TZ_LOCK = 0 
				AND ID2 = ?),0),2)) as SENT,
	
	ISNULL((SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=105 AND CHAR1='221210' AND TZ_LOCK=0),1) AS VALOR,
	
	0 AS SDO_FALAC,

	ISNULL((SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '221210'
				AND TZ_LOCK = 0 
				AND ID2 = ?),0) AS COEFICIENTE,

	0 AS LCR,

	0 AS IMPORTE_MES1,

	0 AS IMPORTE_MES2,
	
	0 AS IMPORTE_MES3
</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>MONNAC</name>
        <type>Integer</type>
      </field>
      <field>
        <name>DIFERENCIA</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONNAC</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONNAC</name>
        <type>Integer</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1168</xloc>
      <yloc>896</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>221210 2</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT

	CONVERT(DATETIME,G.FECHA,103) AS FECHA_INF,
	
	CP.NUMEROPERSONA AS PERSONA, 
	
	ROUND((
			(SELECT IMPORTE/3 FROM PARAMETROSGENERALES WITH (NOLOCK) WHERE CODIGO=737 AND TZ_LOCK=0)*
									(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 
											H.MONEDA = 5 AND
											H.FECHA_COTIZACION = (SELECT MAX (FECHA_COTIZACION) 
																	FROM HISTORICOTIPOSCAMBIO WITH (NOLOCK)
																	WHERE FECHA_COTIZACION &lt;= DBO.ULTIMODIAHABIL(CONVERT(DATETIME,DATEADD(MONTH,-1,CONVERT(DATETIME,G.FECHA,103)),103)))))

	,2) AS MINORISTA,

	G.SALDOS_JTS_OID AS JTS_OID,

	(SELECT NUM1 FROM RRI_PARAMETROS_INF WHERE CODIGO=1 AND ID1 = G.MONEDA) AS MONEDA,

	CP.TITULARIDAD AS CONDICION,

	ROUND(ISNULL (((SELECT TOP 1 SALDO_AJUSTADO 
		FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
		WHERE SALDOS_JTS_OID = G.SALDOS_JTS_OID 
		AND MONEDA = G.MONEDA
		AND FECHA = G.FECHA
		AND TZ_LOCK = G.TZ_LOCK)/
	(SELECT COUNT(NUMEROPERSONA) 
	FROM CLI_ClientePersona WITH (NOLOCK)
	WHERE CODIGOCLIENTE = CP.CODIGOCLIENTE 
	AND TZ_LOCK = CP.TZ_LOCK)),0),2) AS MONTODEPOSITO,

	S.C1785 AS PRODUCTO

	FROM CLI_ClientePersona CP WITH (NOLOCK)
    INNER JOIN SALDOS S WITH (NOLOCK)
        ON CP.CODIGOCLIENTE = S.C1803
        AND CP.TZ_LOCK = S.TZ_LOCK
    INNER JOIN GRL_SALDOS_DIARIOS G WITH (NOLOCK)
        ON G.SALDOS_JTS_OID = S.JTS_OID
        AND G.MONEDA = S.MONEDA
        AND G.TZ_LOCK = S.TZ_LOCK
    INNER JOIN TOPESPRODUCTO TP WITH (NOLOCK)
        ON S.PRODUCTO = TP.CODPRODUCTO
        AND TP.MONEDA = S.MONEDA
        AND TP.TZ_LOCK = S.TZ_LOCK
	INNER JOIN CRE_TAM_EMP_BITACORA CTEB WITH (NOLOCK)
		ON CTEB.CLIENTE = CP.CODIGOCLIENTE
		AND CTEB.TZ_LOCK = S.TZ_LOCK
    WHERE S.C1785 = 4
    AND S.TZ_LOCK = 0
	AND G.SALDO_AJUSTADO>0
    AND G.MONEDA = (SELECT MONNAC FROM PARAMETROS WITH (NOLOCK))
    AND G.FECHA = CONVERT(DATETIME,?,103)
    AND (TP.PermitePrecancelar='S'
    OR DATEDIFF(day,S.C1620,S.C1627)&lt;=30)
GROUP BY
	G.MONEDA,
	CP.TITULARIDAD,
	G.TZ_LOCK,
	CP.TZ_LOCK,
    CODIGOCLIENTE,
    S.C1785,
    G.FECHA,
    CP.NUMEROPERSONA,
    G.SALDO_AJUSTADO,
    G.SALDOS_JTS_OID
ORDER BY 
	CP.NUMEROPERSONA, PRODUCTO ASC</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>480</xloc>
      <yloc>1056</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>221210 4</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT
	CONVERT(DATETIME,?,103) AS FECHA_INFORME,

	'221210' AS CODIGOPART,
	
	? AS MONEDA,
	
	ROUND(ISNULL(?*(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '221210'
				AND TZ_LOCK = 0 
				AND ID2 = ?),0),2) as SENT,
	
	ISNULL((SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=105 AND CHAR1='221210' AND TZ_LOCK=0),1) AS VALOR,
	
	0 AS SDO_FALAC,

	ISNULL((SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '221210'
				AND TZ_LOCK = 0 
				AND ID2 = ?),0) AS COEFICIENTE,

	0 AS LCR,

	0 AS IMPORTE_MES1,

	0 AS IMPORTE_MES2,
	
	0 AS IMPORTE_MES3</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONTO_TOTAL</name>
        <type>BigNumber</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>1056</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>221220</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT

	CONVERT(DATETIME,G.FECHA,103) AS FECHA_INF,
	
	CP.NUMEROPERSONA AS PERSONA, 

	G.SALDOS_JTS_OID AS JTS_OID,

	(SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=1 AND ID1 = G.MONEDA) AS MONEDA,

	CP.TITULARIDAD AS CONDICION,

	ROUND(ISNULL (((SELECT TOP 1 SALDO_AJUSTADO 
		FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
		WHERE SALDOS_JTS_OID = G.SALDOS_JTS_OID 
		AND MONEDA = G.MONEDA
		AND FECHA = G.FECHA
		AND TZ_LOCK = G.TZ_LOCK)/
	(SELECT COUNT(NUMEROPERSONA) 
	FROM CLI_ClientePersona WITH (NOLOCK)
	WHERE CODIGOCLIENTE = CP.CODIGOCLIENTE 
	AND TZ_LOCK = CP.TZ_LOCK)),0),2) AS MONTODEPOSITO,

	S.C1785 AS PRODUCTO

	FROM CLI_ClientePersona CP WITH (NOLOCK)
    INNER JOIN SALDOS S WITH (NOLOCK)
        ON CP.CODIGOCLIENTE = S.C1803
        AND CP.TZ_LOCK = S.TZ_LOCK
    INNER JOIN GRL_SALDOS_DIARIOS G WITH (NOLOCK)
        ON G.SALDOS_JTS_OID = S.JTS_OID
        AND G.MONEDA = S.MONEDA
        AND G.TZ_LOCK = S.TZ_LOCK
    INNER JOIN TOPESPRODUCTO TP WITH (NOLOCK)
        ON S.PRODUCTO = TP.CODPRODUCTO
        AND TP.MONEDA = S.MONEDA
        AND TP.TZ_LOCK = S.TZ_LOCK
	INNER JOIN CRE_TAM_EMP_BITACORA CTEB WITH (NOLOCK)
		ON CTEB.CLIENTE = CP.CODIGOCLIENTE
		AND CTEB.TZ_LOCK = S.TZ_LOCK
    WHERE S.C1785 = 4
    AND S.PRODUCTO != 105
    AND S.TZ_LOCK = 0
    AND G.MONEDA = (SELECT MONNAC FROM PARAMETROS WITH (NOLOCK))
    AND G.FECHA = CONVERT(DATETIME,?,103)
    AND G.SALDO_AJUSTADO>0
    AND (TP.PermitePrecancelar='S'
    OR DATEDIFF(day,G.FECHA,S.C1627)&lt;=30)
GROUP BY
	G.MONEDA,
	CP.TITULARIDAD,
	G.TZ_LOCK,
	CP.TZ_LOCK,
    CODIGOCLIENTE,
    S.C1785,
    G.FECHA,
    CP.NUMEROPERSONA,
    G.SALDO_AJUSTADO,
    G.SALDOS_JTS_OID
ORDER BY 
	CP.NUMEROPERSONA, PRODUCTO ASC</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>480</xloc>
      <yloc>1184</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>221220 2</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT
	CONVERT(DATETIME,?,103) AS FECHA_INFORME,

	'221220' AS CODIGOPART,
	
	? AS MONEDA,
	
	ROUND(ISNULL(?*(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '221220'
				AND TZ_LOCK = 0 
				AND ID2 = ?),0),2) as SENT,
	
	ISNULL((SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=105 AND CHAR1='221220' AND TZ_LOCK=0),1) AS VALOR,
	
	0 AS SDO_FALAC,

	ISNULL((SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '221220'
				AND TZ_LOCK = 0 
				AND ID2 = ?),0) AS COEFICIENTE,

	0 AS LCR,

	0 AS IMPORTE_MES1,

	0 AS IMPORTE_MES2,
	
	0 AS IMPORTE_MES3</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONTO_TOTAL</name>
        <type>BigNumber</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>1184</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>221230</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT

	CONVERT(DATETIME,G.FECHA,103) AS FECHA_INF,
	
	CP.NUMEROPERSONA AS PERSONA, 
	
	G.SALDOS_JTS_OID AS JTS_OID,

	(SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=1 AND ID1 = G.MONEDA) AS MONEDA,

	CP.TITULARIDAD AS CONDICION,

	CASE WHEN G.MONEDA = 2 THEN
		
	ISNULL(ROUND(((SELECT TOP 1 SALDO_AJUSTADO
        FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
        WHERE SALDOS_JTS_OID = G.SALDOS_JTS_OID
        AND MONEDA = G.MONEDA
        AND FECHA = G.FECHA
        AND TZ_LOCK = G.TZ_LOCK)/
    (SELECT COUNT(NUMEROPERSONA)
    FROM CLI_ClientePersona WITH (NOLOCK)
    WHERE CODIGOCLIENTE = CP.CODIGOCLIENTE
    AND TZ_LOCK = CP.TZ_LOCK)) *
									(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 	H.TZ_LOCK = 0 AND
									H.MONEDA = 2 AND
									H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
															FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
															WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)
																AND HTC.MONEDA = G.MONEDA
																AND HTC.TZ_LOCK = H.TZ_LOCK))
		,2),1)
		
				
	ELSE
		ISNULL(ROUND(((SELECT TOP 1 SALDO_AJUSTADO
        FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
        WHERE SALDOS_JTS_OID = G.SALDOS_JTS_OID
        AND MONEDA = G.MONEDA
        AND FECHA = G.FECHA
        AND TZ_LOCK = G.TZ_LOCK)/
    (SELECT COUNT(NUMEROPERSONA)
    FROM CLI_ClientePersona WITH (NOLOCK)
    WHERE CODIGOCLIENTE = CP.CODIGOCLIENTE
    AND TZ_LOCK = CP.TZ_LOCK)) *

		(SELECT H.ARBITRAJE_COMPRA
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 	H.TZ_LOCK = 0 AND
				H.MONEDA= G.MONEDA AND
				H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
									FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
									WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)
									AND HTC.MONEDA = H.MONEDA
									AND HTC.TZ_LOCK = H.TZ_LOCK)) *

		(SELECT TOP 1 H.TIPO_CAMBIO_OFICIAL
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE	H.TZ_LOCK = 0 AND
			H.MONEDA = 2  AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)
									AND HTC.MONEDA = H.MONEDA
									AND HTC.TZ_LOCK = H.TZ_LOCK))
											
		,2),1)


	END AS MONTODEPOSITO,
	
	S.C1785 AS PRODUCTO

	FROM CLI_ClientePersona CP WITH (NOLOCK)
    INNER JOIN SALDOS S WITH (NOLOCK)
        ON CP.CODIGOCLIENTE = S.C1803
        AND CP.TZ_LOCK = S.TZ_LOCK
        
    INNER JOIN GRL_SALDOS_DIARIOS G WITH (NOLOCK)
        ON G.SALDOS_JTS_OID = S.JTS_OID
        AND G.MONEDA = S.MONEDA
        AND G.TZ_LOCK = S.TZ_LOCK
        
	INNER JOIN CRE_TAM_EMP_BITACORA CTEB WITH (NOLOCK)
		ON CTEB.CLIENTE = CP.CODIGOCLIENTE
		AND CTEB.TZ_LOCK = S.TZ_LOCK
		
    WHERE S.C1785 = 4
    AND S.TZ_LOCK = 0
	AND G.SALDO_AJUSTADO >0
    AND G.MONEDA NOT IN ((SELECT MONNAC FROM PARAMETROS WITH (NOLOCK)),999,988)
    AND G.FECHA = CONVERT(DATETIME,?,103)
    AND (DATEDIFF(day,G.FECHA,S.C1627)&lt;=30 OR DATEDIFF(day,S.C1620,S.C1627)&lt;=30)
    
GROUP BY
	G.MONEDA,
	CP.TITULARIDAD,
	G.TZ_LOCK,
	CP.TZ_LOCK,
    CODIGOCLIENTE,
    S.C1785,
    G.FECHA,
    CP.NUMEROPERSONA,
    G.SALDO_AJUSTADO,
    G.SALDOS_JTS_OID
ORDER BY 
	CP.NUMEROPERSONA, PRODUCTO ASC</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>480</xloc>
      <yloc>1296</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>221230 2</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT
	CONVERT(DATETIME,?,103) AS FECHA_INFORME,

	'221230' AS CODIGOPART,
	
	? AS MONEDA,
	
	ROUND(ISNULL(?*(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '221230'
				AND TZ_LOCK = 0 
				AND ID2 = ?),0),2) as SENT,
	
	ISNULL((SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=105 AND CHAR1='221230' AND TZ_LOCK=0),1) AS VALOR,
	
	0 AS SDO_FALAC,

	ISNULL((SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '221230'
				AND TZ_LOCK = 0 
				AND ID2 = ?),0) AS COEFICIENTE,

	0 AS LCR,

	0 AS IMPORTE_MES1,

	0 AS IMPORTE_MES2,
	
	0 AS IMPORTE_MES3</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>MON</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONTO_TOTAL</name>
        <type>BigNumber</type>
      </field>
      <field>
        <name>MON</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MON</name>
        <type>Integer</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>1296</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>351000</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>----PRESTAMOS
SELECT 
	CONVERT(DATETIME,?,103) AS FECHA_INF,
	
	CASE 
	WHEN G.MONEDA = 1 THEN
		ROUND((PP.C2304+PP.C2305),2) 
	
	WHEN G.MONEDA = 2 THEN
		ROUND((PP.C2304+PP.C2305)*
							(SELECT H.TIPO_CAMBIO_OFICIAL
							FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
							WHERE 
									H.MONEDA = 2 AND
									H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
														FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
														WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,?,103)),103)))

		,2) 
		
	ELSE 
		ROUND((PP.C2304+PP.C2305)*

		(SELECT H.ARBITRAJE_COMPRA
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 
			H.MONEDA= G.MONEDA AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,?,103)),103))) * 

		(SELECT TOP 1 H.TIPO_CAMBIO_OFICIAL
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 
			H.MONEDA = 2  AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,?,103)),103)))
		,2)
		END AS MONTODEPOSITO,
		
	(SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=1 AND ID1 = G.MONEDA) AS MONEDA
	
	FROM GRL_SALDOS_DIARIOS G WITH (NOLOCK)

	INNER JOIN SALDOS S WITH (NOLOCK) ON 
		G.SALDOS_JTS_OID=S.JTS_OID AND
		G.MONEDA = S.MONEDA
		AND G.TZ_LOCK = S.TZ_LOCK

	INNER JOIN CLI_CLIENTES C ON 
		S.C1803 = C.CODIGOCLIENTE
		AND S.TZ_LOCK = C.TZ_LOCK

	INNER JOIN CLI_ClientePersona CP ON
		C.CODIGOCLIENTE=CP.CODIGOCLIENTE
		AND CP.TZ_LOCK = S.TZ_LOCK
		
	INNER JOIN PLANPAGOS PP ON 
		S.JTS_OID=PP.SALDO_JTS_OID AND
		S.TZ_LOCK=PP.TZ_LOCK

	LEFT JOIN CRE_TAM_EMP_BITACORA CTEB ON
		CTEB.CLIENTE=C.CODIGOCLIENTE AND
		CTEB.TZ_LOCK=S.TZ_LOCK

	LEFT JOIN CLI_PERSONASFISICAS CPF ON
		CP.NUMEROPERSONA=CPF.NUMEROPERSONAFISICA
		AND CP.TZ_LOCK=CPF.TZ_LOCK

	LEFT JOIN CLI_PERSONASJURIDICAS CPJ ON
		CP.NUMEROPERSONA=CPJ.NUMEROPERSONAJURIDICA
		AND CP.TZ_LOCK=CPJ.TZ_LOCK

	WHERE PP.C2302 BETWEEN CONVERT (DATETIME,?,103) AND CONVERT(DATETIME,DATEADD(DAY,30,CONVERT(DATETIME,?,103)),103) AND 
	S.C1785 = 5 AND 
	S.TZ_LOCK=0 AND 
	C.SUBSEGMENTOCLIENTE =43 AND
	(CPF.SECTOR=1 OR CPJ.SECTOR=1)
	GROUP BY 
		G.SALDOS_JTS_OID,
		PP.C2304,
		PP.C2305,
		G.MONEDA

UNION
---CC DEUDORAS
SELECT 
	CONVERT(DATETIME,G.FECHA,103) AS FECHA_INF,
	
	CASE 
	WHEN G.MONEDA = 1 THEN
		ISNULL(ROUND(SUM(G.SALDO_AJUSTADO),2),0)

	WHEN G.MONEDA = 2 THEN
		
		ISNULL(ROUND(SUM(G.SALDO_AJUSTADO) *
									(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 
											H.MONEDA = 2 AND
											H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
																FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
																WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)))

		,2),0)
	
		ELSE 
		ISNULL(ROUND(SUM(G.SALDO_AJUSTADO)*

		(SELECT H.ARBITRAJE_COMPRA
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 
			H.MONEDA= G.MONEDA AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103))) *

		(SELECT TOP 1 H.TIPO_CAMBIO_OFICIAL
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 
			H.MONEDA = 2  AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)))
		,2),0)
		END AS MONTODEPOSITO, 
	
	(SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=1 AND ID1 = G.MONEDA) AS MONEDA
 
	FROM GRL_SALDOS_DIARIOS G WITH (NOLOCK)
	
	INNER JOIN SALDOS S WITH (NOLOCK) ON 
		G.SALDOS_JTS_OID=S.JTS_OID
		AND G.TZ_LOCK = S.TZ_LOCK
	
	INNER JOIN CLI_CLIENTES C ON 
		S.C1803 = C.CODIGOCLIENTE
		AND S.TZ_LOCK = C.TZ_LOCK
	
	INNER JOIN CLI_ClientePersona CP ON
		C.CODIGOCLIENTE=CP.CODIGOCLIENTE
		AND CP.TZ_LOCK = S.TZ_LOCK
	
	LEFT JOIN CRE_TAM_EMP_BITACORA CTEB ON
		CTEB.CLIENTE=C.CODIGOCLIENTE AND
		CTEB.FECHA=G.FECHA AND
		CTEB.TZ_LOCK=S.TZ_LOCK
	
	LEFT JOIN CLI_PERSONASFISICAS CPF ON
		CP.NUMEROPERSONA=CPF.NUMEROPERSONAFISICA
		AND CP.TZ_LOCK=CPF.TZ_LOCK
	
	LEFT JOIN CLI_PERSONASJURIDICAS CPJ ON
		CP.NUMEROPERSONA=CPJ.NUMEROPERSONAJURIDICA
		AND CP.TZ_LOCK=CPJ.TZ_LOCK
	
	WHERE G.FECHA = CONVERT(DATETIME,?,103) AND 
	S.C1785 = 2 AND 
	S.TZ_LOCK=0 AND 
	C.SUBSEGMENTOCLIENTE =43 AND 
	G.SALDO_AJUSTADO>=0 AND 
	(CPF.SECTOR=1 OR CPJ.SECTOR=1)
	GROUP BY
		G.MONEDA,
		G.FECHA
UNION
--CHEQUES
	SELECT 
	
	CONVERT(DATETIME,?,103) AS FECHA_INF,
	
	CASE 
	WHEN CH.MONEDA = 1 THEN
		ISNULL(ROUND(SUM(CH.IMPORTE),2),0)

	WHEN CH.MONEDA = 2 THEN
		
		ISNULL(ROUND(SUM(CH.IMPORTE) *
									(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 
											H.MONEDA = 2 AND
											H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
																FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
																WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,CH.FECHA_VENCIMIENTO,103)),103)))

		,2),0)
	
		ELSE 
		ISNULL(ROUND(SUM(CH.IMPORTE)*

		(SELECT H.ARBITRAJE_COMPRA
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 
			H.MONEDA= CH.MONEDA AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,CH.FECHA_VENCIMIENTO,103)),103))) *

		(SELECT TOP 1 H.TIPO_CAMBIO_OFICIAL
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 
			H.MONEDA = 2  AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,CH.FECHA_VENCIMIENTO,103)),103)))
		,2),0)
		END AS MONTODEPOSITO,
		
		(SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=1 AND ID1 = CH.MONEDA) AS MONEDA
		
		FROM CHE_CHEQUES CH WITH (NOLOCK) 
	
	INNER JOIN CHE_CHEQUERAS CQ WITH (NOLOCK)ON 
		CH.CUENTA = CQ.CUENTA AND
		CQ.TZ_LOCK = CH.TZ_LOCK
		
	INNER JOIN CLI_CLIENTES CL WITH (NOLOCK) ON 
		CL.CODIGOCLIENTE = CQ.CLIENTE AND
		CL.TZ_LOCK = CH.TZ_LOCK
		
	INNER JOIN CLI_ClientePersona CP WITH (NOLOCK) ON
		CL.CODIGOCLIENTE = CP.CODIGOCLIENTE AND
		CP.TZ_LOCK = CH.TZ_LOCK
		
	LEFT JOIN CRE_TAM_EMP_BITACORA CTEB WITH (NOLOCK) ON
		CTEB.CLIENTE = CL.CODIGOCLIENTE AND
		CTEB.TZ_LOCK = CH.TZ_LOCK
		
	LEFT JOIN CLI_PERSONASFISICAS CPF WITH (NOLOCK) ON
		CP.NUMEROPERSONA = CPF.NUMEROPERSONAFISICA
		AND CP.TZ_LOCK=CPF.TZ_LOCK
		
	LEFT JOIN CLI_PERSONASJURIDICAS CPJ WITH (NOLOCK) ON
		CP.NUMEROPERSONA=CPJ.NUMEROPERSONAJURIDICA
		AND CP.TZ_LOCK=CPJ.TZ_LOCK
	
	WHERE CH.ESTADO='A' AND 
		CH.FECHA_VENCIMIENTO BETWEEN CONVERT (DATETIME,?,103) AND CONVERT(DATETIME,DATEADD(DAY,30,CONVERT(DATETIME,?,103)),103) AND 
		CH.TZ_LOCK=0 AND 
		CL.SUBSEGMENTOCLIENTE=43 AND
		(CPF.SECTOR=1 OR CPJ.SECTOR=1)
	GROUP BY 
	CH.MONEDA,
	CH.FECHA_VENCIMIENTO
UNION ALL
--TARJETAS DE CREDITO

SELECT 
	CONVERT(DATETIME,?,103) AS FECHA_INF,
	
	CASE 
	WHEN S.MONEDA = 1 THEN
		ISNULL(ROUND(SUM(TJCS.PAGO_MIN),2),0)

	WHEN S.MONEDA = 2 THEN
		
		ISNULL(ROUND(SUM(TJCS.PAGO_MIN) *
									(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 
											H.MONEDA = 2 AND
											H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
																FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
																WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,TJCS.FECHA_VTO,103)),103)))

		,2),0)
	
		ELSE 
		ISNULL(ROUND(SUM(TJCS.PAGO_MIN)*

		(SELECT H.ARBITRAJE_COMPRA
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 
			H.MONEDA= S.MONEDA AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,TJCS.FECHA_VTO,103)),103))) *

		(SELECT TOP 1 H.TIPO_CAMBIO_OFICIAL
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 
			H.MONEDA = 2  AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,TJCS.FECHA_VTO,103)),103)))
		,2),0)
		END AS MONTODEPOSITO, 
	
	(SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=1 AND ID1 = S.MONEDA) AS MONEDA

	FROM SALDOS S WITH (NOLOCK)
		
	INNER JOIN CLI_CLIENTES C WITH (NOLOCK) ON 
		S.C1803 = C.CODIGOCLIENTE
		AND C.TZ_LOCK = S.TZ_LOCK
		
	LEFT JOIN CLI_ClientePersona CP WITH (NOLOCK) ON
		C.CODIGOCLIENTE = CP.CODIGOCLIENTE AND
		CP.TZ_LOCK = S.TZ_LOCK
		
	INNER JOIN TJC_MAESTRO_USUARIO TJC WITH (NOLOCK) ON
		TJC.CLIENTE = C.CODIGOCLIENTE AND
		TJC.TZ_LOCK = S.TZ_LOCK
		
	INNER JOIN TJC_Saldos TJCS WITH (NOLOCK) ON
		TJCS.USUARIO = TJC.USUARIO AND
		TJCS.TZ_LOCK = S.TZ_LOCK
		
	LEFT JOIN CRE_TAM_EMP_BITACORA CTEB WITH (NOLOCK) ON
		CTEB.CLIENTE = CP.CODIGOCLIENTE AND
		CTEB.TZ_LOCK = S.TZ_LOCK
		
	LEFT JOIN CLI_PERSONASFISICAS CPF WITH (NOLOCK) ON
		CP.NUMEROPERSONA = CPF.NUMEROPERSONAFISICA
		AND CPF.TZ_LOCK = S.TZ_LOCK
		
	LEFT JOIN CLI_PERSONASJURIDICAS CPJ WITH (NOLOCK) ON
		CP.NUMEROPERSONA = CPJ.NUMEROPERSONAJURIDICA
		AND CPJ.TZ_LOCK = S.TZ_LOCK
		
	WHERE S.TZ_LOCK = 0 AND
		TJC.TIPO_PAGO = '2' AND
		C.SUBSEGMENTOCLIENTE = 43 AND
		(CPF.SECTOR=1 OR CPJ.SECTOR=1) AND
		TJCS.FECHA_VTO BETWEEN CONVERT (DATETIME,?,103) AND CONVERT(DATETIME,DATEADD(DAY,30,CONVERT(DATETIME,?,103)),103)	
	GROUP BY 
	S.MONEDA,
	TJCS.FECHA_VTO</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>480</xloc>
      <yloc>1408</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>351000 3</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT
	CONVERT(DATETIME,?,103) AS FECHA_INFORME,

	'351000' AS CODIGOPART,
	
	? AS MONEDA,
	
	ROUND(ISNULL(?*(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '351000'
				AND TZ_LOCK = 0 
				AND ID2 = ?),0),2) as MONTODEPOSITO,
	
	ISNULL((SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=105 AND CHAR1='351000' AND TZ_LOCK=0),1) AS VALOR,
	
	0 AS SENT,

	ISNULL((SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '351000'
				AND TZ_LOCK = 0 
				AND ID2 = ?),0) AS COEFICIENTE,

	0 AS LCR,

	0 AS IMPORTE_MES1,

	0 AS IMPORTE_MES2,
	
	0 AS IMPORTE_MES3</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONTODEPOSITO</name>
        <type>BigNumber</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>1408</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>352000</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>----PRESTAMOS
SELECT 
	CONVERT(DATETIME,?,103) AS FECHA_INF,
	
	CASE 
	WHEN G.MONEDA = 1 THEN
		ROUND((PP.C2304+PP.C2305),2) 
	
	WHEN G.MONEDA = 2 THEN
		ROUND((PP.C2304+PP.C2305)*
							(SELECT H.TIPO_CAMBIO_OFICIAL
							FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
							WHERE 
									H.MONEDA = 2 AND
									H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
														FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
														WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,?,103)),103)))

		,2) 
		
	ELSE 
		ROUND((PP.C2304+PP.C2305)*

		(SELECT H.ARBITRAJE_COMPRA
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 
			H.MONEDA= G.MONEDA AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,?,103)),103))) * 

		(SELECT TOP 1 H.TIPO_CAMBIO_OFICIAL
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 
			H.MONEDA = 2  AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,?,103)),103)))
		,2)
		END AS MONTODEPOSITO,
		
	(SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=1 AND ID1 = G.MONEDA) AS MONEDA
	
FROM GRL_SALDOS_DIARIOS G WITH (NOLOCK)

	INNER JOIN SALDOS S WITH (NOLOCK) ON 
		G.SALDOS_JTS_OID=S.JTS_OID AND
		G.MONEDA = S.MONEDA
		AND G.TZ_LOCK = S.TZ_LOCK

	INNER JOIN CLI_CLIENTES C ON 
		S.C1803 = C.CODIGOCLIENTE
		AND S.TZ_LOCK = C.TZ_LOCK

	INNER JOIN PLANPAGOS PP ON 
		S.JTS_OID=PP.SALDO_JTS_OID AND
		S.TZ_LOCK=PP.TZ_LOCK

	WHERE PP.C2302 BETWEEN CONVERT (DATETIME,?,103) AND CONVERT(DATETIME,DATEADD(DAY,30,CONVERT(DATETIME,?,103)),103) AND  
	S.C1785 = 5 AND 
	S.TZ_LOCK = 0 AND 
	C.SEGMENTOCLIENTE = 16
	GROUP BY 
		G.FECHA,
		G.MONEDA,
		PP.C2304,
		PP.C2305

UNION
---CC DEUDORAS
SELECT 
	CONVERT(DATETIME,G.FECHA,103) AS FECHA_INF,
	
	CASE 
	WHEN G.MONEDA = 1 THEN
		ISNULL(ROUND(SUM(G.SALDO_AJUSTADO),2),0)

	WHEN G.MONEDA = 2 THEN
		
		ISNULL(ROUND(SUM(G.SALDO_AJUSTADO) *
									(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 
											H.MONEDA = 2 AND
											H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
																FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
																WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)))

		,2),0)
	
		ELSE 
		ISNULL(ROUND(SUM(G.SALDO_AJUSTADO)*

		(SELECT H.ARBITRAJE_COMPRA
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 
			H.MONEDA= G.MONEDA AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103))) *

		(SELECT TOP 1 H.TIPO_CAMBIO_OFICIAL
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 
			H.MONEDA = 2  AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)))
		,2),0)
		END AS MONTODEPOSITO, 
	
	(SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=1 AND ID1 = G.MONEDA) AS MONEDA

	FROM GRL_SALDOS_DIARIOS G WITH (NOLOCK)
	
	INNER JOIN SALDOS S WITH (NOLOCK) ON 
		G.SALDOS_JTS_OID = S.JTS_OID
		AND G.TZ_LOCK = S.TZ_LOCK
	
	INNER JOIN CLI_CLIENTES C ON 
		S.C1803 = C.CODIGOCLIENTE
		AND S.TZ_LOCK = C.TZ_LOCK
	
	WHERE G.FECHA = CONVERT(DATETIME,?,103) AND 
		S.C1785 = 2 AND 
		S.TZ_LOCK = 0 AND 
		G.SALDO_AJUSTADO>=0 AND 
		C.SEGMENTOCLIENTE = 16
	GROUP BY 
		G.FECHA,
		G.MONEDA

UNION
--CHEQUES
	SELECT 
	
	CONVERT(DATETIME,?,103) AS FECHA_INF,
	
	CASE 
	WHEN CH.MONEDA = 1 THEN
		ISNULL(ROUND(SUM(CH.IMPORTE),2),0)

	WHEN CH.MONEDA = 2 THEN
		
		ISNULL(ROUND(SUM(CH.IMPORTE) *
									(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 
											H.MONEDA = 2 AND
											H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
																FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
																WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,CH.FECHA_VENCIMIENTO,103)),103)))

		,2),0)
	
		ELSE 
		ISNULL(ROUND(SUM(CH.IMPORTE)*

		(SELECT H.ARBITRAJE_COMPRA
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 
			H.MONEDA= CH.MONEDA AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,CH.FECHA_VENCIMIENTO,103)),103))) *

		(SELECT TOP 1 H.TIPO_CAMBIO_OFICIAL
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 
			H.MONEDA = 2  AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,CH.FECHA_VENCIMIENTO,103)),103)))
		,2),0)
		END AS MONTODEPOSITO,
		
		(SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=1 AND ID1 = CH.MONEDA) AS MONEDA

	FROM CHE_CHEQUES CH WITH (NOLOCK) 
	
	INNER JOIN CHE_CHEQUERAS CQ WITH (NOLOCK)ON 
		CH.CUENTA = CQ.CUENTA AND
		CQ.TZ_LOCK = CH.TZ_LOCK
		
	INNER JOIN CLI_CLIENTES CL WITH (NOLOCK) ON 
		CL.CODIGOCLIENTE = CQ.CLIENTE AND
		CL.TZ_LOCK = CH.TZ_LOCK
	
	WHERE CH.ESTADO='A' AND 
		CH.FECHA_VENCIMIENTO BETWEEN CONVERT (DATETIME,?,103) AND CONVERT(DATETIME,DATEADD(DAY,30,CONVERT(DATETIME,?,103)),103) AND 
		CH.TZ_LOCK=0 AND 
		CL.SEGMENTOCLIENTE = 16
		
	GROUP BY
	CH.FECHA_VENCIMIENTO,
	CH.MONEDA

UNION ALL
--TARJETAS DE CREDITO

SELECT 
	CONVERT(DATETIME,?,103) AS FECHA_INF,
	
	CASE 
	WHEN S.MONEDA = 1 THEN
		ISNULL(ROUND(SUM(TJCS.PAGO_MIN),2),0)

	WHEN S.MONEDA = 2 THEN
		
		ISNULL(ROUND(SUM(TJCS.PAGO_MIN) *
									(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 
											H.MONEDA = 2 AND
											H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
																FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
																WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,TJCS.FECHA_VTO,103)),103)))

		,2),0)
	
		ELSE 
		ISNULL(ROUND(SUM(TJCS.PAGO_MIN)*

		(SELECT H.ARBITRAJE_COMPRA
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 
			H.MONEDA= S.MONEDA AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,TJCS.FECHA_VTO,103)),103))) *

		(SELECT TOP 1 H.TIPO_CAMBIO_OFICIAL
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 
			H.MONEDA = 2  AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,TJCS.FECHA_VTO,103)),103)))
		,2),0)
		END AS MONTODEPOSITO, 
	
	(SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=1 AND ID1 = S.MONEDA) AS MONEDA

	FROM SALDOS S WITH (NOLOCK)
		
	INNER JOIN CLI_CLIENTES C WITH (NOLOCK) ON 
		S.C1803 = C.CODIGOCLIENTE
		AND C.TZ_LOCK = S.TZ_LOCK
		
	INNER JOIN TJC_MAESTRO_USUARIO TJC WITH (NOLOCK) ON
		TJC.CLIENTE = C.CODIGOCLIENTE AND
		TJC.TZ_LOCK = S.TZ_LOCK
		
	INNER JOIN TJC_Saldos TJCS WITH (NOLOCK) ON
		TJCS.USUARIO = TJC.USUARIO AND
		TJCS.TZ_LOCK = S.TZ_LOCK
		
	WHERE S.TZ_LOCK = 0 AND
		TJC.TIPO_PAGO = '2' AND 
		C.SEGMENTOCLIENTE = 16 AND
		TJCS.FECHA_VTO BETWEEN CONVERT (DATETIME,?,103) AND CONVERT(DATETIME,DATEADD(DAY,30,CONVERT(DATETIME,?,103)),103)	
GROUP BY
	S.MONEDA,
	TJCS.FECHA_VTO</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>464</xloc>
      <yloc>1504</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>352000 2</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT
	CONVERT(DATETIME,?,103) AS FECHA_INFORME,

	'351000' AS CODIGOPART,
	
	? AS MONEDA,
	
	ROUND(ISNULL(?*(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '351000'
				AND TZ_LOCK = 0 
				AND ID2 = ?),0),2) as MONTODEPOSITO,
	
	ISNULL((SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=105 AND CHAR1='351000' AND TZ_LOCK=0),1) AS VALOR,
	
	0 AS SENT,

	ISNULL((SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = '351000'
				AND TZ_LOCK = 0 
				AND ID2 = ?),0) AS COEFICIENTE,

	0 AS LCR,

	0 AS IMPORTE_MES1,

	0 AS IMPORTE_MES2,
	
	0 AS IMPORTE_MES3</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONTODEPOSITO</name>
        <type>BigNumber</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
      <field>
        <name>MONEDA</name>
        <type>Integer</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>1504</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Campos para insertar</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>CODIGO_ERROR</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif>167</nullif>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>NOMBRE_REPORTE</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif>RRII_MEDICION_LCR</nullif>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>DESCRIPCION_ERROR</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif>La fecha ingresada es mayor a la fecha actual</nullif>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>FECHA_REPORTE</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>MENSAJE_EXTRA</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif>-</nullif>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>NOMBRE_ERROR</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif>La fecha ingresada es mayor a la fecha actual</nullif>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Data grid</name>
    <type>DataGrid</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
    </fields>
    <data>
      <line>  </line>
    </data>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1936</xloc>
      <yloc>128</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Database join</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT 
	CONVERT (DATETIME,?,103) AS FECHA_INFORME,
	CODIGOPARTIDA AS CODIGOPART ,
	FALAC_EET AS SDO_FALAC,
	"SET",
	LCR,
	CAST(VALOR AS NUMERIC) AS VALOR,
	COEFICIENTE,
	IMPORTE_MES1,
	IMPORTE_MES2,
	IMPORTE_MES3,
	MONEDA

	FROM RRII_MEDICION_LCR WITH(NOLOCK)
	WHERE TZ_LOCK=0 AND 
		FECHA_INFORME=(SELECT MAX(FECHA_INFORME) FROM RRII_MEDICION_LCR WHERE FECHA_INFORME&lt;CONVERT(DATETIME,?))</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1184</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Date Sys</name>
    <type>SystemInfo</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>fechaActual</name>
        <type>system date (variable)</type>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Error fecha</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>x</send_true_to>
    <send_false_to>Campos para insertar</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>fechaP</leftvalue>
        <function>&lt;=</function>
        <rightvalue>fechaActual</rightvalue>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Estable 221210</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>Prep Val 221210</send_true_to>
    <send_false_to>x 8</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>FILTRO</leftvalue>
        <function>&lt;</function>
        <rightvalue/>
        <value>
          <name>constant</name>
          <type>BigNumber</type>
          <text>0.0</text>
          <length>-1</length>
          <precision>-1</precision>
          <isnull>N</isnull>
          <mask>######0.0###################;-######0.0###################</mask>
        </value>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>896</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>FALAC/CodPartida</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>CODIGOPART</name>
      </field>
      <field>
        <name>MONEDA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>FECHA_INFORME</aggregate>
        <subject>FECHA_INF</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>CODIGOPARTIDA</aggregate>
        <subject>CODIGOPART</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SDO_FALAC</aggregate>
        <subject>SDO_FALAC</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>VALOR</aggregate>
        <subject>VALOR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SENT</aggregate>
        <subject>SENTT</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>COEFICIENTE</aggregate>
        <subject>COEFICIENTE</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>LCR</aggregate>
        <subject>LCR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES1</aggregate>
        <subject>IMPORTE_MES1</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES2</aggregate>
        <subject>IMPORTE_MES2</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES3</aggregate>
        <subject>IMPORTE_MES3</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1360</xloc>
      <yloc>1680</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>FALAC/CodPartida 351000</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>CODIGOPART</name>
      </field>
      <field>
        <name>MONEDA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>FECHA_INFORME</aggregate>
        <subject>FECHA_INFORME</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>CODIGOPARTIDA</aggregate>
        <subject>CODIGOPART</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SDO_FALAC</aggregate>
        <subject>SDO_FALAC</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>VALOR</aggregate>
        <subject>VALOR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SENT</aggregate>
        <subject>SENT</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>COEFICIENTE</aggregate>
        <subject>COEFICIENTE</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>LCR</aggregate>
        <subject>LCR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES1</aggregate>
        <subject>IMPORTE_MES1</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES2</aggregate>
        <subject>IMPORTE_MES2</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES3</aggregate>
        <subject>IMPORTE_MES3</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1360</xloc>
      <yloc>1408</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>FALAC/CodPartida 352000</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>CODIGOPART</name>
      </field>
      <field>
        <name>MONEDA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>FECHA_INFORME</aggregate>
        <subject>FECHA_INFORME</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>CODIGOPARTIDA</aggregate>
        <subject>CODIGOPART</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SDO_FALAC</aggregate>
        <subject>SDO_FALAC</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>VALOR</aggregate>
        <subject>VALOR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SENT</aggregate>
        <subject>SENT</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>COEFICIENTE</aggregate>
        <subject>COEFICIENTE</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>LCR</aggregate>
        <subject>LCR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES1</aggregate>
        <subject>IMPORTE_MES1</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES2</aggregate>
        <subject>IMPORTE_MES2</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES3</aggregate>
        <subject>IMPORTE_MES3</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1360</xloc>
      <yloc>1504</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>FALAC/SENT</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>Prep Val FALAC</send_true_to>
    <send_false_to>Prep Val SET</send_false_to>
    <compare>
      <condition>
        <negated>Y</negated>
        <leftvalue>FALAC_SENT</leftvalue>
        <function>=</function>
        <rightvalue/>
        <value>
          <name>constant</name>
          <type>String</type>
          <text>SENT</text>
          <length>-1</length>
          <precision>-1</precision>
          <isnull>N</isnull>
          <mask/>
        </value>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>704</xloc>
      <yloc>1680</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>FDO_GTIA</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT
	? AS PERSONA,
	CASE WHEN ?=0 THEN
		(SELECT 
			(SELECT (MONTO_MAX)
			FROM TASASFONDOGARANTIA 
			WHERE TIPOPRODUCTO  = 1 
				AND TZ_LOCK = 0 
				AND FECHA_VIGENCIA = (SELECT MAX(TF.FECHA_VIGENCIA) 
										FROM TASASFONDOGARANTIA TF 
										WHERE TF.FECHA_VIGENCIA &lt;= CONVERT(DATETIME,?,103)
											AND TF.TZ_LOCK = 0
											AND TF.TIPOPRODUCTO = 1))-?) 

		ELSE
			(SELECT (SELECT MONTO_MAX 
			FROM TASASFONDOGARANTIA 
			WHERE TIPOPRODUCTO  = 2 
				AND TZ_LOCK = 0 
				AND FECHA_VIGENCIA = (SELECT MAX(TF.FECHA_VIGENCIA) 
									FROM TASASFONDOGARANTIA TF 
									WHERE TF.FECHA_VIGENCIA &lt;= CONVERT(DATETIME,?,103)
									AND TF.TZ_LOCK = 0
									AND TF.TIPOPRODUCTO = 2))-?) 
		END FILTRO</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>PERS</name>
        <type>Integer</type>
      </field>
      <field>
        <name>PERS</name>
        <type>Integer</type>
      </field>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>MONTO_TOTAL</name>
        <type>BigNumber</type>
      </field>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>MONTO_TOTAL</name>
        <type>Number</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>FILTRO ESTABLE</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>Prep Val 212100</send_true_to>
    <send_false_to>x 10</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <conditions>
          <condition>
            <negated>N</negated>
            <leftvalue>FILTRO</leftvalue>
            <function>&lt;</function>
            <rightvalue/>
            <value>
              <name>constant</name>
              <type>BigNumber</type>
              <text>0.0</text>
              <length>-1</length>
              <precision>-1</precision>
              <isnull>N</isnull>
              <mask>######0.0###################;-######0.0###################</mask>
            </value>
          </condition>
        </conditions>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>656</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Feriados</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>CODIGOPART</name>
      </field>
      <field>
        <name>MONEDA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>FECHA_INFORME</aggregate>
        <subject>FECHA_INFORME</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>CODIGOPARTIDA</aggregate>
        <subject>CODIGOPART</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SDO_FALAC</aggregate>
        <subject>SDO_FALAC</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>VALOR</aggregate>
        <subject>VALOR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SENT</aggregate>
        <subject>SET</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>COEFICIENTE</aggregate>
        <subject>COEFICIENTE</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>LCR</aggregate>
        <subject>LCR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES1</aggregate>
        <subject>IMPORTE_MES1</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES2</aggregate>
        <subject>IMPORTE_MES2</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES3</aggregate>
        <subject>IMPORTE_MES3</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1360</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Filter rows</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>Database join</send_true_to>
    <send_false_to>Date Sys</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>feriado</leftvalue>
        <function>=</function>
        <rightvalue/>
        <value>
          <name>constant</name>
          <type>Integer</type>
          <text>1</text>
          <length>-1</length>
          <precision>0</precision>
          <isnull>N</isnull>
          <mask>####0;-####0</mask>
        </value>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Filtro Fdo_gtia</name>
    <type>DBJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT
	? AS PERSONA, 
			((SELECT (MONTO_MAX)
			FROM TASASFONDOGARANTIA 
			WHERE TIPOPRODUCTO  = 1 
				AND TZ_LOCK = 0 
				AND FECHA_VIGENCIA = (SELECT MAX(TF.FECHA_VIGENCIA) 
										FROM TASASFONDOGARANTIA TF 
										WHERE TF.FECHA_VIGENCIA &lt;= CONVERT(DATETIME,?,103)
											AND TF.TZ_LOCK = 0
											AND TF.TIPOPRODUCTO = 1))-?) AS FILTRO</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>PERS</name>
        <type>Integer</type>
      </field>
      <field>
        <name>FECHA_INF</name>
        <type>Date</type>
      </field>
      <field>
        <name>MONTO_TOTAL</name>
        <type>BigNumber</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>912</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Insert / update</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <commit>10000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema>dbo</schema>
      <table>RRII_MEDICION_LCR</table>
      <key>
        <name>CODIGOPART</name>
        <field>CODIGOPARTIDA</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>MONEDA</name>
        <field>MONEDA</field>
        <condition>=</condition>
        <name2/>
      </key>
      <key>
        <name>FECHA_INFORME</name>
        <field>FECHA_INFORME</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>MONEDA</name>
        <rename>MONEDA</rename>
        <update>Y</update>
      </value>
      <value>
        <name>FECHA_INFORME</name>
        <rename>FECHA_INFORME</rename>
        <update>Y</update>
      </value>
      <value>
        <name>CODIGOPARTIDA</name>
        <rename>CODIGOPARTIDA</rename>
        <update>Y</update>
      </value>
      <value>
        <name>FALAC_EET</name>
        <rename>SDO_FALAC</rename>
        <update>Y</update>
      </value>
      <value>
        <name>VALOR</name>
        <rename>VALOR</rename>
        <update>Y</update>
      </value>
      <value>
        <name>SET</name>
        <rename>SENT</rename>
        <update>Y</update>
      </value>
      <value>
        <name>COEFICIENTE</name>
        <rename>COEFICIENTE</rename>
        <update>Y</update>
      </value>
      <value>
        <name>LCR</name>
        <rename>LCR</rename>
        <update>Y</update>
      </value>
      <value>
        <name>IMPORTE_MES1</name>
        <rename>IMPORTE_MES1</rename>
        <update>Y</update>
      </value>
      <value>
        <name>IMPORTE_MES2</name>
        <rename>IMPORTE_MES2</rename>
        <update>Y</update>
      </value>
      <value>
        <name>IMPORTE_MES3</name>
        <rename>IMPORTE_MES3</rename>
        <update>Y</update>
      </value>
    </lookup>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2064</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>KTR</name>
    <type>TransExecutor</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <specification_method>filename</specification_method>
    <trans_object_id/>
    <trans_name/>
    <filename>${Top.Repository}RRII_ERRORES_VALIDACIONES.ktr</filename>
    <directory_path/>
    <group_size>1</group_size>
    <group_field/>
    <group_time/>
    <parameters>
      <inherit_all_vars>Y</inherit_all_vars>
    </parameters>
    <execution_result_target_step/>
    <execution_time_field>ExecutionTime</execution_time_field>
    <execution_result_field>ExecutionResult</execution_result_field>
    <execution_errors_field>ExecutionNrErrors</execution_errors_field>
    <execution_lines_read_field>ExecutionLinesRead</execution_lines_read_field>
    <execution_lines_written_field>ExecutionLinesWritten</execution_lines_written_field>
    <execution_lines_input_field>ExecutionLinesInput</execution_lines_input_field>
    <execution_lines_output_field>ExecutionLinesOutput</execution_lines_output_field>
    <execution_lines_rejected_field>ExecutionLinesRejected</execution_lines_rejected_field>
    <execution_lines_updated_field>ExecutionLinesUpdated</execution_lines_updated_field>
    <execution_lines_deleted_field>ExecutionLinesDeleted</execution_lines_deleted_field>
    <execution_files_retrieved_field>ExecutionFilesRetrieved</execution_files_retrieved_field>
    <execution_exit_status_field>ExecutionExitStatus</execution_exit_status_field>
    <execution_log_text_field>ExecutionLogText</execution_log_text_field>
    <execution_log_channelid_field>ExecutionLogChannelId</execution_log_channelid_field>
    <result_rows_target_step/>
    <result_files_target_step/>
    <result_files_file_name_field>FileName</result_files_file_name_field>
    <executors_output_step/>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>752</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Leer fechaP</name>
    <type>GetVariable</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>fechaP</name>
        <variable>${fecha}</variable>
        <type>Date</type>
        <format>dd/MM/yyyy</format>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1936</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Minoristas/x</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>Prep Val 211000 2</send_true_to>
    <send_false_to>x 3</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>MONTO_TOTAL</leftvalue>
        <function>&lt;=</function>
        <rightvalue>MINORISTA</rightvalue>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>384</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Minoristas/x 4</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>Prep Val 221000</send_true_to>
    <send_false_to>x 4</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>MONTO_TOTAL</leftvalue>
        <function>&lt;=</function>
        <rightvalue>MINORISTA</rightvalue>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>656</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Minoristas/x 5</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>Prep Val 221100/221210</send_true_to>
    <send_false_to>x 5</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>MONTO_TOTAL</leftvalue>
        <function>&lt;=</function>
        <rightvalue>MINORISTA</rightvalue>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>672</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Moneda/SET 221210</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>CODIGOPART</name>
      </field>
      <field>
        <name>MONEDA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>FECHA_INFORME</aggregate>
        <subject>FECHA_INFORME</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>CODIGOPARTIDA</aggregate>
        <subject>CODIGOPART</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SDO_FALAC</aggregate>
        <subject>SDO_FALAC</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>VALOR</aggregate>
        <subject>VALOR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SENT</aggregate>
        <subject>SENT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>COEFICIENTE</aggregate>
        <subject>COEFICIENTE</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>LCR</aggregate>
        <subject>LCR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES1</aggregate>
        <subject>IMPORTE_MES1</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES2</aggregate>
        <subject>IMPORTE_MES2</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES3</aggregate>
        <subject>IMPORTE_MES3</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1376</xloc>
      <yloc>896</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>PARTIDAS PARAMETRIZADAS</name>
    <type>DBJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>--FALAC/SENT

SELECT 
	CONVERT(DATETIME,G.FECHA,103) AS FECHA_INF,

	R.CHAR1 AS CODIGOPART,

	R.CHAR2 AS FALAC_SENT,

	(SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=1 AND ID1 = G.MONEDA) AS MON,
	
	CASE WHEN G.MONEDA = (SELECT MONNAC FROM PARAMETROS WITH (NOLOCK)) THEN 
	
		ISNULL(ROUND(SUM(G.SALDO_AJUSTADO) * (SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
															WHERE CODIGO = 106 
																AND ID4 = R.CHAR1
																AND TZ_LOCK = 0 
																AND ID2 = (SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
																					WHERE CODIGO = 1 
																						AND ID1 = G.MONEDA))
,2),1) 
	
		WHEN G.MONEDA = 2 THEN
		
		ISNULL(ROUND(SUM(G.SALDO_AJUSTADO) *
									(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 	H.TZ_LOCK = 0 AND
									H.MONEDA = 2 AND
									H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
															FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
															WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)
																AND HTC.MONEDA = G.MONEDA
																AND HTC.TZ_LOCK = H.TZ_LOCK)) *
																								(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
																									WHERE CODIGO = 106 
																										AND ID4 = R.CHAR1
																										AND TZ_LOCK = 0 
																										AND ID2 = (SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=1 AND ID1 = G.MONEDA))

		,2),1)
	
	WHEN G.MONEDA = 988 THEN 

		ISNULL(ROUND(SUM(G.SALDO_AJUSTADO) *
									(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 	H.TZ_LOCK = 0 AND 
											H.MONEDA = 988 AND
											H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
																FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK) 
																WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)
																	AND HTC.MONEDA = H.MONEDA
																	AND HTC.TZ_LOCK = H.TZ_LOCK)) *
																									(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
																									WHERE CODIGO = 106 
																										AND ID4 = R.CHAR1
																										AND TZ_LOCK = 0 
																										AND ID2 = (SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=1 AND ID1 = G.MONEDA))

		,2),1)
	
	WHEN G.MONEDA = 999 THEN 

		ISNULL(ROUND(SUM(G.SALDO_AJUSTADO) *
									(SELECT H.TIPO_CAMBIO_OFICIAL
									FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
									WHERE 	H.TZ_LOCK = 0 AND
											H.MONEDA = 999 AND
											H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
																FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK) 
																WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)
																	AND HTC.MONEDA = H.MONEDA
																	AND HTC.TZ_LOCK = H.TZ_LOCK)) *
																									(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
																									WHERE CODIGO = 106 
																										AND ID4 = R.CHAR1
																										AND TZ_LOCK = 0 
																										AND ID2 = (SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=1 AND ID1 = G.MONEDA))

		,2),1)
		
				
	ELSE
		ISNULL(ROUND(SUM(G.SALDO_AJUSTADO)*

		(SELECT H.ARBITRAJE_COMPRA
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE 	H.TZ_LOCK = 0 AND
				H.MONEDA= G.MONEDA AND
				H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
									FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
									WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)
									AND HTC.MONEDA = H.MONEDA
									AND HTC.TZ_LOCK = H.TZ_LOCK)) *

		(SELECT TOP 1 H.TIPO_CAMBIO_OFICIAL
		FROM HISTORICOTIPOSCAMBIO H WITH (NOLOCK)
		WHERE	H.TZ_LOCK = 0 AND
			H.MONEDA = 2  AND
			H.FECHA_COTIZACION = (SELECT MAX(HTC.FECHA_COTIZACION) 
								FROM HISTORICOTIPOSCAMBIO HTC WITH (NOLOCK)
								WHERE HTC.FECHA_COTIZACION &lt;= CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,G.FECHA,103)),103)
									AND HTC.MONEDA = H.MONEDA
									AND HTC.TZ_LOCK = H.TZ_LOCK)) *
																	(SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
																									WHERE CODIGO = 106 
																										AND ID4 = R.CHAR1
																										AND TZ_LOCK = 0 
																										AND ID2 = (SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=1 AND ID1 = G.MONEDA))
											
		,2),1)


	END AS MONTODEPOSITO,
	
	ISNULL(R.NUM1,1) AS VALOR,

	ISNULL((SELECT NUM1/100 FROM RRI_PARAMETROS_INF WITH (NOLOCK) 
			WHERE CODIGO = 106 
				AND ID4 = R.CHAR1 
				AND TZ_LOCK = R.TZ_LOCK 
				AND ID2 = (SELECT NUM1 FROM RRI_PARAMETROS_INF WITH (NOLOCK) WHERE CODIGO=1 AND ID1 = G.MONEDA)),1) AS COEFICIENTE,

	0 AS LCR,

	0 AS SDO_FALACC,

	0 AS SENTT,

	0 AS IMPORTE_MES1,

	0 AS IMPORTE_MES2,
	
	0 AS IMPORTE_MES3
	
	FROM GRL_SALDOS_DIARIOS G WITH (NOLOCK)
	INNER JOIN RRI_PARAMETROS_INF R WITH (NOLOCK)
	  	ON LEFT(G.RUBROCONTABLE,6) = R.ID1
		AND G.TZ_LOCK = R.TZ_LOCK
	WHERE R.CODIGO = 105
	AND G.FECHA = CONVERT(DATETIME,?,103)
	AND G.TZ_LOCK = 0
	AND LEFT(G.RUBROCONTABLE,6) IN (SELECT R.ID1 FROM RRI_PARAMETROS_INF R WITH (NOLOCK) WHERE CODIGO=105)
	GROUP BY 
		G.MONEDA,
		R.CHAR1,
		G.FECHA,
		R.CHAR2,
		R.TZ_LOCK,
		R.NUM1</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>400</xloc>
      <yloc>1680</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Pers/Dep</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>PERSONA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>MONTO_TOTAL</aggregate>
        <subject>MONTODEPOSITO</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>MONEDA</aggregate>
        <subject>MONEDA</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>FECHA_INF</aggregate>
        <subject>FECHA_INF</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>MINORISTA</aggregate>
        <subject>MINORISTA</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>FECHAP</aggregate>
        <subject>fechaP</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>320</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Pers/Dep 221000</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>PERSONA</name>
      </field>
      <field>
        <name>MONEDA</name>
      </field>
      <field>
        <name>PRODUCTO</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>MONTO_TOTAL</aggregate>
        <subject>MONTODEPOSITO</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>FECHA_INF</aggregate>
        <subject>FECHA_INF</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>MINORISTA</aggregate>
        <subject>MINORISTA</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>FECHAP</aggregate>
        <subject>fechaP</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>560</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Pers/Dep 221100</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>PERSONA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>MONTO_TOTAL</aggregate>
        <subject>MONTODEPOSITO</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>FECHA_INF</aggregate>
        <subject>FECHA_INF</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>MINORISTA</aggregate>
        <subject>MINORISTA</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>FECHAP</aggregate>
        <subject>fechaP</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>MONEDA</aggregate>
        <subject>MONEDA</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Pers/Dep 221210</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>PERSONA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>MONTO_TOTAL</aggregate>
        <subject>MONTODEPOSITO</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>FECHA_INF</aggregate>
        <subject>FECHA_INF</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>MINORISTA</aggregate>
        <subject>MINORISTA</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>FECHAP</aggregate>
        <subject>fechaP</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>MONEDA</aggregate>
        <subject>MONEDA</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>560</xloc>
      <yloc>1056</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Pers/Dep 221220</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>PERSONA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>MONTO_TOTAL</aggregate>
        <subject>MONTODEPOSITO</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>FECHA_INF</aggregate>
        <subject>FECHA_INF</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>FECHAP</aggregate>
        <subject>fechaP</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>MONEDA</aggregate>
        <subject>MONEDA</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>656</xloc>
      <yloc>1184</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Pers/Dep 221230</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>PERSONA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>MONTO_TOTAL</aggregate>
        <subject>MONTODEPOSITO</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>FECHA_INF</aggregate>
        <subject>FECHA_INF</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>MONEDA</aggregate>
        <subject>MONEDA</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>656</xloc>
      <yloc>1296</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Pers/Dep/Moneda</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>PERSONA</name>
      </field>
      <field>
        <name>MONEDA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>MONTO_TOTAL</aggregate>
        <subject>MONTODEPOSITO</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>FECHA_INF</aggregate>
        <subject>FECHA_INF</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>PARAMETRO</aggregate>
        <subject>PARAMETRO</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prep Val</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>FECHA_INF</name>
        <rename>FECHA_INF</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>CODIGOPART</name>
        <rename>CODIGOPART</rename>
        <type>String</type>
        <length>20</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MON</name>
        <rename>MON</rename>
        <type>Integer</type>
        <length>5</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONTODEPOSITO</name>
        <rename>MONTODEPOSITO</rename>
        <type>BigNumber</type>
        <length>20</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>544</xloc>
      <yloc>1680</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prep Val 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>FECHA_INF</name>
        <rename>FECHA_INF</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONEDA</name>
        <rename>MONEDA</rename>
        <type>Integer</type>
        <length>5</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONTODEPOSITO</name>
        <rename>MONTODEPOSITO</rename>
        <type>BigNumber</type>
        <length>20</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>656</xloc>
      <yloc>1408</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prep Val 2 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>FECHA_INF</name>
        <rename>FECHA_INF</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONEDA</name>
        <rename>MONEDA</rename>
        <type>Integer</type>
        <length>5</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONTODEPOSITO</name>
        <rename>MONTODEPOSITO</rename>
        <type>BigNumber</type>
        <length>20</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>656</xloc>
      <yloc>1504</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prep Val 211000</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>PERSONA</name>
        <rename>PERSONA</rename>
        <type>Integer</type>
        <length>12</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONTO_TOTAL</name>
        <rename>MONTO_TOTAL</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONEDA</name>
        <rename>MONNAC</rename>
        <type>Integer</type>
        <length>3</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FECHA_INF</name>
        <rename>FECHA_INF</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>800</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prep Val 211000 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>PERSONA</name>
        <rename>PERS</rename>
        <type>Integer</type>
        <length>12</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONTO_TOTAL</name>
        <rename>MONTO_TOTAL</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONEDA</name>
        <rename>MONEDA</rename>
        <type>Integer</type>
        <length>5</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FECHA_INF</name>
        <rename>FECHA_INF</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MINORISTA</name>
        <rename>MINORISTA</rename>
        <type>Number</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FECHAP</name>
        <rename>FECHAP</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>480</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prep Val 212100</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>PERSONA</name>
        <rename>PERSONA</rename>
        <type>Integer</type>
        <length>12</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FILTRO</name>
        <rename>DIFERENCIA</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONEDA</name>
        <rename>MONNAC</rename>
        <type>Integer</type>
        <length>5</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FECHA_INF</name>
        <rename>FECHA_INF</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>800</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prep Val 221000</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>PERSONA</name>
        <rename>PERS</rename>
        <type>Integer</type>
        <length>12</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONTO_TOTAL</name>
        <rename>MONTO_TOTAL</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONEDA</name>
        <rename>MONEDA</rename>
        <type>Integer</type>
        <length>5</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FECHA_INF</name>
        <rename>FECHA_INF</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>784</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prep Val 221100</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>PERSONA</name>
        <rename>PERS</rename>
        <type>Integer</type>
        <length>12</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FILTRO</name>
        <rename>MONTO_TOTAL</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONEDA</name>
        <rename>MONEDA</rename>
        <type>Integer</type>
        <length>5</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FECHA_INF</name>
        <rename>FECHA_INF</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1088</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prep Val 221100/221210</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>PERSONA</name>
        <rename>PERS</rename>
        <type>Integer</type>
        <length>12</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONTO_TOTAL</name>
        <rename>MONTO_TOTAL</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONEDA</name>
        <rename>MONEDA</rename>
        <type>Integer</type>
        <length>5</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FECHA_INF</name>
        <rename>FECHA_INF</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MINORISTA</name>
        <rename>MINORISTA</rename>
        <type>Number</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FECHAP</name>
        <rename>FECHAP</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>784</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prep Val 221210</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>PERSONA</name>
        <rename>PERSONA</rename>
        <type>Integer</type>
        <length>12</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FILTRO</name>
        <rename>DIFERENCIA</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONEDA</name>
        <rename>MONNAC</rename>
        <type>Integer</type>
        <length>5</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FECHA_INF</name>
        <rename>FECHA_INF</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1088</xloc>
      <yloc>896</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prep Val 221210 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>PERSONA</name>
        <rename>PERSONA</rename>
        <type>Integer</type>
        <length>12</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONTO_TOTAL</name>
        <rename>MONTO_TOTAL</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONEDA</name>
        <rename>MONEDA</rename>
        <type>Integer</type>
        <length>5</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FECHA_INF</name>
        <rename>FECHA_INF</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>1056</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prep Val 221220</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>PERSONA</name>
        <rename>PERSONA</rename>
        <type>Integer</type>
        <length>12</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONTO_TOTAL</name>
        <rename>MONTO_TOTAL</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONEDA</name>
        <rename>MONEDA</rename>
        <type>Integer</type>
        <length>5</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FECHA_INF</name>
        <rename>FECHA_INF</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>1184</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prep Val 221230</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>PERSONA</name>
        <rename>PERSONA</rename>
        <type>Integer</type>
        <length>12</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONTO_TOTAL</name>
        <rename>MONTO_TOTAL</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONEDA</name>
        <rename>MON</rename>
        <type>Integer</type>
        <length>5</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FECHA_INF</name>
        <rename>FECHA_INF</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>1296</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prep Val 351000</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>MONTODEPOSITO_1</name>
        <rename>SDO_FALAC</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONEDA_1</name>
        <rename>MON</rename>
        <type>Integer</type>
        <length>5</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FECHA_INFORME</name>
        <rename>FECHA_INFORME</rename>
        <type>Timestamp</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>SENT</name>
        <rename>SENT</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>1408</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prep Val 352000</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>MONTODEPOSITO_1</name>
        <rename>SDO_FALAC</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONEDA_1</name>
        <rename>MON</rename>
        <type>Integer</type>
        <length>5</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FECHA_INFORME</name>
        <rename>FECHA_INFORME</rename>
        <type>Timestamp</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>SENT</name>
        <rename>SENT</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>1504</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prep Val FALAC</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>MONTODEPOSITO</name>
        <rename>SDO_FALAC</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MON</name>
        <rename>MONEDA</rename>
        <type>Integer</type>
        <length>5</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>CODIGOPART</name>
        <rename>CODIGOPART</rename>
        <type>String</type>
        <length>12</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FECHA_INF</name>
        <rename>FECHA_INF</rename>
        <type>Timestamp</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>SENTT</name>
        <rename>SENTT</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>864</xloc>
      <yloc>1680</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prep Val SET</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>MONTODEPOSITO</name>
        <rename>SENTT</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MON</name>
        <rename>MONEDA</rename>
        <type>Integer</type>
        <length>5</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>CODIGOPART</name>
        <rename>CODIGOPART</rename>
        <type>String</type>
        <length>12</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>FECHA_INF</name>
        <rename>FECHA_INF</rename>
        <type>Timestamp</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>SDO_FALACC</name>
        <rename>SDO_FALAC</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>704</xloc>
      <yloc>1792</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prep val 212300</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>PERSONA</name>
        <rename>PERSONA</rename>
        <type>Integer</type>
        <length>10</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONTO_TOTAL</name>
        <rename>MONTO_TOTAL</rename>
        <type>Integer</type>
        <length>10</length>
        <precision>2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>MONEDA</name>
        <rename>MON</rename>
        <type>Integer</type>
        <length>3</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>PARAMETRO</name>
        <rename>PARAMETRO</rename>
        <type>Integer</type>
        <length>10</length>
        <precision>2</precision>
        <conversion_mask>0.00</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>800</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>RRII_ERRORES_VALIDACIONES</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <schema>dbo</schema>
    <table>RRII_ERRORES_VALIDACIONES</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>CODIGO_ERROR</column_name>
        <stream_name>CODIGO_ERROR</stream_name>
      </field>
      <field>
        <column_name>NOMBRE_REPORTE</column_name>
        <stream_name>NOMBRE_REPORTE</stream_name>
      </field>
      <field>
        <column_name>DESCRIPCION_ERROR</column_name>
        <stream_name>DESCRIPCION_ERROR</stream_name>
      </field>
      <field>
        <column_name>FECHA_REPORTE</column_name>
        <stream_name>fechaActual</stream_name>
      </field>
      <field>
        <column_name>NOMBRE_ERROR</column_name>
        <stream_name>NOMBRE_ERROR</stream_name>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>656</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>SET/CodPartida 211000</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>CODIGOPART</name>
      </field>
      <field>
        <name>MONEDA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>FECHA_INFORME</aggregate>
        <subject>FECHA_INFORME</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>CODIGOPARTIDA</aggregate>
        <subject>CODIGOPART</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SDO_FALAC</aggregate>
        <subject>SDO_FALAC</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>VALOR</aggregate>
        <subject>VALOR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SENT</aggregate>
        <subject>SENT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>COEFICIENTE</aggregate>
        <subject>COEFICIENTE</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>LCR</aggregate>
        <subject>LCR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES1</aggregate>
        <subject>IMPORTE_MES1</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES2</aggregate>
        <subject>IMPORTE_MES2</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES3</aggregate>
        <subject>IMPORTE_MES3</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1360</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>SET/CodPartida 212100</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>CODIGOPART</name>
      </field>
      <field>
        <name>MONEDA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>FECHA_INFORME</aggregate>
        <subject>FECHA_INFORME</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>CODIGOPARTIDA</aggregate>
        <subject>CODIGOPART</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SDO_FALAC</aggregate>
        <subject>SDO_FALAC</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>VALOR</aggregate>
        <subject>VALOR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SENT</aggregate>
        <subject>SENT</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>COEFICIENTE</aggregate>
        <subject>COEFICIENTE</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>LCR</aggregate>
        <subject>LCR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES1</aggregate>
        <subject>IMPORTE_MES1</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES2</aggregate>
        <subject>IMPORTE_MES2</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES3</aggregate>
        <subject>IMPORTE_MES3</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1360</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>SET/CodPartida 212300</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>CODIGOPART</name>
      </field>
      <field>
        <name>MONEDA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>FECHA_INFORME</aggregate>
        <subject>FECHA_INFORME</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>CODIGOPARTIDA</aggregate>
        <subject>CODIGOPART</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SDO_FALAC</aggregate>
        <subject>SDO_FALAC</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>VALOR</aggregate>
        <subject>VALOR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SENT</aggregate>
        <subject>SENT</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>COEFICIENTE</aggregate>
        <subject>COEFICIENTE</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>LCR</aggregate>
        <subject>LCR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES1</aggregate>
        <subject>IMPORTE_MES1</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES2</aggregate>
        <subject>IMPORTE_MES2</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES3</aggregate>
        <subject>IMPORTE_MES3</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1360</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>SET/CodPartida 221000</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>CODIGOPART</name>
      </field>
      <field>
        <name>MONEDA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>FECHA_INFORME</aggregate>
        <subject>FECHA_INFORME</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>CODIGOPARTIDA</aggregate>
        <subject>CODIGOPART</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SDO_FALAC</aggregate>
        <subject>SDO_FALAC</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>VALOR</aggregate>
        <subject>VALOR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SENT</aggregate>
        <subject>SENT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>COEFICIENTE</aggregate>
        <subject>COEFICIENTE</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>LCR</aggregate>
        <subject>LCR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES1</aggregate>
        <subject>IMPORTE_MES1</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES2</aggregate>
        <subject>IMPORTE_MES2</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES3</aggregate>
        <subject>IMPORTE_MES3</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1376</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>SET/CodPartida 221100</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>CODIGOPART</name>
      </field>
      <field>
        <name>MONEDA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>FECHA_INFORME</aggregate>
        <subject>FECHA_INFORME</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>CODIGOPARTIDA</aggregate>
        <subject>CODIGOPART</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SDO_FALAC</aggregate>
        <subject>SDO_FALAC</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>VALOR</aggregate>
        <subject>VALOR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SENT</aggregate>
        <subject>SENT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>COEFICIENTE</aggregate>
        <subject>COEFICIENTE</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>LCR</aggregate>
        <subject>LCR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES1</aggregate>
        <subject>IMPORTE_MES1</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES2</aggregate>
        <subject>IMPORTE_MES2</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES3</aggregate>
        <subject>IMPORTE_MES3</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1376</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>SET/CodPartida 221210 2</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>CODIGOPART</name>
      </field>
      <field>
        <name>MONEDA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>FECHA_INFORME</aggregate>
        <subject>FECHA_INFORME</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>CODIGOPARTIDA</aggregate>
        <subject>CODIGOPART</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SDO_FALAC</aggregate>
        <subject>SDO_FALAC</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>VALOR</aggregate>
        <subject>VALOR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SENT</aggregate>
        <subject>SENT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>COEFICIENTE</aggregate>
        <subject>COEFICIENTE</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>LCR</aggregate>
        <subject>LCR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES1</aggregate>
        <subject>IMPORTE_MES1</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES2</aggregate>
        <subject>IMPORTE_MES2</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES3</aggregate>
        <subject>IMPORTE_MES3</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1360</xloc>
      <yloc>1056</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>SET/CodPartida 221220</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>CODIGOPART</name>
      </field>
      <field>
        <name>MONEDA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>FECHA_INFORME</aggregate>
        <subject>FECHA_INFORME</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>CODIGOPARTIDA</aggregate>
        <subject>CODIGOPART</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SDO_FALAC</aggregate>
        <subject>SDO_FALAC</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>VALOR</aggregate>
        <subject>VALOR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SENT</aggregate>
        <subject>SENT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>COEFICIENTE</aggregate>
        <subject>COEFICIENTE</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>LCR</aggregate>
        <subject>LCR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES1</aggregate>
        <subject>IMPORTE_MES1</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES2</aggregate>
        <subject>IMPORTE_MES2</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES3</aggregate>
        <subject>IMPORTE_MES3</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1360</xloc>
      <yloc>1184</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>SET/CodPartida 221230</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>CODIGOPART</name>
      </field>
      <field>
        <name>MONEDA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>FECHA_INFORME</aggregate>
        <subject>FECHA_INFORME</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>CODIGOPARTIDA</aggregate>
        <subject>CODIGOPART</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SDO_FALAC</aggregate>
        <subject>SDO_FALAC</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>VALOR</aggregate>
        <subject>VALOR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SENT</aggregate>
        <subject>SENT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>COEFICIENTE</aggregate>
        <subject>COEFICIENTE</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>LCR</aggregate>
        <subject>LCR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES1</aggregate>
        <subject>IMPORTE_MES1</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES2</aggregate>
        <subject>IMPORTE_MES2</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES3</aggregate>
        <subject>IMPORTE_MES3</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1360</xloc>
      <yloc>1296</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>SET/CodPartida 3</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>CODIGOPART</name>
      </field>
      <field>
        <name>MONEDA</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>FECHA_INFORME</aggregate>
        <subject>FECHA_INF</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>CODIGOPARTIDA</aggregate>
        <subject>CODIGOPART</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SDO_FALAC</aggregate>
        <subject>SDO_FALAC</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>VALOR</aggregate>
        <subject>VALOR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>SENT</aggregate>
        <subject>SENTT_1</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>COEFICIENTE</aggregate>
        <subject>COEFICIENTE</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>LCR</aggregate>
        <subject>LCR</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES1</aggregate>
        <subject>IMPORTE_MES1</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES2</aggregate>
        <subject>IMPORTE_MES2</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>IMPORTE_MES3</aggregate>
        <subject>IMPORTE_MES3</subject>
        <type>FIRST_INCL_NULL</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1360</xloc>
      <yloc>1792</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>SORT MON 4</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>MONEDA</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1200</xloc>
      <yloc>1792</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>SORT MON 5</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>MONEDA</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1200</xloc>
      <yloc>1680</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sort Mon</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>MONEDA</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1200</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sort Mon 2</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>MONEDA</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1248</xloc>
      <yloc>672</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sort Mon 2 2 2 2</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>MONEDA</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1200</xloc>
      <yloc>1056</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sort Mon 221100</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>MONEDA</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1248</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sort Mon 221210</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>MONEDA</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1248</xloc>
      <yloc>896</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sort Mon 221220</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>MONEDA</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1200</xloc>
      <yloc>1184</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sort Mon 221230</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>MONEDA</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1200</xloc>
      <yloc>1296</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sort Mon 3</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>MONEDA</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1200</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sort Mon 3 2</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>MONEDA</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1200</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sort Mon 351000</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>MON</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1200</xloc>
      <yloc>1408</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sort Mon 352000</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>MON</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1200</xloc>
      <yloc>1504</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>ayer feriado</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT 
	CASE WHEN dbo.esFERIADO(CONVERT(DATETIME,DATEADD(DAY,-1,CONVERT(DATETIME,?,103)),103))=1 THEN 
		DATEADD(DAY,-1,CONVERT(DATETIME,?,103))
	ELSE 
		CONVERT(DATETIME,?,103)
	END AS fecha</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1824</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>feriado</name>
    <type>DBJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazConect</connection>
    <rowlimit>0</rowlimit>
    <sql>SELECT 
	CASE WHEN dbo.esFERIADO(CONVERT(DATETIME,?,103))=1 THEN 
		1
	ELSE
		0
	END feriado</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>fechaP</name>
        <type>Date</type>
      </field>
    </parameter>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>llamar fecha ayer</name>
    <type>TransExecutor</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <specification_method>filename</specification_method>
    <trans_object_id/>
    <trans_name/>
    <filename>${Internal.Entry.Current.Directory}/RRII_MEDICION_LCR.ktr</filename>
    <directory_path/>
    <group_size>1</group_size>
    <group_field/>
    <group_time/>
    <parameters>
      <variablemapping>
        <variable>fecha</variable>
        <field>fecha</field>
        <input/>
      </variablemapping>
      <inherit_all_vars>Y</inherit_all_vars>
    </parameters>
    <execution_result_target_step/>
    <execution_time_field>ExecutionTime</execution_time_field>
    <execution_result_field>ExecutionResult</execution_result_field>
    <execution_errors_field>ExecutionNrErrors</execution_errors_field>
    <execution_lines_read_field>ExecutionLinesRead</execution_lines_read_field>
    <execution_lines_written_field>ExecutionLinesWritten</execution_lines_written_field>
    <execution_lines_input_field>ExecutionLinesInput</execution_lines_input_field>
    <execution_lines_output_field>ExecutionLinesOutput</execution_lines_output_field>
    <execution_lines_rejected_field>ExecutionLinesRejected</execution_lines_rejected_field>
    <execution_lines_updated_field>ExecutionLinesUpdated</execution_lines_updated_field>
    <execution_lines_deleted_field>ExecutionLinesDeleted</execution_lines_deleted_field>
    <execution_files_retrieved_field>ExecutionFilesRetrieved</execution_files_retrieved_field>
    <execution_exit_status_field>ExecutionExitStatus</execution_exit_status_field>
    <execution_log_text_field>ExecutionLogText</execution_log_text_field>
    <execution_log_channelid_field>ExecutionLogChannelId</execution_log_channelid_field>
    <result_rows_target_step/>
    <result_files_target_step/>
    <result_files_file_name_field>FileName</result_files_file_name_field>
    <executors_output_step/>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1504</xloc>
      <yloc>128</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>prep fechas</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>fechaP</name>
        <rename>fechaP</rename>
        <type>Date</type>
        <length>10</length>
        <precision>-2</precision>
        <conversion_mask>dd/MM/yyyy</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>fecha</name>
        <rename>fecha</rename>
        <type>Date</type>
        <length>10</length>
        <precision>-2</precision>
        <conversion_mask>dd/MM/yyyy</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1728</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>recursivo</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>llamar fecha ayer</send_true_to>
    <send_false_to>x 11</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>fechaP</leftvalue>
        <function>&lt;></function>
        <rightvalue>fecha</rightvalue>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1616</xloc>
      <yloc>128</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>x</name>
    <type>Dummy</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>x 10</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>656</xloc>
      <yloc>416</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>x 11</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1616</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>x 12</name>
    <type>Dummy</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1616</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>x 2</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>656</xloc>
      <yloc>560</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>x 3</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>384</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>x 4</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>656</xloc>
      <yloc>736</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>x 5</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>672</xloc>
      <yloc>864</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>x 6</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>656</xloc>
      <yloc>1120</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>x 7</name>
    <type>Dummy</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>x 8</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>976</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>x 9</name>
    <type>Dummy</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>656</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>x/Minoristas</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>Prep Val 221210 2</send_true_to>
    <send_false_to>x 6</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>MONTO_TOTAL</leftvalue>
        <function>&gt;=</function>
        <rightvalue>MINORISTA</rightvalue>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>656</xloc>
      <yloc>1056</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
  <attributes/>
</transformation>
