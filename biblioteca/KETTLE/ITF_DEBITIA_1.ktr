<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>ITF_DEBITIA_1</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2023/05/31 09:52:24.510</created_date>
    <modified_user>-</modified_user>
    <modified_date>2023/05/31 09:52:24.510</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
    <notepad>
      <note>1.37.1</note>
      <xloc>0</xloc>
      <yloc>0</yloc>
      <width>49</width>
      <heigth>30</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
  </notepads>
  <connection>
    <name>TopazDS</name>
    <server/>
    <type>MSSQL</type>
    <access>JNDI</access>
    <database>TopazDS</database>
    <port>1521</port>
    <username/>
    <password>Encrypted </password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1521</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>Table input</from>
      <to>Text file output</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Data grid</from>
      <to>Table input</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>Data grid</name>
    <type>DataGrid</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>a</name>
        <type>Integer</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <data>
      <line>
        <item>1</item>
      </line>
    </data>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Table input</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>TopazDS</connection>
    <sql>SET ANSI_WARNINGS OFF

BEGIN--Clientes con atraso
 DECLARE @fecha_info DATETIME;
 
 SELECT @fecha_info = MAX(fecha_info)
 FROM MEMO_CABECERA

 SELECT DISTINCT CONVERT(VARCHAR,d.Num_Doc) AS Num_Doc INTO #TMP_MEMO_DETALLE
 FROM MEMO_DETALLE d WITH (NOLOCK)
  INNER JOIN PRODUCTOS B WITH (NOLOCK) ON B.C6250 = d.PRODUCTO
 WHERE d.Fecha_Info = @fecha_info --(SELECT max(dd.fecha_info) FROM MEMO_DETALLE dd WITH (NOLOCK) WHERE dd.Num_Doc = d.Num_Doc) 
   AND d.Dias_Atraso > 0
   AND (B.C6252 IN (2,5) OR (B.C6252 = 1 AND C6800 = 'T'))
  
  CREATE INDEX IX_TEMP_ITF_MEMO_DETALLE ON #TMP_MEMO_DETALLE(Num_doc);
END

BEGIN--Tomos la ultima cabecera
 SELECT mem1.fecha_info, mem1.CUIT_CUIL_CDI, Deuda_Total, Cuenta_Orden, Prevision,Suc_Cliente , mem1.Sit_Juridica
   INTO #TMP_MEMO_CABECERA
 FROM MEMO_CABECERA mem1 WITH (NOLOCK)
 WHERE mem1.fecha_info = @fecha_info --(SELECT max(mem2.fecha_info) AS fecha_info FROM MEMO_CABECERA mem2 WITH (NOLOCK) WHERE mem2.CUIT_CUIL_CDI = mem1.CUIT_CUIL_CDI)
 
 CREATE INDEX IX_TEMP_ITF_MEMO_CABECERA ON #TMP_MEMO_CABECERA(CUIT_CUIL_CDI);
END

BEGIN --cuentas
	SELECT s.JTS_OID,
		   doc.NUMEROPERSONA,
		   cp.CODIGOCLIENTE,
		   CASE WHEN mem.Suc_Cliente IS NULL THEN 999 ELSE mem.Suc_Cliente END AS memo_Suc_Cliente,
		   pf.EMPLEADO_BC_BANCO,
		   pro.C6251,
		   s.SUCURSAL AS SALDOS_SUCURSAL,
		   s.OPERACION AS SALDOS_OPERACION,
		   s.ORDINAL AS SALDOS_ORDINAL,
		   S.C1621,
		   S.C1604,
		   s.CUENTA,
		   s.C1679,
		   s.c1665,
		   s.c1609,
		   s.c1610,
		   s.C1683,
		   s.PRODUCTO,
		   s.FECHA_SOBREGIRO,
		   s.ULT_FECHA_VIGENTE,
		   pro.ALGORITMOPAGO,
--		   isnull(mem.Deuda_Total,0) AS SALDO_DIARIO_TC,
		   isnull(memd.saldo_capital,0) AS SALDO_DIARIO_TC,
		   CASE WHEN s.C1785 = 1 THEN 'TC'
				 WHEN s.C1785 = 2 THEN 'CC'
				 WHEN s.C1785 = 5 THEN 'PR'
			END AS TIPO_CUENTA,
			doc.NroDocIdent as CID, 
	        CASE WHEN doc.TIPOPERSONA = 'F' THEN doc.NumDocFisico ELSE doc.NroDocIdent END AS Number,
	        doc.NOMBRE AS Name,
	        Replace(CASE WHEN mec.CUIT IS NULL THEN 'SituaciÃ³n Normal' ELSE mec.DESCRIPCION END,'"','') AS CTag1,
			Replace(concat(dir.CALLE,'-',dir.NUMERO,'-',dir.CPA_NUEVO, '-',pa.NOMBREPAIS , '-', pr.DESCRIPCION, '-', dep.NOMBREDEP, '-', loc.DESCRIPCION_DIM3),'"','') AS CTag2,
			--bcra.SITUACION_BCRA AS CTag3,
			cli.CATEGORIA_OFICIAL AS CTag3,
			cli.CATEGORIARESULTANTE AS CTag4,
			CASE WHEN isnull(mem.Cuenta_Orden,'N') = 'N' THEN isnull(mem.Prevision,0) ELSE isnull(mem.Deuda_Total,0) END AS CTag5,
			isnull(OP.DESCRIPCION,'Sin Categoria') AS CTag6,
			CASE 	WHEN pf.FALLECIDO = 'S' THEN 'ADMINISTRATIVA - FALLECIDOS'
					WHEN mem.Sit_Juridica = 'S' THEN 'JUDICIALIZADA'
					WHEN s.SUCURSAL IN (51,52,53) THEN 'ADMINISTRADA'
					WHEN mec.COD_ESTADO = '7' THEN 'ADMINISTRATIVA - FRAUDE'
					ELSE 'PROPIA'
			END  AS CTag7,
			CASE 	WHEN mem.Cuenta_Orden = 'S' THEN 'CO' ELSE '-' END  AS CTag8,
			isnull(cem.email,'') AS Email1, 
			tel.NUMERO AS Phone1,
		    isnull(tel2.NUMERO,' ') AS Phone2,
			m.C6402 AS Currency,
			s.C1644 AS DTag2,
			s.SUCURSAL AS DTag4,
			s.MONEDA,
			s.C1728 AS SITUACION
	INTO #TEMP_ITF_DEBITIA_CUENTAS
	FROM SALDOS s WITH (nolock)
	JOIN monedas m WITH (NOLOCK) ON m.C6399 = s.MONEDA AND m.TZ_LOCK = 0 AND s.C1785 in (1,2,5) AND s.c1651 &lt;&gt; '1'
	JOIN PRODUCTOS pro WITH (NOLOCK) ON pro.C6250 = s.PRODUCTO
	JOIN PLANCTAS pc WITH (NOLOCK) ON pc.C6326 = s.C1730
	JOIN CLI_ClientePersona cp WITH (NOLOCK) ON s.C1803 =cp.CODIGOCLIENTE AND cp.TITULARIDAD = 'T'
	JOIN VW_PERSONAS_FYJ doc WITH (NOLOCK) ON cp.NUMEROPERSONA=doc.NUMEROPERSONA
	JOIN #TMP_MEMO_DETALLE MD WITH (NOLOCK) ON MD.Num_Doc = CONVERT(VARCHAR,doc.NroDocIdent)
	LEFT JOIN (
					SELECT ID, TIPODIRECCION,FORMATO,CALLE,NUMERO,CPA_NUEVO,PAIS,PROVINCIA,DEPARTAMENTO,LOCALIDAD, row_number() OVER (PARTITION BY ID ORDER BY ORDINAL_DIR) AS row 
					FROM CLI_DIRECCIONES WITH (NOLOCK) 
					WHERE TZ_LOCK = 0 AND (TIPODIRECCION='L' OR TIPODIRECCION='PR') 
				) dir ON cp.NUMEROPERSONA=dir.ID AND dir.FORMATO = CASE WHEN doc.TIPOPERSONA = 'F' THEN 'PF' ELSE 'PJ' END AND DIR.row = 1
	LEFT JOIN CLI_PAISES pa WITH (NOLOCK) ON pa.CODIGOPAIS = dir.PAIS
	LEFT JOIN CLI_PROVINCIAS pr WITH (NOLOCK) ON pr.CODIGOPAIS = dir.PAIS AND pr.DIM1 = dir.PROVINCIA
	LEFT JOIN CLI_DEPARTAMENTOS dep WITH (NOLOCK) ON dep.CODIGOPAIS = dir.PAIS AND dep.DEPARTAMENTO = dir.DEPARTAMENTO AND dep.PROVINCIA = dir.PROVINCIA
	LEFT JOIN CLI_LOCALIDADES loc WITH (NOLOCK) ON loc.CODIGOPAIS = dir.PAIS AND loc.DIM1 = dir.PROVINCIA AND loc.DIM2= dir.DEPARTAMENTO AND loc.DIM3 = dir.LOCALIDAD
	LEFT JOIN (
					SELECT ID, FORMATO,NUMERO, row_number() OVER (PARTITION BY ID ORDER BY TIPO_CEL_TEL, ORDINAL) AS row 
					FROM cli_telefonos WITH (NOLOCK) WHERE TZ_LOCK = 0 AND FORMATO IN ('PJ','PF')
				) tel ON tel.ID=cp.NUMEROPERSONA AND tel.FORMATO = CASE WHEN doc.TIPOPERSONA = 'F' THEN 'PF' ELSE 'PJ' END AND tel.row = 1
	LEFT JOIN (
					SELECT ID, FORMATO,NUMERO, row_number() OVER (PARTITION BY ID ORDER BY TIPO_CEL_TEL, ORDINAL) AS row 
					FROM cli_telefonos WITH (NOLOCK) WHERE TZ_LOCK = 0 AND FORMATO IN ('PJ','PF')
				) tel2 ON tel2.ID=cp.NUMEROPERSONA AND tel2.FORMATO = CASE WHEN doc.TIPOPERSONA = 'F' THEN 'PF' ELSE 'PJ' END AND tel2.row = 2
	JOIN CLI_CLIENTES cli WITH (NOLOCK) ON cli.CODIGOCLIENTE=cp.CODIGOCLIENTE
	LEFT JOIN OPCIONES op WITH (NOLOCK) ON op.NUMERODECAMPO = 1036 AND op.OPCIONINTERNA = cli.CATEGORIA_COMERCIAL
	LEFT JOIN cli_personasfisicas pf WITH (NOLOCK) ON pf.NUMEROPERSONAFISICA = cp.NUMEROPERSONA
	LEFT JOIN CRE_BCRA_CENDEU bcra WITH (NOLOCK) ON cli.CODIGOCLIENTE = bcra.CODIGOCLIENTE AND bcra.COD_ENTIDAD = (SELECT TOP 1 bcra2.COD_ENTIDAD FROM  CRE_BCRA_CENDEU bcra2 WITH (NOLOCK) where cli.CODIGOCLIENTE = bcra2.CODIGOCLIENTE AND bcra2.tz_lock = 0 ORDER BY bcra2.COD_ENTIDAD)
	LEFT JOIN (
				SELECT cem1.ID, cem1.email, CASE 	WHEN cem1.FORMATO = 'PJ' THEN 'J' 
													WHEN cem1.FORMATO = 'PF' THEN 'F'
													ELSE cem1.FORMATO
											END AS FORMATO
				FROM CLI_EMAILS cem1 WITH (NOLOCK)
				JOIN (
						SELECT min(ordinal) AS ordinal, ID 
						FROM CLI_EMAILS WITH (NOLOCK)
						WHERE TZ_LOCK = 0
						GROUP BY ID
					) cem2 ON cem1.ID = cem2.ID AND cem1.ordinal = cem2.ordinal
		) cem ON cem.ID = doc.NUMEROPERSONA AND doc.TIPOPERSONA = CEM.FORMATO
	LEFT JOIN #TMP_MEMO_CABECERA mem ON mem.CUIT_CUIL_CDI = doc.NroDocIdent
	INNER JOIN (SELECT sum(Saldo_Capital) AS  Saldo_Capital, Fecha_Info,Cliente, SALDO_JTS_OID, Num_Doc
				FROM MEMO_DETALLE A WITH (NOLOCK)
					INNER JOIN PRODUCTOS B WITH (NOLOCK) ON B.C6250 = A.PRODUCTO
				WHERE Fecha_Info = @fecha_info
					AND (B.C6252 IN (2,5) OR (B.C6252 = 1 AND C6800 = 'T'))
				GROUP BY Fecha_Info,Cliente, SALDO_JTS_OID, Num_Doc) memd ON memd.Fecha_Info = mem.fecha_info AND memd.NUM_DOC=mem.CUIT_CUIL_CDI AND memd.SALDO_JTS_OID = s.JTS_OID
	LEFT JOIN ITF_DEBITIA_MARCA_ESTADO_CLIENTE mec WITH (NOLOCK) ON mec.CUIT = doc.NroDocIdent
	  
	CREATE INDEX IX_TEMP_ITF_DEBITIA_CUENTAS_TIPO_CUENTA ON #TEMP_ITF_DEBITIA_CUENTAS(TIPO_CUENTA);
	CREATE INDEX IX_TEMP_ITF_DEBITIA_CUENTAS_JTS_OID_NUMEROPERSONA_CODIGOCLIENTE ON #TEMP_ITF_DEBITIA_CUENTAS(JTS_OID,NUMEROPERSONA,/*CODIGOCLIENTE*/CID); --5.0
	CREATE INDEX IX_TEMP_ITF_DEBITIA_CUENTAS_NUMEROPERSONA_CODIGOCLIENTE ON #TEMP_ITF_DEBITIA_CUENTAS(NUMEROPERSONA,/*CODIGOCLIENTE*/CID); --5.0
END 
BEGIN --deudas cc
	SELECT c.JTS_OID,
		   c.NUMEROPERSONA,
		   c.CODIGOCLIENTE,
		   c.memo_Suc_Cliente AS CTag9,
		    'CC' AS Product,
			concat('CC','-',c.SALDOS_SUCURSAL,'-',c.CUENTA,'-',c.SALDOS_ORDINAL) AS Reference,
			isnull(FORMAT(c.ULT_FECHA_VIGENTE, 'MM/dd/yyyy'),FORMAT(p.FECHAPROCESO, 'MM/dd/yyyy')) AS DueDate,
			'' AS DTag1,
			CASE WHEN c.C1604&lt; 0 THEN c.C1604*-1 ELSE 0 END AS DTag5,
			concat('Importe de acuerdos: ',c.C1683,' - Saldo en CC: ', c.C1604 /*Case when c.C1604 &lt; 0 Then c.C1604*-1 Else c.C1604 End*/) AS DTag6,
			0 AS Quota,
			CASE WHEN c.C1604> 0 THEN 0
				 ELSE 	CASE 	WHEN c.C1604*-1 > c.C1683 THEN (c.C1604*-1) - c.C1683 
				 		  		ELSE 0 
				 		END 
			END AS Debit,
			0 AS Interest,
			0 AS Interest2,
			0 AS Punitive,
			0 AS DeferredIncome,
			concat('CC','-0-',c.SALDOS_SUCURSAL,'-',c.CUENTA,'-',c.SALDOS_ORDINAL,'-0-0') AS DID
			,CASE WHEN C.C1604>=0 THEN 0 ELSE 1 END AS TIENE_DEUDA
			, c.C1683 AS SUMATORIA_ACUERDO
			, C.C1604
			, c.CID AS NUMDOC --5.0
			INTO #TEMP_ITF_DEBITIA_DEUDAS_CC
	FROM #TEMP_ITF_DEBITIA_CUENTAS c
	CROSS JOIN PARAMETROS p WITH(NOLOCK)
	WHERE c.TIPO_CUENTA = 'CC'
	
	CREATE INDEX IX_TEMP_ITF_DEBITIA_DEUDAS_CC_JTS_OID_NUMEROPERSONA_CODIGOCLIENTE ON #TEMP_ITF_DEBITIA_DEUDAS_CC(JTS_OID,NUMEROPERSONA,/*CODIGOCLIENTE*/NUMDOC); --5.0
	CREATE INDEX IX_TEMP_ITF_DEBITIA_DEUDAS_CC_NUMEROPERSONA_CODIGOCLIENTE ON #TEMP_ITF_DEBITIA_DEUDAS_CC(NUMEROPERSONA, /*CODIGOCLIENTE*/NUMDOC); --5.0
END   
BEGIN --deudas PR
		SELECT c.JTS_OID,
		   c.NUMEROPERSONA,
		   c.CODIGOCLIENTE,
		   c.memo_Suc_Cliente AS CTag9,
			c.C6251 AS Product,
			concat('PR','-',VW.SUCURSAL,'-',VW.OPERACION,'-',c.SALDOS_ORDINAL) AS Reference,
			isnull(FORMAT(PP.C2302, 'MM/dd/yyyy'),0) AS DueDate,
			concat(isnull(crs.JURISDICCION,''),'-',isnull(cpd.NomConvPago,''),'-', CASE WHEN isnull(crs.ID_CONVENIO,0) = 0 THEN '' ELSE convert(VARCHAR,crs.ID_CONVENIO) END ) AS DTag1,
			PP2.TOTAL_CAPITAL_ADEUDADO AS DTag5,
			concat('Cuenta de cobro: ',
			        CASE WHEN pc.c6252 = 3 THEN 'AC' WHEN pc.c6252 = 2 THEN 'CC' ELSE '' END,' - ',
			        isnull(sc.SUCURSAL,0),' - ',
			        convert(BIGINT,sc.CUENTA),
			        ' *** Estado ', CASE WHEN SC.C1651 = '1' THEN 'Cancelada' WHEN SC.C1651 = ' ' THEN 'Activa' ELSE '' END,'-', 
			        CASE WHEN isnull(sc.JTS_OID,0) = 0 THEN '' WHEN b.COD_BLOQUEO IS NOT NULL AND SC.C1679 &lt;&gt; '0'  THEN concat('Bloqueada: ',b.COD_BLOQUEO,' ',cb.DESCRIPCION) ELSE 'Sin bloqueos' END,
			        CASE WHEN gp.JTS_CONTRACUENTA IS NULL THEN '***Sin Garante***' ELSE concat('***Detalle Garante: ','Tipo_doc: ', dgp.TIPODOCIDENT,' Nro_Doc: ', dgp.NRODOCIDENT,' Cta_Cli: ',CAST(CAST(sgp.C1803 AS BIGINT) AS VARCHAR),' Caja_Ahorro: ',sgp.cuenta,'***') END ,
			        CASE WHEN g.NUM_GARANTIA IS NULL THEN 'Sin Garantia***' ELSE concat('Garantia: ', g.NUM_GARANTIA,'***')END) AS DTag6,
			PP.C2300 AS 'Quota',
			PP.C2309 AS Debit,
			CASE 	WHEN PP.C2302&lt;= par.FECHAPROCESO THEN PP.C2310
					ELSE	CASE 	WHEN c.ALGORITMOPAGO = 14 AND c.SITUACION = 'C' THEN PP.C2310
									WHEN c.ALGORITMOPAGO = 14 AND pp.C2310 = 0 THEN 0
									WHEN c.ALGORITMOPAGO = 14 THEN c.c1609 - c.c1610 - isnull((SELECT sum(pla.C2310) FROM PLANPAGOS pla WITH (NOLOCK) WHERE pla.SALDO_JTS_OID = c.JTS_OID AND pla.C2300 &lt; PP.C2300),0)
																	--ISNULL(VAD.MORA+VAD.IVA_MORA+VAD.PUNITORIO+VAD.IVA_PUNITORIO+VAD.IVA_PERCEPCION_MORA+VAD.IVA_PERCEPCION_INTCOMP_MORA,0)
									ELSE PP.C2310
							END 
			END AS Interest,
			CASE 	WHEN PP.C2302&lt;= par.FECHAPROCESO THEN PP.ICMORA_DEV
					ELSE 0
			END AS Interest2,
			CASE 	WHEN PP.C2302&lt;= par.FECHAPROCESO THEN PP.C2311--PP.IVAMORA + PP.IVAPERCEPCIONMORA + PP.IVAINTCOMPMORA
					ELSE 0
			END AS Punitive,
			isnull(gxc.SALDO_GASTO,0) AS DeferredIncome,
			concat('PR','-',0,'-',c.SALDOS_SUCURSAL,'-',c.SALDOS_OPERACION,'-',c.SALDOS_ORDINAL,'-',PP.C2300,'-0') AS DID
			,CASE WHEN C2302 &lt;= PAR.FECHAPROCESO OR PAR.FECHAPROCESO BETWEEN C2301 AND C2302 THEN 1 ELSE 0 END AS TIENE_DEUDA
			,CASE WHEN PP.C2300 &lt;&gt; pp2.C2300 THEN 0 ELSE isnull(PP2.TOTAL_CAPITAL_SIN_VENCER,0) + isnull(gxc2.SALDO_GASTO,0) END as TOTAL_CAPITAL_SIN_VENCER
			, HIS.tipo_cambio_Venta AS TipoCambio
			, c.CID AS NUMDOC --5.0
			INTO #TEMP_ITF_DEBITIA_DEUDAS_PR
	FROM #TEMP_ITF_DEBITIA_CUENTAS c
	LEFT JOIN VW_ASISTENCIAS VW WITH (NOLOCK) ON c.JTS_OID = VW.JTS_OID
	LEFT JOIN VW_ASISTENCIAS_DEUDA VWA WITH (NOLOCK) ON VW.JTS_OID = VWA.JTS_OID 
	JOIN CRE_SALDOS crs WITH (NOLOCK) ON crs.SALDOS_JTS_OID = VW.JTS_OID
	LEFT JOIN conv_convenios_pag cpd WITH (NOLOCK) ON crs.ID_CONVENIO = cpd.ID_ConvPago --AND crs.TIPO_CONVENIO = cpd.Id_TpoConv 1.1
	LEFT JOIN (
					SELECT SALDO_JTS_OID, COD_BLOQUEO, row_number() OVER (PARTITION BY SALDO_JTS_OID ORDER BY COD_BLOQUEO) AS row 
					FROM GRL_BLOQUEOS WITH (NOLOCK) WHERE TZ_LOCK = 0 AND ESTADO &lt;&gt; 2
				) b ON b.SALDO_JTS_OID = c.C1665 AND b.row = 1
	LEFT JOIN GRL_COD_BLOQUEOS CB WITH (NOLOCK) ON b.COD_BLOQUEO = CB.COD_BLOQUEO
	LEFT JOIN (
				SELECT JTSOID_SALDO, NUM_GARANTIA, row_number() OVER (PARTITION BY JTSOID_SALDO ORDER BY NUM_GARANTIA) AS row 
				FROM CRE_GARANTIACREDITO WITH (NOLOCK) WHERE TZ_LOCK = 0
		) g ON g.JTSOID_SALDO = c.jts_oid AND g.row = 1
	CROSS JOIN PARAMETROS par WITH (NOLOCK)
	JOIN PLANPAGOS PP WITH (NOLOCK) ON VW.JTS_OID=PP.SALDO_JTS_OID AND 
			 (	(PP.C2302&lt;= par.FECHAPROCESO) 
				OR (par.FECHAPROCESO BETWEEN PP.C2301 AND PP.C2302 AND PP.C2301 &lt; par.FECHAPROCESO) 
				OR (PP.C2301=c.C1621 AND (c.C1621= par.FECHAPROCESO)) 
			) AND ((PP.TZ_LOCK &lt; 300000000000000 OR PP.TZ_LOCK >= 400000000000000) AND (PP.TZ_LOCK &lt; 100000000000000 OR PP.TZ_LOCK >= 200000000000000)  )
			AND PP.C2309 + PP.C2310 + PP.C2311 > 0
	LEFT JOIN (
		SELECT Z.SALDO_JTS_OID,
	      SUM(Z.TOTAL_CAPITAL_ADEUDADO) AS TOTAL_CAPITAL_ADEUDADO,
	      SUM(Z.C2309 + CASE WHEN INDVENC = 1 THEN 0 ELSE Z.INTERES_DEV END) AS TOTAL_CAPITAL_SIN_VENCER,
	      MIN(Z.c2300) AS c2300
	    FROM
	    (
	  	SELECT 	pp3.SALDO_JTS_OID, (CASE WHEN PP3.C2302 &lt;= p.FECHAPROCESO THEN 1 ELSE 0 END) AS INDVENC
				, PP3.C2309 AS TOTAL_CAPITAL_ADEUDADO
				, (CASE 	WHEN (p.FECHAPROCESO BETWEEN PP3.C2301 AND PP3.C2302 AND PP3.C2301 &lt; p.FECHAPROCESO) 
								OR (PP3.C2301=c.C1621 AND (c.C1621= p.FECHAPROCESO)) THEN PP3.C2309
							WHEN PP3.C2302 >= p.FECHAPROCESO THEN PP3.C2309 
					   		ELSE 0 
					  END 
				  ) AS C2309
				 ,CASE 	WHEN PP3.C2302&lt;= p.FECHAPROCESO THEN PP3.C2310
				 	    WHEN c.ALGORITMOPAGO &lt;&gt; 14 AND p.FECHAPROCESO BETWEEN PP3.C2301 AND PP3.C2302 THEN PP3.C2310
					    WHEN c.ALGORITMOPAGO = 14 AND c.SITUACION = 'C' THEN PP3.C2310
						WHEN c.ALGORITMOPAGO = 14 AND PP3.C2310 = 0 THEN 0
						WHEN c.ALGORITMOPAGO = 14 AND p.FECHAPROCESO BETWEEN PP3.C2301 AND PP3.C2302 THEN c.c1609 - c.c1610 - isnull((SELECT sum(pla.C2310) FROM PLANPAGOS pla WITH (NOLOCK) 
												            WHERE pla.SALDO_JTS_OID = c.JTS_OID AND pla.C2300 &lt; PP3.C2300),0)
						 ELSE 0
					END AS INTERES_DEV
				, (CASE WHEN PP3.C2302 >= p.FECHAPROCESO THEN  c2300 ELSE NULL END ) AS c2300
	 	FROM PLANPAGOS PP3 WITH (NOLOCK)
	 	CROSS JOIN PARAMETROS p WITH (NOLOCK)
	 	JOIN #TEMP_ITF_DEBITIA_CUENTAS C ON C.JTS_OID = PP3.SALDO_JTS_OID AND C.TIPO_CUENTA = 'PR'
	 	JOIN VW_ASISTENCIAS_DEUDA vad WITH (NOLOCK) ON vad.JTS_OID = PP3.SALDO_JTS_OID
	 	WHERE 	((	PP3.C2301 >= p.FECHAPROCESO
	 				AND ((PP3.TZ_LOCK &lt; 300000000000000 OR PP3.TZ_LOCK >= 400000000000000) AND (PP3.TZ_LOCK &lt; 100000000000000 OR PP3.TZ_LOCK >= 200000000000000)  )
	 			) OR 
	 			(
		 			((PP3.C2302&lt;= p.FECHAPROCESO) 
					OR (p.FECHAPROCESO BETWEEN PP3.C2301 AND PP3.C2302 AND PP3.C2301 &lt; p.FECHAPROCESO) 
					OR (PP3.C2301=c.C1621 AND (c.C1621= p.FECHAPROCESO)) 
					) AND ((PP3.TZ_LOCK &lt; 300000000000000 OR PP3.TZ_LOCK >= 400000000000000) AND (PP3.TZ_LOCK &lt; 100000000000000 OR PP3.TZ_LOCK >= 200000000000000)  )
					AND PP3.C2309 + PP3.C2310 + PP3.C2311 > 0
	 			))
	    ) Z
	 	GROUP BY Z.SALDO_JTS_OID
	) AS PP2 ON PP2.SALDO_JTS_OID = c.JTS_OID
	LEFT JOIN (SELECT JTS_OID_PRESTAMO, JTS_CONTRACUENTA, row_number() OVER (PARTITION BY JTS_OID_PRESTAMO, JTS_CONTRACUENTA ORDER BY ORDEN_COBRO) AS row FROM CRE_COBRANZA_CONTRA_CTAS WITH (NOLOCK) WHERE tz_lock=0 ) gp ON gp.JTS_OID_PRESTAMO = c.jts_oid AND gp.row = 1
	LEFT JOIN saldos sgp WITH (NOLOCK) ON sgp.jts_oid = gp.JTS_CONTRACUENTA
	LEFT JOIN CLI_ClientePersona cgp WITH (NOLOCK) ON cgp.codigocliente = sgp.C1803 AND cgp.titularidad = 'T'
	LEFT JOIN VW_PERSONAS_FYJ dgp WITH (NOLOCK) ON dgp.NUMEROPERSONA = cgp.NUMEROPERSONA
	LEFT JOIN saldos sc WITH (NOLOCK) ON sc.jts_oid = c.C1665
	LEFT JOIN productos pc WITH (NOLOCK) ON pc.c6250 = SC.producto
	LEFT JOIN ( SELECT gxc.SALDOS_JTS_OID, gxc.NUMERO_CUOTA, sum(gxc.SALDO_GASTO) AS SALDO_GASTO
				FROM GASTOS_POR_CUOTA gxc WITH (NOLOCK)
				where gxc.CARGO_ID IN (3003,3004)
	GROUP BY gxc.SALDOS_JTS_OID, gxc.NUMERO_CUOTA) gxc ON gxc.SALDOS_JTS_OID = VW.JTS_OID AND gxc.NUMERO_CUOTA = PP.c2300
	LEFT JOIN ( SELECT gxc.SALDOS_JTS_OID, gxc.NUMERO_CUOTA , sum(isnull(gxc2.SALDO_GASTO,0)) AS SALDO_GASTO
				FROM GASTOS_POR_CUOTA gxc WITH (NOLOCK)
				LEFT JOIN GASTOS_POR_CUOTA gxc2 WITH (NOLOCK) ON gxc.SALDOS_JTS_OID = gxc2.SALDOS_JTS_OID AND gxc.NUMERO_CUOTA &lt;= gxc2.NUMERO_CUOTA AND gxc.CARGO_ID = gxc2.CARGO_ID AND gxc.SECUENCIAL = gxc2.SECUENCIAL
				where gxc.CARGO_ID IN (3003,3004) 
				GROUP BY gxc.SALDOS_JTS_OID, gxc.NUMERO_CUOTA) gxc2 ON gxc2.SALDOS_JTS_OID = VW.JTS_OID AND gxc2.NUMERO_CUOTA = PP2.c2300
	LEFT JOIN VW_ASISTENCIAS_DEUDA vad WITH (NOLOCK) ON vad.JTS_OID = c.JTS_OID
	LEFT JOIN HISTORICOTIPOSCAMBIO his  WITH (NOLOCK) ON his.moneda = c.moneda AND his.fecha_cotizacion = par.fechaprocesoanterior
	WHERE c.TIPO_CUENTA = 'PR'
	
	CREATE INDEX IX_TEMP_ITF_DEBITIA_DEUDAS_PR_JTS_OID_NUMEROPERSONA_CODIGOCLIENTE ON #TEMP_ITF_DEBITIA_DEUDAS_PR(JTS_OID,NUMEROPERSONA, /*CODIGOCLIENTE*/NUMDOC); --5.0
	CREATE INDEX IX_TEMP_ITF_DEBITIA_DEUDAS_PR_NUMEROPERSONA_CODIGOCLIENTE ON #TEMP_ITF_DEBITIA_DEUDAS_PR(NUMEROPERSONA, /*CODIGOCLIENTE*/NUMDOC); --5.0
END
BEGIN --deudas TC
	SELECT c.JTS_OID,
		   c.NUMEROPERSONA,
		   c.CODIGOCLIENTE,
		   c.memo_Suc_Cliente AS CTag9,
			tma.DESCRIPCION AS Product,
			concat('TC','-',c.SALDOS_SUCURSAL,'-',memu.USUARIO,'-',0,'-', FORMAT(tjs.FECHA_VTO, 'yyyy-MM-dd')
			) AS Reference,
			CASE 	WHEN tjs.DIAS_ATRASO &lt;&gt; 0 THEN FORMAT((p.FECHAPROCESOANTERIOR - tjs.DIAS_ATRASO), 'MM/dd/yyyy') --CDS-1637 --tjs.FECHA_VTO
					WHEN tjs.DIAS_ATRASO = 0 AND tjs.COD_CANCELACION = 0 AND tjs.FECHA_VTO &lt;= p.FECHAPROCESO THEN  FORMAT(tjs.FECHA_VTO, 'MM/dd/yyyy')
					WHEN tjs.DIAS_ATRASO = 0 AND tjs.COD_CANCELACION = 0 AND tjs.FECHA_VTO &gt; p.FECHAPROCESO THEN  FORMAT(tjs.FECHA_VTO, 'MM/dd/yyyy')
					WHEN tjs.DIAS_ATRASO = 0 AND (tjs.saldo_mn_cierre + tjs.saldo_me_cierre) > 0 AND tjs.COD_CANCELACION = 1 AND tjs.FECHA_VTO > p.FECHAPROCESO THEN  FORMAT(tjs.FECHA_VTO, 'MM/dd/yyyy')
					WHEN tjs.DIAS_ATRASO = 0 AND (tjs.saldo_mn_cierre + tjs.saldo_me_cierre) > 0 AND tjs.COD_CANCELACION = 1  AND tjs.FECHA_VTO &lt;= p.FECHAPROCESO THEN  FORMAT(p.FECHAPROCESO, 'MM/dd/yyyy')
					WHEN tjs.DIAS_ATRASO = 0 AND (tjs.saldo_mn_cierre + tjs.saldo_me_cierre) &lt;= 0 AND (tjs.PAGO_MN + tjs.PAGO_ME) >= 0 AND tjs.COD_CANCELACION = 1 AND tjs.FECHA_VTO > p.FECHAPROCESO THEN  FORMAT(tjs.FECHA_VTO, 'MM/dd/yyyy') --1.5
					WHEN tjs.DIAS_ATRASO = 0 AND (tjs.saldo_mn_cierre + tjs.saldo_me_cierre) &lt;= 0 AND (tjs.PAGO_MN + tjs.PAGO_ME) >= 0 AND tjs.COD_CANCELACION = 1 AND tjs.FECHA_VTO &lt;= p.FECHAPROCESO THEN  FORMAT(p.FECHAPROCESO, 'MM/dd/yyyy') --1.5
					WHEN tjs.FECHA_VTO IS null THEN FORMAT(p.FECHAPROCESO, 'MM/dd/yyyy') ----CDS-1619
			END AS DueDate,
			'' AS DTag1,
			c.SALDO_DIARIO_TC AS DTag5,
			concat(/*CASE WHEN can.SALDO_JTS_OID IS NULL THEN 'Cuenta Operativa-Estado de la tarjeta: ' 
			            ELSE 'Cuenta Cancelada-Estado de la tarjeta: ' END,*/'Estado de la tarjeta:',
			       CASE WHEN MEMU.FECHA_BAJA_USU IS NULL THEN 'Operativa' 
			            ELSE concat('De baja - Fecha de Baja: ',ISNULL(FORMAT(MEMU.FECHA_BAJA_USU, 'dd/MM/yyyy'),'99999999')) END ,
			       '***Cuenta de cobro: ',CASE WHEN sc.CUENTA IS NULL THEN 'Inexistente' WHEN memu.TIPO_COBRO = 1 THEN 'Ninguno' WHEN memu.TIPO_COBRO = 2 THEN 'CA-' ELSE 'CC-' END,
			       sc.sucursal,'-',sc.CUENTA,
			       '***Estado', CASE WHEN sc.C1651 = '1' THEN 'Cancelada' WHEN sc.C1651 = ' ' THEN 'Activa' ELSE '' END,'-', 
			       CASE WHEN isnull(memu.JTS_CUENTA_COBRO,0) = 0 THEN '' --1.1
			            WHEN sc.C1679 = 0 THEN'***Sin bloqueos' 
			            ELSE concat('***Bloqueada - ',g.COD_BLOQUEO,'-',g.DESCRIPCION) END ,
			       '***Total resumen ($): ',tjs.SALDO_MN,
			       '- Total resumen (USD): ',tjs.SALDO_ME,
			       '- Vto del ultimo resumen: ',convert(VARCHAR,tjs.FECHA_VTO,104)) AS DTag6,
			0 AS Quota,
			CASE WHEN TJS.COD_CANCELACION = 1 THEN 0 ELSE 
			     CASE WHEN TJS.FECHA_VTO > p.FECHAPROCESO AND TJS.DIAS_ATRASO = 0 THEN TJS.PAGO_MIN - TJS.PAGO_MN
			     	  WHEN TJS.PAGO_MIN - TJS.PAGO_MN &lt; 0 THEN 0
			          ELSE TJS.PAGO_MIN - TJS.PAGO_MN END  END AS Debit,
			0 AS Interest,
			0 AS Interest2,
			0 AS Punitive,
			0 AS DeferredIncome,
			concat('TC','-',memu.ADMINISTRADORA,'-',c.SALDOS_SUCURSAL,'-',memu.USUARIO,'-0-0-',CONVERT(VARCHAR,tjs.FECHA_VTO,112)) AS DID
			,CASE WHEN tjs.SALDO_MN > 0 THEN 1 ELSE 0 END AS TIENE_DEUDA
			,CASE	WHEN  memu.TIPO_TJC = 'R' THEN 0
					WHEN tjs.DIAS_ATRASO > 0 and tjs.cod_cancelacion = 0  THEN ((((CASE WHEN tjs.SALDO_ME_CIERRE &lt;= 0 THEN 0 ELSE tjs.SALDO_ME_CIERRE END) * me.TCVENTACOMUN) + (CASE WHEN tjs.SALDO_MN_CIERRE &lt;= 0 THEN 0 ELSE tjs.SALDO_MN_CIERRE END)) - tjs.PAGO_MIN)
				    WHEN tjs.DIAS_ATRASO = 0 AND tjs.FECHA_VTO > P.FECHAPROCESO AND tjs.cod_cancelacion = 0 THEN ((((CASE WHEN tjs.SALDO_ME_CIERRE &lt;= 0 THEN 0 ELSE tjs.SALDO_ME_CIERRE END) * me.TCVENTACOMUN) + (CASE WHEN tjs.SALDO_MN_CIERRE &lt;= 0 THEN 0 ELSE tjs.SALDO_MN_CIERRE END)) - (tjs.PAGO_MN + (tjs.PAGO_ME* me.TCVENTACOMUN)))
					WHEN  tjs.COD_CANCELACION = 1 THEN (((CASE WHEN tjs.SALDO_ME_CIERRE &lt;= 0 THEN 0 ELSE tjs.SALDO_ME_CIERRE END) * me.TCVENTACOMUN) + (CASE WHEN tjs.SALDO_MN_CIERRE &lt;= 0 THEN 0 ELSE tjs.SALDO_MN_CIERRE END)) - (tjs.PAGO_MN + (tjs.PAGO_ME* me.TCVENTACOMUN))
					WHEN (tjs.PAGO_MN - CASE WHEN tjs.SALDO_MN_CIERRE &lt;= 0 THEN 0 ELSE tjs.SALDO_MN_CIERRE END) + ((tjs.PAGO_ME - CASE WHEN tjs.SALDO_ME_CIERRE &lt;= 0 THEN 0 ELSE  tjs.SALDO_ME_CIERRE END)* me.TCVENTACOMUN) >= 0 THEN 0
					ELSE (((CASE WHEN tjs.SALDO_ME_CIERRE &lt;= 0 THEN 0 ELSE tjs.SALDO_ME_CIERRE END) * me.TCVENTACOMUN) + (CASE WHEN tjs.SALDO_MN_CIERRE &lt;= 0 THEN 0 ELSE tjs.SALDO_MN_CIERRE END)) - (tjs.PAGO_MN + (tjs.PAGO_ME* me.TCVENTACOMUN)) --- tjs.PAGO_MIN
				END AS CTAG10
			  ,p.FECHAPROCESO
			  , c.CID AS NUMDOC --5.0
			INTO #TEMP_ITF_DEBITIA_DEUDAS_TC
	FROM #TEMP_ITF_DEBITIA_CUENTAS c
	JOIN TJC_MAESTRO_USUARIO memu WITH (NOLOCK) ON memu.JTS_SALDO_TARJETA = c.JTS_OID
	JOIN TJC_SALDOS tjs WITH (NOLOCK) ON tjs.ADMINISTRADORA = memu.ADMINISTRADORA AND tjs.USUARIO = memu.USUARIO
	JOIN TJC_MAESTRO_ADMINISTRADORAS tma WITH (NOLOCK) ON tma.COD_ADMINISTRADORA = tjs.ADMINISTRADORA AND tma.tz_lock = 0
	LEFT JOIN saldos sc WITH (NOLOCK) ON memu.JTS_CUENTA_COBRO = SC.jts_oid
	LEFT JOIN (
					SELECT V.SALDO_JTS_OID,V.COD_BLOQUEO, GG.DESCRIPCION, row_number() OVER (PARTITION BY V.SALDO_JTS_OID ORDER BY V.COD_BLOQUEO) AS row 
					FROM GRL_BLOQUEOS V WITH (NOLOCK)
						JOIN GRL_COD_BLOQUEOS GG ON GG.COD_BLOQUEO = V.COD_BLOQUEO 
						WHERE V.TZ_LOCK = 0 AND V.estado &lt;&gt; 2
			  ) G ON G.SALDO_JTS_OID = sc.JTS_OID AND g.row = 1
	JOIN monedas me WITH (NOLOCK) ON me.C6399 = 2
	LEFT JOIN (
		SELECT ADMINISTRADORA,USUARIO /*, PERIODO_DEUDA*/, MIN(FECHA_VTO) AS H_FECHA_VTO
		FROM TJC_HISTORICO_PAGOS WITH (NOLOCK)
		WHERE (SALDO_MN + SALDO_ME) > 0
		GROUP BY ADMINISTRADORA,USUARIO /*, PERIODO_DEUDA*/ --CDS-1637
	) hp ON tjs.ADMINISTRADORA = hp.ADMINISTRADORA AND hp.USUARIO = tjs.USUARIO /*AND hp.PERIODO_DEUDA = tjs.PERIODO_DEUDA*/ --CDS-1637
	LEFT JOIN CV_CANCELACION_CUENTAS can WITH (NOLOCK) ON can.SALDO_JTS_OID = sc.JTS_OID AND CAN.TZ_LOCK = 0 AND can.estado IN ('C','F')
	CROSS JOIN PARAMETROS p WITH (NOLOCK)
	WHERE c.TIPO_CUENTA = 'TC' --AND memu.fecha_baja_usu IS NULL
	  AND NOT (MEMU.FECHA_BAJA_USU IS NOT NULL
	  	AND c.SALDO_DIARIO_TC = 0)
	
	UPDATE #TEMP_ITF_DEBITIA_DEUDAS_TC
	SET CTAG10 = 0
	WHERE CTAG10 &lt; 0

	CREATE INDEX IX_TEMP_ITF_DEBITIA_DEUDAS_TC_JTS_OID_NUMEROPERSONA_CODIGOCLIENTE ON #TEMP_ITF_DEBITIA_DEUDAS_TC(JTS_OID,NUMEROPERSONA,/*CODIGOCLIENTE*/NUMDOC); --5.0
	CREATE INDEX IX_TEMP_ITF_DEBITIA_DEUDAS_TC_NUMEROPERSONA_CODIGOCLIENTE ON #TEMP_ITF_DEBITIA_DEUDAS_TC(NUMEROPERSONA,/*CODIGOCLIENTE*/NUMDOC); --5.0
END

BEGIN --Busco solo clientes que tengan alguna deuda
	SELECT DISTINCT c.NUMEROPERSONA, c.CID AS NUMDOC--c.CODIGOCLIENTE --5.0
	INTO #TEMP_ITF_DEBITIA_PERSONA_CON_DEUDA
	FROM #TEMP_ITF_DEBITIA_CUENTAS c
	LEFT JOIN #TEMP_ITF_DEBITIA_DEUDAS_CC cc ON c.NUMEROPERSONA = cc.NUMEROPERSONA AND c.CID = cc.NUMDOC --5.0
	LEFT JOIN #TEMP_ITF_DEBITIA_DEUDAS_PR pr ON c.NUMEROPERSONA = pr.NUMEROPERSONA AND c.CID = pr.NUMDOC --5.0
	LEFT JOIN #TEMP_ITF_DEBITIA_DEUDAS_TC tc ON c.NUMEROPERSONA = tc.NUMEROPERSONA AND c.CID = tc.NUMDOC --5.0
	WHERE cc.TIENE_DEUDA = 1 OR pr.TIENE_DEUDA = 1 OR tc.TIENE_DEUDA = 1
	
	CREATE INDEX IX_TEMP_ITF_DEBITIA_PERSONA_CON_DEUDA_NUMEROPERSONA_CODIGOCLIENTE ON #TEMP_ITF_DEBITIA_PERSONA_CON_DEUDA(NUMEROPERSONA, NUMDOC /*,CODIGOCLIENTE*/); --5.0
END

BEGIN -- total deudas	
	SELECT 	JTS_OID, NUMEROPERSONA,CODIGOCLIENTE,CTag9,Product,Reference,DueDate,DTag1,DTag5,DTag6,Quota,Debit,Interest,Interest2,Punitive,DeferredIncome,DID,CTAG11,CTag10
	        , NUMDOC
    INTO #TEMP_ITF_DEBITIA_TOTAL_DEUDAS
	FROM (
	SELECT 	CC.JTS_OID, CC.NUMEROPERSONA,CC.CODIGOCLIENTE,CC.CTag9,CC.Product,CC.Reference,CC.DueDate,CC.DTag1,CC.DTag5,CC.DTag6,CC.Quota,CC.Debit,CC.Interest,CC.Interest2,CC.Punitive,CC.DeferredIncome,CC.DID
			, CASE  WHEN CC.C1604&lt;0 AND CC.SUMATORIA_ACUERDO >= (CC.C1604*-1)  THEN 0
					WHEN CC.C1604&lt;0 AND CC.SUMATORIA_ACUERDO &lt;  (CC.C1604*-1) THEN (CC.C1604*-1) - CC.SUMATORIA_ACUERDO
					ELSE 0
			END  AS CTAG11
			, CASE  WHEN CC.C1604&lt;0 AND CC.SUMATORIA_ACUERDO >= (CC.C1604*-1)  THEN CC.SUMATORIA_ACUERDO - (CC.C1604*-1)
					WHEN CC.C1604&lt;0 AND CC.SUMATORIA_ACUERDO &lt;  (CC.C1604*-1) THEN 0 --CC.SUMATORIA_ACUERDO --5.1
					ELSE 0 
				END AS CTAG10
			, PD.NUMDOC --5.0
	FROM #TEMP_ITF_DEBITIA_DEUDAS_CC CC
	JOIN #TEMP_ITF_DEBITIA_PERSONA_CON_DEUDA PD ON PD.NUMEROPERSONA = CC.NUMEROPERSONA AND PD.NUMDOC = CC.NUMDOC --PD.CODIGOCLIENTE=CC.CODIGOCLIENTE --5.0
	UNION ALL
	SELECT 	PR.JTS_OID, PR.NUMEROPERSONA,PR.CODIGOCLIENTE,PR.CTag9,PR.Product,PR.Reference,PR.DueDate,PR.DTag1,PR.DTag5,PR.DTag6,PR.Quota,PR.Debit,PR.Interest,PR.Interest2,PR.Punitive,PR.DeferredIncome,PR.DID
			,CONVERT(NUMERIC(20,2),ROUND((CASE WHEN PR.TOTAL_CAPITAL_SIN_VENCER = 0 THEN Debit + Interest + Interest2 + Punitive + DeferredIncome ELSE 0 END) * PR.TipoCambio,2)) AS CTAG11 --CDS-3044
			,CONVERT(NUMERIC(20,2),ROUND(PR.TOTAL_CAPITAL_SIN_VENCER * PR.TipoCambio,2)) AS CTAG10 --CDS-3044
			, PD.NUMDOC --5.0
	FROM #TEMP_ITF_DEBITIA_DEUDAS_PR PR
	JOIN #TEMP_ITF_DEBITIA_PERSONA_CON_DEUDA PD ON PD.NUMEROPERSONA = PR.NUMEROPERSONA AND PD.NUMDOC = PR.NUMDOC --PR.CODIGOCLIENTE=PD.CODIGOCLIENTE --5.0
	UNION ALL 
	SELECT 	TC.JTS_OID, TC.NUMEROPERSONA,TC.CODIGOCLIENTE,TC.CTag9,TC.Product,TC.Reference,TC.DueDate,TC.DTag1,TC.DTag5,TC.DTag6,TC.Quota,TC.Debit,TC.Interest,TC.Interest2,TC.Punitive,TC.DeferredIncome,TC.DID
			,(CASE WHEN DueDate &lt;= FECHAPROCESO THEN TC.Debit ELSE 0 END) AS CTAG11
			,CONVERT(NUMERIC(20,2),ROUND(TC.CTAG10,2)) AS CTAG10 --CDS-3044
			, PD.NUMDOC --5.0
	FROM #TEMP_ITF_DEBITIA_DEUDAS_TC TC
	JOIN #TEMP_ITF_DEBITIA_PERSONA_CON_DEUDA PD ON PD.NUMEROPERSONA = TC.NUMEROPERSONA AND PD.NUMDOC = TC.NUMDOC --PD.CODIGOCLIENTE=TC.CODIGOCLIENTE --5.0
	) D

	CREATE INDEX IX_TEMP_ITF_DEBITIA_TOTAL_DEUDAS_JTS_OID_NUMEROPERSONA_CODIGOCLIENTE ON #TEMP_ITF_DEBITIA_TOTAL_DEUDAS(JTS_OID,NUMEROPERSONA , NUMDOC/*CODIGOCLIENTE*/); --5.0
END

	SELECT 	c.CID AS '"CID"'
			,c.Number AS '"Number"'
			,replace(c.Name,',','.') AS '"Name"'
			,c.CTag1 AS '"CTag1"'
			,replace(c.CTag2,',',' ') AS '"CTag2"'
			,c.CTag3 AS '"CTag3"'
			,convert(VARCHAR,c.CTag4) AS '"CTag4"'
			,convert(VARCHAR,c.CTag5) AS '"CTag5"'
			,c.CTag6 AS '"CTag6"'
			,c.CTag7 AS '"CTag7"'
			,c.CTag8 AS '"CTag8"'
			,convert(VARCHAR,d.CTag9) AS '"CTag9"'
			,c.Email1 AS '"Email1"'
			,c.Phone1 AS '"Phone1"'
			,c.Phone2 AS '"Phone2"'
			,replace(d.Product,',',' ') AS '"Product"'
			,d.Reference AS '"Reference"'
			,d.DueDate AS '"DueDate"'
			,c.currency AS '"Currency"'
			,replace(d.DTag1,',',' ') AS '"DTag1"'
			,c.Dtag2 AS '"DTag2"'
			,convert(VARCHAR,c.DTag4) AS '"DTag4"'
			,convert(VARCHAR,d.DTag5) AS '"DTag5"'
			,replace(d.DTag6,',','.') AS '"DTag6"'
			,convert(VARCHAR,d.Quota)AS '"Quota"'
			,convert(VARCHAR,d.Debit) AS '"Debit"'
			,convert(VARCHAR,d.Interest) AS '"Interest"'
			,convert(VARCHAR,d.Interest2) AS '"Interest2"'
			,convert(VARCHAR,d.Punitive) AS '"Punitive"'
			,convert(VARCHAR,d.DeferredIncome) AS '"DeferredIncome"'
			,d.DID AS '"DID"'
			,convert(VARCHAR,dt.CTAG11) AS '"CTag11"'
			,convert(VARCHAR,dt.CTag10) AS '"CTag10"'
			,convert(VARCHAR,dt.CTAG11+dt.CTag10) AS '"CTag12"'
			,'${Top.Output}/DEBITIA/Deuda_Debitia' AS RUTA
	FROM #TEMP_ITF_DEBITIA_CUENTAS c
	JOIN #TEMP_ITF_DEBITIA_TOTAL_DEUDAS d ON c.jts_oid = d.jts_oid AND d.numeropersona= c.NUMEROPERSONA AND c.CID = d.NUMDOC --5.0
	JOIN (
			SELECT NUMDOC, sum(CTAG11) AS CTAG11, sum(CTAG10) AS CTAG10  --5.0
			FROM #TEMP_ITF_DEBITIA_TOTAL_DEUDAS
			GROUP BY NUMDOC --CODIGOCLIENTE --5.0
	)AS dt ON dt.NUMDOC = d.NUMDOC --dt.CODIGOCLIENTE = d.CODIGOCLIENTE --5.0
	
BEGIN --borro temporales
	DROP TABLE #TEMP_ITF_DEBITIA_CUENTAS
	DROP TABLE #TEMP_ITF_DEBITIA_DEUDAS_CC
	DROP TABLE #TEMP_ITF_DEBITIA_DEUDAS_PR
	DROP TABLE #TEMP_ITF_DEBITIA_DEUDAS_TC
	DROP TABLE #TEMP_ITF_DEBITIA_PERSONA_CON_DEUDA
	DROP TABLE #TEMP_ITF_DEBITIA_TOTAL_DEUDAS
	DROP TABLE #TMP_MEMO_DETALLE
	DROP TABLE #TMP_MEMO_CABECERA
END

SET ANSI_WARNINGS ON</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Text file output</name>
    <type>TextFileOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <separator>,</separator>
    <enclosure/>
    <enclosure_forced>N</enclosure_forced>
    <enclosure_fix_disabled>N</enclosure_fix_disabled>
    <header>Y</header>
    <footer>N</footer>
    <format>DOS</format>
    <compression>None</compression>
    <encoding>UTF-8</encoding>
    <endedLine/>
    <fileNameInField>Y</fileNameInField>
    <fileNameField>RUTA</fileNameField>
    <create_parent_folder>Y</create_parent_folder>
    <file>
      <name>${Top.Output}AMCO/CAJA DE AHORRO#MENSUAL</name>
      <servlet_output>N</servlet_output>
      <do_not_open_new_file_init>Y</do_not_open_new_file_init>
      <extention>csv</extention>
      <append>N</append>
      <split>N</split>
      <haspartno>N</haspartno>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <SpecifyFormat>N</SpecifyFormat>
      <date_time_format/>
      <add_to_result_filenames>Y</add_to_result_filenames>
      <pad>N</pad>
      <fast_dump>N</fast_dump>
      <splitevery>0</splitevery>
    </file>
    <fields>
      <field>
        <name>"CID"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"Number"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"Name"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"CTag1"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"CTag2"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"CTag3"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"CTag4"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"CTag5"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"CTag6"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"CTag7"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"CTag8"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"CTag9"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"Email1"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"Phone1"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"Phone2"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"Product"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"Reference"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"DueDate"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"Currency"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"DTag1"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"DTag2"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"DTag4"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"DTag5"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"DTag6"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"Quota"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"Debit"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"Interest"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"Interest2"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"Punitive"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"DeferredIncome"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"CTag11"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"CTag10"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"CTag12"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>"DID"</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <trim_type>none</trim_type>
        <length>-1</length>
        <precision>-1</precision>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
  <attributes/>
</transformation>
