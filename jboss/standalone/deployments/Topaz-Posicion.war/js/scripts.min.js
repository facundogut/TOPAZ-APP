function close_disabledPageModal(){$("#disabledPageMask").fadeOut(200),$("#disabledPageModalContainer").fadeOut(200)}function show_disabledPageModal(){var a=document.body,b=document.documentElement,c=Math.max(a.scrollHeight,a.offsetHeight,b.clientHeight,b.scrollHeight,b.offsetHeight);$("#disabledPageMask").css({height:c+"px"}),$("#disabledPageMask").css({display:"block",opacity:0}),$("#disabledPageModalContainer").css({display:"block",opacity:0}),$("#disabledPageModalContainer").fadeTo(200,1),$("#disabledPageMask").fadeTo(200,.8),$("#disabledPageModal").fadeIn(200)}function close_helpsModal(){$("#mask").fadeOut(200),$("#helpsModalContainer").fadeOut(200),$(".modal_window").fadeOut(200),$("body").css({overflow:"visible"}),$("#addFilterBtn").css({display:"none"}),$("#removeFilterBtn").css({display:"none"})}function show_helpsModal(){$("body").css({overflow:"hidden"}),$("#mask").css({display:"block",opacity:0}),$("#helpsModalContainer").css({display:"block",opacity:0}),$("#helpsModalContainer").fadeTo(200,1),$("#mask").fadeTo(200,.8),$("#helpModal").fadeIn(200),$("#helpTableContainer").html('<table class="helpTable table table-hover dataTable no-footer "></table>'),$("#helpsModalContainer").animate({scrollTop:0,scrollLeft:0},0)}function close_filterModal(){$("#filterMask").fadeOut(200),$("#filterModalContainer").fadeOut(200)}function show_filterModal(){$("body").css({overflow:"hidden"}),$("#filterMask").css({display:"block",opacity:0}),$("#filterModalContainer").css({display:"block",opacity:0}),$("#filterModalContainer").fadeTo(200,1),$("#filterMask").fadeTo(200,.8),$("#filterModal").fadeIn(200),$("#filterModalContainer").animate({scrollTop:0,scrollLeft:0},0)}function close_imagesModal(){$("#mask").fadeOut(500),$("#imagesModalContainer").fadeOut(500),$(".modal_window").fadeOut(500),$("body").css({overflow:"visible"})}function show_imagesModal(a){$("body").css({overflow:"hidden"}),$("#mask").css({display:"block",opacity:0}),$("#imagesModalContainer").css({display:"block",opacity:0}),$("#imagesModalContainer").fadeTo(200,1),$("#mask").fadeTo(200,.8),$("#imageModal").fadeIn(200),$("#imageModal").html(a),$("#imagesModalContainer").animate({scrollTop:0,scrollLeft:0},0)}App.ErrorData=Ember.Object.extend({title:null,iconImage:"error.png",isCollapsed:!1,errors:null}),App.Attribute=Ember.Object.extend({label:null,key:null,value:null,tooltip:null,help:null}),App.KeyValuePair=Ember.Object.extend({key:null,value:null}),App.SingleValue=Ember.Object.extend({value:null}),App.Cell=Ember.Object.extend({value:null,row:null,column:null,parentFrame:null}),App.Column=Ember.Object.extend({key:null,header:null,columnSpan:1,hidden:!1,textAlign:null}),App.Row=Ember.Object.extend({values:null}),App.Link=Ember.Object.extend({name:null,to:null,parameters:null,enabledData:null}),App.FormField=Ember.Object.extend({key:null,label:null,value:null,columnSpan:1,hidden:!1}),App.GridsField=Ember.Object.extend({formData:null,gridData:null}),App.ErrorManager=Ember.Object.extend({setFrameTypeNotValidError:function(a,b,c){c.addError("El frame <strong>"+a+"</strong> es de tipo no válido: <strong>"+b+"</strong>")},setFrameNotFoundError:function(a,b){b.addError("El frame anidado <strong>"+a+"</strong> no existe.")},setLinkVisibilityError:function(a,b,c,d){d.addError("Hubo un error al evaluar la condición de visibilidad del link <strong>"+a+"</strong> del frame <strong>"+b+"</strong><br/> <br/><strong>"+c+"</strong>")},setPageParseError:function(a){a.addError("Hubo un error en el parse del json de la página")},setFrameParseError:function(a,b,c){c.addError("Hubo un error en el parse del json del frame <strong>"+a+"</strong><br/> <br/><strong>"+b+"</strong>")},setFrameDataError:function(a,b,c){c.addError("Hubo un error al interpretar los datos del frame <strong>"+a+"</strong><br/> <br/><strong>"+b+"</strong>")},setFilesParseError:function(a,b,c,d){d.addError("Hubo un error al obtener el archivo  del frame <strong>"+b+"</strong><br/> <br/><strong> indice: "+a+"</strong><br/> <br/><strong>"+c+"</strong>")}}),App.Frame=Ember.Object.extend({id:null,title:null,iconImage:null,loading:!0,service:null,links:null,page:null,isCollapsed:!1,isEnabled:!1,enabledData:null,parseFrameGenericData:function(a){var b=null;if(a.links){b=[];for(var c=0;c<a.links.length;c++){var d=App.Link.create({name:a.links[c].name,to:a.links[c].to,parameters:a.links[c].parameters,enabledData:a.links[c].enabled?a.links[c].enabled:null});b.push(d)}}this.set("id",a.id),this.set("title",a.title),this.set("input",a.input);var e=a.mainFrame?Boolean(a.mainFrame):!1;this.set("isMainFrame",e),this.set("links",b),this.set("templateName",a.type+"FrameView");var f=a.enabled?a.enabled:null;this.set("enabledData",f);var g=a.collapsed?Boolean(a.collapsed):!1;this.set("isCollapsed",g);var h=a.icon?a.icon:"default.png";this.set("iconImage",h)},getInputParameters:function(){for(var a="",b="",c=0;c<this.input.parameters.length;c++){var d=this.input.parameters[c];if(a+=d+",","service"===this.input.type){var e=this.page.getParameterValue(d);b+=e+","}else if("nested"===this.input.type){var e=this.page.getParameterValue(d,this.input.frameId);null==e&&(e=this.page.getParameterValue(d)),b+=e+","}}var f={ids:a,values:b};return f},resolveFrameDataInput:function(){if("service"===this.input.type)this.page.get("attributesLoaded")&&this.getFrameData();else if("nested"===this.input.type){var a=this.page.getFrame(this.input.frameId);null!=a?a.addDataSelectionObserver(this):this.page.addPendingObserver([this.input.frameId,this])}},updateOnDataSelectionChanged:function(){this.getFrameData()},checkFrameEnabled:function(){try{if(this.enabledData){var condition=this.enabledData.condition;if(this.enabledData.parameters)for(var i=0;i<this.enabledData.parameters.length;i++){var enabledParameter=this.enabledData.parameters[i],value;value="nested"===this.input.type?this.page.getParameterValue(enabledParameter,this.input.frameId):this.page.getParameterValue(enabledParameter),condition=condition.replace("#"+enabledParameter,"'"+value+"'")}this.set("isEnabled",eval(condition))}else this.set("isEnabled",!0)}catch(e){this.set("isEnabled",!1),this.page.addError("Hubo un error al evaluar la condición ("+this.enabledData.condition+") del frame "+this.id)}}}),App.FilesFrame=App.Frame.extend({columns:null,data:null,pageLength:0,fileInput:null,updateOnDataSelectionCleared:function(){this.set("data",null),this.checkFrameEnabled()},parseFrame:function(a){this.parseFrameGenericData(a),this.fileInput=a.filesProperties.fileInput;for(var b=0,c=a.filesProperties.columns.length,d=[],e=0;e<a.filesProperties.columns.length;e++){var f=a.filesProperties.columns[e],g=f.textAlign?f.textAlign:null,h=0,i=f.hidden?Boolean(f.hidden):!1;f.columnSpan&&!i?(h=Number(f.columnSpan),c--,b+=h):i&&c--,d.push(App.Column.create({key:f.value,header:f.header,columnSpan:h,hidden:i,textAlign:g}))}c>0&&this._calculateDefaultColumnSpan(d,b,c),this.set("columns",d);var j=a.filesProperties.pageLength?Number(a.filesProperties.pageLength):0;this.set("pageLength",j),this.resolveFrameDataInput()},_calculateDefaultColumnSpan:function(a,b,c){var d=11,e=d-b,f=Math.floor(e/c);0==f?(f=1,g=0):f>2&&(f=2*c>e?1:2);for(var g=e-f*c,h=null,i=0;i<a.length;i++){var j=a[i];j.hidden||(h=j,0==j.columnSpan&&(j.columnSpan=f))}g>0&&(h.columnSpan+=g)},getFrameData:function(){if(this.checkFrameEnabled(),this.isEnabled){var frame=this;frame.set("loading",!0);var parameters=this.getInputParameters();Ember.$.post(this.page.dataServiceUrl,{service:frame.input.service,serviceType:"simple",parameters:parameters.ids,values:parameters.values}).then(function(response){try{var data=jQuery.parseJSON(response)}catch(e){return App.ErrorManager.create().setFrameParseError(frame.id,response,frame.page),void frame.set("loading",!1)}try{var rows=[];for(j=0;j<data.length;j++){var dataValues=[];for(k=0;k<frame.columns.length;k++)dataValues.push(App.Cell.create({value:eval("data["+j+"]."+frame.columns[k].key),row:j,column:k,parentFrame:frame}));rows.push(App.Row.create({values:dataValues}))}frame.set("data",rows)}catch(e){App.ErrorManager.create().setFrameDataError(frame.id,response,frame.page)}frame.set("loading",!1)})}},getParameterValue:function(a,b){if(b>=0){for(var c=this.data[b],d=-1,e=0;e<this.columns.length;e++)if(this.columns[e].key===a){d=e;break}if(-1!=d)return c.values[d].value}return null}}),App.FormFrame=App.Frame.extend({data:null,updateOnDataSelectionCleared:function(){for(var a=0;a<this.data.length;a++)for(var b=this.data[a],c=0;c<b.length;c++)b[c].set("value",null);this.checkFrameEnabled()},parseFrame:function(a){this.parseFrameGenericData(a);for(var b=[],c=0;c<a.formProperties.data.length;c++){for(var d=a.formProperties.data[c],e=[],f=0;f<d.length;f++){var g=2,h=d[f].hidden?Boolean(d[f].hidden):!1;d[f].columnSpan&&!h&&(g=Number(d[f].columnSpan)),e.push(App.FormField.create({key:d[f].key,label:d[f].label,value:d[f].value,columnSpan:g,hidden:h}))}b.push(e)}this.set("data",b),this.resolveFrameDataInput()},getFrameData:function(){if(this.checkFrameEnabled(),this.isEnabled){var a=this;a.set("loading",!0);var b=this.getInputParameters();Ember.$.post(this.page.dataServiceUrl,{service:a.input.service,serviceType:"simple",parameters:b.ids,values:b.values}).then(function(b){try{var c=jQuery.parseJSON(b)}catch(d){return App.ErrorManager.create().setFrameParseError(a.id,b,a.page),void a.set("loading",!1)}try{if(c.length>0){a.isMainFrame&&a.page.set("mainFrameLoaded",!0),c=c[0];for(var e=0;e<a.data.length;e++)for(var f=a.data[e],g=0;g<f.length;g++)c[f[g].key]?f[g].set("value",c[f[g].key]):f[g].set("value","")}else{a.isMainFrame&&a.page.set("parametersError","No hay información para los datos ingresados.");for(var e=0;e<a.data.length;e++)for(var f=a.data[e],g=0;g<f.length;g++)f[g].set("value","")}}catch(d){App.ErrorManager.create().setFrameDataError(a.id,b,a.page)}a.set("loading",!1)})}},getParameterValue:function(a){for(var b=0;b<this.data.length;b++){var c=this.data[b].filter(function(b){return b.key===a});if(0!=c.length)return c[0].value?c[0].value:""}return null}}),App.GridFrame=App.Frame.extend({columns:null,data:null,pageLength:0,selectedIndex:-1,dataSelectionObservers:null,updateOnDataSelectionCleared:function(){this.set("data",null),this.checkFrameEnabled()},addDataSelectionObserver:function(a){null==this.dataSelectionObservers&&(this.dataSelectionObservers=[]),this.dataSelectionObservers.push(a)},onDataChanged:function(){this.set("selectedIndex",-1)}.observes("data"),onSelectionChanged:function(){if(null!=this.dataSelectionObservers)for(var a=0;a<this.dataSelectionObservers.length;a++)-1==this.selectedIndex?this.dataSelectionObservers[a].updateOnDataSelectionCleared():this.dataSelectionObservers[a].updateOnDataSelectionChanged()}.observes("selectedIndex"),parseFrame:function(a){this.parseFrameGenericData(a);for(var b=0,c=a.gridProperties.columns.length,d=[],e=0;e<a.gridProperties.columns.length;e++){var f=a.gridProperties.columns[e],g=f.textAlign?f.textAlign:null,h=0,i=f.hidden?Boolean(f.hidden):!1;f.columnSpan&&!i?(h=Number(f.columnSpan),c--,b+=h):i&&c--,d.push(App.Column.create({key:f.value,header:f.header,columnSpan:h,hidden:i,textAlign:g}))}c>0&&this._calculateDefaultColumnSpan(d,b,c),this.set("columns",d);var j=a.gridProperties.pageLength?Number(a.gridProperties.pageLength):0;this.set("pageLength",j),this.resolveFrameDataInput()},_calculateDefaultColumnSpan:function(a,b,c){var d=12,e=d-b,f=Math.floor(e/c);0==f?(f=1,g=0):f>2&&(f=2*c>e?1:2);for(var g=e-f*c,h=null,i=0;i<a.length;i++){var j=a[i];j.hidden||(h=j,0==j.columnSpan&&(j.columnSpan=f))}g>0&&(h.columnSpan+=g)},getFrameData:function(){if(this.checkFrameEnabled(),this.isEnabled){var frame=this;frame.set("loading",!0);var parameters=this.getInputParameters();Ember.$.post(this.page.dataServiceUrl,{service:frame.input.service,serviceType:"simple",parameters:parameters.ids,values:parameters.values}).then(function(response){try{var data=jQuery.parseJSON(response)}catch(e){return App.ErrorManager.create().setFrameParseError(frame.id,response,frame.page),void frame.set("loading",!1)}try{var rows=[];if(data.length>0){for(frame.isMainFrame&&frame.page.set("mainFrameLoaded",!0),j=0;j<data.length;j++){var dataValues=[];for(k=0;k<frame.columns.length;k++)dataValues.push(App.Cell.create({value:eval("data["+j+"]."+frame.columns[k].key),row:j,column:k,parentFrame:frame}));rows.push(App.Row.create({values:dataValues}))}frame.set("data",rows)}else frame.isMainFrame&&frame.page.set("parametersError","No hay información para los datos ingresados.")}catch(e){App.ErrorManager.create().setFrameDataError(frame.id,response,frame.page)}frame.set("loading",!1)})}},getParameterValue:function(a,b){if(b||0==b||(b=this.selectedIndex),-1!=b){for(var c=this.data[b],d=-1,e=0;e<this.columns.length;e++)if(this.columns[e].key===a){d=e;break}if(-1!=d)return c.values[d].value}return null}}),App.GridsFrame=App.Frame.extend({columns:null,headerForm:null,data:null,pageLength:0,updateOnDataSelectionCleared:function(){this.set("data",null),this.checkFrameEnabled()},parseFrame:function(a){this.parseFrameGenericData(a);for(var b=[],c=0;c<a.formProperties.data.length;c++){for(var d=a.formProperties.data[c],e=[],f=0;f<d.length;f++){var g=2,h=d[f].hidden?Boolean(d[f].hidden):!1;d[f].columnSpan&&!h&&(g=Number(d[f].columnSpan)),e.push(App.FormField.create({key:d[f].key,label:d[f].label,value:d[f].value,columnSpan:g,hidden:h}))}b.push(e)}this.set("headerForm",b);for(var i=0,j=a.gridProperties.columns.length,k=[],f=0;f<a.gridProperties.columns.length;f++){var l=a.gridProperties.columns[f],m=l.textAlign?l.textAlign:null,g=0,n=l.hidden?Boolean(l.hidden):!1;l.columnSpan&&!n?(g=Number(l.columnSpan),j--,i+=g):n&&j--,k.push(App.Column.create({key:l.value,header:l.header,columnSpan:g,hidden:n,textAlign:m}))}j>0&&this._calculateDefaultColumnSpan(k,i,j),this.set("columns",k);var o=a.gridProperties.pageLength?Number(a.gridProperties.pageLength):0;this.set("pageLength",o),this.resolveFrameDataInput()},_calculateDefaultColumnSpan:function(a,b,c){var d=12,e=d-b,f=Math.floor(e/c);0==f?(f=1,g=0):f>2&&(f=2*c>e?1:2);for(var g=e-f*c,h=null,i=0;i<a.length;i++){var j=a[i];j.hidden||(h=j,0==j.columnSpan&&(j.columnSpan=f))}g>0&&(h.columnSpan+=g)},getFrameData:function(){if(this.checkFrameEnabled(),this.isEnabled){var frame=this;frame.set("loading",!0);var parameters=this.getInputParameters();Ember.$.post(this.page.dataServiceUrl,{service:frame.input.service,parameters:parameters.ids,values:parameters.values}).then(function(response){try{var dataGroups=jQuery.parseJSON(response)}catch(e){return App.ErrorManager.create().setFrameParseError(frame.id,response,frame.page),void frame.set("loading",!1)}try{if(dataGroups.length>0){frame.isMainFrame&&frame.page.set("mainFrameLoaded",!0);for(var data=[],z=0;z<dataGroups.length;z++){for(var group=dataGroups[z],formRows=[],i=0;i<frame.headerForm.length;i++){for(var dataRow=frame.headerForm[i],fields=[],j=0;j<dataRow.length;j++)group.DataValues[dataRow[j].key]&&fields.push(App.FormField.create({key:dataRow[j].key,label:dataRow[j].label,value:group.DataValues[dataRow[j].key],columnSpan:dataRow[j].columnSpan,hidden:dataRow[j].hidden}));formRows.push(fields)}var gridRows=[];for(j=0;j<group.Entity2s.Entity2.length;j++){var dataValues=[];for(k=0;k<frame.columns.length;k++)dataValues.push(App.Cell.create({value:eval("group.Entity2s.Entity2["+j+"]."+frame.columns[k].key),row:j,column:k,parentFrame:frame}));gridRows.push(App.Row.create({values:dataValues}))}data.push(App.GridsField.create({formData:formRows,gridData:gridRows}))}frame.set("data",data)}else frame.isMainFrame&&frame.page.set("parametersError","No hay información para los datos ingresados.")}catch(e){App.ErrorManager.create().setFrameDataError(frame.id,response,frame.page)}frame.set("loading",!1)})}},getParameterValue:function(a,b,c){for(var d=this.data[c],e=d.gridData[b],f=-1,g=0;g<this.columns.length;g++)if(this.columns[g].key===a){f=g;break}if(-1!=f)return e.values[f].value;for(var h=d.formData,g=0;g<h.length;g++){var i=h[g].filter(function(b){return b.key===a});if(0!=i.length)return i[0].value?i[0].value:""}return null}}),App.ImagesFrame=App.Frame.extend({data:null,updateOnDataSelectionCleared:function(){this.set("data",null),this.checkFrameEnabled()},parseFrame:function(a){this.parseFrameGenericData(a),this.resolveFrameDataInput()},getFrameData:function(){if(this.checkFrameEnabled(),this.isEnabled){var a=this;a.set("loading",!0);var b=(this.get("controller"),this.getInputParameters());Ember.$.post(this.page.dataServiceUrl,{service:a.input.service,serviceType:"simple",parameters:b.ids,values:b.values}).then(function(b){try{var c=jQuery.parseJSON(b)}catch(d){return App.ErrorManager.create().setFrameParseError(a.id,b,a.page),void a.set("loading",!1)}try{for(var e=6,f=[],g=[],h=0;h<c.length;h++){var i=c[h].FILENAME;g.push(i),(h+1)%e===0&&(f.push(g),g=[])}g.length>0&&f.push(g),a.set("data",f)}catch(d){App.ErrorManager.create().setFrameDataError(a.id,b,a.page)}a.set("loading",!1)})}},getParameterValue:function(){return null}}),App.Page=Ember.Object.extend({attributes:null,globalAttributes:[],frames:null,pendingFrames:[],errorData:null,dataServiceUrl:"MiddlewareService",mainFrameLoaded:!1,parametersError:null,init:function(){var a=App.ErrorData.create({title:"Errores",errors:Ember.A([])});this.set("errorData",a)},hasErrors:function(){return null!=this.errorData&&this.errorData.errors.length>0}.property("errorData.errors.[]"),addError:function(a){this.errorData.errors.addObject(a)},getData:function(a,b){var c=this;return Ember.$.post("DispatcherService?pageId="+c.id).then(function(d){if("error"==d)return!1;try{var e=jQuery.parseJSON(d),f=c.getPreviousPages(e,b);c.set("previousPages",f);var g=c.getAttributes(e,a);c.set("attributes",g);var h=[];if(h.push(App.Attribute.create({key:"USUARIO",value:userName})),c.set("globalAttributes",h),e.page.attributesService)return c.getServiceAttributes(e).then(function(a){for(var b=0;b<a.length;b++)c.globalAttributes.push(a[b]);var d=c.getFrames(c,e);return c.set("frames",d),!0});var i=c.getFrames(c,e);return c.set("frames",i),!0}catch(j){var k=App.ErrorData.create({title:"Errores",errors:Ember.A([])});return c.set("errorData",k),App.ErrorManager.create().setPageParseError(c),!0}})},onFramesChanged:function(){for(var a=[],b=0;b<this.pendingFrames.length;b++){var c=this.pendingFrames[b][0],d=this.getFrame(c);if(null!=d){var e=this.pendingFrames[b][1];d.addDataSelectionObserver(e),a.push(this.pendingFrames[b])}else App.ErrorManager.create().setFrameNotFoundError(c,this)}for(var b=0;b<a.length;b++){var f=this.pendingFrames.indexOf(a[b]);this.pendingFrames.splice(f,1)}}.observes("frames"),attributesLoaded:function(){if(null==this.attributes)return!1;for(var a=!0,b=0;b<this.attributes.length;b++)a=a&&""!==this.attributes[b].value;return a}.property("attributes"),showParametersPanel:function(){return null!=this.get("parametersError")||!this.get("attributesLoaded")}.property("attributesLoaded","parametersError"),showFrames:function(){return this.mainFrameLoaded&&this.get("attributesLoaded")&&null==this.get("parametersError")}.property("attributesLoaded","mainFrameLoaded","parametersError"),addPendingObserver:function(a){this.pendingFrames.push(a)},getFrame:function(a){if(null==this.frames)return null;var b=this.frames.filter(function(b){return b.id===a});return 0!=b.length?b[0]:null},getAttribute:function(a){var b=this.attributes.filter(function(b){return b.key==a});if(0!=b.length)return b[0];var c=this.globalAttributes.filter(function(b){return b.key==a});return 0!=c.length?c[0]:null},getParameterValue:function(a,b,c,d){if(b){var e=this.getFrame(b);if(null!=e){var f=e.getParameterValue(a,c,d);if(f||""===f)return f}}var g=this.attributes.filter(function(b){return b.key==a});if(0!=g.length)return g[0].value;var h=this.globalAttributes.filter(function(b){return b.key==a});return 0!=h.length?h[0].value:void 0},getServiceAttributes:function(a){for(var b="",c="",d=0;d<a.page.attributesService.parameters.length;d++){var e=this.getAttribute(a.page.attributesService.parameters[d]);if(e){var f=e.key;b+=f+",";var g=$.trim(e.value.toUpperCase());""===g&&(g=" "),c+=g+","}}return Ember.$.post(this.dataServiceUrl,{service:a.page.attributesService.service,serviceType:"simple",parameters:b,values:c}).then(function(a){var b=[];try{for(var c=jQuery.parseJSON(a),d=0;d<c.length;d++){var e=Object.keys(c[d])[0],f=App.Attribute.create({key:e,value:c[d][e]});b.push(f)}}catch(g){}return b})},getAttributes:function(a,b){for(var c=[],d=0;d<a.page.attributes.length;d++){var e=a.page.attributes[d],f=b[e.key];f||(f=e.defaultValue?e.defaultValue:"");var g=e.tooltip?e.tooltip:null,h=e.help?e.help:null,i=App.Attribute.create({label:e.label,key:e.key,value:f,tooltip:g,help:h});if(h){h.attribute=i,h.page=this,h.fields=[];for(var j=0;j<h.columns.length;j++){var k=h.columns[j];k.filter&&h.fields.push({description:k.header,value:k.value})}}c.push(i)}return c},getPreviousPages:function(a,b){try{for(var c=[],d=b.split("#"),e=0;e<d.length;e++){for(var f=d[e],g=f.split(":"),h=g[0],i=[],j=1;j<g.length;j+=2){var k={key:g[j],value:g[j+1]};i.push(k)}var l={title:h,attributes:i};c.push(l)}return c}catch(m){return[]}},getFrames:function(a,b){for(var c=[],d=null,e=!1,f=0;f<b.page.frames.length;f++){var g=b.page.frames[f];if(!a._isFrameDisabled(g.id,a.id)){var h=!0;if("Grid"==g.type?d=App.GridFrame.create({page:a}):"Form"==g.type?d=App.FormFrame.create({page:a}):"Images"==g.type?d=App.ImagesFrame.create({page:a}):"Grids"==g.type?d=App.GridsFrame.create({page:a}):"Files"==g.type?d=App.FilesFrame.create({page:a}):(h=!1,App.ErrorManager.create().setFrameTypeNotValidError(g.id,g.type,a)),h){var i=g.mainFrame?Boolean(g.mainFrame):!1;i&&(e=!0),d.parseFrame(g),c.push(d)}}}return e||a.set("mainFrameLoaded",!0),c},_isFrameDisabled:function(a,b){for(var c=0;c<disabledFrames.length;c++)if(disabledFrames[c].page==b&&disabledFrames[c].frameId==a)return!0;return!1},getPreviousPagesAndCurrentData:function(){var a=this.getPreviousPagesData();""!==a&&(a+="#"),a+=this.id;for(var b=0;b<this.attributes.length;b++)a+=":"+this.attributes[b].key+":"+this.attributes[b].value;return a},getPreviousPagesData:function(){for(var a="",b=0;b<this.previousPages.length;b++){a+=this.previousPages[b].title;for(var c=0;c<this.previousPages[b].attributes.length;c++)a+=":"+this.previousPages[b].attributes[c].key+":"+this.previousPages[b].attributes[c].value;a+="#"}return a=a.replace(/#$/,"")}}),App.IndexController=Ember.ObjectController.extend({queryParams:["response"],response:null}),App.PageController=Ember.ObjectController.extend({queryParams:["params","values","prev"],params:[],values:[],prev:[],actions:{logOutClick:function(){var a=this;Ember.$.post("LogoutServlet").then(function(){a.transitionToRoute("index")})}}}),App.FilesTableView=Em.View.extend({classNames:["table"],tagName:"table",didInsertElement:function(){var a=this.get("controller"),b=a.get("model"),c=this.get("context");if(c&&c.length>0){var d=c[0].values[0].parentFrame,e=[],f=[];e.push({sTitle:"Link",mData:"link"});for(var g=0;g<d.columns.length;g++)d.columns[g].hidden||e.push({sTitle:d.columns[g].header,mData:d.columns[g].key});for(var g=0;g<c.length;g++){var h={};h.link='<a class="downloadFile-btn"><i class="glyphicon glyphicon-download-alt"></i></a>';for(var i=0;i<c[g].values.length;i++)h[d.columns[c[g].values[i].column].key]=c[g].values[i].value;f.push(h)}var j=d.pageLength,k=[];k.push({aTargets:[0],sClass:"col-sm-1"});for(var i=1,g=0;g<d.columns.length;g++)d.columns[g].hidden||k.push(d.columns[g].textAlign?{aTargets:[i++],sClass:"text-"+d.columns[g].textAlign+" col-sm-"+d.columns[g].columnSpan}:{aTargets:[i++],sClass:"col-sm-"+d.columns[g].columnSpan});{this.$().dataTable({paging:0!=j&&c.length>j,pageLength:j,info:!1,ordering:!1,deferRender:!0,searching:!1,lengthChange:!1,responsive:!0,bProcessing:!0,aaData:f,aoColumns:e,bLengthChange:!1,dom:'t<"bottom"p><"clear">',aoColumnDefs:k,language:{lengthMenu:"Mostrando _MENU_registros por página",zeroRecords:"No hay registros",info:"Mostrando página _PAGE_ de _PAGES_",infoEmpty:"No hay registros disponibles",infoFiltered:"(filtrados de _MAX_ registros)",search:"Buscar:",loadingRecords:"Cargando...",processing:"Procesando...",thousands:".",paginate:{first:"Primera",last:"Última",previous:"Anterior",next:"Siguiente"}},createdRow:function(c,e,f){$("td a",c).on("click",{frame:d,index:f},function(){var c=$(this).find("i");c.removeClass("glyphicon-download-alt"),c.addClass("glyphicon-refresh glyphicon-refresh-animate");for(var e="",g="",h=0;h<d.fileInput.parameters.length;h++){var i=d.fileInput.parameters[h];e+=i+",";var j=b.getParameterValue(i,d.id,f);g+=j+","}Ember.$.post(d.page.dataServiceUrl,{service:d.fileInput.service,parameters:e,values:g}).then(function(b){try{var e=jQuery.parseJSON(b)}catch(g){return App.ErrorManager.create().setFilesParseError(f,d.id,b,d.page),c.addClass("glyphicon-download-alt"),void c.removeClass("glyphicon-refresh glyphicon-refresh-animate")}try{e=e[0].DataValues;var h=a.const.filesFolderUrl,i=e.ReportFileName;window.open(h+i,"_blank")}catch(g){App.ErrorManager.create().setFrameDataError(d.id,b,d.page)}c.addClass("glyphicon-download-alt"),c.removeClass("glyphicon-refresh glyphicon-refresh-animate")})})}})}}}}),App.FormFieldView=Ember.View.extend({classNameBindings:["columnSpan","defaultClass"],defaultClass:function(){return"col-xs-6"}.property(),columnSpan:function(){return"col-sm-"+this.get("context.columnSpan")}.property("context.columnSpan")}),App.FrameHeaderView=Ember.View.extend({frameIconStyle:function(){var a=this.get("context.loading");return a?"-animation: spin .7s infinite linear; -webkit-animation: spin2 .7s infinite linear;":"width:24px;height:24px;margin: 0px; background-image: url('images/icons/"+this.get("context.iconImage")+"')"}.property("context.iconImage","context.loading"),click:function(){var a=this.get("context");a.set("isCollapsed",!a.isCollapsed)}}),App.FrameLinksView=Ember.View.extend({didInsertElement:function(){this._super();var a=this.get("context");if(a.links&&"App.GridFrame"!=a.constructor.toString()){menuLinks=[];for(var b=this.get("controller"),c=b.get("model"),d=0;d<a.links.length;d++){var e=a.links[d],f=this.linkEnabled(e,a.id,a.page);f&&menuLinks.push({title:e.name,name:e.name,linkTo:e.to,frameId:a.id,parameters:e.parameters,fun:function(a){var d=a.data,e=disabledPages.filter(function(a){return a===d.linkTo});if(0!=e.length)show_disabledPageModal();else{for(var f=[],g=[],h=0;h<d.parameters.length;h++){var i=d.parameters[h];f.push('"'+i+'"');var j=c.getParameterValue(i,d.frameId);g.push('"'+j+'"')}var k='"'+c.getPreviousPagesAndCurrentData()+'"';b.transitionToRoute("/"+d.linkTo+"?params=["+f.toString()+"]&values=["+g.toString()+"]&prev="+k)}}})}var g=[];g.push(this),g.push(menuLinks),Ember.run.scheduleOnce("afterRender",g,function(){var a=this[0],b=this[1],c=a.get("element");$(c).find(".btnLinks").contextMenu(b)})}},linkEnabled:function(link,frameId,page){try{if(link.enabledData){var condition=link.enabledData.condition;if(link.enabledData.parameters)for(var j=0;j<link.enabledData.parameters.length;j++){var enabledParameter=link.enabledData.parameters[j],value=page.getParameterValue(enabledParameter,frameId);condition=condition.replace("#"+enabledParameter,"'"+value+"'")}return eval(condition)}return!0}catch(e){return App.ErrorManager.create().setLinkVisibilityError(link.name,frameId,link.enabledData.condition,page),!1}}}),App.TableView=Em.View.extend({classNames:["table","table-hover"],tagName:"table",didInsertElement:function(){var a=this.get("controller"),b=a.get("model"),c=this.get("context"),d=this;if(c&&c.length>0){for(var e=c[0].values[0].parentFrame,f=[],g=[],h=0;h<e.columns.length;h++)e.columns[h].hidden||f.push({sTitle:e.columns[h].header,mData:e.columns[h].key});for(var h=0;h<c.length;h++){for(var i={},j=0;j<c[h].values.length;j++)i[e.columns[c[h].values[j].column].key]=c[h].values[j].value;g.push(i)}for(var k=e.pageLength,l=[],j=0,h=0;h<e.columns.length;h++)e.columns[h].hidden||l.push(e.columns[h].textAlign?{aTargets:[j++],sClass:"text-"+e.columns[h].textAlign+" col-sm-"+e.columns[h].columnSpan}:{aTargets:[j++],sClass:"col-sm-"+e.columns[h].columnSpan});var m=this.$().dataTable({paging:0!=k&&c.length>k,pageLength:k,info:!1,ordering:!1,deferRender:!0,searching:!1,lengthChange:!1,responsive:!0,bProcessing:!0,aaData:g,aoColumns:f,bLengthChange:!1,dom:'t<"bottom"p><"clear">',aoColumnDefs:l,language:{lengthMenu:"Mostrando _MENU_registros por página",zeroRecords:"No hay registros",info:"Mostrando página _PAGE_ de _PAGES_",infoEmpty:"No hay registros disponibles",infoFiltered:"(filtrados de _MAX_ registros)",search:"Buscar:",loadingRecords:"Cargando...",processing:"Procesando...",thousands:".",paginate:{first:"Primera",last:"Última",previous:"Anterior",next:"Siguiente"}},createdRow:function(c,f,g){if(e.links){var h=$("td",c),i=$(this).parents(".grids-row"),j=-1;if(i){var k=i.parent();j=k.find(".grids-row").index(i)}for(var l=0;l<h.length;l++){for(var n=[],o=0;o<e.links.length;o++){var p=d.linkEnabled(e.links[o],e.id,g,j,e.page);p&&n.push({title:e.links[o].name,name:e.links[o].name,linkTo:e.links[o].to,group:j,frameId:e.id,row:g,parameters:e.links[o].parameters,fun:function(c){var d=c.data,e=disabledPages.filter(function(a){return a===d.linkTo});if(0!=e.length)show_disabledPageModal();else{for(var f=[],g=[],h=0;h<d.parameters.length;h++){var i=d.parameters[h];f.push('"'+i+'"');var j=b.getParameterValue(i,d.frameId,d.row,d.group);g.push('"'+j+'"')}var k='"'+b.getPreviousPagesAndCurrentData()+'"';a.transitionToRoute("/"+d.linkTo+"?params=["+f.toString()+"]&values=["+g.toString()+"]&prev="+k)}}})}n.length>0&&$(h[l]).contextMenu(n)}}$(c).on("click",{frame:e},function(){$(this);$(this).hasClass("selectedTR")?e.links||($(this).removeClass("selectedTR"),"App.GridFrame"===e.constructor.toString()&&e.set("selectedIndex",-1)):(m.$("tr.selectedTR").removeClass("selectedTR"),$(this).addClass("selectedTR"),"App.GridFrame"===e.constructor.toString()&&e.set("selectedIndex",Number(g)))}),$(c).on("contextmenu",{frame:e},function(){$(this).hasClass("selectedTR")&&($(this).removeClass("selectedTR"),"App.GridFrame"===e.constructor.toString()&&e.set("selectedIndex",-1))})}})}},linkEnabled:function(link,frameId,index,groupIndex,page){try{if(link.enabledData){for(var condition=link.enabledData.condition,j=0;j<link.enabledData.parameters.length;j++){var enabledParameter=link.enabledData.parameters[j],value=page.getParameterValue(enabledParameter,frameId,index,groupIndex);condition=condition.replace("#"+enabledParameter,"'"+value+"'")}return eval(condition)}return!0}catch(e){return App.ErrorManager.create().setLinkVisibilityError(link.name,frameId,link.enabledData.condition,page),!1}}}),App.GalleryView=Em.View.extend({classNames:["carousel","slide"],imageUrl:function(){return this.get("context").toString()}.property(),didInsertElement:function(){var a=this.get("controller"),b=(a.get("model"),this.get("context")),c=a.const.imagesFolderUrl,d=this.get("element"),e=d.id;b.length>1?$(d).find(".carousel-control").prop("href","#"+e):$(d).find(".carousel-control").css({display:"none"});for(var f="",g="active",h=0;h<b.length;h++){f+='<div class="item '+g+'"><div class="row">',g="";for(var i=0;i<b[h].length;i++)f+='<div class="col-sm-2 col-xs-4">',f+='<a class="activate_modal thumbnail"><img src="'+c+b[h][i]+'" alt="Image" class="img-responsive"></a>',f+="</div>";f+="</div></div>"}$(d).find(".carousel-inner").append(f),$(d).find(".activate_modal").click(function(){var a=$(this).children("img").attr("src"),b='<img src="'+a+'">';show_imagesModal(b)});var j=document.body,k=document.documentElement,l=Math.max(j.scrollHeight,j.offsetHeight,k.clientHeight,k.scrollHeight,k.offsetHeight);$("#mask").css({height:l+"px"}),$(d).carousel({interval:0})}}),App.DisabledPageModalView=Ember.View.extend({actions:{closeModal:function(){close_disabledPageModal()}}}),App.FilterModalView=Ember.View.extend({currentHelp:null,selectedOperator:null,selectedField:null,selectedValue:null,error:null,fields:function(){return null==this.currentHelp?[]:this.currentHelp.fields
}.property("currentHelp"),operators:[{description:"Comienza por",value:"1"},{description:"Contiene a",value:"2"},{description:"No contiene a",value:"3"},{description:"Igual",value:"4"},{description:"Distinto",value:"5"},{description:"Mayor",value:"6"},{description:"Mayor o igual",value:"7"},{description:"Menor",value:"8"},{description:"Menor o igual",value:"9"}],actions:{onFilterChange:function(){var a=this,b=this.get("parentView"),c=b.get("childViews").filter(function(a){return"parametersPanel"===a["class"]})[0];if(this.selectedValue&&this.selectedOperator&&this.selectedField){var d=c.getHelpParameters(this.currentHelp),e=d.parametersIds,f=d.parametersValues;e+="TIENEFILTRO,CAMPO,OPERADOR,VALOR",f+="1,",f+=this.selectedField+",",f+=this.selectedOperator+",",f+=$.trim(this.selectedValue.toUpperCase())+",",Ember.$.post(this.currentHelp.page.dataServiceUrl,{service:this.currentHelp.input.service,serviceType:"help",parameters:e,values:f}).then(function(b){try{var d=jQuery.parseJSON(b)[0].Entity2s.Entity2;0==d.length?a.set("error","El filtro no encontró ningún valor."):(a.set("error",null),a.currentHelp.values=d,$("#helpTableContainer").html('<table class="helpTable table table-hover dataTable no-footer "></table>'),c.drawHelp(a.currentHelp),$("#addFilterBtn").css({display:"none"}),$("#removeFilterBtn").css({display:"block"}),a.send("closeModal"))}catch(e){a.set("error","El filtro no encontró ningún valor.")}})}else this.selectedField?this.selectedOperator?this.selectedValue||this.set("error","Debe ingresar un valor."):this.set("error","Debe seleccionar un operador."):this.set("error","Debe seleccionar un campo.")},closeModal:function(){this.set("error",null),close_filterModal()}}}),App.HeaderView=Ember.View.extend({userName:function(){return userName}.property(),today:function(){var a=new Date,b=a.getDate(),c=a.getMonth()+1,d=a.getFullYear();return 10>b&&(b="0"+b),10>c&&(c="0"+c),b+"/"+c+"/"+d}.property()}),App.HelpsModalView=Ember.View.extend({didInsertElement:function(){this._super()},actions:{helpClose:function(){close_helpsModal();var a=this.get("parentView"),b=a.get("childViews").filter(function(a){return"filterModal"===a["class"]})[0];b.set("currentHelp",null),b.set("selectedOperator",null),b.set("selectedField",null),b.set("selectedValue",null)}}}),App.ImagesModalView=Ember.View.extend({didInsertElement:function(){this._super(),$("#mask").unbind("click"),$("#mask").click(function(){close_imagesModal(),$("#mask").unbind("click")}),$(".imagesModal").unbind("click"),$(".imagesModal").click(function(){close_imagesModal()}),$("#newWindowButton").unbind("click"),$("#newWindowButton").click(function(){var a=$("#imageModal img").attr("src");window.open(a,"_blank")})}}),App.ParameterHeaderView=Ember.View.extend({click:function(a){var b=$(a.currentTarget),c=b.parents(".parameter"),d=c.children(".parameterContent"),e=b.children(".parameterExpand"),f=e.children(".glyphicon");d.is(":visible")?(d.css("display","none"),f.addClass("glyphicon-chevron-down"),f.removeClass("glyphicon-chevron-up")):(d.css("display","block"),f.addClass("glyphicon-chevron-up"),f.removeClass("glyphicon-chevron-down"))}}),App.ParametersPanelView=Ember.View.extend({selectedPage:null,homePages:null,loading:!1,actions:{onParameterChange:function(){if(!this.get("loading")){this.set("loading",!0);for(var a=[],b=[],c=this.get("controller"),d=c.get("model"),e=0;e<d.attributes.length;e++){var f=d.attributes[e].key;a.push('"'+f+'"');var g=$.trim(d.attributes[e].value.toUpperCase());if(b.push('"'+g+'"'),!g&&0!=g||""==g)return void this.set("loading",!1)}var h='"'+d.getPreviousPagesData()+'"';this.isNewNavigation(a,b)?(d.set("parametersError",null),d.set("mainFrameLoaded",!1),c.transitionToRoute("/"+d.id+"?params=["+a.toString()+"]&values=["+b.toString()+"]&prev="+h)):this.set("loading",!1)}},parametersPanelButtonClick:function(){var a="arrow-menu-btn",b="parametersContainer";$("."+b).is(":visible")?($("."+b).removeClass("show"),$("."+a).removeClass("closeArrow"),$("."+b).addClass("hide"),$("."+a).addClass("openArrow")):($("."+b).removeClass("hide"),$("."+a).removeClass("openArrow"),$("."+b).addClass("show"),$("."+a).addClass("closeArrow"))},helpClick:function(a){var b=this,c=this.get("parentView"),d=c.get("childViews").filter(function(a){return"filterModal"===a["class"]})[0];d.set("currentHelp",a);var e=document.body,f=document.documentElement,g=Math.max(e.scrollHeight,e.offsetHeight,f.clientHeight,f.scrollHeight,f.offsetHeight);if($("#mask").css({height:g+"px"}),$("#filterMask").css({height:g+"px"}),$("#helpTitle").text("AYUDA DE "+a.attribute.label),a.input){$("#addFilterBtn").css({display:"block"});var h=[];h.push({title:"Agregar filtro",name:"Agregar filtro",fun:function(){show_filterModal()}}),$("#addFilterBtn").contextMenu(h);var i=[];i.push({title:"Modificar filtro",name:"Modificar filtro",fun:function(){show_filterModal()}}),i.push({title:"Quitar filtro",name:"Quitar filtro",fun:function(){d.set("selectedOperator",null),d.set("selectedValue",null),d.set("selectedField",null),$("#addFilterBtn").css({display:"block"}),$("#removeFilterBtn").css({display:"none"}),$("#helpTableContainer").html('<table class="helpTable table table-hover dataTable no-footer "></table>'),b.getHelpData(a)}}),$("#removeFilterBtn").contextMenu(i)}show_helpsModal(),a.input?this.getHelpData(a):this.drawHelp(a)}},getHelpData:function(a){var b=this,c=this.getHelpParameters(a),d=c.parametersIds,e=c.parametersValues;d+="TIENEFILTRO,CAMPO,OPERADOR,VALOR",e+="0, , , ,",Ember.$.post(a.page.dataServiceUrl,{service:a.input.service,serviceType:"help",parameters:d,values:e}).then(function(c){try{var d=jQuery.parseJSON(c)[0].Entity2s.Entity2;a.values=d,b.drawHelp(a)}catch(e){}})},getHelpParameters:function(a){for(var b="",c="",d=0;d<a.input.parameters.length;d++){var e=a.page.getAttribute(a.input.parameters[d]);if(e){var f=e.key;b+=f+",";var g=$.trim(e.value.toUpperCase());""===g&&(g=" "),c+=g+","}}return{parametersIds:b,parametersValues:c}},drawHelp:function(a){for(var b=this,c=[],d=[],e=0;e<a.columns.length;e++)a.columns[e].hidden||c.push({sTitle:a.columns[e].header,mData:a.columns[e].value});for(var e=0;e<a.values.length;e++){for(var f={},g=0;g<c.length;g++)f[c[g].mData]=a.values[e][c[g].mData];d.push(f)}for(var h=[],g=0,e=0;e<a.columns.length;e++)if(!a.columns[e].hidden){var i=a.columns[e].columnSpan?Number(a.columns[e].columnSpan):2;h.push({aTargets:[g++],sClass:"col-sm-"+i})}$(".helpTable").dataTable({paging:!1,pageLength:0,info:!1,ordering:!1,deferRender:!0,searching:!1,lengthChange:!1,responsive:!0,bProcessing:!0,aaData:d,aoColumns:c,bLengthChange:!1,dom:'t<"bottom"p><"clear">',aoColumnDefs:h,language:{lengthMenu:"Mostrando _MENU_registros por página",zeroRecords:"No hay registros",info:"Mostrando página _PAGE_ de _PAGES_",infoEmpty:"No hay registros disponibles",infoFiltered:"(filtrados de _MAX_ registros)",search:"Buscar:",loadingRecords:"Cargando...",processing:"Procesando...",thousands:".",paginate:{first:"Primera",last:"Última",previous:"Anterior",next:"Siguiente"}},createdRow:function(c,d,e){$(c).on("click",{help:a},function(){for(var c=0;c<a.valueColumns.length;c++){var d=a.valueColumns[c],f=a.values[e][d],g=a.page.getAttribute(d);g.set("value",f)}var h=b.get("parentView"),i=h.get("childViews").filter(function(a){return"filterModal"===a["class"]})[0];i.set("currentHelp",null),i.set("selectedOperator",null),i.set("selectedField",null),i.set("selectedValue",null),close_helpsModal()})}})},isNewNavigation:function(a,b){var c=this.get("controller");for(i=0;i<a.length;i++){var d=c.params.indexOf(a[i].substring(1,a[i].length-1));if('"'+c.values[d]+'"'!=b[i])return!0}return!1},watchSelectedPage:function(){null!=this.selectedPage&&this.get("controller").transitionToRoute("/"+this.selectedPage)}.observes("selectedPage"),didInsertElement:function(){this._super();var a=($("body").height(),$(window).height(),$(".header").height()),b=$(".footer").height();this.setFrameContainerMinHeight(),this.alturaPanel(a,a+b),$(".user-other-info").css("width","auto");var c=this;$(".frame-container").resize(function(){var a=$(".header").height();c.setFrameContainerMinHeight(),c.alturaPanel(a,a+b),$(".user-other-info").css("width","auto")}),this._populateHomePages()},setFrameContainerMinHeight:function(){{var a=$("body").height(),b=$(window).height(),c=$(".header").height(),d=$(".footer").height();parseInt($(".frame-container").css("padding-top"))}b>a&&$(".frame-container").css("min-height",b-(c+d))},alturaPanel:function(a,b){var c=$("body").height(),d=c-b;$(".parametersContainer").css({height:d}),$(".parametersPanel").css({top:a,height:d})},_populateHomePages:function(){var a=document.getElementById("homePages");if(a&&null!=pages)for(var b=0;b<pages.length;b++){var c=document.createElement("option");c.value=pages[b],c.text=pages[b],a.appendChild(c)}this.set("homePages",pages)}}),App.LoginView=Ember.View.extend({}),App.PageView=Ember.View.extend({}),App.FrameView=Ember.View.extend({}),App.GridFrameView=App.FrameView.extend({}),App.GridsFrameView=App.FrameView.extend({}),App.FormFrameView=App.FrameView.extend({}),App.ImagesFrameView=App.FrameView.extend({}),App.initializer({name:"app",initialize:function(a,b){b.register("constants:main",App.Constants,{singleton:!0,instantiate:!0}),b.inject("model","const","constants:main"),b.inject("controller","const","constants:main"),b.inject("view","const","constants:main")}}),App.Router.map(function(){this.resource("page",{path:":page_id"})}),App.PageRoute=Ember.Route.extend({queryParams:{values:{refreshModel:!0},params:{refreshModel:!0}},model:function(a){for(var b=a.page_id,c=a.params,d=a.values,e={},f=0;f<d.length;f++)e[c[f]]=d[f];var g=this,h=App.Page.create({id:b});return h.getData(e,a.prev).then(function(a){return a?h:void g.transitionTo("index")})}});