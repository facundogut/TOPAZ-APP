<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<map>
    <class>
        <class-name>topsystems.topaz.server.businesslogic.calculosDeIVA.objectsdomain.CargosIVA</class-name>
        <entity-name>core.vo.CargosIVA</entity-name>
        <table-name>CI_CARGOS_IVA</table-name>
        <database-name>TOP/CLIENTES</database-name>
        <attribute>
            <attribute-name>idCargo</attribute-name>
            <column-name>ID_CARGO</column-name>
            <key>primary</key>
        </attribute>
        <attribute>
            <attribute-name>codigo</attribute-name>
            <column-name>CODIGO</column-name>
        </attribute>
        <attribute>
            <attribute-name>campoMontoAdeudado</attribute-name>
            <column-name>CAMPO_MONTO_ADEUDADO</column-name>
        </attribute>
        <attribute>
            <attribute-name>campoMontoPagado</attribute-name>
            <column-name>CAMPO_MONTO_PAGADO</column-name>
        </attribute>
        <attribute>
            <attribute-name>campoMontoFinanciado</attribute-name>
            <column-name>CAMPO_MONTO_FINANCIADO</column-name>
        </attribute>
    </class>
    <class>
        <class-name>topsystems.topaz.server.businesslogic.calculosDeIVA.objectsdomain.PayIVADetail</class-name>
        <entity-name>core.vo.PayIVADetail</entity-name>
        <table-name>BS_PAYS_DETAIL_IVA</table-name>
        <database-name>TOP/CLIENTES</database-name>
        <attribute>
            <attribute-name>tz_lock</attribute-name>
            <column-name>tz_lock</column-name>
        </attribute>
        <attribute>
            <attribute-name>saldoJtsOid</attribute-name>
            <column-name>SALDOS_JTS_OID</column-name>
            <key>primary</key>
        </attribute>
        <attribute>
            <attribute-name>hPJtsOid</attribute-name>
            <column-name>HP_JTS_OID</column-name>
            <key>primary</key>
        </attribute>
        <attribute>
            <attribute-name>cuota</attribute-name>
            <column-name>CUOTA</column-name>
            <key>primary</key>
        </attribute>
        <attribute>
            <attribute-name>ivaInteres</attribute-name>
            <column-name>IVAINTERES</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaInteresPercepcion</attribute-name>
            <column-name>IVAINTERESPERCEPCION</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaSubsidio</attribute-name>
            <column-name>IVASUBSIDIO</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaSubsidioPercepcion</attribute-name>
            <column-name>IVASUBSIDIOPERCEPCION</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaMora</attribute-name>
            <column-name>IVAMORA</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaMoraPercepcion</attribute-name>
            <column-name>IVAMORAPERCEPCION</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaICMora</attribute-name>
            <column-name>IVAICMORA</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaICMoraPercepcion</attribute-name>
            <column-name>IVAICMORAPERCEPCION</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaFinanciado</attribute-name>
            <column-name>IVAFINANCIADO</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaPercepcionFinanciado</attribute-name>
            <column-name>IVAPERCEPCIONFINANCIADO</column-name>
        </attribute>
    </class>
    <class>
        <class-name>topsystems.topaz.server.businesslogic.calculosDeIVA.objectsdomain.PayIVAAConfirmar</class-name>
        <entity-name>core.vo.PayIVAAConfirmar</entity-name>
        <table-name>BS_PAYS_IVA_A_CONFIRMAR</table-name>
        <database-name>TOP/CLIENTES</database-name>
        <attribute>
            <attribute-name>tz_lock</attribute-name>
            <column-name>tz_lock</column-name>
        </attribute>
        <attribute>
            <attribute-name>nroasientomov</attribute-name>
            <column-name>NROASIENTOMOV</column-name>
            <key>primary</key>
        </attribute>
        <attribute>
            <attribute-name>ordinalAsiento</attribute-name>
            <column-name>ORDINALASIENTO</column-name>
            <key>primary</key>
        </attribute>
        <attribute>
            <attribute-name>fechaprocesomov</attribute-name>
            <column-name>FECHAPROCESOMOV</column-name>
            <key>primary</key>
        </attribute>
        <attribute>
            <attribute-name>sucursalmvto</attribute-name>
            <column-name>SUCURSALMVTO</column-name>
            <key>primary</key>
        </attribute>
        <attribute>
            <attribute-name>saldoJtsOid</attribute-name>
            <column-name>SALDOS_JTS_OID</column-name>
            <key>primary</key>
        </attribute>
        <attribute>
            <attribute-name>cuota</attribute-name>
            <column-name>CUOTA</column-name>
            <key>primary</key>
        </attribute>
        <attribute>
            <attribute-name>ivaInteres</attribute-name>
            <column-name>IVAINTERES</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaInteresFinan</attribute-name>
            <column-name>IVAINTERESFINAN</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaInteresPercepcion</attribute-name>
            <column-name>IVAINTERESPERCEPCION</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaInteresPercepcionFinan</attribute-name>
            <column-name>IVAINTERESPERCEPCIONFINAN</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaSubsidio</attribute-name>
            <column-name>IVASUBSIDIO</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaSubsidioFinan</attribute-name>
            <column-name>IVASUBSIDIOFINAN</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaSubsidioPercepcion</attribute-name>
            <column-name>IVASUBSIDIOPERCEPCION</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaSubsidioPercepcionFinan</attribute-name>
            <column-name>IVASUBSIDIOPERCEPCIONFINAN</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaMora</attribute-name>
            <column-name>IVAMORA</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaMoraPercepcion</attribute-name>
            <column-name>IVAMORAPERCEPCION</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaICMora</attribute-name>
            <column-name>IVAICMORA</column-name>
        </attribute>
        <attribute>
            <attribute-name>ivaICMoraPercepcion</attribute-name>
            <column-name>IVAICMORAPERCEPCION</column-name>
        </attribute>
    </class>
    <query>
        <class-name>topsystems.automaticprocess.calculosdelIVA.QueryIVAFinanciado</class-name>
        <query-name>query.QueryIVAFinanciado</query-name>
        <database-name>TOP/CLIENTES</database-name>
        <sentence>
					select 'UNO' TIPO, pp.saldo_jts_oid SALDOJTSOID, pp.c2300 CUOTA, pp.c2310 MONTOIMPONIBLE, s.C1728, s.C1729
					  from planpagos pp
					  INNER JOIN saldos s ON pp.SALDO_JTS_OID=s.JTS_OID
					  INNER JOIN productos p ON p.C6250=s.PRODUCTO
					 where 
					   S.C1785=5 AND 
					   (
					   	(s.C1728= 'N' AND s.C1729='V' and pp.c2302 &lt;= (select fechaproceso from parametros)) -- Vigentes no suspenso
					   	OR 
						(s.C1728= 'N' AND s.C1729 = 'S' AND pp.C2302 &lt; s.FCAMBIOESTADOSUSPENSO) -- Vigentes en suspenso
					   )
					   AND (p.C6800 &lt;&gt; 'CF' AND p.C6800 &lt;&gt; 'CR')
					   and pp.tz_lock = 0
					   AND s.TZ_LOCK=0
					   and pp.c2310 &gt; 0
					   and not exists (select ifxc.MONTO_IMPONIBLE from BS_IVA_FINANCIADO_POR_CUOTA ifxc
									   where ifxc.SALDO_JTS_OID = pp.saldo_jts_oid 
										 and ifxc.NUMERO_CUOTA = pp.c2300) 
					UNION
					select 'DOS' TIPO, pp.saldo_jts_oid SALDOJTSOID, pp.c2300 CUOTA, pp.c2310 MONTOIMPONIBLE, s.C1728, s.C1729
					  from planpagos pp
					  INNER JOIN saldos s ON pp.SALDO_JTS_OID=s.JTS_OID
					  INNER JOIN productos p ON p.C6250=s.PRODUCTO
					 where 
					   S.C1785=5 AND 
					   (
					   	(s.C1728= 'N' AND s.C1729='V' and pp.c2302 &lt;= (select fechaproceso from parametros))  -- Vigentes no suspenso
					   	OR 
						(s.C1728= 'N' AND s.C1729 = 'S' AND pp.C2302 &lt; s.FCAMBIOESTADOSUSPENSO) -- Vigentes en suspenso
					   )
					   AND (p.C6800 &lt;&gt; 'CF' AND p.C6800 &lt;&gt; 'CR')
					   AND pp.tz_lock = 0
					   and s.TZ_LOCK=0
					   and pp.c2310 &gt; 0
					   and exists (select ifxc.MONTO_IMPONIBLE from BS_IVA_FINANCIADO_POR_CUOTA ifxc
								   where ifxc.SALDO_JTS_OID = pp.saldo_jts_oid 
									 and ifxc.NUMERO_CUOTA = pp.c2300 
									 and ifxc.MONTO_IMPONIBLE &lt; pp.c2310)
						order by SALDOJTSOID, CUOTA
				</sentence>
        <attribute>
            <attribute-name>tipo</attribute-name>
            <column-name>TIPO </column-name>
            <column-type>String</column-type>
        </attribute>
        <attribute>
            <attribute-name>jtsOid</attribute-name>
            <column-name>SALDOJTSOID</column-name>
            <column-type>long</column-type>
        </attribute>
        <attribute>
            <attribute-name>numeroCuota</attribute-name>
            <column-name>CUOTA</column-name>
            <column-type>long</column-type>
        </attribute>
        <attribute>
            <attribute-name>montoImponible</attribute-name>
            <column-name>MONTOIMPONIBLE</column-name>
            <column-type>double</column-type>
        </attribute>
    </query>
    <class>
        <class-name>topsystems.automaticprocess.calculosdelIVA.VOIVAFinanciadoPorCuota</class-name>
        <entity-name>vo.IVAFinanciadoPorCuota</entity-name>
        <table-name>BS_IVA_FINANCIADO_POR_CUOTA</table-name>
        <database-name>TOP/CLIENTES</database-name>
        <attribute>
            <attribute-name>saldoJTS_OID</attribute-name>
            <column-name>SALDO_JTS_OID</column-name>
            <key>primary</key>
        </attribute>
        <attribute>
            <attribute-name>numeroCuota</attribute-name>
            <column-name>NUMERO_CUOTA</column-name>
            <key>primary</key>
        </attribute>
        <attribute>
            <attribute-name>fechaProceso</attribute-name>
            <column-name>FECHA_PROCESO</column-name>
        </attribute>
        <attribute>
            <attribute-name>montoImponible</attribute-name>
            <column-name>MONTO_IMPONIBLE</column-name>
        </attribute>
        <attribute>
            <attribute-name>IVAfinanciado</attribute-name>
            <column-name>IVA_FINANCIADO</column-name>
        </attribute>
        <attribute>
            <attribute-name>IVApercepcionFinanciado</attribute-name>
            <column-name>IVA_PERCEPCION_FINANCIADO</column-name>
        </attribute>
    </class>
</map>
