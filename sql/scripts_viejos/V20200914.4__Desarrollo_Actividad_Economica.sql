execute ('

CREATE VIEW VW_ACT_ECO_WS AS
SELECT  DISTINCT
COD_ACTIVIDAD,
DESCRIPCION,
PERIODO_ACTIVIDAD,
TIPO_ACTIVIDAD,
VERIFICADO_AFIP,
FECHA_VERIFICADO,
CODIGO_PERSONA,
TIPO_DOCUMENTO,
NUMERO_DOCUMENTO,
ORDINAL
FROM
(     

SELECT 
i.COD_ACTIVIDAD,
a.DESCRIPCION,
i.PERIODO AS PERIODO_ACTIVIDAD,
(CASE i.ORDEN
WHEN 1 THEN ''Primaria''
ELSE ''Secundaria''
END) AS TIPO_ACTIVIDAD,
''S'' AS VERIFICADO_AFIP,
(SELECT FECHAPROCESO FROM PARAMETROS) AS FECHA_VERIFICADO,
d.NUMEROPERSONAFJ AS CODIGO_PERSONA,
d.TIPODOCUMENTO AS TIPO_DOCUMENTO,
i.CUIL AS NUMERO_DOCUMENTO,
i.ORDEN AS ORDINAL
FROM ITF_AFIP_ACT_ECONOMICA i INNER JOIN CLI_Cod_Act_AFIP a ON i.COD_ACTIVIDAD=a.CODIGO_ACT_AFIP AND i.TZ_LOCK=0 LEFT JOIN CLI_DocumentosPFPJ d ON d.NUMERODOCUMENTO=i.CUIL

UNION ALL

SELECT
c.CODIGO_ACTIVIDAD,
a.DESCRIPCION,
''202001'' AS PERIODO_ACTIVIDAD,
(CASE c.ORDINAL_ACTIVIDAD
WHEN 1 THEN ''Primaria''
ELSE ''Secundaria''
END) AS TIPO_ACTIVIDAD,
''S'' AS VERIFICADO_AFIP,
c.FECHA_VERIFICADO,
c.CODIGO_PERSONA_CLIENTE,
d.TIPODOCUMENTO,
d.NUMERODOCUMENTO,
c.ORDINAL_ACTIVIDAD AS ORDINAL
FROM CLI_ACTIVIDAD_ECONOMICA c INNER JOIN 
CLI_Cod_Act_AFIP a ON c.CODIGO_ACTIVIDAD=a.CODIGO_ACT_AFIP AND c.TZ_LOCK=0 
LEFT JOIN CLI_DocumentosPFPJ d ON d.NUMEROPERSONAFJ=c.CODIGO_PERSONA_CLIENTE

)X

')


INSERT INTO dbo.DESCRIPTORES (TITULO, IDENTIFICACION, TIPODEARCHIVO, DESCRIPCION, GRUPODELMAPA, NOMBREFISICO, TIPODEDBMS, LARGODELREGISTRO, INICIALIZACIONDELREGISTRO, BASE, SELECCION, ACEPTA_MOVS_DIFERIDO)
VALUES (10, 209, NULL, 'Actividad Economica con WS', 0, 'VW_ACT_ECO_WS', 'D', NULL, NULL, 'Top/Clientes', NULL, 'N')


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34878, NULL, 0, 'Código Actividad', 'Código Actividad', 12, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 209, 'COD_ACTIVIDAD', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34879, NULL, 0, 'Descripcion', 'Descripcion', 400, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 209, 'DESCRIPCION', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34880, NULL, 0, 'Tipo Actividad', 'Tipo Actividad', 10, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 209, 'TIPO_ACTIVIDAD', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34881, NULL, 0, 'Verificado AFIP', 'Verificado AFIP', 1, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 209, 'VERIFICADO_AFIP', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34882, NULL, 0, 'Fecha Verificado', 'Fecha Verificado', 8, 'F', 0, 'F', 0, 0, 0, 0, 0, 0, 0, 209, 'FECHA_VERIFICADO', 0, NULL)



INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34883, NULL, 0, 'Código Persona', 'Código Persona', 12, 'N', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 209, 'CODIGO_PERSONA', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34884, NULL, 0, 'Tipo Documento', 'Tipo Documento', 4, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 209, 'TIPO_DOCUMENTO', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34885, NULL, 0, 'Numero Documento', 'Numero Documento', 20, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 209, 'NUMERO_DOCUMENTO', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34886, ' ', 0, 'Ordinal', 'Ordinal', 3, 'N', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 209, 'ORDINAL', 0, NULL)



INSERT INTO dbo.AYUDAS (NUMERODEARCHIVO, NUMERODEAYUDA, DESCRIPCION, FILTRO, MOSTRARTODOS, CAMPOS, CAMPOSVISTA, BASEVISTA, NOMBREVISTA, AYUDAGRANDE)
VALUES (209, 2091, 'Ayuda Principal', '', 0, '34878R;34879;34888;34880;34881;34882;34886R;', NULL, NULL, NULL, 0)



INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34887, ' ', 0, 'Ayuda VW_ACT_ECO_WS', 'Ayuda', 3, 'N', 0, NULL, 0, 0, 0, 0, 0, 2091, 0, 0, NULL, 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34888, ' ', 0, 'Periodo Inicio Actividad', 'Período Inicio Actividad', 7, 'A', 0, 'M', 0, 0, 0, 0, 0, 0, 0, 209, 'PERIODO_ACTIVIDAD', 0, 'mm/aaaa')



INSERT INTO dbo.PARAMETROSGENERALES (CODIGO, DESCRIPCION, ALFA, NUMERICO, FECHA, IMPORTE, TASA, TZ_LOCK)
VALUES (31, 'Actividad Econom. para PJ', '000012', 0, NULL, 0, 0, 0)

execute ('
CREATE VIEW VW_Cod_Act_AFIP AS
SELECT 
a.CODIGO_ACT_AFIP,
a.DESCRIPCION AS DESCRIPCION_AFIP,
(CASE
WHEN a.CODIGO_BCRA<100 THEN ''0''+(CONVERT(VARCHAR(3),a.CODIGO_BCRA))
ELSE CONVERT(VARCHAR(3),a.CODIGO_BCRA)
END
) AS CODIGO_BCRA,
b.DESCRIPCION AS DESCRIPCION_BCRA,
a.CODIGO_SECCION,
s.DESCRIPCION AS DESCRIPCION_SECCION,
a.CODIGO_SECTOR,
e.DESCRIPCION AS DESCRIPCION_SECTOR
FROM CLI_Cod_Act_AFIP a, CLI_Cod_Act_BCRA b, CLI_SECCION s,CLI_ACTIVIDAD_SECTOR e
WHERE a.CODIGO_BCRA=b.CODIGO_BCRA AND a.CODIGO_SECCION=s.CODIGO_SECCION AND a.CODIGO_SECTOR=e.CODIGO_SECTOR
')


INSERT INTO dbo.DESCRIPTORES (TITULO, IDENTIFICACION, TIPODEARCHIVO, DESCRIPCION, GRUPODELMAPA, NOMBREFISICO, TIPODEDBMS, LARGODELREGISTRO, INICIALIZACIONDELREGISTRO, BASE, SELECCION, ACEPTA_MOVS_DIFERIDO)
VALUES (10, 90, NULL, 'VW CLI_Cod_Act_AFIP', 0, 'VW_Cod_Act_AFIP', 'D', NULL, NULL, 'Top/Clientes', NULL, 'N')


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34335, ' ', 0, 'CODIGO_ACT_AFIP', 'Código Actividad', 12, 'A', 0, NULL, 0, 0, 0, 0, 0, 901, 0, 90, 'CODIGO_ACT_AFIP', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34336, ' ', 0, 'DESCRIPCION_AFIP', 'Descripción', 400, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 90, 'DESCRIPCION_AFIP', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34337, ' ', 0, 'CODIGO_BCRA', 'Código BCRA', 4, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 90, 'CODIGO_BCRA', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34338, ' ', 0, 'DESCRIPCION_BCRA', 'Descripción', 250, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 90, 'DESCRIPCION_BCRA', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34339, ' ', 0, 'CODIGO_SECCION', 'Sección', 1, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 90, 'CODIGO_SECCION', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34340, ' ', 0, 'DESCRIPCION_SECCION', 'Descripción', 250, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 90, 'DESCRIPCION_SECCION', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34341, ' ', 0, 'CODIGO_SECTOR', 'Sector', 5, 'N', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 90, 'CODIGO_SECTOR', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34342, ' ', 0, 'DESCRIPCION_SECTOR', 'Descripción', 250, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 90, 'DESCRIPCION_SECTOR', 0, NULL)


INSERT INTO dbo.AYUDAS (NUMERODEARCHIVO, NUMERODEAYUDA, DESCRIPCION, FILTRO, MOSTRARTODOS, CAMPOS, CAMPOSVISTA, BASEVISTA, NOMBREVISTA, AYUDAGRANDE)
VALUES (90, 901, 'Ayuda Principal', '', 0, '34335R;34336;34337;34338;34339;34340;34341;34342;', NULL, NULL, NULL, 0)


INSERT INTO dbo.INDICES (NUMERODEARCHIVO, NUMERODEINDICE, DESCRIPCION, CLAVESREPETIDAS, CAMPO1, CAMPO2, CAMPO3, CAMPO4, CAMPO5, CAMPO6, CAMPO7, CAMPO8, CAMPO9, CAMPO10, CAMPO11, CAMPO12, CAMPO13, CAMPO14, CAMPO15, CAMPO16, CAMPO17, CAMPO18, CAMPO19, CAMPO20)
VALUES (90, 1, 'Indice', 0, 34335, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)


