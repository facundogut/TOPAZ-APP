DROP VIEW dbo.VW_DIRECCIONES_PERSONAS
GO

CREATE VIEW dbo.VW_DIRECCIONES_PERSONAS  (
	TIPODOCUMENTO,
	NUMERODOCUMENTO,
	TIPO_DOC_FISICO,
 	NUM_DOC_FISICO,
 	NOMBRE,
 	ID,
	FORMATO,
	DESC_FORMATO,
	TIPODIRECCION,
	DESC_TIPODIRECCION,
	ORDINAL_DIR,
	PAIS,
	NOMBREPAIS,
	PROVINCIA,
	NOMBREPROVINCIA,
	DEPARTAMENTO,
	NOMBREDEPARTAMENTO,
	LOCALIDAD,
	NOMBRELOCALIDAD,
	CPA_NUEVO,
	BARRIO,
	CALLE,
	NUMERO,
	PISO,
	APARTAMENTO,
	MANZANA,
	PARCELA,
	CASA,
	MONOBLOCK,
	TIRA,
	CHACRA,
	NORMALIZADO,
	PROVINCIA_EXTERIOR,
	DEPARTAMENTO_EXTERIOR,
	LOCALIDAD_EXTERIOR
)
AS
 SELECT 
 	  v.TIPODOCUMENTO,
 	  v.NUMERODOCUMENTO,
 	  v.TIPO_DOC_FISICO,
 	  v.NUM_DOC_FISICO,
 	  concat(u.APELLIDOPATERNO,' ',u.PRIMERNOMBRE) AS NOMBRE,
 	  a.ID,
   	  a.FORMATO,
   	  (SELECT DESCRIPCION FROM OPCIONES O WHERE O.IDIOMA = 'E' AND O.NUMERODECAMPO = 33051 AND O.OPCIONINTERNA= a.FORMATO) AS DESC_FORMATO,
   	  a.TIPODIRECCION,
   	  (SELECT DESCRIPCION FROM OPCIONES O WHERE O.IDIOMA = 'E' AND O.NUMERODECAMPO = 33052 AND O.OPCIONINTERNA= a.TIPODIRECCION) AS DESC_TIPODIRECCION,
   	  a.ORDINAL_DIR,
   	  a.PAIS,
   	  p.NOMBREPAIS,
   	  a.PROVINCIA,
   	  PP.DESCRIPCION AS NOMBREPROVINCIA,
   	  a.DEPARTAMENTO,
   	  D.NOMBREDEP AS NOMBREDEPARTAMENTO,
   	  a.LOCALIDAD,
      L.DESCRIPCION_DIM3 AS NOMBRELOCALIDAD,
      a.CPA_NUEVO,
      A.BARRIO,
      A.CALLE,
      A.NUMERO,
      A.PISO,
	  A.APARTAMENTO,
	  A.MANZANA,
	  A.PARCELA,
	  A.CASA,
      A.MONOBLOCK,
	  A.TIRA,
	  A.CHACRA,
	  CASE 
	  WHEN A.NORMALIZADO ='S' THEN 'SI'
	  WHEN A.NORMALIZADO ='N' THEN 'NO'
	  END AS NORMALIZADO,
      A.PROVINCIA_EXTERIOR,
      A.DEPARTAMENTO_EXTERIOR,
      A.LOCALIDAD_EXTERIOR
         
   FROM  
      dbo.CLI_DIRECCIONES AS A
      LEFT JOIN dbo.CLI_PAISES AS P ON P.CODIGOPAIS = A.PAIS
      LEFT JOIN dbo.CLI_PROVINCIAS AS PP ON PP.DIM1 = A.PROVINCIA
      LEFT JOIN dbo.CLI_DEPARTAMENTOS AS D ON (a.DEPARTAMENTO=d.DEPARTAMENTO) AND (PP.DIM1=d.PROVINCIA)
      LEFT JOIN dbo.CLI_LOCALIDADES AS l ON (a.LOCALIDAD=l.DIM3) AND (l.DIM1=PP.DIM1) AND (l.DIM2=d.DEPARTAMENTO), 
      dbo.CLI_PERSONASFISICAS  AS U, 
      dbo.CLI_DOCUMENTOSPFPJ  AS V

   WHERE 
	  (U.NUMEROPERSONAFISICA = a.ID AND U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ) AND 
      ((A.TZ_LOCK < 300000000000000 OR A.TZ_LOCK >= 400000000000000) AND (A.TZ_LOCK < 100000000000000 OR A.TZ_LOCK >= 200000000000000)) AND 
      ((U.TZ_LOCK < 300000000000000 OR U.TZ_LOCK >= 400000000000000) AND (U.TZ_LOCK < 100000000000000 OR U.TZ_LOCK >= 200000000000000)) AND 
      ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000)) 
      
UNION ALL


   SELECT 
 	  v.TIPODOCUMENTO,
 	  v.NUMERODOCUMENTO,
 	  v.TIPO_DOC_FISICO,
 	  v.NUM_DOC_FISICO,
 	  j.RAZONSOCIAL AS NOMBRE,
 	  a.ID,
   	  a.FORMATO,
   	  (SELECT DESCRIPCION FROM OPCIONES O WHERE O.IDIOMA = 'E' AND O.NUMERODECAMPO = 33051 AND O.OPCIONINTERNA= a.FORMATO) AS DESC_FORMATO,
   	  a.TIPODIRECCION,
   	  (SELECT DESCRIPCION FROM OPCIONES O WHERE O.IDIOMA = 'E' AND O.NUMERODECAMPO = 33052 AND O.OPCIONINTERNA= a.TIPODIRECCION) AS DESC_TIPODIRECCION,
   	  a.ORDINAL_DIR,
   	  a.PAIS,
   	  p.NOMBREPAIS,
   	  a.PROVINCIA,
   	  PP.DESCRIPCION AS NOMBREPROVINCIA,
   	  a.DEPARTAMENTO,
   	  D.NOMBREDEP AS NOMBREDEPARTAMENTO,
   	  a.LOCALIDAD,
      L.DESCRIPCION_DIM3 AS NOMBRELOCALIDAD,
      a.CPA_NUEVO,
      A.BARRIO,
      A.CALLE,
      A.NUMERO,
      A.PISO,
	  A.APARTAMENTO,
	  A.MANZANA,
	  A.PARCELA,
	  A.CASA,
      A.MONOBLOCK,
	  A.TIRA,
	  A.CHACRA,
	  CASE 
	  WHEN A.NORMALIZADO ='S' THEN 'SI'
	  WHEN A.NORMALIZADO ='N' THEN 'NO'
	  END AS NORMALIZADO,
      A.PROVINCIA_EXTERIOR,
      A.DEPARTAMENTO_EXTERIOR,
      A.LOCALIDAD_EXTERIOR
         
   FROM  
      dbo.CLI_DIRECCIONES AS A
      LEFT JOIN dbo.CLI_PAISES AS P ON P.CODIGOPAIS = A.PAIS
      LEFT JOIN dbo.CLI_PROVINCIAS AS PP ON PP.DIM1 = A.PROVINCIA
      LEFT JOIN dbo.CLI_DEPARTAMENTOS AS D ON (a.DEPARTAMENTO=d.DEPARTAMENTO) AND (PP.DIM1=d.PROVINCIA)
      LEFT JOIN dbo.CLI_LOCALIDADES AS l ON (a.LOCALIDAD=l.DIM3) AND (l.DIM1=PP.DIM1) AND (l.DIM2=d.DEPARTAMENTO), 
      dbo.CLI_PERSONASJURIDICAS  AS J, 
      dbo.CLI_DOCUMENTOSPFPJ  AS V

   WHERE 
	  (J.NUMEROPERSONAJURIDICA = a.ID AND J.NUMEROPERSONAJURIDICA = V.NUMEROPERSONAFJ) AND 
      ((A.TZ_LOCK < 300000000000000 OR A.TZ_LOCK >= 400000000000000) AND (A.TZ_LOCK < 100000000000000 OR A.TZ_LOCK >= 200000000000000)) AND 
      ((J.TZ_LOCK < 300000000000000 OR J.TZ_LOCK >= 400000000000000) AND (J.TZ_LOCK < 100000000000000 OR J.TZ_LOCK >= 200000000000000)) AND 
      ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000))
GO

---------------------------------------------------------------------------------------------------------------------------------------------------

DROP VIEW dbo.VW_CLI_DIRECCIONES
GO

CREATE VIEW dbo.VW_CLI_DIRECCIONES  (
	TIPODOCUMENTO,
	NUMERODOCUMENTO,
	TIPO_DOC_FISICO,
 	NUM_DOC_FISICO,
	NOMBRE,
	FORMATO,
	DESC_FORMATO,
	TIPODIRECCION,
	DESC_TIPODIRECCION,
	ORDINAL_DIR,
	PAIS,
	PROVINCIA,
	DEPARTAMENTO,
	LOCALIDAD,
	CPA_NUEVO,
	BARRIO,
	CALLE,
	NUMERO,
	PISO,
	APARTAMENTO,
	MANZANA,
	PARCELA,
	CASA,
	MONOBLOCK,
	TIRA,
	CHACRA,
	NORMALIZADO,
	PROVINCIA_EXT,
	DEPARTAMENTO_EXT,
	LOCALIDAD_EXT,
	TIPO_CLIENTE,
	NOMBRECLIENTE,
	CODIGOCLIENTE,
	NUMEROPERSONA,
	TIPOPERSONA
)
AS
 SELECT 
 	  v.TIPODOCUMENTO,
 	  v.NUMERODOCUMENTO,
 	  v.TIPO_DOC_FISICO,
 	  v.NUM_DOC_FISICO,
 	  concat(u.APELLIDOPATERNO,' ',u.PRIMERNOMBRE) AS NOMBRE,
   	  a.FORMATO,
   	  (SELECT DESCRIPCION FROM OPCIONES O WHERE O.IDIOMA = 'E' AND O.NUMERODECAMPO = 33051 AND O.OPCIONINTERNA= a.FORMATO) AS DESC_FORMATO,
   	  a.TIPODIRECCION,
   	  (SELECT DESCRIPCION FROM OPCIONES O WHERE O.IDIOMA = 'E' AND O.NUMERODECAMPO = 33052 AND O.OPCIONINTERNA= a.TIPODIRECCION) AS DESC_TIPODIRECCION,
   	  a.ORDINAL_DIR,
   	  p.NOMBREPAIS AS PAIS,
   	  PP.DESCRIPCION AS PROVINCIA,
   	  D.NOMBREDEP AS DEPARTAMENTO,
      L.DESCRIPCION_DIM3 AS LOCALIDAD,
      a.CPA_NUEVO,
      A.BARRIO,
      A.CALLE,
      A.NUMERO,
      A.PISO,
	  A.APARTAMENTO,
	  A.MANZANA,
	  A.PARCELA,
	  A.CASA,
      A.MONOBLOCK,
	  A.TIRA,
	  A.CHACRA,
	  CASE 
	  WHEN A.NORMALIZADO ='S' THEN 'SI'
	  WHEN A.NORMALIZADO ='N' THEN 'NO'
	  END AS NORMALIZADO,
      A.PROVINCIA_EXTERIOR AS LOCALIDAD_EXT,
      A.DEPARTAMENTO_EXTERIOR AS LOCALIDAD_EXT,
      A.LOCALIDAD_EXTERIOR AS LOCALIDAD_EXT,
   	 (SELECT DESCRIPCION FROM OPCIONES WHERE IDIOMA = 'E' AND NUMERODECAMPO = 1040 AND OPCIONINTERNA = r.tipo) AS TIPO_CLIENTE,
   	  R.NOMBRECLIENTE,
   	  R.CODIGOCLIENTE,  
      V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
      (SELECT DESCRIPCION FROM OPCIONES WHERE IDIOMA = 'E' AND NUMERODECAMPO = 1861 AND OPCIONINTERNA = V.TIPOPERSONA) AS TIPOPERSONA
         
   FROM 
   	  dbo.CLI_DIRECCIONES AS A
   	  LEFT JOIN dbo.CLI_PAISES AS P ON P.CODIGOPAIS = A.PAIS
   	  LEFT JOIN dbo.CLI_PROVINCIAS AS PP ON PP.DIM1 = A.PROVINCIA  	  
      LEFT JOIN dbo.CLI_DEPARTAMENTOS AS D ON (a.DEPARTAMENTO=d.DEPARTAMENTO) AND (PP.DIM1=d.PROVINCIA)
      LEFT JOIN dbo.CLI_LOCALIDADES AS l ON (a.LOCALIDAD=l.DIM3) AND (l.DIM1=PP.DIM1) AND (l.DIM2=d.DEPARTAMENTO), 
      dbo.CLI_CLIENTES  AS R, 
      dbo.CLI_CLIENTEPERSONA  AS T, 
      dbo.CLI_PERSONASFISICAS  AS U, 
      dbo.CLI_DOCUMENTOSPFPJ  AS V
     
   WHERE 
      (R.CODIGOCLIENTE = T.CODIGOCLIENTE) AND 
      (U.NUMEROPERSONAFISICA = T.NUMEROPERSONA AND U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ) AND 
      (T.TITULARIDAD='T') AND
      (T.NUMEROPERSONA=A.ID) AND (a.ID=t.NUMEROPERSONA) AND 

      ((R.TZ_LOCK < 300000000000000 OR R.TZ_LOCK >= 400000000000000) AND (R.TZ_LOCK < 100000000000000 OR R.TZ_LOCK >= 200000000000000)) AND 
      ((T.TZ_LOCK < 300000000000000 OR T.TZ_LOCK >= 400000000000000) AND (T.TZ_LOCK < 100000000000000 OR T.TZ_LOCK >= 200000000000000)) AND 
      ((U.TZ_LOCK < 300000000000000 OR U.TZ_LOCK >= 400000000000000) AND (U.TZ_LOCK < 100000000000000 OR U.TZ_LOCK >= 200000000000000)) AND 
      ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000)) AND
      ((A.TZ_LOCK < 300000000000000 OR A.TZ_LOCK >= 400000000000000) AND (A.TZ_LOCK < 100000000000000 OR A.TZ_LOCK >= 200000000000000))
      
UNION ALL

   SELECT 
 	  v.TIPODOCUMENTO,
 	  v.NUMERODOCUMENTO,
 	  v.TIPO_DOC_FISICO,
 	  v.NUM_DOC_FISICO,
 	  j.RAZONSOCIAL AS NOMBRE,
   	  a.FORMATO,
   	  (SELECT DESCRIPCION FROM OPCIONES O WHERE O.IDIOMA = 'E' AND O.NUMERODECAMPO = 33051 AND O.OPCIONINTERNA= a.FORMATO) AS DESC_FORMATO,
   	  a.TIPODIRECCION,
   	  (SELECT DESCRIPCION FROM OPCIONES O WHERE O.IDIOMA = 'E' AND O.NUMERODECAMPO = 33052 AND O.OPCIONINTERNA= a.TIPODIRECCION) AS DESC_TIPODIRECCION,
   	  a.ORDINAL_DIR,
   	  p.NOMBREPAIS AS PAIS,
   	  PP.DESCRIPCION AS PROVINCIA,
   	  D.NOMBREDEP AS DEPARTAMENTO,
      L.DESCRIPCION_DIM3 AS LOCALIDAD,
      a.CPA_NUEVO,
      A.BARRIO,
      A.CALLE,
      A.NUMERO,
      A.PISO,
	  A.APARTAMENTO,
	  A.MANZANA,
	  A.PARCELA,
	  A.CASA,
      A.MONOBLOCK,
	  A.TIRA,
	  A.CHACRA,
	  CASE 
	  WHEN A.NORMALIZADO ='S' THEN 'SI'
	  WHEN A.NORMALIZADO ='N' THEN 'NO'
	  END AS NORMALIZADO,
      A.PROVINCIA_EXTERIOR AS PROVINCIA_EXT,
      A.DEPARTAMENTO_EXTERIOR AS DEPARTAMENTO_EXT,
      A.LOCALIDAD_EXTERIOR AS LOCALIDAD_EXT,
   	 (SELECT DESCRIPCION FROM OPCIONES WHERE IDIOMA = 'E' AND NUMERODECAMPO = 1040 AND OPCIONINTERNA = r.tipo) AS TIPO_CLIENTE,
   	  R.NOMBRECLIENTE,
   	  R.CODIGOCLIENTE,  
      V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
      (SELECT DESCRIPCION FROM OPCIONES WHERE IDIOMA = 'E' AND NUMERODECAMPO = 1861 AND OPCIONINTERNA = V.TIPOPERSONA) AS TIPOPERSONA 
    
         
   FROM 
   	  dbo.CLI_DIRECCIONES AS A
   	  LEFT JOIN dbo.CLI_PAISES AS P ON P.CODIGOPAIS = A.PAIS
   	  LEFT JOIN dbo.CLI_PROVINCIAS AS PP ON PP.DIM1 = A.PROVINCIA  	  
      LEFT JOIN dbo.CLI_DEPARTAMENTOS AS D ON (a.DEPARTAMENTO=d.DEPARTAMENTO) AND (PP.DIM1=d.PROVINCIA)
      LEFT JOIN dbo.CLI_LOCALIDADES AS l ON (a.LOCALIDAD=l.DIM3) AND (l.DIM1=PP.DIM1) AND (l.DIM2=d.DEPARTAMENTO),
      dbo.CLI_CLIENTES  AS R, 
      dbo.CLI_CLIENTEPERSONA  AS T, 
      dbo.CLI_PERSONASJURIDICAS  AS J, 
      dbo.CLI_DOCUMENTOSPFPJ  AS V

   WHERE 
      (R.CODIGOCLIENTE = T.CODIGOCLIENTE) AND 
      (J.NUMEROPERSONAJURIDICA = T.NUMEROPERSONA AND J.NUMEROPERSONAJURIDICA = V.NUMEROPERSONAFJ) AND 
      (T.TITULARIDAD='T') AND
      (T.NUMEROPERSONA=A.ID) AND (a.ID=t.NUMEROPERSONA) AND 
    
      ((R.TZ_LOCK < 300000000000000 OR R.TZ_LOCK >= 400000000000000) AND (R.TZ_LOCK < 100000000000000 OR R.TZ_LOCK >= 200000000000000)) AND 
      ((T.TZ_LOCK < 300000000000000 OR T.TZ_LOCK >= 400000000000000) AND (T.TZ_LOCK < 100000000000000 OR T.TZ_LOCK >= 200000000000000)) AND 
      ((J.TZ_LOCK < 300000000000000 OR J.TZ_LOCK >= 400000000000000) AND (J.TZ_LOCK < 100000000000000 OR J.TZ_LOCK >= 200000000000000)) AND 
      ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000)) AND
      ((A.TZ_LOCK < 300000000000000 OR A.TZ_LOCK >= 400000000000000) AND (A.TZ_LOCK < 100000000000000 OR A.TZ_LOCK >= 200000000000000))
GO


------------------------------------------------------------------------------------------------------------------------------
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37241, ' ', 0, 'Piso', 'Piso', 8, 'N', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3351, 'PISO', 0, NULL)
GO
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37242, ' ', 0, 'Apartamento', 'Apartamento', 100, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3351, 'APARTAMENTO', 0, NULL)
GO
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37243, ' ', 0, 'Manzana', 'Manzana', 15, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3351, 'MANZANA', 0, NULL)
GO
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37244, ' ', 0, 'Parecela', 'Parecela', 15, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3351, 'PARCELA', 0, NULL)
GO
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37245, ' ', 0, 'Casa', 'Casa', 15, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3351, 'CASA', 0, NULL)
GO
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37246, ' ', 0, 'Monoblock', 'Monoblock', 15, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3351, 'MONOBLOCK', 0, NULL)
GO
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37247, ' ', 0, 'Tira', 'Tira', 15, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3351, 'TIRA', 0, NULL)
GO
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37248, ' ', 0, 'Chacra', 'Chacra', 15, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3351, 'CHACRA', 0, NULL)
GO
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37249, ' ', 0, 'Normalizado', 'Normalizado', 2, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3351, 'NORMALIZADO', 0, NULL)
GO

---------------------------------------------------------------------------------------------------------------------------------------------------

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37250, ' ', 0, 'Piso', 'Piso', 8, 'N', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3347, 'PISO', 0, NULL)
GO
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37251, ' ', 0, 'Apartamento', 'Apartamento', 100, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3347, 'APARTAMENTO', 0, NULL)
GO
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37252, ' ', 0, 'Manzana', 'Manzana', 15, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3347, 'MANZANA', 0, NULL)
GO
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37253, ' ', 0, 'Parecela', 'Parecela', 15, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3347, 'PARCELA', 0, NULL)
GO
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37254, ' ', 0, 'Casa', 'Casa', 15, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3347, 'CASA', 0, NULL)
GO
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37255, ' ', 0, 'Monoblock', 'Monoblock', 15, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3347, 'MONOBLOCK', 0, NULL)
GO
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37256, ' ', 0, 'Tira', 'Tira', 15, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3347, 'TIRA', 0, NULL)
GO
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37257, ' ', 0, 'Chacra', 'Chacra', 15, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3347, 'CHACRA', 0, NULL)
GO
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37258, ' ', 0, 'Normalizado', 'Normalizado', 2, 'A', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3347, 'NORMALIZADO', 0, NULL)
GO

---------------------------------------------------------------------------------------------------------------------------------------------------
UPDATE dbo.AYUDAS
SET CAMPOS = '37124;37125;37126;37127;37128;37129ROA1;37130R;37131;37132R;37133;37134RA1;37135;37136;37137;37138;37139;37140;37141;37142;37143;37144;37145;37146;37147;37148;37149;37250;37251;37252;37253;37254;37255;37256;37257;37258;'
WHERE NUMERODEAYUDA = 33471
GO


UPDATE dbo.AYUDAS
SET CAMPOS = '37176;37177;37178;37179;37180;37181R;37182R;37183;37184R;37185;37186R;37187;37188;37189;37190;37191;37192;37193;37194;37195;37196;37197;37241;37242;37243;37244;37245;37246;37247;37248;37249;37198;37199;37200R;37202;'
WHERE NUMERODEAYUDA = 33511
GO

-----------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------
CREATE VIEW dbo.VW_DIRECCIONES_JUZGADOS  (
	"Número de Juzgado",
 	"Nombre de Juzgado",
 	ID,
	"Formato",
	"Desc. Formato",
	"Tipo de Dirección",
	"Desc. Tipo Dirección",
	"Ordinal",
	"País",
	"Nombre País",
	"Provincia",
	"Desc. Provincia",
	"Departamento",
	"Desc. Departamento",
	"Localidad",
	"Desc. Localidad",
	"CPA Nuevo",
	"Barrio",
	"Calle",
	"Número",
	"Piso",
	"Apartamento",
	"Manzana",
	"Parcela",
	"Casa",
    "Monoblock", 
	"Tira",
	"Chacra",
	"Normalizado",
	"Provincia Exterior",
	"Departamento Exterior",
	"Localidad Exterior"
)
AS
    SELECT 
 	  j.NRO_JUZGADO AS "Número de Juzgado",
 	  j.NOMBRE AS "Nombre de Juzgado",
 	  a.ID,
   	  a.FORMATO AS "Formato",
   	  (SELECT DESCRIPCION FROM OPCIONES O WHERE O.IDIOMA = 'E' AND O.NUMERODECAMPO = 33051 AND O.OPCIONINTERNA= a.FORMATO) AS "Desc. Formato",
   	  a.TIPODIRECCION AS "Tipo de Dirección",
   	  (SELECT DESCRIPCION FROM OPCIONES O WHERE O.IDIOMA = 'E' AND O.NUMERODECAMPO = 33052 AND O.OPCIONINTERNA= a.TIPODIRECCION) AS "Desc. Tipo Dirección",
   	  a.ORDINAL_DIR AS "Ordinal",
   	  a.PAIS AS "País",
   	  p.NOMBREPAIS AS "Nombre País",
   	  a.PROVINCIA AS "Provincia", 
   	  PP.DESCRIPCION AS "Desc. Provincia",
   	  a.DEPARTAMENTO AS "Departamento",
   	  D.NOMBREDEP AS "Desc. Departamento",
   	  a.LOCALIDAD AS "Localidad",
      L.DESCRIPCION_DIM3 AS "Desc. Localidad",
      a.CPA_NUEVO AS "CPA Nuevo",
      A.BARRIO AS "Barrio",
      A.CALLE AS "Calle",
      A.NUMERO AS "Número",
      A.PISO AS "Piso",
	  A.APARTAMENTO AS "Apartamento",
	  A.MANZANA AS "Manzana",
	  A.PARCELA AS "Parcela",
	  A.CASA AS "Casa",
      A.MONOBLOCK AS "Monoblock", 
	  A.TIRA AS "Tira",
	  A.CHACRA AS "Chacra",
	  CASE 
	  WHEN A.NORMALIZADO ='S' THEN 'SI'
	  WHEN A.NORMALIZADO ='N' THEN 'NO'
	  END AS "Normalizado",
      A.PROVINCIA_EXTERIOR AS "Provincia Exterior",
      A.DEPARTAMENTO_EXTERIOR AS "Departamento Exterior",
      A.LOCALIDAD_EXTERIOR AS "Localidad Exterior"
         
   FROM  
      dbo.CLI_DIRECCIONES AS A
      LEFT JOIN dbo.CLI_PAISES AS P ON P.CODIGOPAIS = A.PAIS
      LEFT JOIN dbo.CLI_PROVINCIAS AS PP ON PP.DIM1 = A.PROVINCIA
      LEFT JOIN dbo.CLI_DEPARTAMENTOS AS D ON (a.DEPARTAMENTO=d.DEPARTAMENTO) AND (PP.DIM1=d.PROVINCIA)
      LEFT JOIN dbo.CLI_LOCALIDADES AS l ON (a.LOCALIDAD=l.DIM3) AND (l.DIM1=PP.DIM1) AND (l.DIM2=d.DEPARTAMENTO), 
      dbo.DJ_JUZGADOS  AS J 
   WHERE 
	  (J.NRO_JUZGADO = a.ID AND a.FORMATO = 'J') AND
      ((A.TZ_LOCK < 300000000000000 OR A.TZ_LOCK >= 400000000000000) AND (A.TZ_LOCK < 100000000000000 OR A.TZ_LOCK >= 200000000000000)) AND 
      ((J.TZ_LOCK < 300000000000000 OR J.TZ_LOCK >= 400000000000000) AND (J.TZ_LOCK < 100000000000000 OR J.TZ_LOCK >= 200000000000000))
GO
-----------------------------------------------------------------------------------------------------------------------------------------------------

CREATE VIEW dbo.VW_CORREOS_JUZGADOS  (
	"Número de Juzgado",
 	"Nombre de Juzgado",
 	ID,
	"Formato",
	"Descripción Formato",
	"Tipo",
	"Descripción Tipo",
	"Ordinal",
	"Email"
	)
AS
    SELECT 
 	  j.NRO_JUZGADO AS "Número de Juzgado",
 	  j.NOMBRE AS "Nombre de Juzgado",
 	  e.ID,
   	  e.FORMATO AS "Formato",
      (SELECT DESCRIPCION FROM OPCIONES O WHERE O.IDIOMA = 'E' AND O.NUMERODECAMPO = 33460 AND O.OPCIONINTERNA= e.FORMATO) AS DESC_FORMATO,
      e.TIPO,
   	  (SELECT DESCRIPCION FROM OPCIONES O WHERE O.IDIOMA = 'E' AND O.NUMERODECAMPO = 33494 AND O.OPCIONINTERNA= e.TIPO) AS DESC_TIPO,
   	  e.ORDINAL,
	  e.EMAIL
		
		         
   FROM  
      dbo.CLI_EMAILS AS E,
      dbo.DJ_JUZGADOS  AS J 
   WHERE 
	  (J.NRO_JUZGADO = e.ID AND e.FORMATO ='J') AND 
	  ((E.TZ_LOCK < 300000000000000 OR E.TZ_LOCK >= 400000000000000) AND (E.TZ_LOCK < 100000000000000 OR E.TZ_LOCK >= 200000000000000)) AND 
      ((J.TZ_LOCK < 300000000000000 OR J.TZ_LOCK >= 400000000000000) AND (J.TZ_LOCK < 100000000000000 OR J.TZ_LOCK >= 200000000000000))
GO

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

CREATE VIEW dbo.VW_TELEFONOS_JUZGADOS  (
	"Número de Juzgado",
 	"Nombre de Juzgado",
 	ID,
	"Formato",
	"Descripción Formato",
	"Tipo",
	"Descripción Tipo",
	"Ordinal",
	"Tipo Fijo/Celular",
	"Descripción",
	"Número"
	)
AS
    SELECT 
 	  j.NRO_JUZGADO AS "Número de Juzgado",
 	  j.NOMBRE AS "Nombre de Juzgado",
 	  t.ID,
   	  t.FORMATO AS "Formato",
	  (SELECT DESCRIPCION FROM OPCIONES O WHERE O.IDIOMA = 'E' AND O.NUMERODECAMPO = 33426 AND O.OPCIONINTERNA= t.FORMATO) AS DESC_FORMATO,
	  t.TIPO,
	  (SELECT DESCRIPCION FROM OPCIONES O WHERE O.IDIOMA = 'E' AND O.NUMERODECAMPO = 33427 AND O.OPCIONINTERNA= t.TIPO) AS DESC_TIPO,
	  t.ORDINAL,
	  t.TIPO_CEL_TEL,
	  (SELECT DESCRIPCION FROM OPCIONES O WHERE O.IDIOMA = 'E' AND O.NUMERODECAMPO = 33435 AND O.OPCIONINTERNA= t.TIPO_CEL_TEL) AS DESC_TIPO_CEL_TEL,
	  t.NUMERO
   FROM  
      dbo.CLI_TELEFONOS AS t,
      dbo.DJ_JUZGADOS  AS J 
   WHERE 
	  (J.NRO_JUZGADO = t.ID AND t.FORMATO ='J') AND 
	  ((T.TZ_LOCK < 300000000000000 OR T.TZ_LOCK >= 400000000000000) AND (T.TZ_LOCK < 100000000000000 OR T.TZ_LOCK >= 200000000000000)) AND 
      ((J.TZ_LOCK < 300000000000000 OR J.TZ_LOCK >= 400000000000000) AND (J.TZ_LOCK < 100000000000000 OR J.TZ_LOCK >= 200000000000000))
GO

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37259, ' ', 0, 'Dirección Juzgados', 'Dirección Juzgados', 12, 'N', 0, NULL, 0, 0, 0, 0, 0, 3583, 0, 0, 'DIR_JUZGADOS', 0, NULL)
GO

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37260, ' ', 0, 'Correos Juzgados', 'Correos Juzgados', 12, 'N', 0, NULL, 0, 0, 0, 0, 0, 3584, 0, 0, 'CORREOS_JUZGADOS', 0, NULL)
GO

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37261, ' ', 0, 'Teléfonos Juzgados', 'Teléfonos Juzgados', 12, 'N', 0, NULL, 0, 0, 0, 0, 0, 3585, 0, 0, 'TELEFONOS_JUZGADOS', 0, NULL)
GO

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


INSERT INTO dbo.AYUDAS (NUMERODEARCHIVO, NUMERODEAYUDA, DESCRIPCION, FILTRO, MOSTRARTODOS, CAMPOS, CAMPOSVISTA, BASEVISTA, NOMBREVISTA, AYUDAGRANDE)
VALUES (0, 3583, 'VW_DIRECCIONES_JUZGADOS', '', 0, '665;9106;3251R;950R;12111;1429R;118;2617R;9096;622;4898;1373;465;1490;466;2487;531;9103;4968;4183;', 'Número de Juzgado;Nombre de Juzgado;ID;Formato;Desc. Formato;Tipo de Dirección;Desc. Tipo Dirección;Ordinal;País;Nombre País;Provincia;Desc. Provincia;Departamento;Desc. Departamento;Localidad;Desc. Localidad;CPA Nuevo;Barrio;Calle;Número;', 'TOP/CLIENTES', 'VW_DIRECCIONES_JUZGADOS', 0)
GO

INSERT INTO dbo.AYUDAS (NUMERODEARCHIVO, NUMERODEAYUDA, DESCRIPCION, FILTRO, MOSTRARTODOS, CAMPOS, CAMPOSVISTA, BASEVISTA, NOMBREVISTA, AYUDAGRANDE)
VALUES (0, 3584, 'VW_CORREOS_JUZGADOS', '', 0, '665;9106;3251R;950R;12111;1429R;118;2617R;950;', 'Número de Juzgado;Nombre de Juzgado;ID;Formato;Descripción Formato;Tipo;Descripción Tipo;Ordinal;Email;', 'TOP/CLIENTES', 'VW_CORREOS_JUZGADOS', 0)
GO

INSERT INTO dbo.AYUDAS (NUMERODEARCHIVO, NUMERODEAYUDA, DESCRIPCION, FILTRO, MOSTRARTODOS, CAMPOS, CAMPOSVISTA, BASEVISTA, NOMBREVISTA, AYUDAGRANDE)
VALUES (0, 3585, 'VW_TELEFONOS_JUZGADOS', '', 0, '665;9106;3251R;950R;12111;1429R;118;2617R;556;118;622;', 'Número de Juzgado;Nombre de Juzgado;ID;Formato;Descripción Formato;Tipo;Descripción Tipo;Ordinal;Tipo Fijo/Celular;Descripción;Número;', 'TOP/CLIENTES', 'VW_TELEFONOS_JUZGADOS', 0)
GO

