execute ('CREATE VIEW VW_PF_DOCUMENTOS
(
   TIPODOC, 
   NUMERODOC, 
   NUMEROPERSONA, 
   NIVELAPERTURA, 
   TIPOPERSONA, 
   NOMBRES, 
   APELLIDOS, 
   EMPLEADO_BC_BANCO)
AS 
     SELECT TOP 9223372036854775807 WITH TIES 
      V.TIPODOCUMENTO AS TIPODOC, 
      V.NUMERODOCUMENTO AS NUMERODOC, 
      V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
      CASE U.NIVEL_APERTURA
         WHEN 0 THEN ''REGISTRO''
         WHEN 1 THEN ''BÁSICO''
         WHEN 2 THEN ''PASIVOS''
         WHEN 3 THEN ''ACTIVOS''
      END AS NIVELAPERTURA, 
      V.TIPOPERSONA, 
      U.PRIMERNOMBRE, 
      U.APELLIDOPATERNO, 
      U.EMPLEADO_BC_BANCO
   FROM dbo.CLI_PERSONASFISICAS  AS U, dbo.CLI_DOCUMENTOSPFPJ  AS V
   WHERE 
      U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ AND 
      (V.TIPOPERSONA = ''F'' OR V.TIPOPERSONA = ''U'') AND 
      ((U.TZ_LOCK < 300000000000000 OR U.TZ_LOCK >= 400000000000000) AND (U.TZ_LOCK < 100000000000000 OR U.TZ_LOCK >= 200000000000000)) AND 
      ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000))
   ORDER BY NUMEROPERSONA
  ')

execute(' CREATE VIEW VW_PFPJ_DOCUMENTOS (
   TIPODOC, 
   NUMERODOC, 
   NUMEROPERSONA, 
   NIVELAPERTURA, 
   TIPOPERSONA, 
   NOMBRE, 
   ESTADO,
   MOTIVO_INHABILITADO)
AS 
   SELECT TOP 9223372036854775807 WITH TIES 
      V.TIPODOCUMENTO AS TIPODOC, 
      V.NUMERODOCUMENTO AS NUMERODOC, 
      V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
      CASE U.NIVEL_APERTURA
         WHEN 0 THEN ''REGISTRO''
         WHEN 1 THEN ''BÁSICO''
         WHEN 3 THEN ''ACTIVOS''
      END AS NIVELAPERTURA, 
      V.TIPOPERSONA, 
      (U.APELLIDOPATERNO+ '' '' +U.PRIMERNOMBRE) AS NOMBRE,
      CASE U.ESTADO
      	 WHEN 0 THEN ''HABILITADO''
         WHEN 1 THEN ''INHABILITADO''
       END AS ESTADO,   
      CASE U.MOTIVO_INHABILITADO
      	 WHEN 1 THEN ''INHABILITADO POR EL BCRA''
         WHEN 2 THEN ''INHABILITADO POR FALLECIMIENTO''
         WHEN 3 THEN ''INHABILITADO UIF''
         WHEN 4 THEN ''INHABILITADO TERRORISMO''
         WHEN 5 THEN ''INHABILITACION ADMINISTRATIVA''
       END AS MOTIVO_INHABILITADO
   FROM dbo.CLI_PERSONASFISICAS  AS U, dbo.CLI_DOCUMENTOSPFPJ  AS V
   WHERE 
      U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ AND 
      (V.TIPOPERSONA = ''F'') AND 
      (U.TZ_LOCK=0) AND 
      (V.TZ_LOCK=0)
   ORDER BY NUMEROPERSONA
UNION ALL
   SELECT TOP 9223372036854775807 WITH TIES 
      V.TIPODOCUMENTO AS TIPODOC, 
      V.NUMERODOCUMENTO AS NUMERODOC, 
      V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
      CASE T.NIVEL_APERTURA
         WHEN 1 THEN ''BÁSICO''
         WHEN 3 THEN ''ACTIVOS''
         WHEN 4 THEN ''INST.FINANCIERA''
      END AS NIVELAPERTURA, 
      V.TIPOPERSONA, 
      T.RAZONSOCIAL AS NOMBRE,  
      CASE T.ESTADO
      	 WHEN 0 THEN ''HABILITADO''
         WHEN 1 THEN ''INHABILITADO''
      END AS ESTADO,   
      CASE T.MOTIVO_INHABILITADO
      	 WHEN 1 THEN ''INHABILITADO POR EL BCRA''
         WHEN 3 THEN ''INHABILITADO UIF''
         WHEN 4 THEN ''INHABILITADO TERRORISMO''
         WHEN 5 THEN ''INHABILITACION ADMINISTRATIVA''
         WHEN 6 THEN ''P/LIQ TOTAL DE LA SOCIEDAD''
      END AS MOTIVO_INHABILITADO
   FROM dbo.CLI_PERSONASJURIDICAS  AS T, dbo.CLI_DOCUMENTOSPFPJ  AS V
   WHERE 
      T.NUMEROPERSONAJURIDICA = V.NUMEROPERSONAFJ AND 
      (V.TIPOPERSONA = ''J'' OR V.TIPOPERSONA = ''I'')AND  
      (T.TZ_LOCK = 0) AND 
      (V.TZ_LOCK = 0)
   ORDER BY NUMEROPERSONA
')

execute ('

CREATE VIEW VW_PF_HAB_DOCUMENTOS (
   TIPODOC, 
   NUMERODOC, 
   NUMEROPERSONA, 
   NIVELAPERTURA, 
   TIPOPERSONA, 
   NOMBRES, 
   APELLIDOS, 
   ESTADO,
   MOTIVO_INHABILITADO)
AS 
   SELECT TOP 9223372036854775807 WITH TIES 
      V.TIPODOCUMENTO AS TIPODOC, 
      V.NUMERODOCUMENTO AS NUMERODOC, 
      V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
      CASE U.NIVEL_APERTURA
         WHEN 0 THEN ''REGISTRO''
         WHEN 1 THEN ''BÁSICO''
         WHEN 3 THEN ''ACTIVOS''
      END AS NIVELAPERTURA, 
      V.TIPOPERSONA, 
      U.PRIMERNOMBRE AS NOMBRES, 
      U.APELLIDOPATERNO AS APELLIDOS, 
      CASE U.ESTADO
      	 WHEN 0 THEN ''HABILITADO''
         WHEN 1 THEN ''INHABILITADO''
       END AS ESTADO,   
      CASE U.MOTIVO_INHABILITADO
      	 WHEN 1 THEN ''INHABILITADO POR EL BCRA''
         WHEN 2 THEN ''INHABILITADO POR FALLECIMIENTO''
         WHEN 3 THEN ''INHABILITADO UIF''
         WHEN 4 THEN ''INHABILITADO TERRORISMO''
         WHEN 5 THEN ''INHABILITACION ADMINISTRATIVA''
      END AS MOTIVO_INHABILITADO
   FROM dbo.CLI_PERSONASFISICAS  AS U, dbo.CLI_DOCUMENTOSPFPJ  AS V
   WHERE 
      U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ AND 
      (V.TIPOPERSONA = ''F'') AND 
      (U.TZ_LOCK =0) AND 
      (V.TZ_LOCK =0)
   ORDER BY NUMEROPERSONA
')


execute(' 

CREATE VIEW VW_PF_CONYUGE_DOC (
   TIPODOC, 
   NÚMERODOC, 
   NÚMEROPERSONA, 
   NOMBRE, 
   TIPODOCCÓNYUGE, 
   NÚMERODOCCÓNYUGE, 
   NÚMEROCÓNYUGE, 
   NOMBRECÓNYUGE, 
   TIPORELACIÓN, 
   FECHA, 
   DESCRIPCIÓN)
AS 
     SELECT TOP 9223372036854775807 WITH TIES 
      V.TIPODOCUMENTO AS TIPODOC, 
      V.NUMERODOCUMENTO AS NÚMERODOC, 
      U.NUMEROPERSONAFISICA AS NÚMEROPERSONA, 
      ISNULL(X.PRIMERNOMBRE, '''') + '' '' + ISNULL(X.APELLIDOPATERNO, '''') AS NOMBRE, 
      W.TIPODOCUMENTO AS TIPODOCCÓNYUGE, 
      W.NUMERODOCUMENTO AS NÚMERODOCCÓNYUGE, 
      U.NUMEROPERSONAFISICACONY AS NÚMEROCÓNYUGE, 
      ISNULL(Z.PRIMERNOMBRE, '''') + '' '' + ISNULL(Z.APELLIDOPATERNO, '''')  AS NOMBRECÓNYUGE, 
      U.TIPORELACION AS TIPORELACIÓN, 
      U.FECHA, 
      U.DESCRIPCION AS DESCRIPCIÓN
   FROM 
      dbo.CLI_PFCONYUGE  AS U, 
      dbo.CLI_DOCUMENTOSPFPJ  AS V, 
      dbo.CLI_DOCUMENTOSPFPJ  AS W, 
      dbo.CLI_PERSONASFISICAS  AS X, 
      dbo.CLI_PERSONASFISICAS  AS Z
   WHERE 
      U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ AND 
      U.NUMEROPERSONAFISICACONY = W.NUMEROPERSONAFJ AND 
      U.NUMEROPERSONAFISICA = X.NUMEROPERSONAFISICA AND 
      U.NUMEROPERSONAFISICACONY = Z.NUMEROPERSONAFISICA AND 
      ((U.TZ_LOCK < 300000000000000 OR U.TZ_LOCK >= 400000000000000) AND (U.TZ_LOCK < 100000000000000 OR U.TZ_LOCK >= 200000000000000)) AND 
      ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000)) AND 
      ((W.TZ_LOCK < 300000000000000 OR W.TZ_LOCK >= 400000000000000) AND (W.TZ_LOCK < 100000000000000 OR W.TZ_LOCK >= 200000000000000))
   ORDER BY NÚMEROPERSONA
');
