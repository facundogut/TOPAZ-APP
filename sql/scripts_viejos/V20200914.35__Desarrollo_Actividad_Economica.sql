
EXECUTE('

ALTER VIEW VW_ACT_ECO_WS AS
SELECT 
COD_ACTIVIDAD,
MAX(DESCRIPCION) AS ''DESCRIPCION'',
MAX(PERIODO_ACTIVIDAD) AS ''PERIODO_ACTIVIDAD'',
MAX(TIPO_ACTIVIDAD) AS ''TIPO_ACTIVIDAD'',
MAX(VERIFICADO_AFIP) AS ''VERIFICADO_AFIP'',
MAX(FECHA_VERIFICADO) AS ''FECHA_VERIFICADO'',
MAX(CODIGO_PERSONA) AS ''CODIGO_PERSONA'',
MAX(TIPO_DOCUMENTO) AS ''TIPO_DOCUMENTO'',
MAX(NUMERO_DOCUMENTO) AS ''NUMERO_DOCUMENTO'',
MAX(ORDINAL) AS ''ORDINAL''
FROM
(     

SELECT 
i.COD_ACTIVIDAD,
a.DESCRIPCION,
(RIGHT(i.PERIODO,2)+LEFT(i.PERIODO,4)) AS PERIODO_ACTIVIDAD,
(CASE i.ORDEN
WHEN 1 THEN ''Primaria''
ELSE ''Secundaria''
END) AS TIPO_ACTIVIDAD,
''S'' AS VERIFICADO_AFIP,
(SELECT FECHAPROCESO FROM PARAMETROS) AS FECHA_VERIFICADO,
d.NUMEROPERSONAFJ AS CODIGO_PERSONA,
d.TIPODOCUMENTO AS TIPO_DOCUMENTO,
i.CUIL AS NUMERO_DOCUMENTO,
i.ORDEN AS ORDINAL
FROM ITF_AFIP_ACT_ECONOMICA i INNER JOIN CLI_Cod_Act_AFIP a ON i.COD_ACTIVIDAD=a.CODIGO_ACT_AFIP AND i.TZ_LOCK=0 LEFT JOIN CLI_DocumentosPFPJ d ON d.NUMERODOCUMENTO=i.CUIL

UNION

SELECT
c.CODIGO_ACTIVIDAD AS COD_ACTIVIDAD,
a.DESCRIPCION,
c.INICIO_ACTIVIDAD AS PERIODO_ACTIVIDAD,
(CASE c.ORDINAL_ACTIVIDAD
WHEN 1 THEN ''Primaria''
ELSE ''Secundaria''
END) AS TIPO_ACTIVIDAD,
c.VERIFICADO_AFIP AS VERIFICADO_AFIP,
c.FECHA_VERIFICADO,
c.CODIGO_PERSONA_CLIENTE AS CODIGO_PERSONA,
d.TIPODOCUMENTO AS TIPO_DOCUMENTO,
d.NUMERODOCUMENTO AS NUMERO_DOCUMENTO,
c.ORDINAL_ACTIVIDAD AS ORDINAL
FROM CLI_ACTIVIDAD_ECONOMICA c INNER JOIN 
CLI_Cod_Act_AFIP a ON c.CODIGO_ACTIVIDAD=a.CODIGO_ACT_AFIP AND c.TZ_LOCK=0 
LEFT JOIN CLI_DocumentosPFPJ d ON d.NUMEROPERSONAFJ=c.CODIGO_PERSONA_CLIENTE

)X GROUP BY 
X.COD_ACTIVIDAD



')

execute ('

CREATE VIEW VW_ACT_ECO AS
SELECT
COD_ACTIVIDAD,
DESCRIPCION,
PERIODO_ACTIVIDAD,
TIPO_ACTIVIDAD,
VERIFICADO_AFIP,
FECHA_VERIFICADO,
CODIGO_PERSONA,
TIPO_DOCUMENTO,
NUMERO_DOCUMENTO,
ORDINAL
FROM
(     

SELECT
c.CODIGO_ACTIVIDAD AS COD_ACTIVIDAD,
a.DESCRIPCION,
c.INICIO_ACTIVIDAD AS PERIODO_ACTIVIDAD,
(CASE c.ORDINAL_ACTIVIDAD
WHEN 1 THEN ''Primaria''
ELSE ''Secundaria''
END) AS TIPO_ACTIVIDAD,
c.VERIFICADO_AFIP AS VERIFICADO_AFIP,
c.FECHA_VERIFICADO,
c.CODIGO_PERSONA_CLIENTE AS CODIGO_PERSONA,
d.TIPODOCUMENTO AS TIPO_DOCUMENTO,
d.NUMERODOCUMENTO AS NUMERO_DOCUMENTO,
c.ORDINAL_ACTIVIDAD AS ORDINAL
FROM CLI_ACTIVIDAD_ECONOMICA c INNER JOIN 
CLI_Cod_Act_AFIP a ON c.CODIGO_ACTIVIDAD=a.CODIGO_ACT_AFIP AND c.TZ_LOCK=0 
LEFT JOIN CLI_DocumentosPFPJ d ON d.NUMEROPERSONAFJ=c.CODIGO_PERSONA_CLIENTE

)X

')


execute ('

INSERT INTO dbo.DESCRIPTORES (TITULO, IDENTIFICACION, TIPODEARCHIVO, DESCRIPCION, GRUPODELMAPA, NOMBREFISICO, TIPODEDBMS, LARGODELREGISTRO, INICIALIZACIONDELREGISTRO, BASE, SELECCION, ACEPTA_MOVS_DIFERIDO)
VALUES (10, 262, NULL, ''Actividad Economica en Topaz'', 0, ''VW_ACT_ECO'', ''D'', NULL, NULL, ''Top/Clientes'', NULL, ''N'')


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34951, NULL, 0, ''Código Actividad'', ''Código Actividad'', 12, ''A'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 262, ''COD_ACTIVIDAD'', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34952, NULL, 0, ''Descripcion'', ''Descripcion'', 400, ''A'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 262, ''DESCRIPCION'', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34953, NULL, 0, ''Tipo Actividad'', ''Tipo Actividad'', 10, ''A'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 262, ''TIPO_ACTIVIDAD'', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34954, NULL, 0, ''Verificado AFIP'', ''Verificado AFIP'', 1, ''A'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 262, ''VERIFICADO_AFIP'', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34955, NULL, 0, ''Fecha Verificado'', ''Fecha Verificado'', 8, ''F'', 0, ''F'', 0, 0, 0, 0, 0, 0, 0, 262, ''FECHA_VERIFICADO'', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34956, NULL, 0, ''Código Persona'', ''Código Persona'', 12, ''N'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 262, ''CODIGO_PERSONA'', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34957, NULL, 0, ''Tipo Documento'', ''Tipo Documento'', 4, ''A'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 262, ''TIPO_DOCUMENTO'', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34958, NULL, 0, ''Numero Documento'', ''Numero Documento'', 20, ''A'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 262, ''NUMERO_DOCUMENTO'', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34959, '' '', 0, ''Ordinal'', ''Ordinal'', 3, ''N'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 262, ''ORDINAL'', 0, NULL)


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34960, '' '', 0, ''Periodo Inicio Actividad'', ''Período Inicio Actividad'', 7, ''A'', 0, ''M'', 0, 0, 0, 0, 0, 0, 0, 262, ''PERIODO_ACTIVIDAD'', 0, ''mm/aaaa'')




INSERT INTO dbo.AYUDAS (NUMERODEARCHIVO, NUMERODEAYUDA, DESCRIPCION, FILTRO, MOSTRARTODOS, CAMPOS, CAMPOSVISTA, BASEVISTA, NOMBREVISTA, AYUDAGRANDE)
VALUES (262, 2621, ''Ayuda Principal'', '''', 0, ''34951R;34952;34953;34954;34955;34959R;'', NULL, NULL, NULL, 0)



INSERT INTO dbo.INDICES (NUMERODEARCHIVO, NUMERODEINDICE, DESCRIPCION, CLAVESREPETIDAS, CAMPO1, CAMPO2, CAMPO3, CAMPO4, CAMPO5, CAMPO6, CAMPO7, CAMPO8, CAMPO9, CAMPO10, CAMPO11, CAMPO12, CAMPO13, CAMPO14, CAMPO15, CAMPO16, CAMPO17, CAMPO18, CAMPO19, CAMPO20)
VALUES (262, 1, ''Indice Principal'', 0, 34951, 34959, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)




INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (34961, '' '', 0, ''Ayuda Actividad Economica Topaz'', ''Ayuda Actividad Economica Topaz'', 3, ''N'', 0, NULL, 0, 0, 0, 0, 0, 2621, 0, 0, NULL, 0, NULL)

')

execute ('

UPDATE dbo.DICCIONARIO
SET NUMERODECAMPO = 1255
	, USODELCAMPO = '' ''
	, REFERENCIA = 0
	, DESCRIPCION = ''Inicio de actividad''
	, PROMPT = ''Inicio Activid.''
	, LARGO = 7
	, TIPODECAMPO = ''A''
	, DECIMALES = 0
	, EDICION = NULL
	, CONTABILIZA = 0
	, CONCEPTO = 0
	, CALCULO = 0
	, VALIDACION = 0
	, TABLADEVALIDACION = 0
	, TABLADEAYUDA = 0
	, OPCIONES = 0
	, TABLA = 27
	, CAMPO = ''INICIO_ACTIVIDAD''
	, BASICO = 0
	, MASCARA = NULL
WHERE NUMERODECAMPO = 1255

')