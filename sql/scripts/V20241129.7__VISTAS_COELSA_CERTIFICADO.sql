EXECUTE('
	IF OBJECT_ID (''dbo.VW_CHEQUES_COELSA'') IS NOT NULL
		DROP VIEW dbo.VW_CHEQUES_COELSA
')

EXECUTE('
	CREATE VIEW [dbo].[VW_CHEQUES_COELSA] AS
	SELECT DISTINCT
		CP.CODIGOCLIENTE AS NumeroCliente,
		S.CUENTA AS NumeroCuenta,
		CHE.NUMEROCHEQUE AS NumeroCheque,
		CHE.ESTADO AS Estado,
		CHE.IMPORTE AS Importe,
		CHE.FECHAESTADO AS Fecha,
		CHE.SUCURSAL AS Sucursal,
		CHE.MONEDA AS Moneda,
		CHE.PRODUCTO AS Producto, 
		CHE.OPERACION AS Operacion, 
		CHE.ORDINAL AS Ordinal,
		CHE.SERIE AS Serie
	FROM
		SALDOS S
	INNER JOIN CHE_CHEQUES CHE WITH(NOLOCK) ON
		S.CUENTA=CHE.CUENTA
	INNER JOIN CLI_ClientePersona CP WITH(NOLOCK) ON
		S.C1803 = CP.CODIGOCLIENTE
	WHERE
		CP.TITULARIDAD = ''T''
		AND CHE.ESTADO=''R''
		AND CHE.SERIE=''E''
		AND ((CHE.TZ_LOCK < 100000000000000 OR CHE.TZ_LOCK >= 200000000000000)
			AND (CHE.TZ_LOCK < 300000000000000 OR CHE.TZ_LOCK >= 400000000000000))
')

EXECUTE('
	IF OBJECT_ID (''dbo.VW_CHEQUES_RECHAZADOS'') IS NOT NULL
		DROP VIEW dbo.VW_CHEQUES_RECHAZADOS
')

EXECUTE('
	CREATE VIEW [dbo].[VW_CHEQUES_RECHAZADOS] AS
	SELECT  
		CHE.NUMEROCHEQUE AS NumeroCheque,
		CHE.CUENTA AS Cuenta,
		CHE.ESTADO AS Estado,
		CHE.IMPORTE AS Importe,
		CHE.FECHAESTADO AS Fecha
	FROM
		CHE_CHEQUES CHE
	WHERE
		CHE.ESTADO=''R''
')