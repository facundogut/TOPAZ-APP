Execute('DROP TABLE IF EXISTS dbo.ITF_LK_ATM_COMISIONES;
CREATE TABLE dbo.ITF_LK_ATM_COMISIONES (
	CAJERO_TIPO VARCHAR(8) NOT NULL,
	CUENTA_PRODUCTO NUMERIC(5,0) NOT NULL,
	CUENTA_MONEDA NUMERIC (4,0) NOT NULL, 
	COMISION_IMPORTE NUMERIC(15,2) NOT NULL DEFAULT 0,
	TZ_LOCK NUMERIC(15,0) NOT NULL DEFAULT 0,
	CONSTRAINT PK_ITF_LK_ATM_COMISIONES PRIMARY KEY (CAJERO_TIPO, CUENTA_PRODUCTO, CUENTA_MONEDA)
);')

Execute('INSERT INTO dbo.ITF_LK_ATM_COMISIONES (
	CAJERO_TIPO, CUENTA_PRODUCTO, CUENTA_MONEDA, COMISION_IMPORTE
) VALUES
(''LINKNBCH'', 	1,  1,	0),
(''LINKOTRO'',	1,	1,	1097.47),
(''BANELCO'', 	1,	1,	1604.46),
(''EXTERIOR'',	1,	1,	6417.84),
(''EXTERIOR'',	6,	1,	6417.84),	-- PRODUCTOS 6 Y 16 SON DE AYUDA SOCIAL
(''EXTERIOR'',	16,	1,	6417.84),
(''LINKOTRO'',	24,	1,	948.64),
(''BANELCO'',		24,	1,	1386.66),
(''EXTERIOR'',	24,	1,	5546.64),
(''LINKOTRO'',	7,	1,	1097.47),
(''BANELCO'',		7,	1,	1604.46),
(''EXTERIOR'',	7,	1,	6417.84),
(''LINKOTRO'',	1,	2,	1),
(''BANELCO'',		1,	2,	1),
(''EXTERIOR'',	1,	2,	3.5),
(''LINKOTRO'',	5,	1,	1097.47),
(''BANELCO'',		5,	1,	1604.46),
(''EXTERIOR'',	5,	1,	6417.84),
(''LINKOTRO'',	5,	2,	1),
(''BANELCO'',		5,	2,	1),
(''EXTERIOR'',	5,	2,	3.5),
(''LINKOTRO'',	51,	1,	1097.47),
(''BANELCO'',		51,	1,	1604.46),
(''EXTERIOR'',	51,	1,	6417.84),
(''LINKOTRO'',	52,	1,	1097.47),
(''BANELCO'',		52,	1,	1604.46),
(''EXTERIOR'',	52,	1,	6417.84)
;')


Execute('DROP TABLE IF EXISTS dbo.ITF_LK_ATM_COMISIONES_EXCLUSIONES;
CREATE TABLE dbo.ITF_LK_ATM_COMISIONES_EXCLUSIONES (
	PRODUCTO NUMERIC(5,0) NOT NULL PRIMARY KEY,
	MOTIVO VARCHAR(50) NOT NULL,
	HABILITADO NUMERIC(1,0) NOT NULL,
	TZ_LOCK NUMERIC(15,0) NOT NULL DEFAULT 0
);')

Execute('INSERT INTO dbo.ITF_LK_ATM_COMISIONES_EXCLUSIONES (
	PRODUCTO, MOTIVO, HABILITADO
) VALUES 
(23,	''Sueldos Publicos'',				1),
(3,		''Sueldos Privados'',				1),
(9,		''DJ Ejecutivas'',				1),
(10,	''DJ Alimentos/Litis'',			1),
(24,	''Cuenta Gratuita Universal'',	1),
(4,		''ANSES'',						1),
(6,		''UVHI'',							1),
(16,	''Becas Provinciales'',			1),
(12,	''Fondo de Cese Laboral'',		1),
(13,	''Cuenta Operativa NBCH'',		1)
;')

Execute('DROP TABLE IF EXISTS dbo.ITF_LK_ATM_COMISIONES_COBRADAS;
CREATE TABLE dbo.ITF_LK_ATM_COMISIONES_COBRADAS (
	TRANSACCION_FECHA VARCHAR(9) NOT NULL,
	TRANSACCION_HORA VARCHAR(8) NOT NULL,
	TRANSACCION_SECUENCIA_NUMERO VARCHAR(12) NOT NULL,
	TRANSACCION_TERMINAL_NUMERO VARCHAR(16) NOT NULL,
	TRANSACCION_CODIGO VARCHAR(2) NOT NULL,
	ASIENTO_FECHA DATETIME NULL,
	ASIENTO_SUCURSAL NUMERIC(5,0) NULL,
	ASIENTO_NUMERO NUMERIC(10,0) NULL,
	ATM_RED_LOGICA VARCHAR(4) NOT NULL,
	ATM_FIID VARCHAR(4) NOT NULL,
	ATM_PAIS VARCHAR(2) NOT NULL,
	ATM_TIPO VARCHAR(8) NOT NULL,
	CUENTA_JTS_OID NUMERIC(10,0) NOT NULL,
	CUENTA_TIPO VARCHAR(2) NOT NULL,
	CUENTA_MONEDA NUMERIC(5,0) NOT NULL,
	CUENTA_NUMERO VARCHAR(19) NOT NULL,
	BASE_IMPONIBLE NUMERIC(15,2) NULL,
	COMISIONES NUMERIC(15,2) NULL,
	IMPUESTOS NUMERIC(15,2) NULL,
	ID_MOVIMIENTO_PENDIENTE BIGINT NULL,
	CONSTRAINT PK_ITF_LK_ATM_COMISIONES_COBRADAS PRIMARY KEY (TRANSACCION_FECHA, TRANSACCION_HORA, TRANSACCION_SECUENCIA_NUMERO, TRANSACCION_TERMINAL_NUMERO)
);')

Execute('DELETE FROM ITF_MASTER_PARAMETROS WHERE CODIGO = 1008;
INSERT INTO ITF_MASTER_PARAMETROS (
	CODIGO, CODIGO_INTERFACE, FUNCIONALIDAD, ALFA_1
) VALUES
(1008, 2014082, ''TRANSACCIONES_COBRO'', ''10'')
;')


Execute('ALTER TABLE ITF_MATRIZ_IGR ADD TIPO_PERSONA VARCHAR(2);
ALTER TABLE ITF_MATRIZ_IGR ADD CANAL NUMERIC(2);')

Execute('UPDATE dbo.OPERACIONES
SET COMPORTAMIENTOENCIERRE = ''I''
WHERE TITULO = 6800 AND IDENTIFICACION = 8915;


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (21327, '' '', 0, ''TIPO_PERSONA'', ''Tipo Persona'', 2, ''A'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 848, ''Tipo Persona'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (21328, '' '', 0, ''CANAL'', ''Canal'', 2, ''N'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 848, ''Canal'', 0, NULL)')

Execute('DROP TABLE IF EXISTS dbo.SBCMPI;
CREATE TABLE dbo.SBCMPI (
	ID BIGINT NOT NULL IDENTITY(1,1) PRIMARY KEY,
	SATELITE VARCHAR(10) NOT NULL,
	CAUSAL VARCHAR(10) NOT NULL,
	CUENTA_JTS_OID NUMERIC(10,0) NOT NULL,
	IMPORTE NUMERIC(15,2) NOT NULL,
	MONEDA NUMERIC(4,0) NOT NULL,
	FECHA_A_COBRAR DATETIME NOT NULL,
	FECHA_VENCIMIENTO DATETIME NULL,
	FECHA_ALTA DATETIME NOT NULL,
	ESTADO VARCHAR(1) NOT NULL DEFAULT ''I'',
	RESULTADO_ULTIMA_EJECUCION VARCHAR(100) NOT NULL DEFAULT 0,
	BANDEJA_JTS_OID BIGINT NULL,
	ASIENTO_FECHA DATETIME NULL,
	ASIENTO_SUCURSAL NUMERIC(5,0) NULL,
	ASIENTO_NUMERO NUMERIC(10,0) NULL,
	TZ_LOCK NUMERIC(15,0) NOT NULL DEFAULT 0
);')

EXEC('
    DELETE FROM OPERACIONES WHERE IDENTIFICACION IN (5254,5255);
');

EXEC('
    INSERT INTO OPERACIONES (TITULO,IDENTIFICACION,NOMBRE,DESCRIPCION,MNEMOTECNICO,AUTORIZACION,FORMULARIOPRINCIPAL,PROXOPERACION,ESTADO,TZ_LOCK,COPIAS,SUBOPERACION,PERMITEBAJA,COMPORTAMIENTOENCIERRE,REQUIERECONTRASENA,PERMITECONCURRENTE,PERMITEESTADODIFERIDO,ICONO_TITULO,ESTILO) VALUES
        (6800,5254,''ABMC LK ATM COMISIONES'',''ABMC LK ATM COMISIONES'',''5254'',''N'',NULL,NULL,''P'',0,NULL,0,''S'',''N'',''N'',''N'',''S'',NULL,0),
        (6800,5255,''ABMC LK ATM COMISIONES EXCLUSIONES'',''ABMC LK ATM COMISIONES EXCLUSIONES'',''5255'',''N'',NULL,NULL,''P'',0,NULL,0,''S'',''N'',''N'',''N'',''S'',NULL,0);
');

EXEC('
    DELETE FROM DESCRIPTORES WHERE IDENTIFICACION IN (870,871);
');

EXEC('
    INSERT INTO DESCRIPTORES (TITULO,IDENTIFICACION,TIPODEARCHIVO,DESCRIPCION,GRUPODELMAPA,NOMBREFISICO,TIPODEDBMS,LARGODELREGISTRO,INICIALIZACIONDELREGISTRO,BASE,SELECCION,ACEPTA_MOVS_DIFERIDO) VALUES
	    (930,870,NULL,''LK_ATM_COMISIONES'',0,''LK_ATM_COMISIONES'',''D'',NULL,NULL,''Top/Clientes'',NULL,''N''),
	    (930,871,NULL,''LK_ATM_COMISIONES_EXCLUSIONES'',0,''LK_ATM_COMISIONES_EXCLUSIONES'',''D'',NULL,NULL,''Top/Clientes'',NULL,''N'');
');

EXEC('
    DELETE FROM DICCIONARIO WHERE TABLA IN (871,871) OR NUMERODECAMPO IN (41507, 41508, 41509, 41510, 41511, 41512, 41513, 41514, 41515);
');

EXEC('
    INSERT INTO diccionario (NUMERODECAMPO,USODELCAMPO,REFERENCIA,DESCRIPCION,PROMPT,LARGO,TIPODECAMPO,DECIMALES,EDICION,CONTABILIZA,CONCEPTO,CALCULO,VALIDACION,TABLADEVALIDACION,TABLADEAYUDA,OPCIONES,TABLA,CAMPO,BASICO,MASCARA) VALUES
        (41507,NULL,0,''Ayuda LK Comisiones'',''Ayuda LK Comisiones'',5,''N'',0,NULL,0,0,0,0,0,8701,0,0,''C41507'',0,NULL),
        (41508,NULL,0,''Ayuda LK Com. Exclusiones'',''Ayuda LK Com. Exclusiones'',5,''N'',0,NULL,0,0,0,0,0,8711,0,0,''C41508'',0,NULL),
        (41509,NULL,0,''CAJERO_TIPO'',''CAJERO_TIPO'',8,''A'',0,NULL,0,0,0,0,0,0,1,870,''CAJERO_TIPO'',0,NULL),
        (41510,NULL,0,''CUENTA_PRODUCTO'',''CUENTA_PRODUCTO'',5,''N'',0,NULL,0,0,0,0,0,0,0,870,''CUENTA_PRODUCTO'',0,NULL),
        (41511,NULL,0,''CUENTA_MONEDA'',''CUENTA_MONEDA'',4,''N'',0,NULL,0,0,0,0,0,0,0,870,''CUENTA_MONEDA'',0,NULL),
        (41512,NULL,0,''COMISION_IMPORTE'',''COMISION_IMPORTE'',15,''N'',2,''I'',0,0,0,0,0,0,0,870,''COMISION_IMPORTE'',0,NULL),
        (41513,NULL,0,''PRODUCTO'',''PRODUCTO'',5,''N'',0,'''',0,0,0,0,0,0,0,871,''PRODUCTO'',0,NULL),
        (41514,NULL,0,''MOTIVO'',''MOTIVO'',50,''A'',0,''I'',0,0,0,0,0,0,0,871,''MOTIVO'',0,NULL),
        (41515,NULL,0,''HABILITADO'',''HABILITADO'',1,''N'',0,''I'',0,0,0,0,0,0,1,871,''HABILITADO'',0,NULL);
');

EXEC('
    DELETE FROM INDICES WHERE NUMERODEARCHIVO IN (870,871);
');

EXEC('
    INSERT INTO INDICES (NUMERODEARCHIVO,NUMERODEINDICE,DESCRIPCION,CLAVESREPETIDAS,CAMPO1,CAMPO2,CAMPO3,CAMPO4,CAMPO5,CAMPO6,CAMPO7,CAMPO8,CAMPO9,CAMPO10,CAMPO11,CAMPO12,CAMPO13,CAMPO14,CAMPO15,CAMPO16,CAMPO17,CAMPO18,CAMPO19,CAMPO20) VALUES
	    (870,1,''i1 LK_ATM_COMISIONES'',0,41509,41510,41511,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL),
	    (871,1,''i1 LK_ATM_COMISIONES_EXCL.'',0,41513,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);
');

EXEC('
    DELETE FROM AYUDAS WHERE NUMERODEAYUDA IN (8701,8711);
');

EXEC('
    INSERT INTO AYUDAS (NUMERODEARCHIVO,NUMERODEAYUDA,DESCRIPCION,FILTRO,MOSTRARTODOS,CAMPOS,CAMPOSVISTA,BASEVISTA,NOMBREVISTA,AYUDAGRANDE) VALUES
	    (870,8701,''Ay.LK ATM COM.'',NULL,NULL,''41509R;41510R;41511R;41512;'',NULL,NULL,NULL,0),
	    (871,8711,''Ay.LK ATM COM. Excl.'',NULL,NULL,''41513R;41514;41515;'',NULL,NULL,NULL,0);
');

EXEC('
    DELETE FROM OPCIONES WHERE NUMERODECAMPO IN (41509,41515);
');

EXEC('
    INSERT INTO OPCIONES (NUMERODECAMPO,IDIOMA,DESCRIPCION,OPCIONINTERNA,OPCIONDEPANTALLA) VALUES
        (41509,''E'','''',''BANELCO'',''BANELCO''),
        (41509,''E'','''',''EXTERIOR'',''EXTERIOR''),
        (41509,''E'','''',''LINKNBCH'',''LINK NBCH''),
        (41509,''E'','''',''LINKOTRO'',''LINK OTRO''),
        (41515,''E'',''DESHABILITADO'',''0'',''0''),
        (41515,''E'',''HABILITADO'',''1'',''1'');
');

