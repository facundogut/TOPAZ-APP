DROP TABLE IF EXISTS dbo.MAESTRO_TRANSFERENCIAS;

CREATE TABLE dbo.MAESTRO_TRANSFERENCIAS (
	ID BIGINT NOT NULL IDENTITY(1,1) PRIMARY KEY,
	CANAL VARCHAR(2) NOT NULL,
	INTERFAZ VARCHAR(10) NOT NULL,
	LINK_TERMINAL VARCHAR(2) NULL,
	MOTIVO VARCHAR(3) NOT NULL,
	REFERENCIA VARCHAR(15) NOT NULL,
	SOLICITUD_FECHA DATETIME NULL,
	ORIGEN_ENTIDAD NUMERIC(5,0) NULL,
	ORIGEN_SUBSISTEMA VARCHAR(2) NULL,
	ORIGEN_SUCURSAL NUMERIC(5,0) NULL,
	ORIGEN_CUENTA NUMERIC(13,0) NULL,
	ORIGEN_CUIT NUMERIC(11,0) NULL,
	ORIGEN_RAZON_SOCIAL VARCHAR(50) NULL,
	ORIGEN_CBU VARCHAR(22) NULL,
	ORIGEN_ASIENTO_NUMERO NUMERIC(10,0) NULL,
	ORIGEN_ASIENTO_FECHA DATETIME NULL,
	ORIGEN_ASIENTO_SUCURSAL NUMERIC(5,0) NULL,
	DESTINO_ENTIDAD NUMERIC(5,0) NULL,
	DESTINO_SUBSISTEMA VARCHAR(2) NULL,
	DESTINO_SUCURSAL NUMERIC(5,0) NULL,
	DESTINO_CUENTA NUMERIC(13,0) NULL,
	DESTINO_CUIT NUMERIC(11,0) NULL,
	DESTINO_RAZON_SOCIAL VARCHAR(50) NULL,
	DESTINO_CBU VARCHAR(22) NULL,
	DESTINO_ASIENTO_NUMERO NUMERIC(10,0) NULL,
	DESTINO_ASIENTO_FECHA DATETIME NULL,
	DESTINO_ASIENTO_SUCURSAL NUMERIC(5,0) NULL,
	MONEDA NUMERIC(5,0) NOT NULL,
	IMPORTE NUMERIC(15,2) NOT NULL,
	TITULAR VARCHAR(1) NULL,
	TZ_LOCK NUMERIC(15,0) NOT NULL DEFAULT 0
);

CREATE UNIQUE NONCLUSTERED INDEX IDX_MAESTRO_TRANSFERENCIAS_ASIENTO_ORIGEN ON MAESTRO_TRANSFERENCIAS(ORIGEN_ASIENTO_NUMERO, ORIGEN_ASIENTO_FECHA, ORIGEN_ASIENTO_SUCURSAL) WHERE ORIGEN_ASIENTO_NUMERO IS NOT NULL AND ORIGEN_ASIENTO_FECHA IS NOT NULL AND ORIGEN_ASIENTO_SUCURSAL IS NOT NULL;
CREATE UNIQUE NONCLUSTERED INDEX IDX_MAESTRO_TRANSFERENCIAS_ASIENTO_DESTINO ON MAESTRO_TRANSFERENCIAS(DESTINO_ASIENTO_NUMERO, DESTINO_ASIENTO_FECHA, DESTINO_ASIENTO_SUCURSAL) WHERE DESTINO_ASIENTO_NUMERO IS NOT NULL AND DESTINO_ASIENTO_FECHA IS NOT NULL AND DESTINO_ASIENTO_SUCURSAL IS NOT NULL;
