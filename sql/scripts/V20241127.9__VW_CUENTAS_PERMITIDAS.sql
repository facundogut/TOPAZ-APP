EXECUTE('
IF OBJECT_ID (''dbo.VW_CUENTAS_PERMITIDAS'') IS NOT NULL
	DROP VIEW dbo.VW_CUENTAS_PERMITIDAS
')
EXECUTE ('
CREATE VIEW VW_CUENTAS_PERMITIDAS AS
SELECT 
  s1.*
FROM 
  SALDOS s1
LEFT JOIN 
  SALDOS s2 ON s1.C1665 = s2.JTS_OID
WHERE 
  s1.TZ_LOCK = 0 
  AND s1.C1785 = 4 
  AND s2.C1651 != ''1'' 
  AND ( 
    s2.C1679 = ''0'' 
    OR NOT EXISTS (
      SELECT 1 
      FROM GRL_BLOQUEOS c 
      WHERE c.COD_BLOQUEO IN (4, 24) AND c.ESTADO = 1 
      AND c.SALDO_JTS_OID = s2.JTS_OID
    )
  )
  ')