EXECUTE('
IF OBJECT_ID (''dbo.VW_CLI_X_DOC_TODOS'') IS NOT NULL
	DROP VIEW dbo.VW_CLI_X_DOC_TODOS
')
EXECUTE('
CREATE   VIEW [VW_CLI_X_DOC_TODOS] (
					NUMERODOC,
					TIPODOC, 
					PAISDOCUMENTO,
					[CODIGOCLIENTE], 
					NOMBRECLIENTE,
					NUMEROPERSONA,
					TIPOPERSONA)
AS 
SELECT 
    V.NUMERODOCUMENTO AS NUMERODOC, 
    V.TIPODOCUMENTO AS TIPODOC, 
    v.PAISDOCUMENTO,
    R.[CODIGOCLIENTE],
    R.NOMBRECLIENTE,
    V.NUMEROPERSONAFJ AS NUMEROPERSONA,
	''F'' AS TIPOPERSONA
FROM 
    CLI_CLIENTES  AS R with (nolock) 
    inner join CLI_CLIENTEPERSONA  AS T with (nolock) on	R.[CODIGOCLIENTE] = T.[CODIGOCLIENTE] 
																
																AND ((T.TZ_LOCK < 300000000000000 OR T.TZ_LOCK >= 400000000000000) 
																AND (T.TZ_LOCK < 100000000000000 OR T.TZ_LOCK >= 200000000000000))
    inner join CLI_PERSONASFISICAS  AS U with (nolock) on	U.NUMEROPERSONAFISICA = T.NUMEROPERSONA
																AND (	(U.TZ_LOCK < 300000000000000 OR U.TZ_LOCK >= 400000000000000) 
																AND (U.TZ_LOCK < 100000000000000 OR U.TZ_LOCK >= 200000000000000))
    inner join CLI_DOCUMENTOSPFPJ  AS V with (nolock) on	U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ
																AND ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) 
																AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000))
WHERE	((R.TZ_LOCK < 300000000000000 OR R.TZ_LOCK >= 400000000000000) 
		AND (R.TZ_LOCK < 100000000000000 OR R.TZ_LOCK >= 200000000000000)) 
UNION ALL
SELECT 
        V.NUMERODOCUMENTO AS NUMERODOC, 
		V.TIPODOCUMENTO AS TIPODOC, 
		v.PAISDOCUMENTO,
		R.[CODIGOCLIENTE],
		R.NOMBRECLIENTE,
		V.NUMEROPERSONAFJ AS NUMEROPERSONA,
		''J'' AS TIPOPERSONA
FROM 
    CLI_CLIENTES  AS R with (nolock) 
	inner join CLI_CLIENTEPERSONA  AS T with (nolock) on	R.[CODIGOCLIENTE] = T.[CODIGOCLIENTE]
																
																AND ((T.TZ_LOCK < 300000000000000 OR T.TZ_LOCK >= 400000000000000) 
																AND (T.TZ_LOCK < 100000000000000 OR T.TZ_LOCK >= 200000000000000))
    inner join CLI_PERSONASJURIDICAS  AS S with (nolock) on S.NUMEROPERSONAJURIDICA = T.NUMEROPERSONA 
																AND ((S.TZ_LOCK < 300000000000000 OR S.TZ_LOCK >= 400000000000000) 
																AND (S.TZ_LOCK < 100000000000000 OR S.TZ_LOCK >= 200000000000000))
    inner join CLI_DOCUMENTOSPFPJ  AS V with (nolock) on	S.NUMEROPERSONAJURIDICA = V.NUMEROPERSONAFJ
																AND ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) 
																AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000))
WHERE	((R.TZ_LOCK < 300000000000000 OR R.TZ_LOCK >= 400000000000000) 
		AND (R.TZ_LOCK < 100000000000000 OR R.TZ_LOCK >= 200000000000000))
')
