Execute('CREATE OR ALTER PROCEDURE SP_ITF_BUSCO_ACUMULADO_INTERBANKING(
@P_IMPORTE 		NUMERIC(15,2),
@P_FECHA 		VARCHAR(8),
@P_MONEDA 		NUMERIC(1,0),
@P_JTS_OID 		NUMERIC(10,0),
@O_RETORNO  	NUMERIC (15,2) OUTPUT)
 
AS
BEGIN
	DECLARE @V_ANIO NUMERIC(4,0); 
	DECLARE @V_MES NUMERIC(2,0); 
	DECLARE @V_COUNT NUMERIC(15,2);
	DECLARE @VAL_UVA NUMERIC(15,2);
	SET @V_COUNT=0;
	SET @V_ANIO = CAST(SUBSTRING(@P_FECHA , 1, 4) AS NUMERIC(4,0)); 	
	SET @V_MES  = CAST(SUBSTRING(@P_FECHA , 5, 2) AS NUMERIC(2,0));
	SELECT @V_COUNT = ISNULL((
	    SELECT SUM(IMPORTE_MOVIMIENTOS) 
	    FROM GRL_CONTADOR_MOVIMIENTOS GRL (NOLOCK) 
	    WHERE GRL.ANIO = @V_ANIO 
	    AND GRL.MES = @V_MES 
	    AND GRL.CODIGO_TRANSACCION IN (160)
	    AND GRL.SALDOS_JTS_OID = @P_JTS_OID
	), 0)
 
		
	SELECT @VAL_UVA= (SELECT C6440 FROM MONEDAS M (NOLOCK) WHERE M.C6399=999)
	IF @P_MONEDA = 1  
	    SET @O_RETORNO = (@V_COUNT + @P_IMPORTE) / @VAL_UVA;  
	ELSE  
	    SET @O_RETORNO = (@V_COUNT + @P_IMPORTE) ;
END')