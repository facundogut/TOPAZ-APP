Execute('CREATE OR ALTER  PROCEDURE dbo.[SP_AFIP_IVA_RG18]
	@usuario varchar(50),
	@archivo VARCHAR(100)
AS
BEGIN
	--inserto en bitacora las bajas de los registgros que no vinieron en el nuevo padron
	
			INSERT INTO dbo.CON_BITACORA_IMPUESTOS (JTS_NOVEDAD, --n
													FECHA_PROCESO, 
													HORA, 
													ID_CLIENTE, --n
													ID_PERSONA, --n
													TIPO_ID, 
													CUIT, --n
													TIPO_CARGO_IMPOSITIVO,  --n
													ALICUOTA, 
													FECHA_INICIO, 
													FECHA_FIN,
													--id_cargo_impuesto,
													sucursal, --n
													tipo_novedad,
													archivo_padron,
													cod_usuario,
													CONDICION,
													num_certificado,
													valor_exclusion)
											SELECT  ISNULL((SELECT MAX(JTS_NOVEDAD) FROM CON_BITACORA_IMPUESTOS),0)+ (ROW_NUMBER() OVER (ORDER BY VV.TIPOCARGO)), 
													(SELECT FECHAPROCESO FROM PARAMETROS (NOLOCK)), 
													(select convert(varchar,getdate(),108)), 
													 a.ID_CLIENTE, 
													C.NUMEROPERSONA, 
													''C'', 
													try_convert(NUMERIC,V.NUMERODOC), 
													VV.tipocargo, 
													0, 
													a.PERIODO_DESDE, 
													a.PERIODO_HASTA,
													--car.id_cargo,
													(SELECT SUCURSALvinculada FROM CLI_CLIENTES WHERE codigocliente=a.ID_CLIENTE AND TZ_LOCK=0),
													''B'',
													substring(@archivo,1,30),
													@usuario,
													VV.SEGMENTO,
													''RG18'',
													100
						FROM ITF_IVARG18_PERCEPCION_ULT_PADRON_AUX A  							
						INNER JOIN CLI_ClientePersona c ON A.ID_CLIENTE=c.CODIGOCLIENTE
						INNER JOIN CI_CARGOS_TARIFAS CAR ON A.ID_CLIENTE=car.ID_CLIENTE
						INNER JOIN VW_CLIENTES_PERSONAS V ON V.NUMEROPERSONA=C.NUMEROPERSONA 
						INNER JOIN VW_CARGOS_IMPUESTOS VV ON vv.id_cargo= CAr.id_cargo								
						WHERE a.ID_CLIENTE NOT IN (SELECT try_convert(NUMERIC,VW.CODIGOCLIENTE)
						 					   FROM VW_CLIENTES_PERSONAS VW, ITF_AFIP_IVA_RG18 RG
						 					   WHERE try_convert(NUMERIC,VW.NUMERODOC)=RG.CUIT
						 					   AND VW.TITULARIDAD=''T'')
						AND C.TZ_LOCK=0
						AND car.TZ_LOCK=0
						AND VV.TIPOCARGO = 2 -- Filtro pedido por Vives 17/2/2025
						--AND imp.TZ_LOCK=0
						GROUP BY vv.TIPOCARGO,a.ID_CLIENTE,C.NUMEROPERSONA,V.NUMERODOC,a.PERIODO_DESDE,a.PERIODO_HASTA,VV.SEGMENTO



 --limpio tablas

	DELETE ci FROM CI_CARGOS_TARIFAS ci
	INNER JOIN VW_CARGOS vw ON ci.ID_CARGO=vw.ID_CARGO
	WHERE RANGO_HASTA IN (9999999999998)
	AND vw.TIPOCARGO = 2 --Antes in (2,3) Vives pidió cambiar para solo 2. 17/2/2025
	AND ci.ID_CLIENTE!=0
	
	DELETE ci FROM CI_IMPUESTOS_TARIFAS ci
	INNER JOIN vw_impuestos vw ON ci.ID_IMPUESTO=vw.ID_IMPUESTO
	WHERE RANGO_HASTA IN (9999999999998)
	AND vw.TIPOCARGO = 2 --Antes in (2,3) Vives pidió cambiar para solo 2. 17/2/2025
	AND ci.ID_CLIENTE != 0
	
	TRUNCATE TABLE ITF_IVARG18_PERCEPCION_ULT_PADRON_AUX

 --cargo tabla con nuevo padron

	INSERT INTO ITF_IVARG18_PERCEPCION_ULT_PADRON_AUX (PERIODO_DESDE, 
											   	   		PERIODO_HASTA, 
											   	   		INCISO_RESOLUCION_GRAL,
											   	   		RAZON_SOCIAL, 
											   	   		ID_CLIENTE)
											SELECT DISTINCT RG.PERIODO_DESDE, 
	   												RG.PERIODO_HASTA, 
	   												RG.INCISO_RESOLUCION_GRAL, 
	   												RG.RAZON_SOCIAL,
	   												VW.CODIGOCLIENTE
											FROM VW_CLIENTES_PERSONAS VW, ITF_AFIP_IVA_RG18 RG
											WHERE try_convert(NUMERIC,VW.NUMERODOC)=RG.CUIT
											AND VW.TITULARIDAD=''T''
	

 --limpio tablas

	DELETE ci FROM CI_CARGOS_TARIFAS ci
	INNER JOIN VW_CARGOS vw ON ci.ID_CARGO=vw.ID_CARGO
	INNER JOIN ITF_IVARG18_PERCEPCION_ULT_PADRON_AUX p ON ci.ID_Cliente=p.ID_Cliente
	WHERE RANGO_HASTA = 9999999999997
	AND vw.TIPOCARGO = 2 --Antes in (2,3) Vives pidió cambiar para solo 2. 17/2/2025
	AND ci.ID_CLIENTE!=0
	
	DELETE ci FROM CI_IMPUESTOS_TARIFAS ci
	INNER JOIN vw_impuestos vw ON ci.ID_IMPUESTO=vw.ID_IMPUESTO
	INNER JOIN ITF_IVARG18_PERCEPCION_ULT_PADRON_AUX p ON ci.ID_Cliente=p.ID_Cliente
	WHERE RANGO_HASTA = 9999999999997
	AND vw.TIPOCARGO = 2 --Antes in (2,3) Vives pidió cambiar para solo 2. 17/2/2025
	AND ci.ID_CLIENTE != 0


	--doy de alta los registros que vienen en el nuevo padron
	
					INSERT INTO dbo.CI_CARGOS_TARIFAS (ID_CARGO, 
												   		MONEDA, 
												   		ID_CLIENTE, 
												   		SEGMENTO, 
												   		FECHA_DESDE, 
												   		FECHA_HASTA,
												   		tasa,
												   		rango_hasta,
												   		MONEDA_IMPORTE) 
					SELECT DISTINCT vw.ID_CARGO, 
					   		vw.MONEDA, 
					   		a.ID_CLIENTE, 
					   		vw.segmento, 
					   		a.PERIODO_DESDE, 
					   		a.PERIODO_HASTA,
					   		0,
					   		9999999999998,
					   		vw.MONEDA
					FROM VW_CARGOS vw, ITF_IVARG18_PERCEPCION_ULT_PADRON_AUX a, CLI_CLIENTES c
					WHERE a.ID_CLIENTE=c.CODIGOCLIENTE
					AND c.ESTADO=0 
					AND c.TZ_LOCK=0
					And vw.TIPOCARGO = 2
	
	
					INSERT INTO dbo.CI_impuestoS_TARIFAS (ID_impuesto, 
												   		MONEDA, 
												   		ID_CLIENTE, 
												   		SEGMENTO, 
												   		FECHA_DESDE, 
												   		FECHA_HASTA,
												   		tasa,
												   		rango_hasta,
												   		MONEDA_IMPORTE,
												   		IMPORTE_APLICAR) 
					SELECT distinct vw.ID_impuesto, 
					   		vw.MONEDA, 
					   		a.ID_CLIENTE, 
					   		vw.segmento, 
					   		a.PERIODO_DESDE, 
					   		a.PERIODO_HASTA,
					   		0,
					   		9999999999998,
					   		vw.MONEDA,
					   		0
					FROM VW_impuestOS vw, ITF_IVARG18_PERCEPCION_ULT_PADRON_AUX a, CLI_CLIENTES c
					WHERE a.ID_CLIENTE=c.CODIGOCLIENTE
					AND c.ESTADO=0 
					AND c.TZ_LOCK=0		
					and vw.TIPOCARGO = 2 -- Filtro pedido por Vives 17/2/2025
	
	
   --inserto en bitacora Altas de cargos y de impuestos	
	
						INSERT INTO dbo.CON_BITACORA_IMPUESTOS (JTS_NOVEDAD, 
													FECHA_PROCESO, 
													HORA, 
													ID_CLIENTE, 
													ID_PERSONA,
													TIPO_ID, 
													CUIT, 
													TIPO_CARGO_IMPOSITIVO, 
													ALICUOTA, 
													FECHA_INICIO, 
													FECHA_FIN,
													--id_cargo_impuesto,
													sucursal,
													tipo_novedad,
													ARCHIVO_PADRON,
													cod_usuario,
													CONDICION,
													num_certificado,
													valor_exclusion)
											SELECT  ISNULL((SELECT MAX(JTS_NOVEDAD) FROM CON_BITACORA_IMPUESTOS),0)+ (ROW_NUMBER() OVER (ORDER BY VV.TIPOCARGO)), 
													(SELECT FECHAPROCESO FROM PARAMETROS (NOLOCK)), 
													(select convert(varchar,getdate(),108)), 
													 a.ID_CLIENTE, 
													C.NUMEROPERSONA, 
													''C'', 
													V.NUMERODOC, 
													VV.tipocargo, 
													0, 
													a.PERIODO_DESDE, 
													a.PERIODO_HASTA,
													--car.id_cargo,
													(SELECT SUCURSALvinculada FROM CLI_CLIENTES WHERE codigocliente=a.ID_CLIENTE AND TZ_LOCK=0),
													''A'',
													substring(@archivo,1,30),
													@usuario,
													VV.SEGMENTO,
													''RG18'',
													100
						FROM ITF_IVARG18_PERCEPCION_ULT_PADRON_AUX A  							
						INNER JOIN CLI_ClientePersona c ON A.ID_CLIENTE=c.CODIGOCLIENTE
						INNER JOIN CLI_CLIENTES cli ON cli.codigocliente=c.codigocliente
						INNER JOIN CI_CARGOS_TARIFAS CAR ON A.ID_CLIENTE=car.ID_CLIENTE
						INNER JOIN VW_CLIENTES_PERSONAS V ON V.NUMEROPERSONA=C.NUMEROPERSONA 
						INNER JOIN VW_CARGOS_IMPUESTOS VV ON vv.id_cargo= CAr.id_cargo							
						WHERE C.TZ_LOCK=0
						AND car.TZ_LOCK=0
						AND cli.ESTADO=0
						AND cli.TZ_LOCK=0
						AND V.titularidad=''T''
						AND VV.TIPOCARGO = 2 -- Filtro pedido por Vives 17/2/2025
						GROUP BY vv.TIPOCARGO,a.ID_CLIENTE,C.NUMEROPERSONA, V.NUMERODOC,a.PERIODO_DESDE,a.PERIODO_HASTA,VV.SEGMENTO


					--inserto en el log los cargos faltantes	SE INSERTA UNO POR TIPO DE CARGO AGRUPAR POR CARGO
			INSERT INTO dbo.ITF_LOG_CARGOS_IMPUESTOS (COD_IMPUESTO,
														PERIODO_DESDE,  
														PERIODO_HASTA, 
														COD_CLIENTE, 
														ID_PERSONA, 
														FECHA_PROCESO, 
														FECHA_EJECUCION, 
														CONDICION, 
														ALICUOTA)
												SELECT vv.TIPOCARGO, 
					   									CONVERT(VARCHAR(8), a.PERIODO_DESDE, 112), 
					   									CONVERT(VARCHAR(8), a.PERIODO_HASTA, 112),
												   		a.ID_CLIENTE, 
												   		c.NUMEROPERSONA, 
												   		CONVERT(VARCHAR(8),(SELECT FECHAPROCESO FROM PARAMETROS (NOLOCK)), 112), 
												   		CONVERT(VARCHAR(8), GETDATE(), 112),
												   		vv.SEGMENTO,
												   		0 
						FROM ITF_IVARG18_PERCEPCION_ULT_PADRON_AUX A  							
						INNER JOIN CLI_ClientePersona c ON A.ID_CLIENTE=c.CODIGOCLIENTE
						INNER JOIN CLI_CLIENTES cli ON cli.codigocliente=c.codigocliente
						INNER JOIN CI_CARGOS_TARIFAS CAR ON A.ID_CLIENTE=car.ID_CLIENTE
						INNER JOIN VW_CLIENTES_PERSONAS V ON V.NUMEROPERSONA=C.NUMEROPERSONA 
						INNER JOIN VW_CARGOS_IMPUESTOS VV ON vv.id_cargo= CAr.id_cargo							
						WHERE C.TZ_LOCK=0
						AND car.TZ_LOCK=0
						AND cli.ESTADO=0
						AND cli.TZ_LOCK=0
						AND V.titularidad=''T''
						AND VV.TIPOCARGO = 2 -- Filtro pedido por Vives 17/2/2025
						GROUP BY vv.TIPOCARGO,vv.SEGMENTO,a.ID_CLIENTE,C.NUMEROPERSONA, V.NUMERODOC,a.PERIODO_DESDE,a.PERIODO_HASTA

		   			 		   
			--para el reporte de inconsistencias		 
			   	INSERT INTO ITF_AFIP_RG18_INCONSISTENCIAS (COD_CLIENTE, 
			   											   NRO_PERSONA, 
			   											   CUIT, 
			   											   RAZON_SOCIAL, 
			   											   CONDICION_IVA, 
			   											   TIPO_CERTIFICADO,	
			   											   PORCENTAJE,	
			   											   FECHA_DESDE,
			   											   FECHA_HASTA,
			   											   COMENTARIO)
				SELECT DISTINCT a.ID_CLIENTE, 
						v.NUMEROPERSONA, 
						v.NUMERODOC, 
						a.RAZON_SOCIAL,  
						cli.IVA,
						''RG18'' , 
						0,
						CONVERT(VARCHAR(10),a.PERIODO_DESDE, 103), 
						CONVERT(VARCHAR(10),a.PERIODO_HASTA, 103),
						''INCONSISTENCIA''
						FROM ITF_IVARG18_PERCEPCION_ULT_PADRON_AUX A  							
						INNER JOIN CLI_ClientePersona c ON A.ID_CLIENTE=c.CODIGOCLIENTE
						INNER JOIN VW_CLIENTES_PERSONAS V ON V.NUMEROPERSONA=C.NUMEROPERSONA 
						INNER JOIN cli_clientes cli ON cli.CODIGOCLIENTE=a.ID_CLIENTE							
						WHERE C.TZ_LOCK=0
						AND cli.TZ_LOCK=0
						AND (cli.IVA<>''AC'' OR cli.ESTADO!=0)
	
	
	UPDATE dbo.NUMERATORVALUES
	SET VALOR = (SELECT max(jts_novedad) FROM CON_BITACORA_IMPUESTOS)+1
	WHERE DIA = 0 AND MES = 0 AND ANIO = 0 AND SUCURSAL = 0 AND NUMERO = 66319		   		
	
END')

Execute('
delete itf_master_parametros where codigo = 550;
INSERT INTO dbo.ITF_MASTER_PARAMETROS (CODIGO, CODIGO_INTERFACE, FUNCIONALIDAD, ALFA_1, ALFA_2, ALFA_3, NUMERICO_1, NUMERICO_2, FECHA, IMPORTE_1, IMPORTE_2, TZ_LOCK)
VALUES (550, 21411, ''LK CLI - Parm SQL'', '''', '''', '''', 30, 0, NULL, 0, 0, 0)')

Execute('CREATE OR ALTER   PROCEDURE SP_ITF_BUSCO_ACUMULADO_INTERBANKING(
@P_FECHA 		VARCHAR(8),
@P_MONEDA 		NUMERIC(1,0),
@P_JTS_OID 		NUMERIC(10,0),
@O_RETORNO  	NUMERIC (15,2) OUTPUT) 

AS
BEGIN
	DECLARE @V_ANIO NUMERIC(4,0); 
	DECLARE @V_MES NUMERIC(2,0); 
	DECLARE @V_COUNT NUMERIC(15,2);
	DECLARE @VAL_UVA NUMERIC(15,2);
	
	SET @V_ANIO = CAST(SUBSTRING(@P_FECHA , 1, 4) AS NUMERIC(4,0)); 	
	SET @V_MES  = CAST(SUBSTRING(@P_FECHA , 5, 2) AS NUMERIC(2,0));
	
	SELECT @V_COUNT = (
	
	SELECT SUM(IMPORTE_MOVIMIENTOS) 
	FROM GRL_CONTADOR_MOVIMIENTOS GRL (NOLOCK) 
		WHERE 	GRL.ANIO=@V_ANIO 
		AND 	GRL.MES=@V_MES 
		AND 	GRL.CODIGO_TRANSACCION IN (160)
		AND 	GRL.SALDOS_JTS_OID=@P_JTS_OID 
	)
	
	SELECT @VAL_UVA= (SELECT C6440 FROM MONEDAS M (NOLOCK) WHERE M.C6399=999)
	
	IF @P_MONEDA = 1  
	    SET @O_RETORNO = @V_COUNT / @VAL_UVA;  
	ELSE  
	    SET @O_RETORNO = @V_COUNT;
END')

---------------------------------------------------------------------------------------------------
Execute('
INSERT INTO dbo.CI_EVENTO (ID_EVENTO, DESCRIPCION, TZ_LOCK)
VALUES (959, ''INTERBANKING'', 0)

------------------------------------------------------------------------------------
INSERT INTO dbo.CI_CARGOS_X_EVENTO (ID_CARGO, ID_EVENTO, TZ_LOCK, TIPO_RELACION, CAMPO_SEGMENTO, DESCRIPCION_SEGMENTO, PRIORIDAD)
VALUES (400, 959, 0, ''A'', 0, '''', 2)

INSERT INTO dbo.CI_CARGOS_X_EVENTO (ID_CARGO, ID_EVENTO, TZ_LOCK, TIPO_RELACION, CAMPO_SEGMENTO, DESCRIPCION_SEGMENTO, PRIORIDAD)
VALUES (950, 959, 0, ''A'', 0, '''', 1)

------------------------------------------------------------------------------------

INSERT INTO dbo.CI_CARGOS (ID_CARGO, DESCRIPCION, ENQUEUE, EXONERABLE, ID_FORMULA, ACTUALIZABLE, CONDICION, PIVOT_, MONEDA_IMPORTE, IMPORTE_MINIMO, IMPORTE_MAXIMO, TRATAMIENTO_MINIMO, TZ_LOCK, CAMPO_MONTO_IMPONIBLE, CAMPO_RANGO_TARIFA, NETEAR, CANTIDAD_REINTENTOS, CONCEPTO, PIVOT_ENCOLA, CONTABILIZA, SOBREGIRO, BLOQUEO, CONTROL_MAX_MIN, TIPO_FECHA_VIGENCIA, TIPO_DOCUMENTO, ACEPTAPAGOPARCIAL, FECHAHASTA, FECHADESDE, MONEDA_RANGO, BUSCA_MONEDA_RANGO, CODIGO_TRANSACCION, REGENERA_AL_PAGAR, CARGO_O_IMPUESTO, INCLUIRENCUOTA, CUOTASNOCONSIDERARALFINAL, COBRARHASTADIAS, PORCENTAJE_MINIMO, PORCENTAJE_MAXIMO, CAMPO_DIA_COBRO, GENERA_RESERVA, DIAS_COBRO_HASTA_INMOVILIZADA, DESCRIPCION_1, DESCRIPCION_2, DESCRIPCION_3, GENERA_FACTURA_EN_CERO, TIPO_CARGO_IMPOSITIVO)
VALUES (950, ''COMISION INTERBANKING'', ''N'', ''N'', 1, ''N'', 950, 37413, 1, 0, 9999999999999.99, ''C'', 0, 0, 68, ''N'', 0, 0, NULL, NULL, ''R'', ''C'', ''N'', 0, ''F'', ''N'', ''30650201'', ''20000101'', 0, ''N'', 950, ''N'', ''C'', ''N'', 0, 0, 0, 0, 0, ''S'', 0, NULL, NULL, NULL, ''N'', 0)

------------------------------------------------------------------------------------

INSERT INTO dbo.CI_CARGOS_TARIFAS (ID_CARGO, MONEDA, RANGO_HASTA, TASA, IMPORTE_APLICAR, MONEDA_IMPORTE, TZ_LOCK, ID_CLIENTE, SEGMENTO, APLICA_MIN_MAX, IMPORTE_MINIMO, IMPORTE_MAXIMO, FECHA_DESDE, FECHA_HASTA, EMPRESA)
VALUES (950, 2, 6000, 0, 0, 2, 0, 0, ''0'', ''N'', 0, 0, ''20000101'', ''20990101'', 0)

INSERT INTO dbo.CI_CARGOS_TARIFAS (ID_CARGO, MONEDA, RANGO_HASTA, TASA, IMPORTE_APLICAR, MONEDA_IMPORTE, TZ_LOCK, ID_CLIENTE, SEGMENTO, APLICA_MIN_MAX, IMPORTE_MINIMO, IMPORTE_MAXIMO, FECHA_DESDE, FECHA_HASTA, EMPRESA)
VALUES (950, 1, 7500, 0, 4589, 1, 0, 0, ''0'', ''N'', 0, 0, ''20000101'', ''20990101'', 0)

INSERT INTO dbo.CI_CARGOS_TARIFAS (ID_CARGO, MONEDA, RANGO_HASTA, TASA, IMPORTE_APLICAR, MONEDA_IMPORTE, TZ_LOCK, ID_CLIENTE, SEGMENTO, APLICA_MIN_MAX, IMPORTE_MINIMO, IMPORTE_MAXIMO, FECHA_DESDE, FECHA_HASTA, EMPRESA)
VALUES (950, 1, 9999999999999, 0, 4589, 1, 0, 0, ''0'', ''N'', 0, 0, ''20000101'', ''20990101'', 0)

INSERT INTO dbo.CI_CARGOS_TARIFAS (ID_CARGO, MONEDA, RANGO_HASTA, TASA, IMPORTE_APLICAR, MONEDA_IMPORTE, TZ_LOCK, ID_CLIENTE, SEGMENTO, APLICA_MIN_MAX, IMPORTE_MINIMO, IMPORTE_MAXIMO, FECHA_DESDE, FECHA_HASTA, EMPRESA)
VALUES (950, 2, 9999999999999, 0, 9.99, 2, 0, 0, ''0'', ''N'', 0, 0, ''20000101'', ''20990101'', 0)

------------------------------------------------------------------------------------

INSERT INTO dbo.CI_FORMULAS (ID_FORMULA, DESCRIPCION, FORMULA, TZ_LOCK, ES_CONDICION)
VALUES (950, ''NO ES USF NI CAUSA JUD'', ''(C33360#''''S''''YC47106#''''S''''YC24=''''D'''')'', 0, 1)

------------------------------------------------------------------------------------

UPDATE dbo.TTR_CODIGO_TRANSACCION_DEF
SET UTILIZA_CONTADOR_MOVIM = ''S''
WHERE CODIGO_TRANSACCION = 160

------------------------------------------------------------------------------------

UPDATE dbo.ITF_MASTER_CAUSALES
SET ID_Evento = 959
WHERE ID_SATELITE = ''ATE'' AND COD_CAUSAL = ''63DOIA''

------------------------------------------------------------------------------------

INSERT INTO dbo.TTR_CODIGO_TRANSACCION_DEF (TZ_LOCK, CODIGO_TRANSACCION, DESCRIPCION, UTILIZA_CONTADOR_MOVIM, EN_PROMEDIO_MENSUAL, USO_COMERCIAL, INFO_EXTENDIDA, GRUPO, TIPO, DEBITO_CREDITO, INTERBANKING)
VALUES (0, 950, ''Comisión Interbanking'', ''S'', NULL, '' '', ''N'', 0, NULL, NULL, NULL)

------------------------------------------------------------------------------------

INSERT INTO dbo.PLANCTAS (TZ_LOCK, C6300, C6301, C6302, C6303, C6304, C6305, C6306, C6307, C6308, C6309, C6310, C6311, C6312, C6313, C6314, C6315, C6316, C6317, C6326, C6327, C6329, C6330, C6331, C6340, C6341, RUBRO_PERDIDA_VAL, RUBRO_GANANCIA_VAL, C6318, DEV_TASA_MORA, CALIFICA, DIADEVENGA, PREVISIONA, APERT_REFERENC, CENTRAL_RIESGOS, LCRED_CONTINGENCIA, TIPO_AJUSTE_VALUACION, EXPSOBREGIRO, ESTADO_ORG_CONTROL, DEVENGADO_POR_PLAZO, DISTRIBUYE_CENTROCOSTO, CONVIERTEA_MN, COD_INTERNO_IFRS, INVENTARIADO)
VALUES (0, ''Interbanking - Com Transf'', ''5410036270'', '' '', '' '', ''9'', ''C'', ''0'', ''  '', '' '', ''0'', ''  '', ''  '', ''  '', ''  '', ''  '', ''  '', '' '', '' '', 5410036270, ''N'', 0, 0, 0, 5410036270, 0, 0, 0, ''N'', ''N'', ''N'', '' '', 0, ''N'', ''S'', ''0'', 0, ''N'', ''N'', ''N'', ''N'', ''N'', ''541003'', ''N'')

------------------------------------------------------------------------------------

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37413, '' '', 0, ''Campo para esquema '', ''Campo para esquema'', 15, ''N'', 2, ''I'', 0, 0, 0, 0, 0, 0, 0, 0, ''Campo para esquema'', 0, NULL)

------------------------------------------------------------------------------------

INSERT INTO dbo.CI_IMPUESTOS_X_CARGO (ID_IMPUESTO, ID_CARGO, LECTURA_TOPAZ, TZ_LOCK, CAMPO_SEGMENTO, DESCRIPCION_SEGMENTO, PRIORIDAD)
VALUES (3, 950, ''A'', 0, 0, NULL, 0)

INSERT INTO dbo.CI_IMPUESTOS_X_CARGO (ID_IMPUESTO, ID_CARGO, LECTURA_TOPAZ, TZ_LOCK, CAMPO_SEGMENTO, DESCRIPCION_SEGMENTO, PRIORIDAD)
VALUES (4, 950, ''A'', 0, 1357, ''Cond Percep IVA'', 0)

INSERT INTO dbo.CI_IMPUESTOS_X_CARGO (ID_IMPUESTO, ID_CARGO, LECTURA_TOPAZ, TZ_LOCK, CAMPO_SEGMENTO, DESCRIPCION_SEGMENTO, PRIORIDAD)
VALUES (10, 950, ''A'', 0, 34096, ''Cond CREDEB'', 0)

------------------------------------------------------------------------------------

INSERT INTO dbo.ESQUEMACONTABLE (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, DESCRIPCION, CAMPO, RUBROSALIDA, CD, D_DC, C_DC, TRANSACCION, CONDICION, USAR_CAMPOS_MOVIMIENTOS)
VALUES (0, 311000, -1, 73, 1, ''Cars 37413'', 37413, 5410036270, NULL, ''C'', ''C'', 7, ''1=1'', ''S'')

INSERT INTO dbo.ESQUEMACONTABLE (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, DESCRIPCION, CAMPO, RUBROSALIDA, CD, D_DC, C_DC, TRANSACCION, CONDICION, USAR_CAMPOS_MOVIMIENTOS)
VALUES (0, 400001, -1, 73, 1, ''Cars 37413'', 37413, 5410036270, NULL, ''C'', ''C'', 7, ''1=1'', ''S'')

INSERT INTO dbo.ESQUEMACONTABLE (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, DESCRIPCION, CAMPO, RUBROSALIDA, CD, D_DC, C_DC, TRANSACCION, CONDICION, USAR_CAMPOS_MOVIMIENTOS)
VALUES (0, 400011, -1, 73, 1, ''Cars 37413'', 37413, 5410036270, NULL, ''C'', ''C'', 7, ''1=1'', ''S'')

INSERT INTO dbo.ESQUEMACONTABLE (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, DESCRIPCION, CAMPO, RUBROSALIDA, CD, D_DC, C_DC, TRANSACCION, CONDICION, USAR_CAMPOS_MOVIMIENTOS)
VALUES (0, 400012, -1, 73, 1, ''Cars 37413'', 37413, 5410036270, NULL, ''C'', ''C'', 7, ''1=1'', ''S'')

INSERT INTO dbo.ESQUEMACONTABLE (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, DESCRIPCION, CAMPO, RUBROSALIDA, CD, D_DC, C_DC, TRANSACCION, CONDICION, USAR_CAMPOS_MOVIMIENTOS)
VALUES (0, 400013, -1, 73, 1, ''Cars 37413'', 37413, 5410036270, NULL, ''C'', ''C'', 7, ''1=1'', ''S'')

INSERT INTO dbo.ESQUEMACONTABLE (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, DESCRIPCION, CAMPO, RUBROSALIDA, CD, D_DC, C_DC, TRANSACCION, CONDICION, USAR_CAMPOS_MOVIMIENTOS)
VALUES (0, 400014, -1, 73, 1, ''Cars 37413'', 37413, 5410036270, NULL, ''C'', ''C'', 7, ''1=1'', ''S'')

INSERT INTO dbo.ESQUEMACONTABLE (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, DESCRIPCION, CAMPO, RUBROSALIDA, CD, D_DC, C_DC, TRANSACCION, CONDICION, USAR_CAMPOS_MOVIMIENTOS)
VALUES (0, 400015, -1, 73, 1, ''Cars 37413'', 37413, 5410036270, NULL, ''C'', ''C'', 7, ''1=1'', ''S'')

INSERT INTO dbo.ESQUEMACONTABLE (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, DESCRIPCION, CAMPO, RUBROSALIDA, CD, D_DC, C_DC, TRANSACCION, CONDICION, USAR_CAMPOS_MOVIMIENTOS)
VALUES (0, 400016, -1, 73, 1, ''Cars 37413'', 37413, 5410036270, NULL, ''C'', ''C'', 7, ''1=1'', ''S'')

INSERT INTO dbo.ESQUEMACONTABLE (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, DESCRIPCION, CAMPO, RUBROSALIDA, CD, D_DC, C_DC, TRANSACCION, CONDICION, USAR_CAMPOS_MOVIMIENTOS)
VALUES (0, 400017, -1, 73, 1, ''Cars 37413'', 37413, 5410036270, NULL, ''C'', ''C'', 7, ''1=1'', ''S'')

INSERT INTO dbo.ESQUEMACONTABLE (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, DESCRIPCION, CAMPO, RUBROSALIDA, CD, D_DC, C_DC, TRANSACCION, CONDICION, USAR_CAMPOS_MOVIMIENTOS)
VALUES (0, 400018, -1, 73, 1, ''Cars 37413'', 37413, 5410036270, NULL, ''C'', ''C'', 7, ''1=1'', ''S'')

INSERT INTO dbo.ESQUEMACONTABLE (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, DESCRIPCION, CAMPO, RUBROSALIDA, CD, D_DC, C_DC, TRANSACCION, CONDICION, USAR_CAMPOS_MOVIMIENTOS)
VALUES (0, 400020, -1, 73, 1, ''Cars 37413'', 37413, 5410036270, NULL, ''C'', ''C'', 7, ''1=1'', ''S'')

INSERT INTO dbo.ESQUEMACONTABLE (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, DESCRIPCION, CAMPO, RUBROSALIDA, CD, D_DC, C_DC, TRANSACCION, CONDICION, USAR_CAMPOS_MOVIMIENTOS)
VALUES (0, 400070, -1, 73, 1, ''Cars 37413'', 37413, 5410036270, NULL, ''C'', ''C'', 7, ''1=1'', ''S'')

INSERT INTO dbo.ESQUEMACONTABLE (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, DESCRIPCION, CAMPO, RUBROSALIDA, CD, D_DC, C_DC, TRANSACCION, CONDICION, USAR_CAMPOS_MOVIMIENTOS)
VALUES (0, 3117540000, -1, 73, 1, ''Cars 37413'', 37413, 5410036270, NULL, ''C'', ''C'', 7, ''1=1'', ''S'')

INSERT INTO dbo.ESQUEMACONTABLE (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, DESCRIPCION, CAMPO, RUBROSALIDA, CD, D_DC, C_DC, TRANSACCION, CONDICION, USAR_CAMPOS_MOVIMIENTOS)
VALUES (0, 3510090020, -1, 73, 1, ''Cars 37413'', 37413, 5410036270, NULL, ''C'', ''C'', 7, ''1=1'', ''S'')

INSERT INTO dbo.ESQUEMACONTABLE (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, DESCRIPCION, CAMPO, RUBROSALIDA, CD, D_DC, C_DC, TRANSACCION, CONDICION, USAR_CAMPOS_MOVIMIENTOS)
VALUES (0, 3550090020, -1, 73, 1, ''Cars 37413'', 37413, 5410036270, NULL, ''C'', ''C'', 7, ''1=1'', ''S'')

------------------------------------------------------------------------------------

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 311000, -1, 73, 101, ''C'', 2, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 311000, -1, 73, 102, ''C'', 5, ''C6326'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 311000, -1, 73, 103, ''C'', 6, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 311000, -1, 73, 104, ''C'', 7, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 311000, -1, 73, 105, ''C'', 8, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400001, -1, 73, 101, ''C'', 2, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400001, -1, 73, 102, ''C'', 5, ''C6326'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400001, -1, 73, 103, ''C'', 6, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400001, -1, 73, 104, ''C'', 7, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400001, -1, 73, 105, ''C'', 8, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400011, -1, 73, 101, ''C'', 2, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400011, -1, 73, 102, ''C'', 5, ''C6326'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400011, -1, 73, 103, ''C'', 6, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400011, -1, 73, 104, ''C'', 7, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400011, -1, 73, 105, ''C'', 8, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400012, -1, 73, 101, ''C'', 2, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400012, -1, 73, 102, ''C'', 5, ''C6326'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400012, -1, 73, 103, ''C'', 6, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400012, -1, 73, 104, ''C'', 7, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400012, -1, 73, 105, ''C'', 8, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400013, -1, 73, 101, ''C'', 2, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400013, -1, 73, 102, ''C'', 5, ''C6326'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400013, -1, 73, 103, ''C'', 6, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400013, -1, 73, 104, ''C'', 7, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400013, -1, 73, 105, ''C'', 8, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400014, -1, 73, 101, ''C'', 2, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400014, -1, 73, 102, ''C'', 5, ''C6326'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400014, -1, 73, 103, ''C'', 6, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400014, -1, 73, 104, ''C'', 7, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400014, -1, 73, 105, ''C'', 8, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400015, -1, 73, 101, ''C'', 2, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400015, -1, 73, 102, ''C'', 5, ''C6326'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400015, -1, 73, 103, ''C'', 6, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400015, -1, 73, 104, ''C'', 7, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400015, -1, 73, 105, ''C'', 8, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400016, -1, 73, 101, ''C'', 2, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400016, -1, 73, 102, ''C'', 5, ''C6326'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400016, -1, 73, 103, ''C'', 6, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400016, -1, 73, 104, ''C'', 7, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400016, -1, 73, 105, ''C'', 8, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400017, -1, 73, 101, ''C'', 2, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400017, -1, 73, 102, ''C'', 5, ''C6326'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400017, -1, 73, 103, ''C'', 6, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400017, -1, 73, 104, ''C'', 7, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400017, -1, 73, 105, ''C'', 8, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400018, -1, 73, 101, ''C'', 2, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400018, -1, 73, 102, ''C'', 5, ''C6326'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400018, -1, 73, 103, ''C'', 6, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400018, -1, 73, 104, ''C'', 7, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400018, -1, 73, 105, ''C'', 8, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400020, -1, 73, 101, ''C'', 2, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400020, -1, 73, 102, ''C'', 5, ''C6326'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400020, -1, 73, 103, ''C'', 6, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400020, -1, 73, 104, ''C'', 7, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400020, -1, 73, 105, ''C'', 8, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400070, -1, 73, 101, ''C'', 2, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400070, -1, 73, 102, ''C'', 5, ''C6326'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400070, -1, 73, 103, ''C'', 6, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400070, -1, 73, 104, ''C'', 7, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 400070, -1, 73, 105, ''C'', 8, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 3117540000, -1, 73, 101, ''C'', 2, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 3117540000, -1, 73, 102, ''C'', 5, ''C6326'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 3117540000, -1, 73, 103, ''C'', 6, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 3117540000, -1, 73, 104, ''C'', 7, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 3117540000, -1, 73, 105, ''C'', 8, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 3510090020, -1, 73, 101, ''C'', 2, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 3510090020, -1, 73, 102, ''C'', 5, ''C6326'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 3510090020, -1, 73, 103, ''C'', 6, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 3510090020, -1, 73, 104, ''C'', 7, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 3510090020, -1, 73, 105, ''C'', 8, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 3550090020, -1, 73, 101, ''C'', 2, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 3550090020, -1, 73, 102, ''C'', 5, ''C6326'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 3550090020, -1, 73, 103, ''C'', 6, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 3550090020, -1, 73, 104, ''C'', 7, ''0'')

INSERT INTO dbo.ESQUEMACAMPO (PROCESO, RUBRO, MONEDA, LINEA, ORDINAL, CP, NUMERO, FORMULA)
VALUES (0, 3550090020, -1, 73, 105, ''C'', 8, ''0'')

-------------------------------------------------------------------------------------------------------------------------

INSERT INTO dbo.MACROR (PROCESO, ORDINAL, ARCHIVO, INDICE, CONDICION, RECEPTOR, FORMULA)
VALUES (227, 0, 3316, 1, ''Busca Causa Judicial'', NULL, NULL)

INSERT INTO dbo.MACROR (PROCESO, ORDINAL, ARCHIVO, INDICE, CONDICION, RECEPTOR, FORMULA)
VALUES (227, 1, 3316, 1, ''C33143=C669'', ''C50033'', ''C50033+1'')

-------------------------------------------------------------------------------------------------------------------------')
EXECUTE('
	CREATE OR ALTER PROCEDURE [dbo].[SP_NBCH24_MOVIMIENTOS]
		@P_jtsoid numeric(15, 0),
		@P_fechaDesde datetime,
		@P_fechaHasta datetime,
		@P_pagina integer, 
		@P_cantidad integer,
		@P_ttr nvarchar(MAX) = NULL,
		@P_fv char(1),
		@P_filter char(5)
	AS
	BEGIN

		SET NOCOUNT ON;

		Select 
		h.MOV_JTS_OID id,
		h.SALDO_JTS_OID jts_oid, 
		h.FECHA_VALOR fechaValor,
		h.FECHA_PROCESADO fechaProceso, 
		a.HORAFIN fechaHoraReloj,
		h.DEBITO_CREDITO operacion, 
		h.MONTO monto, 
		case when h.DEBITO_CREDITO = ''D'' then -h.monto else h.monto end importe,
		COALESCE(SALDO_AJUSTADO, 0)  + 
		SUM(case when h.DEBITO_CREDITO = ''D'' then -h.monto else h.monto end ) OVER (PARTITION BY h.FECHA_VALOR ORDER BY h.FECHA_VALOR, h.MOV_JTS_OID) AS saldoParcial,
		CASE WHEN h.CODIGO_TRANSACCION = 0 then h.CONCEPTO ELSE codTtr.DESCRIPCION END concepto,
		a.OPERACION nroOperacion, 
		h.CODIGO_TRANSACCION codTransaccion, 
		h.ASIENTO comprobante,
		dbo.diaHabil(h.fecha_Valor - 1, ''D'') fechaSaldo, 
		COALESCE(SALDO_AJUSTADO, 0) saldoDiario,    
		case when mon.C6403 = ''I'' then ctz.cotBcra else null end cotizacion,
		hm.infoExtendida detalle

		from HISTORIA_VISTA h WITH (NOLOCK)
		inner join ASIENTOS A WITH (NOLOCK) on H.ASIENTO = A.ASIENTO and H.SUCURSAL = A.SUCURSAL and H.FECHA_PROCESADO = A.FECHAPROCESO 
		left join HISTORICO_MOVIMIENTOS hm WITH (NOLOCK) on h.MOV_JTS_OID = hm.movJtsOid  
		inner join saldos s WITH (NOLOCK) on s.JTS_OID = h.SALDO_JTS_OID 
		inner join TTR_CODIGO_TRANSACCION_DEF codTtr WITH (NOLOCK) ON h.CODIGO_TRANSACCION = codTtr.CODIGO_TRANSACCION
		left JOIN STRING_SPLIT(@P_ttr, '','') AS ttr ON ttr.value = h.CODIGO_TRANSACCION
		left join GRL_SALDOS_DIARIOS sal WITH (NOLOCK) on sal.fecha = dbo.diaHabil(h.fecha_Valor - 1, ''D'') and h.SALDO_JTS_OID = sal.SALDOS_JTS_OID
		left join VW_NBCH24_GRL_COTIZACIONES ctz WITH (NOLOCK) on h.FECHA_VALOR = ctz.fecha and ctz.codigo = s.moneda --fecha de cotizacion para UVA
		inner join monedas mon on ctz.codigo = mon.C6399
		where a.ESTADO = 77 and h.MONTO > 0 

		and 
		((h.SALDO_JTS_OID = @P_jtsoid and cast(h.FECHA_PROCESADO as Date) BETWEEN @P_fechaDesde and @P_fechaHasta and @P_filter = ''*PROC'') 
		or 
		(h.SALDO_JTS_OID = @P_jtsoid and cast(a.HORAFIN as Date)  BETWEEN @P_fechaDesde and @P_fechaHasta and @P_filter = ''*TIME'') )

		and  (@P_ttr IS NULL OR ttr.value IS NOT NULL) --si @p_ttr es null incluye todos los codigos de transaccion 
		and (@P_fv <> ''S'' OR h.FECHA_VALOR < h.FECHA_PROCESADO)
		order by h.FECHA_VALOR desc, a.HORAFIN desc
		OFFSET (@P_pagina - 1) * @P_cantidad ROWS
		FETCH NEXT @P_cantidad ROWS ONLY
	END;
');