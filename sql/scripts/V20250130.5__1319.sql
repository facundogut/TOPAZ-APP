EXEC('
--Verifica existencia de acreditacion para un convenio 
CREATE OR ALTER PROCEDURE dbo.SP_ADINTAR_EXISTE_ACRED_CONVENIO 
	@P_NRO_PERSONA FLOAT, 
	@P_CONVENIO NUMERIC(15,0), 
	@EXISTE NUMERIC(15,0) OUTPUT 
AS 
BEGIN 
	SET @EXISTE = 0;
	
	SELECT top 1 
	@EXISTE = COALESCE(a.CONVENIO,0) 
	FROM SALDOS s (nolock) 
	INNER JOIN CRE_SOL_ACREDITACIONES_SUELDOS a (nolock) ON s.JTS_OID = a.SALDO_JTS_OID AND a.TZ_LOCK = 0 
	INNER JOIN CLI_ClientePersona c (nolock) ON c.CODIGOCLIENTE = s.C1803 AND c.TITULARIDAD = ''T'' and left(c.TZ_LOCK, 1) in (0,4) 
	WHERE c.NUMEROPERSONA = @P_NRO_PERSONA AND a.CONVENIO = @P_CONVENIO AND left(s.TZ_LOCK,1) in (0,4) 
END; 
');

EXEC('
--SP para el servicio de Scoring 
CREATE OR ALTER PROCEDURE dbo.SP_ADINTAR_SCORING_SERVICE 
	@NRO_PERSONA FLOAT, 
	@TotalMonto NUMERIC(15,2) OUTPUT, 
	@Convenio NUMERIC(15,0) OUTPUT 
AS 
BEGIN 
	SET @TotalMonto = 0;
	SET @Convenio = 0;
	
	SELECT TOP 1 
	@TotalMonto = COALESCE(TOTAL_MONTO,0), 
	@Convenio = COALESCE(CONVENIO,0) 
	FROM VW_ADINTAR_SCORING 
	WHERE NRO_PERSONA = @NRO_PERSONA 
	ORDER BY TOTAL_MONTO DESC 
END;
');