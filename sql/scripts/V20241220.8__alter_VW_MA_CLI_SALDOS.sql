execute('
CREATE OR ALTER VIEW [dbo].[VW_MA_CLI_SALDOS] (
		NUMEROPERSONA,
		TIPODOC, 
		NUMERODOC, 
		NIVELAPERTURA_PER,
		CODIGOCLIENTE,
		NOMBRECLIENTE,
		SECTOR,
		SEGMENTOCLIENTE,
		SUBSEGMENTOCLIENTE,
		NIVELAPERTURA_CLI,
		ESTADO_PER,
		ESTADO_CLI,
		PRODUCTO,
		BLOQUEO_SAL,
		INMOV_SAL,
		CANCEL_SAL,
		SALDO_JTS_OID,
		MONEDA,
		CUENTA,
		ConvenioPago)
AS 
SELECT 
    V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
    V.TIPODOCUMENTO AS TIPODOC, 
    V.NUMERODOCUMENTO AS NUMERODOC, 
    U.NIVEL_APERTURA AS NIVELAPERTURA_PER,
    R.CODIGOCLIENTE, 
    R.NOMBRECLIENTE,
    R.SUBDIVISION1 AS SECTOR,
    R.SEGMENTOCLIENTE AS SEGMENTOCLIENTE,
    R.SUBSEGMENTOCLIENTE AS SUBSEGMENTOCLIENTE,
    R.NIVEL_APERTURA AS NIVELAPERTURA_CLI,
    U.ESTADO AS ESTADO_PER,
    R.ESTADO AS ESTADO_CLI,
    S.PRODUCTO AS PRODUCTO,
    s.C1679 AS BLOQUEO_SAL,
    S.C1728 AS INMOV_SAL,
    S.C1651 AS CANCEL_SAL,
    S.JTS_OID AS SALDO_JTS_OID,
    S.MONEDA AS MONEDA,
    S.CUENTA AS CUENTA,
    CP.ConvenioPago AS ConvenioPago 
FROM CLI_CLIENTES  AS R WITH(NOLOCK) 
INNER JOIN CLI_CLIENTEPERSONA AS T WITH(NOLOCK) ON
	R.CODIGOCLIENTE=T.CODIGOCLIENTE 
INNER JOIN CLI_PERSONASFISICAS AS U WITH(NOLOCK) ON
	T.NUMEROPERSONA=U.NUMEROPERSONAFISICA 
INNER JOIN CLI_DOCUMENTOSPFPJ AS V WITH(NOLOCK) ON
	V.NUMEROPERSONAFJ=U.NUMEROPERSONAFISICA
INNER JOIN SALDOS AS s WITH(NOLOCK) ON
	s.C1803=r.CODIGOCLIENTE
INNER JOIN MA_CONVENIO_PRODUCTOS AS CP WITH(NOLOCK) ON
	CP.Producto=S.PRODUCTO
WHERE 
    R.CODIGOCLIENTE = T.CODIGOCLIENTE
    AND R.TIPO=''F''
    AND U.NUMEROPERSONAFISICA = T.NUMEROPERSONA
    AND U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ
    AND T.titularidad=''T''
    AND R.TZ_LOCK =0
	AND T.TZ_LOCK =0
	AND U.TZ_LOCK =0
	AND V.TZ_LOCK =0
	AND S.TZ_LOCK =0

')

