EXECUTE('
IF OBJECT_ID (''dbo.VW_CRE_ORDEN_COBRANZA_ASISTENCIAS'') IS NOT NULL
	DROP VIEW dbo.VW_CRE_ORDEN_COBRANZA_ASISTENCIAS
')

EXECUTE('
CREATE VIEW dbo.VW_CRE_ORDEN_COBRANZA_ASISTENCIAS
AS 
SELECT isnull(b.CODIGO,0) AS codigo,isNULL(b.ORDEN,99) AS orden,a.JTS_OID,a.CLIENTE,a.VENCIMIENTO,a.TIPO, a.CLASIFICACION
FROM VW_ASISTENCIAS_COBRADOR a with (nolock)
LEFT JOIN VW_ORDEN_COBRANZA_ASISTENCIAS b with (nolock) ON (a.FAMILIA=b.CODIGO_ITEM  AND b.tipo=''F'') OR(a.PRODUCTO=b.CODIGO_ITEM AND b.tipo=''P'')
WHERE a.SALDO>0 AND a.CLASIFICACION IN (''PP'',''AH'',''T'')
')

EXECUTE('
IF OBJECT_ID (''dbo.VW_ORDEN_COBRANZA_DEBITOS_AUTOMATICOS'') IS NOT NULL
	DROP VIEW dbo.VW_ORDEN_COBRANZA_DEBITOS_AUTOMATICOS
')

EXECUTE('
CREATE VIEW VW_ORDEN_COBRANZA_DEBITOS_AUTOMATICOS
AS
SELECT ISNULL(b.CODIGO_COBRANZA,0) AS CODIGO,ISNULL(b.ORDEN,99) AS ORDEN,CD.CONVENIO,S.C1803 AS CLIENTE,DD.FECHA_NOVEDAD AS FECHA,
0 AS TIPO,''C'' AS CLASIFICACION
FROM REC_DET_DEBITOSAUTOMATICOS DD with (nolock)
INNER JOIN REC_CAB_DEBITOSAUTOMATICOS CD WITH(nolock)
ON DD.ID_CABEZAL=CD.ID AND CD.TZ_LOCK = 0
INNER JOIN SALDOS S WITH (nolock) 
ON S.JTS_OID=DD.JTS_DEBITO AND S.TZ_LOCK = 0
INNER JOIN CONV_CONVENIOS_REC C WITH(NOLOCK) ON C.Id_ConvRec = CD.CONVENIO AND C.TZ_LOCK = 0
LEFT JOIN CRE_COB_ORDEN_COBRANZA b with (nolock) 
ON CD.CONVENIO=b.CODIGO_ITEM AND b.TZ_LOCK=0 AND b.TIPO=''C''
WHERE DD.ESTADO = ''V'' AND CD.ESTADO IN (''V'',''Z'')
')