EXECUTE('
IF OBJECT_ID (''dbo.VBS_DETALLE_CUOTAS_PAGADAS_MIGRADOS'') IS NOT NULL
	DROP VIEW dbo.VBS_DETALLE_CUOTAS_PAGADAS_MIGRADOS
')

EXECUTE('
CREATE   VIEW dbo.VBS_DETALLE_CUOTAS_PAGADAS_MIGRADOS AS
	SELECT P.HP_JTS_OID, P.NUMERADOR, P.NUMERADOR_HP, P.NUMERADOR_HP_SUB, P.SALDO_JTS_OID, P.VENCIMIENTOCUOTA, P.NCUOTA, P.CAPITAL, P.INTERES, P.SALDO_CAPITAL, P.SALDO_INTERES, P.DIASATRASO, P.TASAINTERES, P.PAGOPARCIAL, P.PP_IVAINTERES, P.PP_IVAPERCEPCIONINTERES, P.PP_MORA, P.PP_IVAMORA, P.PP_IVAPERCEPCIONMORA, P.PP_INTCOMPMORA, P.PP_IVAINTCOMPMORA, P.PP_IVAPERCEPCIONINTCOMPMORA, P.PP_GASTOS, P.PP_GASTOS_TOT, P.SUBSIDIO, P.FECHAVALOR, P.CODIGO, P.CARGO, P.ADMITE_PP
	FROM VBS_DETALLE_CUOTAS_PAGADAS P
	UNION 
	SELECT 1,1,1,1,M.SALDOS_JTS_OID,M.VENCIMIENTO,M.CUOTA,M.CAPITAL,M.INTERES,0,0,M.DIAS_ATRASO,M.TASA_INTERES,''Pago'', M.IVA_INTERES,M.IVA_PERCEPCION_INTERES,M.MORA,M.IVA_MORA,M.IVA_PERCEPCION_MORA,M.PUNITORIOS,M.IVA_PUNITORIOS,M.IVA_PERCEPCION_PUNITORIOS,M.GASTOS+ M.SEGUROS+ M.OTROS+ M.COMISION+M.PERCEPCION_IIBB,M.GASTOS+ M.SEGUROS+ M.OTROS+ M.COMISION+M.PERCEPCION_IIBB,M.SUBSIDIO,M.FECHA_PAGO,0,NULL,0
	FROM BS_PAYS_DETAIL_MIGRADOS M WITH (NOLOCK)
	WHERE M.TZ_LOCK = 0
')