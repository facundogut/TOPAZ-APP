EXECUTE('
IF OBJECT_ID (''dbo.VW_COMISION_CTAS_VISTA'') IS NOT NULL
	DROP VIEW dbo.VW_COMISION_CTAS_VISTA
')
EXECUTE('
CREATE   VIEW [dbo].[VW_COMISION_CTAS_VISTA] (
   JTS_OID,  
   MONEDA, 
   SALDO,
   TIPO_PRODUCTO,
   CLIENTE,
   TIPO_CLIENTE,
   MONOTRIBUTO,
   IVA,
   USF,
   COBRA_COMISION)
AS 
SELECT S.JTS_OID, 
		S.MONEDA, 
		S.C1604+S.C1683+S.C1605+S.C2627+S.C50107, 
		S.C1785 ,
		S.C1803, 
		C.TIPO, 
		C.MONOTRIBUTO, 
		C.IVA, 
		C.USF, 
		T.DEBITO_MANTENIMIENTO
FROM SALDOS AS S with(nolock) 
inner join CLI_CLIENTES AS C with(nolock) on  S.C1803 = C.CODIGOCLIENTE
											AND C.TZ_LOCK = 0 AND C.USF = ''N''
inner join PRODUCTOS AS P with(nolock) on S.PRODUCTO = P.C6250 
										AND P.TZ_LOCK = 0
inner join TOPESPRODUCTO AS T with(nolock) on T.CODPRODUCTO = S.PRODUCTO AND T.MONEDA = S.MONEDA AND T.DEBITO_MANTENIMIENTO=''S''
											
WHERE  S.C1785 IN (2,3) 
	AND S.TZ_LOCK = 0 
	AND S.C1728 <> ''I''
	AND S.TIPO_SALDO_FONDO=0

')
