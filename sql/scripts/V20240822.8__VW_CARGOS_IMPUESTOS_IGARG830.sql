IF OBJECT_ID ('dbo.VW_CARGOS_IMPUESTOS_IGARG830') IS NOT NULL
	DROP VIEW dbo.VW_CARGOS_IMPUESTOS_IGARG830
GO

CREATE VIEW dbo.[VW_CARGOS_IMPUESTOS_IGARG830]
AS
SELECT ID_CARGO,descripcion, Moneda, TipoCargo, TASA, segmento FROM CI_CARGOS_TARIFAS CCT
JOIN 
(
  SELECT Id_cargo AS idCargo, DESCRIPCION, MONEDA_IMPORTE,TIPO_CARGO_IMPOSITIVO AS TipoCargo
  FROM CI_CARGOS
  WHERE TIPO_CARGO_IMPOSITIVO = 4
  UNION
  SELECT ID_IMPUESTO AS idCargo, DESCRIPCION, MONEDA_IMPORTE,TIPO_IMPUESTO AS TipoCargo
  FROM CI_IMPUESTOS
  WHERE TIPO_IMPUESTO = 4
) AS CargoImpuesto
ON CCT.Id_Cargo = CargoImpuesto.idCargo
WHERE id_cliente = 0 AND TZ_LOCK = 0
AND segmento!='EX'
GO
