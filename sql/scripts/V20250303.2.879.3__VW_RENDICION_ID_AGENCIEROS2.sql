EXECUTE('
IF OBJECT_ID (''dbo.VW_RENDICION_ID_AGENCIEROS2'') IS NOT NULL
	DROP VIEW dbo.VW_RENDICION_ID_AGENCIEROS2
')
EXECUTE('
CREATE VIEW VW_RENDICION_ID_AGENCIEROS2 AS 
SELECT A.ID,  A.FECHA_COBRO_PAGO, A.SIG_IMP_LIQUIDO AS [SIGNO], C.Acreditacion AS [ACREDITACION],
		(CASE WHEN C.Acreditacion = OE.OPCIONINTERNA AND OE.OPCIONINTERNA = ''24H''
			THEN dbo.diaHabil(DATEADD(day,1,a.FECHA_COBRO_PAGO),''A'')
			WHEN C.Acreditacion = OE.OPCIONINTERNA AND 	OE.OPCIONINTERNA = ''48H''
			THEN dbo.diaHabil(DATEADD(day,2,a.FECHA_COBRO_PAGO),''A'') END) AS [FECHA_REND] 
	FROM REC_Agencieros A,
		CONV_CONVENIOS_REC C
		JOIN OPCIONES OE ON OE.OPCIONINTERNA = C.Acreditacion AND OE.NUMERODECAMPO = 44755 AND OE.IDIOMA = ''E''
		JOIN PARAMETROSGENERALES p ON C.Id_ConvRec = p.NUMERICO AND p.CODIGO IN(300,301) AND p.TZ_LOCK = 0
	WHERE A.ESTADO = ''P'' AND A.ESTADO_REND = ''R'' AND A.SIG_IMP_LIQUIDO IN(1,2) 
	
	GROUP BY A.ID, C.Acreditacion, A.FECHA_COBRO_PAGO, OE.OPCIONINTERNA, A.SIG_IMP_LIQUIDO

')