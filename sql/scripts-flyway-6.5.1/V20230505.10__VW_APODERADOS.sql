EXECUTE('IF OBJECT_ID (''VW_APODERADOS'') IS NOT NULL
	DROP VIEW VW_APODERADOS')

EXECUTE('
CREATE   VIEW [VW_APODERADOS] (
										   ID_ENTIDAD, 
										   TIPO_PODER, 
										   PODER, 
										   TIPO_ENTIDAD, 
										   ENTIDAD, 
										   ID_PERSONA, 
										   CATEGORIA, 
										   PRIMERNOMBRE, 
										   APELLIDOPATERNO, 
										   APELLIDOMATERNO)
AS 
   SELECT --TOP 9223372036854775807 WITH TIES 
		  A.ID_ENTIDAD, 
		  A.TIPO_PODER, 
		  B.DESCRIPCION AS PODER, 
		  A.TIPO_ENTIDAD, 
		  C.DESCRIPCION AS ENTIDAD, 
		  A.ID_PERSONA, 
		  A.CATEGORIA, 
		  E.PRIMERNOMBRE, 
		  E.APELLIDOPATERNO, 
		  E.APELLIDOMATERNO
   FROM 
      PYF_APODERADOS  AS A WITH (NOLOCK) 
      INNER JOIN PYF_TIPOPODERES  AS B WITH (NOLOCK) ON A.TIPO_PODER = B.TIPO_PODER
														AND B.TZ_LOCK = 0
      INNER JOIN PYF_TIPOENTIDAD  AS C WITH (NOLOCK) ON A.TIPO_ENTIDAD = C.TIPO_ENTIDAD 
														AND C.TZ_LOCK = 0
      INNER JOIN CLI_PERSONASFISICAS  AS E WITH (NOLOCK) ON A.ID_PERSONA = E.NUMEROPERSONAFISICA
															 AND E.TZ_LOCK = 0
   WHERE 
      A.TZ_LOCK = 0 
 /*  ORDER BY 
      A.ID_ENTIDAD, 
      A.TIPO_ENTIDAD, 
      A.TIPO_PODER, 
      A.CATEGORIA
*/ ')



