/****** Object:  View [dbo].[VW_CUENTAS]    Script Date: 24/02/2021 11:02:03 ******/
DROP VIEW [dbo].[VW_CUENTAS]
GO
/****** Object:  View [dbo].[VW_CUENTAS]    Script Date: 24/02/2021 11:02:03 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_CUENTAS]
(
	CUENTA,
	NOMBRE,
	PRODUCTO,
	DESCRIPCION,
	MONEDA,
	SUCURSAL,
	ORDINAL,
	OPERACION,
	CLIENTE,
	TIPO_DOCUMENTO,
	DOCUMENTO,
	TIPOPROD,
	BLOQUEO,
	C1728,
	TIPO_SALDO_FONDO,
	RUBRO,
	C1651,
	SALDO_ACTUAL,
	C1601,
	JTS_OID,
	VISUALIZABLE,
	NOMBRE_RUBRO
) AS 
SELECT	S.CUENTA, 
		VS.NOMBRE_CUENTA, 
		S.PRODUCTO, 
		P.C6251, 
		S.MONEDA, 
		S.SUCURSAL, 
		S.ORDINAL, 
		S.OPERACION, 
		S.C1803, 
		D.TIPODOC, 
		D.NUMERODOC , 
		S.C1785, 
		S.C1679, 
		S.C1728, 
		S.TIPO_SALDO_FONDO, 
		S.C1730, 
		S.C1651, 
		S.C1604, 
		S.C1601, 
		S.JTS_OID, 
		S.C1694, 
		PL.C6300
FROM SALDOS AS S with (nolock)
	INNER JOIN VTA_SALDOS AS VS with (nolock) ON S.JTS_OID = VS.JTS_OID_SALDO
	INNER JOIN PRODUCTOS AS P with (nolock) ON S.PRODUCTO = P.C6250 
												AND S.C1785 = P.C6252
	INNER JOIN VW_CLI_X_DOC AS D with (nolock) ON S.C1803 = D.[CODIGOCLIENTE] 
	INNER JOIN PLANCTAS PL with (nolock) ON S.C1730 = PL.C6301
WHERE S.TZ_LOCK = 0 
		AND P.TZ_LOCK = 0 
		AND PL.TZ_LOCK = 0 
		AND VS.TZ_LOCK = 0;
GO


