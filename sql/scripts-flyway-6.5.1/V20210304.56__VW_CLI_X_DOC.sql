/****** Object:  View [dbo].[VW_CLI_X_DOC]    Script Date: 24/02/2021 13:01:45 ******/
DROP VIEW [dbo].[VW_CLI_X_DOC]
GO

/****** Object:  View [dbo].[VW_CLI_X_DOC]    Script Date: 24/02/2021 13:01:45 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[VW_CLI_X_DOC] (
   TIPODOC, 
   NUMERODOC,
   PAISDOCUMENTO,
   [CODIGOCLIENTE], 
   NOMBRECLIENTE,
   NUMEROPERSONA,
   TIPOPERSONA)
AS 
   /*Generated by SQL Server Migration Assistant for Oracle version 7.9.0.*/
   SELECT 
      V.TIPODOCUMENTO AS TIPODOC, 
      V.NUMERODOCUMENTO AS NUMERODOC, 
      v.PAISDOCUMENTO,
      R.[CODIGOCLIENTE],
      R.NOMBRECLIENTE,
      V.NUMEROPERSONAFJ AS NUMEROPERSONA,/*,
      r.CODIGOBLOQUEO As [Codigo Bloqueo], 
	  r.TIPO As [Tipo  Cliente], 
	  r.TIPOAPERTURA As [Tipo Apertura], 
	  r.ESTADO As [Estado], 
	  r.NIVEL_APERTURA As [Nivel Apertura]*/
	  'F' AS TIPOPERSONA
   FROM 
      dbo.CLI_CLIENTES  AS R with (nolock) 
      inner join dbo.CLI_CLIENTEPERSONA  AS T with (nolock) on R.[CODIGOCLIENTE] = T.[CODIGOCLIENTE]
      inner join dbo.CLI_PERSONASFISICAS  AS U with (nolock) on U.NUMEROPERSONAFISICA = T.NUMEROPERSONA
      inner join dbo.CLI_DOCUMENTOSPFPJ  AS V with (nolock) on U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ
   WHERE 
      t.TITULARIDAD='T' 
	  and
      ((R.TZ_LOCK < 300000000000000 OR R.TZ_LOCK >= 400000000000000) AND (R.TZ_LOCK < 100000000000000 OR R.TZ_LOCK >= 200000000000000)) AND 
      ((T.TZ_LOCK < 300000000000000 OR T.TZ_LOCK >= 400000000000000) AND (T.TZ_LOCK < 100000000000000 OR T.TZ_LOCK >= 200000000000000)) AND 
      ((U.TZ_LOCK < 300000000000000 OR U.TZ_LOCK >= 400000000000000) AND (U.TZ_LOCK < 100000000000000 OR U.TZ_LOCK >= 200000000000000)) AND 
      ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000))
   
    UNION ALL
   SELECT 
      V.TIPODOCUMENTO AS TIPODOC, 
      V.NUMERODOCUMENTO AS NUMERODOC, 
      v.PAISDOCUMENTO,
      R.[CODIGOCLIENTE],
      R.NOMBRECLIENTE,
      V.NUMEROPERSONAFJ AS NUMEROPERSONA,/*,
      r.CODIGOBLOQUEO As [Codigo Bloqueo], 
	  r.TIPO As [Tipo  Cliente], 
	  r.TIPOAPERTURA As [Tipo Apertura], 
	  r.ESTADO As [Estado], 
	  r.NIVEL_APERTURA As [Nivel Apertura]*/
	  'J' AS TIPOPERSONA
   FROM 
      dbo.CLI_CLIENTES  AS R with (nolock) 
	  inner join dbo.CLI_CLIENTEPERSONA  AS T with (nolock) on R.[CODIGOCLIENTE] = T.[CODIGOCLIENTE] 
      inner join dbo.CLI_PERSONASJURIDICAS  AS S with (nolock) on S.NUMEROPERSONAJURIDICA = T.NUMEROPERSONA 
      inner join dbo.CLI_DOCUMENTOSPFPJ  AS V with (nolock) on  S.NUMEROPERSONAJURIDICA = V.NUMEROPERSONAFJ
   WHERE 
      t.TITULARIDAD='T' AND
      ((R.TZ_LOCK < 300000000000000 OR R.TZ_LOCK >= 400000000000000) AND (R.TZ_LOCK < 100000000000000 OR R.TZ_LOCK >= 200000000000000)) AND 
      ((T.TZ_LOCK < 300000000000000 OR T.TZ_LOCK >= 400000000000000) AND (T.TZ_LOCK < 100000000000000 OR T.TZ_LOCK >= 200000000000000)) AND 
      ((S.TZ_LOCK < 300000000000000 OR S.TZ_LOCK >= 400000000000000) AND (S.TZ_LOCK < 100000000000000 OR S.TZ_LOCK >= 200000000000000)) AND 
      ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000))
GO


