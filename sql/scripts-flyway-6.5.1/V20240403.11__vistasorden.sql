EXECUTE('
IF OBJECT_ID (''dbo.VW_ORDEN_COBRANZA_DEBITOS_AUTOMATICOS'') IS NOT NULL
	DROP VIEW dbo.VW_ORDEN_COBRANZA_DEBITOS_AUTOMATICOS
')

EXECUTE('
CREATE VIEW VW_ORDEN_COBRANZA_DEBITOS_AUTOMATICOS
AS
SELECT b.CODIGO_COBRANZA AS CODIGO,b.ORDEN,CD.CONVENIO,S.C1803 AS CLIENTE,DD.FECHA_COBRANZA AS FECHA,0 AS TIPO,''C'' AS CLASIFICACION
FROM REC_DET_DEBITOSAUTOMATICOS DD with (nolock)
INNER JOIN REC_CAB_DEBITOSAUTOMATICOS CD WITH(nolock)
ON DD.ID_CABEZAL=CD.ID
INNER JOIN SALDOS S WITH (nolock) 
ON S.JTS_OID=DD.JTS_DEBITO
INNER JOIN CRE_COB_ORDEN_COBRANZA b with (nolock) 
ON CD.CONVENIO=b.CODIGO_ITEM AND b.TZ_LOCK=0
WHERE b.TIPO=''C''
')

EXECUTE('
IF OBJECT_ID (''dbo.VW_CRE_ORDEN_COBRANZA_SUELDOS'') IS NOT NULL
	DROP VIEW dbo.VW_CRE_ORDEN_COBRANZA_SUELDOS
')

EXECUTE('
CREATE VIEW VW_CRE_ORDEN_COBRANZA_SUELDOS
AS
SELECT DA.CODIGO,
DA.ORDEN,
DA.CONVENIO AS JTS_DEBITO,
DA.CLIENTE,
DA.FECHA,
DA.TIPO,
DA.CLASIFICACION
FROM VW_ORDEN_COBRANZA_DEBITOS_AUTOMATICOS DA
UNION
SELECT
CA.codigo,
CA.orden,
CA.JTS_OID,
CA.CLIENTE,
CA.VENCIMIENTO,
CA.TIPO,
CA.CLASIFICACION
FROM VW_CRE_ORDEN_COBRANZA_ASISTENCIAS CA
')
