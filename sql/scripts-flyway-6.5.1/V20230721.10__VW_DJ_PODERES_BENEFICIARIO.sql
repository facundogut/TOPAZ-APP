EXECUTE('
IF OBJECT_ID (''dbo.VW_DJ_PODERES_BENEFICIARIO'') IS NOT NULL
	DROP VIEW dbo.VW_DJ_PODERES_BENEFICIARIO
')

EXECUTE('
CREATE   VIEW VW_DJ_PODERES_BENEFICIARIO(
							ID_ENTIDAD,
							TIPO_PODER,
							TIPO_ENTIDAD,
							ID_PERSONA,
							CATEGORIA,
							FECHA_VENCIMIENTO,
							FECHA_INI_SUSPENSION,
							TZ_LOCK)
AS
		   SELECT 
		  	  A.ID_ENTIDAD, 
		  	  A.TIPO_PODER,  
			  A.TIPO_ENTIDAD, 
			  A.ID_PERSONA, 
			  A.CATEGORIA,
			  A.FECHA_VENCIMIENTO,
			  A.FECHA_INI_SUSPENSION,
			  A.TZ_LOCK
		   FROM 
		   	  dbo.PYF_APODERADOS  AS A WITH (NOLOCK) 
			  LEFT JOIN dbo.PYF_TIPOPODER_X_TIPOENTIDAD AS D WITH (NOLOCK) ON A.TIPO_ENTIDAD = D.TIPO_ENTIDAD
			  													AND A.TIPO_PODER = D.TIPO_PODER
			  LEFT JOIN dbo.PYF_APODERAMIENTO AS E WITH (NOLOCK) ON E.CODPODER = A.TIPO_PODER
			  													AND E.CODAPODERAMIENTO = 22
		   WHERE 
		      A.TZ_LOCK = 0

')
