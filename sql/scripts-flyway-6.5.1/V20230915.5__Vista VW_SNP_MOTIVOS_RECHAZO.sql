EXECUTE('
IF OBJECT_ID (''dbo.VW_SNP_MOTIVOS_RECHAZO'') IS NOT NULL
	DROP VIEW dbo.VW_SNP_MOTIVOS_RECHAZO
')
EXECUTE('
CREATE   VIEW VW_SNP_MOTIVOS_RECHAZO
AS
SELECT
	M.ID_MOTIVO,
	OFU.DESCRIPCION AS FUNCIONALIDAD,
	M.CODIGO_NACHA,
	M.DESCRIPCION,
	OEC.DESCRIPCION AS ENTIDAD_CAMARA
FROM SNP_MOTIVOS_RECHAZO AS M WITH (nolock)
INNER JOIN OPCIONES AS OFU WITH (nolock) ON
	OFU.NUMERODECAMPO = 45581
	AND OFU.IDIOMA = ''E''
	AND OFU.OPCIONINTERNA = M.FUNCIONALIDAD
INNER JOIN OPCIONES AS OEC WITH (nolock) ON
	OEC.NUMERODECAMPO = 45584
	AND OEC.IDIOMA = ''E''
	AND OEC.OPCIONINTERNA = M.ENTIDAD_CAMARA
WHERE
	((M.TZ_LOCK < 100000000000000 OR M.TZ_LOCK >= 200000000000000)
		AND (M.TZ_LOCK < 300000000000000 OR M.TZ_LOCK >= 400000000000000)  )
')

