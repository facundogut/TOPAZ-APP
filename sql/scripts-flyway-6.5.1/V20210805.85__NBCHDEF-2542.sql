EXECUTE('
DELETE FROM dbo.DICCIONARIO
WHERE NUMERODECAMPO = 37007

DELETE FROM dbo.AYUDAS
WHERE NUMERODEAYUDA = 2882

DROP VIEW VW_PERSONASJUR_PRIORIZADA

DELETE FROM dbo.INDICES
WHERE NUMERODEARCHIVO = 288 AND NUMERODEINDICE = 3

')

EXECUTE('
-- VW_InstitucionesFinancieras
ALTER view VW_INSTITUCIONESFINANCIERAS as
  select
    d.TIPODOCUMENTO,
    d.NUMERODOCUMENTO,
    d.NUMEROPERSONAFJ,
    j.RAZONSOCIAL,
	j.NIVEL_APERTURA as APERTURA
  from
    CLI_DOCUMENTOSPFPJ d
    inner join CLI_PERSONASJURIDICAS j on d.TIPOPERSONA = ''J'' and d.NUMEROPERSONAFJ = j.NUMEROPERSONAJURIDICA
  where
    (d.TZ_LOCK < 300000000000000 or d.TZ_LOCK >= 400000000000000) and (d.TZ_LOCK < 100000000000000 or d.TZ_LOCK >= 200000000000000)
    and (j.TZ_LOCK < 300000000000000 or j.TZ_LOCK >= 400000000000000) and (j.TZ_LOCK < 100000000000000 or j.TZ_LOCK >= 200000000000000)
    and j.NIVEL_APERTURA = 4
  union all
  select
    v.TIPODOCUMENTO,
    v.NUMERODOCUMENTO,
    v.NUMEROPERSONAJURIDICA as NUMEROPERSONAFJ,
    v.RAZONSOCIAL,
	0 as APERTURA
  from
    CLI_VINCULADOSJURIDICOS v
  where
    (v.TZ_LOCK < 300000000000000 or v.TZ_LOCK >= 400000000000000) and (v.TZ_LOCK < 100000000000000 or v.TZ_LOCK >= 200000000000000)
    and v.TIPO_PERSONA = ''I'' AND (v.TIPODOCUMENTO + v.NUMERODOCUMENTO) NOT IN (
     SELECT
     (d.TIPODOCUMENTO+d.NUMERODOCUMENTO)
     from
    CLI_DOCUMENTOSPFPJ d
    inner join CLI_PERSONASJURIDICAS j on d.TIPOPERSONA = ''J'' and d.NUMEROPERSONAFJ = j.NUMEROPERSONAJURIDICA
  where
    (d.TZ_LOCK < 300000000000000 or d.TZ_LOCK >= 400000000000000) and (d.TZ_LOCK < 100000000000000 or d.TZ_LOCK >= 200000000000000)
    and (j.TZ_LOCK < 300000000000000 or j.TZ_LOCK >= 400000000000000) and (j.TZ_LOCK < 100000000000000 or j.TZ_LOCK >= 200000000000000)
    and j.NIVEL_APERTURA = 4);


')

EXECUTE('
-- VW_PersonasJuridicas
alter view VW_PERSONASJURIDICAS as
  select
    d.TIPODOCUMENTO,
    d.NUMERODOCUMENTO,
    d.NUMEROPERSONAFJ,
    j.RAZONSOCIAL,
	j.NIVEL_APERTURA as APERTURA
  from
    CLI_DOCUMENTOSPFPJ d
    inner join CLI_PERSONASJURIDICAS j on d.TIPOPERSONA = ''J'' and d.NUMEROPERSONAFJ = j.NUMEROPERSONAJURIDICA
  where
    (d.TZ_LOCK < 300000000000000 or d.TZ_LOCK >= 400000000000000) and (d.TZ_LOCK < 100000000000000 or d.TZ_LOCK >= 200000000000000)
    and (j.TZ_LOCK < 300000000000000 or j.TZ_LOCK >= 400000000000000) and (j.TZ_LOCK < 100000000000000 or j.TZ_LOCK >= 200000000000000)
    and j.NIVEL_APERTURA < 4
  union all
  select
    v.TIPODOCUMENTO,
    v.NUMERODOCUMENTO,
    v.NUMEROPERSONAJURIDICA as NUMEROPERSONAFJ,
    v.RAZONSOCIAL,
	0 as APERTURA
  from
    CLI_VINCULADOSJURIDICOS v
  where
    (v.TZ_LOCK < 300000000000000 or v.TZ_LOCK >= 400000000000000) and (v.TZ_LOCK < 100000000000000 or v.TZ_LOCK >= 200000000000000)
    and v.TIPO_PERSONA = ''J'' AND (v.TIPODOCUMENTO + v.NUMERODOCUMENTO) NOT IN (
     SELECT
     (d.TIPODOCUMENTO+d.NUMERODOCUMENTO)
     from
    CLI_DOCUMENTOSPFPJ d
    inner join CLI_PERSONASJURIDICAS j on d.TIPOPERSONA = ''J'' and d.NUMEROPERSONAFJ = j.NUMEROPERSONAJURIDICA
  where
    (d.TZ_LOCK < 300000000000000 or d.TZ_LOCK >= 400000000000000) and (d.TZ_LOCK < 100000000000000 or d.TZ_LOCK >= 200000000000000)
    and (j.TZ_LOCK < 300000000000000 or j.TZ_LOCK >= 400000000000000) and (j.TZ_LOCK < 100000000000000 or j.TZ_LOCK >= 200000000000000)
    and j.NIVEL_APERTURA < 4);

')