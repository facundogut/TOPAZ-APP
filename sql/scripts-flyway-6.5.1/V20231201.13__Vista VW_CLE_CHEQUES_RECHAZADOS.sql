EXECUTE('
IF OBJECT_ID (''dbo.VW_CLE_CHEQUES_RECHAZADOS'') IS NOT NULL
	DROP VIEW dbo.VW_CLE_CHEQUES_RECHAZADOS
')
EXECUTE('
CREATE VIEW [dbo].[VW_CLE_CHEQUES_RECHAZADOS] (
		MICRLINE,
		NUMERO_SERIE,
		NUMERO_CHEQUE, 
		CUENTA,
		SUCURSAL,
		MONEDA,
		PRODUCTO,
		FECHA)
AS
SELECT 
	concat(R.JTS_SALDOS, R.NRO_CHEQUE, R.MONEDA, R.CLIENTE) AS "MICRLINE",
	R.SERIE_CHEQUE AS "NUMERO_SERIE",
	R.NRO_CHEQUE AS "NUMERO_CHEQUE",
	R.CUENTA,
	R.SUCURSAL,
	R.MONEDA,
	R.PRODUCTO,
	R.FECHA_CHEQUE AS "FECHA"
FROM CHE_BCO_RECHAZADOS R WITH (nolock)
WHERE 
	R.TZ_LOCK = 0 
	AND R.FECHA_PAGO_MULTA IS NULL
	AND R.FECHA_NOTIF_BCRA IS NOT NULL
	AND R.FECHA_NOTIF_BCRA <= (SELECT FECHAPROCESO FROM PARAMETROS WITH (nolock))
')

