EXECUTE('
IF OBJECT_ID (''dbo.VW_VINCULADOS_GYF'') IS NOT NULL
	DROP VIEW dbo.VW_VINCULADOS_GYF
')

EXECUTE('
CREATE VIEW dbo.VW_VINCULADOS_GYF AS 
SELECT VG.ID AS ''Id'',
O.DESCRIPCION AS ''Tipo'',
CASE WHEN VG.TIPO_VINCULACION=''P'' THEN VP.DESCRIPCION    
     WHEN VG.TIPO_VINCULACION=''S'' THEN VS.DESCRIPCION
     ELSE ''Sin Descripción'' END AS ''Descripción Tipo'',
 VG.TOPE_FRACCIONAMIENTO_SING AS ''Tope Grandes Exposiciones Sin Garantía'',
 VG.TOPE_FRACCIONAMIENTO_CONG AS ''Tope Grandes Exposiciones Con Garantía''     
FROM CRE_VINCULADOS_GYF VG
LEFT JOIN CLI_VINCULOS_PRIMARIOS VP ON VP.ID=VG.ID 
LEFT JOIN CLI_VINCULOS_SECUNDARIOS VS ON VS.ID=VG.ID
LEFT JOIN OPCIONES AS O WITH(NOLOCK) ON O.NUMERODECAMPO=44038 AND O.OPCIONINTERNA=VG.TIPO_VINCULACION
WHERE VG.TZ_LOCK=0
')