EXECUTE('
--
IF OBJECT_ID (''dbo.VW_CLE_DEPOSITOS_ECHEQ'') IS NOT NULL
	DROP VIEW dbo.VW_CLE_DEPOSITOS_ECHEQ
--
')
EXECUTE('
--
CREATE VIEW VW_CLE_DEPOSITOS_ECHEQ
AS
SELECT
	E.SUCURSAL,
	E.CUENTA ,
	V.NOMBRE_CUENTA AS DENOMINACION_CUENTA,
	E.PRODUCTO,
	P.C6251 AS DESCRIPCION_PRODUCTO,
	E.MONEDA,
	E.SERIE,
	E.NUMERO_CHEQUE,
	E.IMPORTE,
	O.DESCRIPCION AS ESTADO,
	C.TIPODOC,
	C.NUMERODOC
FROM CLE_DEPOSITOS_ECHEQ AS E WITH(nolock)
INNER JOIN SALDOS AS S WITH(nolock) ON
	S.SUCURSAL = E.SUCURSAL
	AND S.PRODUCTO = E.PRODUCTO
	AND S.CUENTA = E.CUENTA
	AND S.MONEDA = E.MONEDA
	AND S.OPERACION = E.OPERACION
	AND S.ORDINAL = E.ORDINAL
	AND ((S.TZ_LOCK < 100000000000000 OR S.TZ_LOCK >= 200000000000000)
		AND (S.TZ_LOCK < 300000000000000 OR S.TZ_LOCK >= 400000000000000)  
	)
INNER JOIN VTA_SALDOS AS V WITH(nolock) ON
	V.JTS_OID_SALDO = S.JTS_OID
	AND ((V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000)
		AND (V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000)  
	)
INNER JOIN PRODUCTOS AS P WITH(nolock) ON
	P.C6250 = E.PRODUCTO
	AND ((P.TZ_LOCK < 100000000000000 OR P.TZ_LOCK >= 200000000000000)
		AND (P.TZ_LOCK < 300000000000000 OR P.TZ_LOCK >= 400000000000000)  
	)
LEFT JOIN VW_CLI_X_DOC AS C WITH(nolock) ON
	C.CODIGOCLIENTE = S.C1803
LEFT JOIN OPCIONES AS O WITH(nolock) ON
	O.NUMERODECAMPO = 35811
	AND O.IDIOMA = ''E''
	AND O.OPCIONINTERNA = E.ESTADO
WHERE
	E.TZ_LOCK = 0
--
')

