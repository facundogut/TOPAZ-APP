EXECUTE('
CREATE OR ALTER   PROCEDURE [dbo].[SP_ITF_SOS_VINCULACION_CONT]
	@FechaIni VARCHAR(8),
	@FechaFin VARCHAR(8)
AS
  DECLARE @PERIODO VARCHAR(6);
  DECLARE @FECHAPROCESO VARCHAR(8);
   
BEGIN

  SELECT @FECHAPROCESO = CONVERT(VARCHAR, FECHAPROCESO, 112) FROM PARAMETROS
  
  SET @PERIODO = SUBSTRING(CONVERT(VARCHAR, @FechaIni, 112),1,6);
  
	--Limpiamos por si hay reproceso
	DELETE FROM SOS_VINCULACION_CONT
	WHERE PERIODO = @PERIODO;
	
	INSERT INTO SOS_VINCULACION_CONT(EMPRESA, PERIODO, FECHADEINFORMACION, CLASEDECUENTA, NUMERODECUENTA,
	TIPODECUENTAUOPERACION, NUMERODEOPERACION, SUCURSALSISCEN, IDENTTRIBUTARIATIPO, IDENTTRIBUTARIANUMERO,
	CONDICION, ORDENRELACION, FECHAALTA, CODCLIENTE, NROPERSFISICAJURIDICA)
	SELECT EMPRESA,
	@PERIODO AS PERIODO,
	FECHADEINFORMACION,
	CLASEDECUENTA,
	NUMERODECUENTA,
	TIPODECUENTAUOPERACION,
	NUMERODEOPERACION,
	SUCURSALSISCEN,
	IDENTTRIBUTARIATIPO,
	IDENTTRIBUTARIANUMERO,
	CONDICION,
	ORDENRELACION,
	FECHAALTA,
	CODCLIENTE,
	NROPERSFISICAJURIDICA
	FROM SOS_VINCULACION mov 
	WHERE MOV.FECHADEINFORMACION BETWEEN @FechaIni AND @FechaFin
	
	 
END
')