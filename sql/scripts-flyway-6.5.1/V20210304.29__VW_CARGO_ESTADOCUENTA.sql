
/****** Object:  View [dbo].[VW_CARGO_ESTADOCUENTA]    Script Date: 24/02/2021 10:35:04 ******/
DROP VIEW [dbo].[VW_CARGO_ESTADOCUENTA]
GO

/****** Object:  View [dbo].[VW_CARGO_ESTADOCUENTA]    Script Date: 24/02/2021 10:35:04 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_CARGO_ESTADOCUENTA] (
   JTS_OID_COBRO,
   CLIENTE,
   MONEDA,
   PERIODO_PROD,
   PERIODO_EST,
   TIPO_PRODUCTO,
   COBRA_RESUMEN,
   SALDO_ACTUAL,
   USF,
   INMOVILIZADO)
AS 
   SELECT DISTINCT
      S.JTS_OID,
      S.C1803,
      S.MONEDA,
      P.PERIODOLEGALESTCTA,
      E.PERIODICIDAD,
      S.C1785,
      T.COBRA_RESUMEN,
      S.C1604+S.C1683+S.C1605+S.C2627+S.C50107,
      C.USF,
      S.C1728
   FROM dbo.SALDOS S with (nolock)
   inner join dbo.GRL_ESTADOS_DE_CUENTA E with (nolock) on S.CUENTA = E.CUENTA 
														and S.PRODUCTO = E.PRODUCTO 
														and S.MONEDA = E.MONEDA 
														and S.SUCURSAL = E.SUCURSAL
														and S.OPERACION = E.OPERACION
														and S.ORDINAL = E.ORDINAL 
														
   inner join dbo.PRODUCTOS P with (nolock) on S.PRODUCTO = P.C6250
   inner join dbo.TOPESPRODUCTO T with (nolock) on P.C6250 = T.CODPRODUCTO
   inner join dbo.PLANCTAS PL with (nolock) on S.C1730 = PL.C6326
   inner join dbo.CLI_CLIENTES C with (nolock) on C.CODIGOCLIENTE = S.C1803
   WHERE ((S.TZ_LOCK < 300000000000000 OR S.TZ_LOCK >= 400000000000000) AND (S.TZ_LOCK < 100000000000000 OR S.TZ_LOCK >= 200000000000000))
   AND ((E.TZ_LOCK < 300000000000000 OR E.TZ_LOCK >= 400000000000000) AND (E.TZ_LOCK < 100000000000000 OR E.TZ_LOCK >= 200000000000000))
   AND ((P.TZ_LOCK < 300000000000000 OR P.TZ_LOCK >= 400000000000000) AND (P.TZ_LOCK < 100000000000000 OR P.TZ_LOCK >= 200000000000000))
   AND ((T.TZ_LOCK < 300000000000000 OR T.TZ_LOCK >= 400000000000000) AND (T.TZ_LOCK < 100000000000000 OR T.TZ_LOCK >= 200000000000000))
   AND S.C1651 <> '1' ;
go





