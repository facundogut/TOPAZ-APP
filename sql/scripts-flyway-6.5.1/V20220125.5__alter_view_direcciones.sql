
EXECUTE('
CREATE OR ALTER VIEW [dbo].[VW_DIRECCIONES_PERSONAS]  (
														TIPODOCUMENTO,
														NUMERODOCUMENTO,
														TIPO_DOC_FISICO,
 														NUM_DOC_FISICO,
 														NOMBRE,
 														ID,
														FORMATO,
														DESC_FORMATO,
														TIPODIRECCION,
														DESC_TIPODIRECCION,
														ORDINAL_DIR,
														PAIS,
														NOMBREPAIS,
														PROVINCIA,
														NOMBREPROVINCIA,
														DEPARTAMENTO,
														NOMBREDEPARTAMENTO,
														LOCALIDAD,
														NOMBRELOCALIDAD,
														CPA_NUEVO,
														BARRIO,
														CALLE,
														NUMERO,
														PISO,
														APARTAMENTO,
														MANZANA,
														PARCELA,
														CASA,
														MONOBLOCK,
														TIRA,
														CHACRA,
														NORMALIZADO,
														PROVINCIA_EXTERIOR,
														DEPARTAMENTO_EXTERIOR,
														LOCALIDAD_EXTERIOR,
														OBSERVACIONES
)
AS
 SELECT 
 	  v.TIPODOCUMENTO,
 	  v.NUMERODOCUMENTO,
 	  v.TIPO_DOC_FISICO,
 	  v.NUM_DOC_FISICO,
 	  concat(u.APELLIDOPATERNO,'' '',u.PRIMERNOMBRE) AS NOMBRE,
 	  a.ID,
   	  a.FORMATO,
   	  (	SELECT DESCRIPCION 
		FROM OPCIONES O WITH (NOLOCK)
		WHERE O.IDIOMA = ''E'' 
		AND O.NUMERODECAMPO = 33051 
		AND O.OPCIONINTERNA= a.FORMATO) AS DESC_FORMATO,
   	  a.TIPODIRECCION,
   	  (	SELECT DESCRIPCION 
		FROM OPCIONES O  WITH (NOLOCK)
		WHERE O.IDIOMA = ''E''
		AND O.NUMERODECAMPO = 33052 
		AND O.OPCIONINTERNA= a.TIPODIRECCION) AS DESC_TIPODIRECCION,
   	  a.ORDINAL_DIR,
   	  a.PAIS,
   	  p.NOMBREPAIS,
   	  a.PROVINCIA,
   	  PP.DESCRIPCION AS NOMBREPROVINCIA,
   	  a.DEPARTAMENTO,
   	  D.NOMBREDEP AS NOMBREDEPARTAMENTO,
   	  a.LOCALIDAD,
      L.DESCRIPCION_DIM3 AS NOMBRELOCALIDAD,
      a.CPA_NUEVO,
      A.BARRIO,
      A.CALLE,
      A.NUMERO,
      A.PISO,
	  A.APARTAMENTO,
	  A.MANZANA,
	  A.PARCELA,
	  A.CASA,
      A.MONOBLOCK,
	  A.TIRA,
	  A.CHACRA,
	  CASE 
		  WHEN A.NORMALIZADO =''S'' THEN ''SI''
		  WHEN A.NORMALIZADO =''N'' THEN ''NO''
	  END AS NORMALIZADO,
      A.PROVINCIA_EXTERIOR,
      A.DEPARTAMENTO_EXTERIOR,
      A.LOCALIDAD_EXTERIOR,
      A.OBSERVACIONES
   FROM  
      dbo.CLI_DIRECCIONES AS A  WITH (NOLOCK)
      LEFT JOIN dbo.CLI_PAISES  AS P WITH (NOLOCK)ON P.CODIGOPAIS = A.PAIS
      LEFT JOIN dbo.CLI_PROVINCIAS AS PP WITH (NOLOCK)ON PP.DIM1 = A.PROVINCIA
      LEFT JOIN dbo.CLI_DEPARTAMENTOS AS D WITH (NOLOCK)ON (a.DEPARTAMENTO=d.DEPARTAMENTO) 
															AND (PP.DIM1=d.PROVINCIA)
      LEFT JOIN dbo.CLI_LOCALIDADES AS l  WITH (NOLOCK)ON (a.LOCALIDAD=l.DIM3) 
															AND (l.DIM1=PP.DIM1) 
															AND (l.DIM2=d.DEPARTAMENTO) 
      INNER JOIN dbo.CLI_PERSONASFISICAS AS U  WITH (NOLOCK)ON U.NUMEROPERSONAFISICA = a.ID 
      INNER JOIN dbo.CLI_DOCUMENTOSPFPJ AS V WITH (NOLOCK) ON U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ

   WHERE 
      ((A.TZ_LOCK < 300000000000000 OR A.TZ_LOCK >= 400000000000000) AND (A.TZ_LOCK < 100000000000000 OR A.TZ_LOCK >= 200000000000000)) AND 
      ((U.TZ_LOCK < 300000000000000 OR U.TZ_LOCK >= 400000000000000) AND (U.TZ_LOCK < 100000000000000 OR U.TZ_LOCK >= 200000000000000)) AND 
      ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000)) 
      
UNION ALL


   SELECT 
 	  v.TIPODOCUMENTO,
 	  v.NUMERODOCUMENTO,
 	  v.TIPO_DOC_FISICO,
 	  v.NUM_DOC_FISICO,
 	  j.RAZONSOCIAL AS NOMBRE,
 	  a.ID,
   	  a.FORMATO,
   	  (	SELECT DESCRIPCION 
		FROM OPCIONES O WITH (NOLOCK)
		WHERE O.IDIOMA = ''E'' 
			AND O.NUMERODECAMPO = 33051
			AND O.OPCIONINTERNA= a.FORMATO) AS DESC_FORMATO,
   	  a.TIPODIRECCION,
   	  (	SELECT DESCRIPCION 
		FROM OPCIONES O WITH (NOLOCK)
		WHERE O.IDIOMA = ''E''
			AND O.NUMERODECAMPO = 33052 
			AND O.OPCIONINTERNA= a.TIPODIRECCION) AS DESC_TIPODIRECCION,
   	  a.ORDINAL_DIR,
   	  a.PAIS,
   	  p.NOMBREPAIS,
   	  a.PROVINCIA,
   	  PP.DESCRIPCION AS NOMBREPROVINCIA,
   	  a.DEPARTAMENTO,
   	  D.NOMBREDEP AS NOMBREDEPARTAMENTO,
   	  a.LOCALIDAD,
      L.DESCRIPCION_DIM3 AS NOMBRELOCALIDAD,
      a.CPA_NUEVO,
      A.BARRIO,
      A.CALLE,
      A.NUMERO,
      A.PISO,
	  A.APARTAMENTO,
	  A.MANZANA,
	  A.PARCELA,
	  A.CASA,
      A.MONOBLOCK,
	  A.TIRA,
	  A.CHACRA,
	  CASE 
		  WHEN A.NORMALIZADO =''S'' THEN ''SI''
		  WHEN A.NORMALIZADO =''N'' THEN ''NO''
	  END AS NORMALIZADO,
      A.PROVINCIA_EXTERIOR,
      A.DEPARTAMENTO_EXTERIOR,
      A.LOCALIDAD_EXTERIOR,
      A.OBSERVACIONES   
   FROM  
      dbo.CLI_DIRECCIONES AS A WITH (NOLOCK)
      LEFT JOIN dbo.CLI_PAISES AS P WITH (NOLOCK)ON P.CODIGOPAIS = A.PAIS
      LEFT JOIN dbo.CLI_PROVINCIAS AS PP WITH (NOLOCK)ON PP.DIM1 = A.PROVINCIA
      LEFT JOIN dbo.CLI_DEPARTAMENTOS AS D WITH (NOLOCK)ON (a.DEPARTAMENTO=d.DEPARTAMENTO) 
														AND (PP.DIM1=d.PROVINCIA)
      LEFT JOIN dbo.CLI_LOCALIDADES AS l WITH (NOLOCK)ON (a.LOCALIDAD=l.DIM3) 
														AND (l.DIM1=PP.DIM1) AND (l.DIM2=d.DEPARTAMENTO) 
      INNER JOIN dbo.CLI_PERSONASJURIDICAS  AS J WITH (NOLOCK) ON J.NUMEROPERSONAJURIDICA = a.ID 
      INNER JOIN dbo.CLI_DOCUMENTOSPFPJ  AS V WITH (NOLOCK) ON J.NUMEROPERSONAJURIDICA = V.NUMEROPERSONAFJ

   WHERE 
      ((A.TZ_LOCK < 300000000000000 OR A.TZ_LOCK >= 400000000000000) AND (A.TZ_LOCK < 100000000000000 OR A.TZ_LOCK >= 200000000000000)) AND 
      ((J.TZ_LOCK < 300000000000000 OR J.TZ_LOCK >= 400000000000000) AND (J.TZ_LOCK < 100000000000000 OR J.TZ_LOCK >= 200000000000000)) AND 
      ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000))

')