EXECUTE('
IF OBJECT_ID (''dbo.VW_CHEQUERAS_SIN_CERRAR'') IS NOT NULL
	DROP VIEW dbo.VW_CHEQUERAS_SIN_CERRAR
')

EXECUTE('
CREATE   VIEW [dbo].[VW_CHEQUERAS_SIN_CERRAR] (
													   NUMEROCHEQUERA, 
													   SERIE, 
													   ESTADO, 
													   CLIENTE, 
													   CUENTA, 
													   MONEDA, 
													   PRODUCTO, 
													   SUCURSAL, 
													   OPERACION, 
													   ORDINAL, 
													   CHEQUEDESDE, 
													   CHEQUEHASTA,
													   NOMINA_CIERRE)
AS 
SELECT TOP 9223372036854775807 WITH TIES 
		U.NUMEROCHEQUERA, 
		U.SERIE, 
		U.ESTADO, 
		U.CLIENTE, 
		U.CUENTA, 
		U.MONEDA, 
		U.PRODUCTO, 
		U.SUCURSAL, 
		U.OPERACION, 
		U.ORDINAL, 
		U.CHEQUEDESDE, 
		U.CHEQUEHASTA,
		U.NOMINA_CIERRE
FROM dbo.CHE_CHEQUERAS  AS U WITH (NOLOCK)
WHERE	(U.ESTADO <> '' '' 
		AND U.ESTADO <> ''B'' 
		AND U.ESTADO <> ''D'' 
		AND U.ESTADO <> ''N'') 
		AND U.CANTIDADCHEQUES <> U.CHEQUESUSADOS 
		AND(	(U.TZ_LOCK < 300000000000000 OR U.TZ_LOCK >= 400000000000000) 
			AND (U.TZ_LOCK < 100000000000000 OR U.TZ_LOCK >= 200000000000000))
ORDER BY U.CUENTA
')

EXECUTE('
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (35351, '' '', 0, ''NOMINA_CIERRE'', ''NOMINA_CIERRE'', 1, ''A'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 234, ''NOMINA_CIERRE'', 0, NULL)
')


