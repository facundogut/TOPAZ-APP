EXECUTE('DROP PROCEDURE IF EXISTS dbo.SP_LINK_TRK;')

EXECUTE('
CREATE PROCEDURE dbo.SP_LINK_TRK

@ID_TARJETA VARCHAR(19),

@TIPO1   VARCHAR(2),
@NUMERO1   VARCHAR(19),
@ESTADO1   VARCHAR(1),

@TIPO2   VARCHAR(2),
@NUMERO2   VARCHAR(19),
@ESTADO2   VARCHAR(1),

@TIPO3   VARCHAR(2),
@NUMERO3   VARCHAR(19),
@ESTADO3   VARCHAR(1),

@TIPO4   VARCHAR(2),
@NUMERO4   VARCHAR(19),
@ESTADO4   VARCHAR(1),

@TIPO5   VARCHAR(2),
@NUMERO5   VARCHAR(19),
@ESTADO5   VARCHAR(1),

@TIPO6   VARCHAR(2),
@NUMERO6   VARCHAR(19),
@ESTADO6   VARCHAR(1),

@TIPO7   VARCHAR(2),
@NUMERO7   VARCHAR(19),
@ESTADO7   VARCHAR(1),

@TIPO8   VARCHAR(2),
@NUMERO8   VARCHAR(19),
@ESTADO8   VARCHAR(1),

@TIPO9   VARCHAR(2),
@NUMERO9   VARCHAR(19),
@ESTADO9   VARCHAR(1),

@TIPO10   VARCHAR(2),
@NUMERO10   VARCHAR(19),
@ESTADO10   VARCHAR(1),

@TIPO11   VARCHAR(2),
@NUMERO11   VARCHAR(19),
@ESTADO11   VARCHAR(1),

@TIPO12   VARCHAR(2),
@NUMERO12   VARCHAR(19),
@ESTADO12   VARCHAR(1),

@TIPO13   VARCHAR(2),
@NUMERO13   VARCHAR(19),
@ESTADO13   VARCHAR(1),

@TIPO14   VARCHAR(2),
@NUMERO14   VARCHAR(19),
@ESTADO14   VARCHAR(1),

@TIPO15   VARCHAR(2),
@NUMERO15   VARCHAR(19),
@ESTADO15   VARCHAR(1),

@TIPO16     VARCHAR(2),
@NUMERO16   VARCHAR(19),
@ESTADO16   VARCHAR(1)

AS
BEGIN
	DECLARE @flag INT;
	IF @NUMERO1 <> ''''
    BEGIN
		SET @flag = (SELECT COUNT(*) FROM TJD_LINK_MAESTRO_CUENTA WHERE NUMERO=@NUMERO1 AND ID_TARJETA = @ID_TARJETA);
    
    	IF @flag = 0
    	BEGIN
    		INSERT INTO TJD_LINK_MAESTRO_CUENTA (ID_TARJETA, NUMERO, TIPO, ESTADO)
			VALUES (@ID_TARJETA, @NUMERO1, @TIPO1, @ESTADO1);
		END
		
		ELSE
		BEGIN
		UPDATE dbo.TJD_LINK_MAESTRO_CUENTA
			SET ID_TARJETA = @ID_TARJETA,
			NUMERO = @NUMERO1,
			ESTADO = @ESTADO1,
			TIPO = @TIPO1
   			WHERE ID_TARJETA = @ID_TARJETA AND NUMERO = @NUMERO1
		END
	END
    	
    IF @NUMERO2 <> ''''
    BEGIN
		SET @flag = (SELECT COUNT(*) FROM TJD_LINK_MAESTRO_CUENTA WHERE NUMERO=@NUMERO2 AND ID_TARJETA = @ID_TARJETA);
    	
    	IF @flag = 0
    	BEGIN
    		INSERT INTO TJD_LINK_MAESTRO_CUENTA (ID_TARJETA, NUMERO, TIPO, ESTADO)
			VALUES (@ID_TARJETA, @NUMERO2, @TIPO2, @ESTADO2);
		END
		
		ELSE
		BEGIN
		UPDATE dbo.TJD_LINK_MAESTRO_CUENTA
			SET ID_TARJETA = @ID_TARJETA,
			NUMERO = @NUMERO2,
			ESTADO = @ESTADO2,
			TIPO = @TIPO2
   			WHERE ID_TARJETA = @ID_TARJETA AND NUMERO = @NUMERO2
		END
    END
    
    IF @NUMERO3 <> ''''
    BEGIN
		SET @flag = (SELECT COUNT(*) FROM TJD_LINK_MAESTRO_CUENTA WHERE NUMERO=@NUMERO3 AND ID_TARJETA = @ID_TARJETA);
		
    	IF @flag = 0
    	BEGIN
    		INSERT INTO TJD_LINK_MAESTRO_CUENTA (ID_TARJETA, NUMERO, TIPO, ESTADO)
			VALUES (@ID_TARJETA, @NUMERO3, @TIPO3, @ESTADO3);
		END
		
		ELSE
		BEGIN
		UPDATE dbo.TJD_LINK_MAESTRO_CUENTA
			SET ID_TARJETA = @ID_TARJETA,
			NUMERO = @NUMERO3,
			ESTADO = @ESTADO3,
			TIPO = @TIPO3
   			WHERE ID_TARJETA = @ID_TARJETA AND NUMERO = @NUMERO3
		END
    END
    
    IF @NUMERO4 <> ''''
    BEGIN
		SET @flag = (SELECT COUNT(*) FROM TJD_LINK_MAESTRO_CUENTA WHERE NUMERO=@NUMERO4 AND ID_TARJETA = @ID_TARJETA);
    	
    	IF @flag = 0
    	BEGIN
    		INSERT INTO TJD_LINK_MAESTRO_CUENTA (ID_TARJETA, NUMERO, TIPO, ESTADO)
			VALUES (@ID_TARJETA, @NUMERO4, @TIPO4, @ESTADO4);
		END
		
		ELSE
		BEGIN
		UPDATE dbo.TJD_LINK_MAESTRO_CUENTA
			SET ID_TARJETA = @ID_TARJETA,
			NUMERO = @NUMERO4,
			ESTADO = @ESTADO4,
			TIPO = @TIPO4
   			WHERE ID_TARJETA = @ID_TARJETA AND NUMERO = @NUMERO4
		END
    END
    
    IF @NUMERO5 <> ''''
    BEGIN
    	SET @flag = (SELECT COUNT(*) FROM TJD_LINK_MAESTRO_CUENTA WHERE NUMERO=@NUMERO5 AND ID_TARJETA = @ID_TARJETA);
    	
    	IF @flag = 0
    	BEGIN
    		INSERT INTO TJD_LINK_MAESTRO_CUENTA (ID_TARJETA, NUMERO, TIPO, ESTADO)
			VALUES (@ID_TARJETA, @NUMERO5, @TIPO5, @ESTADO5);
		END
		
		ELSE
		BEGIN
		UPDATE dbo.TJD_LINK_MAESTRO_CUENTA
			SET ID_TARJETA = @ID_TARJETA,
			NUMERO = @NUMERO5,
			ESTADO = @ESTADO5,
			TIPO = @TIPO5
   			WHERE ID_TARJETA = @ID_TARJETA AND NUMERO = @NUMERO5
		END
    END
    
    IF @NUMERO6 <> ''''
    BEGIN
    	SET @flag = (SELECT COUNT(*) FROM TJD_LINK_MAESTRO_CUENTA WHERE NUMERO=@NUMERO6 AND ID_TARJETA = @ID_TARJETA);
    	
    	IF @flag = 0
    	BEGIN
    		INSERT INTO TJD_LINK_MAESTRO_CUENTA (ID_TARJETA, NUMERO, TIPO, ESTADO)
			VALUES (@ID_TARJETA, @NUMERO6, @TIPO6, @ESTADO6);
		END
		
		ELSE
		BEGIN
		UPDATE dbo.TJD_LINK_MAESTRO_CUENTA
			SET ID_TARJETA = @ID_TARJETA,
			NUMERO = @NUMERO6,
			ESTADO = @ESTADO6,
			TIPO = @TIPO6
   			WHERE ID_TARJETA = @ID_TARJETA AND NUMERO = @NUMERO6
		END
    END
    
    IF @NUMERO7 <> ''''
    BEGIN
    	SET @flag = (SELECT COUNT(*) FROM TJD_LINK_MAESTRO_CUENTA WHERE NUMERO=@NUMERO7 AND ID_TARJETA = @ID_TARJETA);
    	
    	IF @flag = 0
    	BEGIN
    		INSERT INTO TJD_LINK_MAESTRO_CUENTA (ID_TARJETA, NUMERO, TIPO, ESTADO)
			VALUES (@ID_TARJETA, @NUMERO7, @TIPO7, @ESTADO7);
		END
		
		ELSE
		BEGIN
		UPDATE dbo.TJD_LINK_MAESTRO_CUENTA
			SET ID_TARJETA = @ID_TARJETA,
			NUMERO = @NUMERO7,
			ESTADO = @ESTADO7,
			TIPO = @TIPO7
   			WHERE ID_TARJETA = @ID_TARJETA AND NUMERO = @NUMERO7
		END
    END
    
    IF @NUMERO8 <> ''''
    BEGIN
    	SET @flag = (SELECT COUNT(*) FROM TJD_LINK_MAESTRO_CUENTA WHERE NUMERO=@NUMERO8 AND ID_TARJETA = @ID_TARJETA);
    	
    	IF @flag = 0
    	BEGIN
    		INSERT INTO TJD_LINK_MAESTRO_CUENTA (ID_TARJETA, NUMERO, TIPO, ESTADO)
			VALUES (@ID_TARJETA, @NUMERO8, @TIPO8, @ESTADO8);
		END
		
		ELSE
		BEGIN
		UPDATE dbo.TJD_LINK_MAESTRO_CUENTA
			SET ID_TARJETA = @ID_TARJETA,
			NUMERO = @NUMERO8,
			ESTADO = @ESTADO8,
			TIPO = @TIPO8
   			WHERE ID_TARJETA = @ID_TARJETA AND NUMERO = @NUMERO8
		END
    END
    
    IF @NUMERO9 <> ''''
    BEGIN
    	SET @flag = (SELECT COUNT(*) FROM TJD_LINK_MAESTRO_CUENTA WHERE NUMERO=@NUMERO9 AND ID_TARJETA = @ID_TARJETA);
    	
    	IF @flag = 0
    	BEGIN
    		INSERT INTO TJD_LINK_MAESTRO_CUENTA (ID_TARJETA, NUMERO, TIPO, ESTADO)
			VALUES (@ID_TARJETA, @NUMERO9, @TIPO9, @ESTADO9);
		END
		
		ELSE
		BEGIN
		UPDATE dbo.TJD_LINK_MAESTRO_CUENTA
			SET ID_TARJETA = @ID_TARJETA,
			NUMERO = @NUMERO9,
			ESTADO = @ESTADO9,
			TIPO = @TIPO9
   			WHERE ID_TARJETA = @ID_TARJETA AND NUMERO = @NUMERO9
		END
    END
    
    IF @NUMERO10 <> ''''
    BEGIN
    	SET @flag = (SELECT COUNT(*) FROM TJD_LINK_MAESTRO_CUENTA WHERE NUMERO=@NUMERO10 AND ID_TARJETA = @ID_TARJETA);
    	
    	IF @flag = 0
    	BEGIN
    		INSERT INTO TJD_LINK_MAESTRO_CUENTA (ID_TARJETA, NUMERO, TIPO, ESTADO)
			VALUES (@ID_TARJETA, @NUMERO10, @TIPO10, @ESTADO10);
		END
		
		ELSE
		BEGIN
		UPDATE dbo.TJD_LINK_MAESTRO_CUENTA
			SET ID_TARJETA = @ID_TARJETA,
			NUMERO = @NUMERO10,
			ESTADO = @ESTADO10,
			TIPO = @TIPO10
   			WHERE ID_TARJETA = @ID_TARJETA AND NUMERO = @NUMERO10
		END
    END
    
    IF @NUMERO11 <> ''''
    BEGIN
    	SET @flag = (SELECT COUNT(*) FROM TJD_LINK_MAESTRO_CUENTA WHERE NUMERO=@NUMERO11 AND ID_TARJETA = @ID_TARJETA);
    	
    	IF @flag = 0
    	BEGIN
    		INSERT INTO TJD_LINK_MAESTRO_CUENTA (ID_TARJETA, NUMERO, TIPO, ESTADO)
			VALUES (@ID_TARJETA, @NUMERO11, @TIPO11, @ESTADO11);
		END
		
		ELSE
		BEGIN
		UPDATE dbo.TJD_LINK_MAESTRO_CUENTA
			SET ID_TARJETA = @ID_TARJETA,
			NUMERO = @NUMERO11,
			ESTADO = @ESTADO11,
			TIPO = @TIPO11
   			WHERE ID_TARJETA = @ID_TARJETA AND NUMERO = @NUMERO11
		END
    END
    
    IF @NUMERO12 <> ''''
    BEGIN
    	SET @flag = (SELECT COUNT(*) FROM TJD_LINK_MAESTRO_CUENTA WHERE NUMERO=@NUMERO12 AND ID_TARJETA = @ID_TARJETA);
    	
    	IF @flag = 0
    	BEGIN
    		INSERT INTO TJD_LINK_MAESTRO_CUENTA (ID_TARJETA, NUMERO, TIPO, ESTADO)
			VALUES (@ID_TARJETA, @NUMERO12, @TIPO12, @ESTADO12);
		END
		
		ELSE
		BEGIN
		UPDATE dbo.TJD_LINK_MAESTRO_CUENTA
			SET ID_TARJETA = @ID_TARJETA,
			NUMERO = @NUMERO12,
			ESTADO = @ESTADO12,
			TIPO = @TIPO12
   			WHERE ID_TARJETA = @ID_TARJETA AND NUMERO = @NUMERO12
		END
    END
    
    IF @NUMERO13 <> ''''
    BEGIN
    	SET @flag = (SELECT COUNT(*) FROM TJD_LINK_MAESTRO_CUENTA WHERE NUMERO=@NUMERO13 AND ID_TARJETA = @ID_TARJETA);
    	
    	IF @flag = 0
    	BEGIN
    		INSERT INTO TJD_LINK_MAESTRO_CUENTA (ID_TARJETA, NUMERO, TIPO, ESTADO)
			VALUES (@ID_TARJETA, @NUMERO13, @TIPO13, @ESTADO13);
		END
		
		ELSE
		BEGIN
		UPDATE dbo.TJD_LINK_MAESTRO_CUENTA
			SET ID_TARJETA = @ID_TARJETA,
			NUMERO = @NUMERO13,
			ESTADO = @ESTADO13,
			TIPO = @TIPO13
   			WHERE ID_TARJETA = @ID_TARJETA AND NUMERO = @NUMERO13
		END
    END
    
    IF @NUMERO14 <> ''''
    BEGIN
    	SET @flag = (SELECT COUNT(*) FROM TJD_LINK_MAESTRO_CUENTA WHERE NUMERO=@NUMERO14 AND ID_TARJETA = @ID_TARJETA);
    	
    	IF @flag = 0
    	BEGIN
    		INSERT INTO TJD_LINK_MAESTRO_CUENTA (ID_TARJETA, NUMERO, TIPO, ESTADO)
			VALUES (@ID_TARJETA, @NUMERO14, @TIPO14, @ESTADO14);
		END
		
		ELSE
		BEGIN
		UPDATE dbo.TJD_LINK_MAESTRO_CUENTA
			SET ID_TARJETA = @ID_TARJETA,
			NUMERO = @NUMERO14,
			ESTADO = @ESTADO14,
			TIPO = @TIPO14
   			WHERE ID_TARJETA = @ID_TARJETA AND NUMERO = @NUMERO14
		END
    END
    
    IF @NUMERO15 <> ''''
    BEGIN
    	SET @flag = (SELECT COUNT(*) FROM TJD_LINK_MAESTRO_CUENTA WHERE NUMERO=@NUMERO15 AND ID_TARJETA = @ID_TARJETA);
    	
    	IF @flag = 0
    	BEGIN
    		INSERT INTO TJD_LINK_MAESTRO_CUENTA (ID_TARJETA, NUMERO, TIPO, ESTADO)
			VALUES (@ID_TARJETA, @NUMERO15, @TIPO15, @ESTADO15);
		END
		
		ELSE
		BEGIN
		UPDATE dbo.TJD_LINK_MAESTRO_CUENTA
			SET ID_TARJETA = @ID_TARJETA,
			NUMERO = @NUMERO15,
			ESTADO = @ESTADO15,
			TIPO = @TIPO15
   			WHERE ID_TARJETA = @ID_TARJETA AND NUMERO = @NUMERO15
		END
    END
    
    IF @NUMERO16 <> ''''
    BEGIN
    	SET @flag = (SELECT COUNT(*) FROM TJD_LINK_MAESTRO_CUENTA WHERE NUMERO=@NUMERO16 AND ID_TARJETA = @ID_TARJETA);
    	
    	IF @flag = 0
    	BEGIN
    		INSERT INTO TJD_LINK_MAESTRO_CUENTA (ID_TARJETA, NUMERO, TIPO, ESTADO)
			VALUES (@ID_TARJETA, @NUMERO16, @TIPO16, @ESTADO16);
		END
		
		ELSE
		BEGIN
		UPDATE dbo.TJD_LINK_MAESTRO_CUENTA
			SET ID_TARJETA = @ID_TARJETA,
			NUMERO = @NUMERO16,
			ESTADO = @ESTADO16,
			TIPO = @TIPO16
   			WHERE ID_TARJETA = @ID_TARJETA AND NUMERO = @NUMERO16
		END
    END   
   
END;')


