EXECUTE('
ALTER TABLE CV_MOTIVOS_CANCELACION ADD Tipo VARCHAR(2)
')

EXECUTE('
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (35340, '' '', 0, ''Tipo'', ''Tipo'', 2, ''A'', 0, NULL, 0, 0, 0, 0, 0, 0, 1, 243, ''Tipo'', 0, NULL)

INSERT INTO dbo.OPCIONES (NUMERODECAMPO, IDIOMA, DESCRIPCION, OPCIONINTERNA, OPCIONDEPANTALLA)
VALUES (35340, ''E'', ''Automático ambas'', ''AA'', ''AA'')

INSERT INTO dbo.OPCIONES (NUMERODECAMPO, IDIOMA, DESCRIPCION, OPCIONINTERNA, OPCIONDEPANTALLA)
VALUES (35340, ''E'', ''Automático cuenta corriente'', ''AC'', ''AC'')

INSERT INTO dbo.OPCIONES (NUMERODECAMPO, IDIOMA, DESCRIPCION, OPCIONINTERNA, OPCIONDEPANTALLA)
VALUES (35340, ''E'', ''Automático caja ahorro'', ''AH'', ''AH'')

INSERT INTO dbo.OPCIONES (NUMERODECAMPO, IDIOMA, DESCRIPCION, OPCIONINTERNA, OPCIONDEPANTALLA)
VALUES (35340, ''E'', ''Manual ambas'', ''MA'', ''MA'')

INSERT INTO dbo.OPCIONES (NUMERODECAMPO, IDIOMA, DESCRIPCION, OPCIONINTERNA, OPCIONDEPANTALLA)
VALUES (35340, ''E'', ''Manual cuenta corriente'', ''MC'', ''MC'')

INSERT INTO dbo.OPCIONES (NUMERODECAMPO, IDIOMA, DESCRIPCION, OPCIONINTERNA, OPCIONDEPANTALLA)
VALUES (35340, ''E'', ''Manual caja ahorro'', ''MH'', ''MH'')

UPDATE dbo.CV_MOTIVOS_CANCELACION
SET Tipo = ''MC''
WHERE CODIGO_MOTIVO = 3

UPDATE dbo.CV_MOTIVOS_CANCELACION
SET Tipo = ''MC''
WHERE CODIGO_MOTIVO = 4

UPDATE dbo.CV_MOTIVOS_CANCELACION
SET Tipo = ''MH''
WHERE CODIGO_MOTIVO = 1

UPDATE dbo.CV_MOTIVOS_CANCELACION
SET Tipo = ''MH''
WHERE CODIGO_MOTIVO = 2

INSERT INTO dbo.PARAMETROSGENERALES (CODIGO, DESCRIPCION, ALFA, NUMERICO, FECHA, IMPORTE, TASA, TZ_LOCK)
VALUES (734, ''Días de cancelación de CC'', NULL, 30, NULL, 0, 0, 0)

UPDATE dbo.TOPESPRODUCTO
SET BAJA_INTERACTIVA = ''N''
WHERE CODPRODUCTO = 12 AND MONEDA = 1
')

EXECUTE('
IF OBJECT_ID (''dbo.VW_CUENTAS_A_CANCELAR'') IS NOT NULL
	DROP VIEW dbo.VW_CUENTAS_A_CANCELAR
')

EXECUTE('
CREATE VIEW [dbo].[VW_CUENTAS_A_CANCELAR] 
AS
SELECT S.SUCURSAL, S.PRODUCTO, S.CUENTA, S.MONEDA, S.OPERACION, S.ORDINAL
FROM SALDOS S WITH(NOLOCK)
INNER JOIN CV_CANCELACION_CUENTAS C WITH(NOLOCK) ON C.SALDO_JTS_OID = S.JTS_OID
WHERE C.TZ_LOCK = 0 AND S.TZ_LOCK = 0 AND C.ESTADO = ''C''
AND (SELECT DATEADD(DAY,(SELECT NUMERICO FROM PARAMETROSGENERALES WHERE CODIGO = 734), C.FECHA_CANCELACION)) <= (SELECT FECHAPROCESO FROM PARAMETROS)
')

EXECUTE('
INSERT INTO dbo.DESCRIPTORES (TITULO, IDENTIFICACION, TIPODEARCHIVO, DESCRIPCION, GRUPODELMAPA, NOMBREFISICO, TIPODEDBMS, LARGODELREGISTRO, INICIALIZACIONDELREGISTRO, BASE, SELECCION, ACEPTA_MOVS_DIFERIDO)
VALUES (35, 3544, NULL, ''Vista cuentas a cancelar'', 0, ''VW_CUENTAS_A_CANCELAR'', ''D'', NULL, NULL, ''TOP/CLIENTES'', NULL, ''N'')

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (35652, NULL, 0, ''SUCURSAL'', ''SUCURSAL'', 5, ''N'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3544, ''SUCURSAL'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (35653, '' '', 0, ''PRODUCTO'', ''PRODUCTO'', 5, ''N'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3544, ''PRODUCTO'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (35654, '' '', 0, ''CUENTA'', ''CUENTA'', 12, ''N'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3544, ''CUENTA'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (35655, '' '', 0, ''MONEDA'', ''MONEDA'', 4, ''N'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3544, ''MONEDA'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (35656, '' '', 0, ''OPERACION'', ''OPERACION'', 12, ''N'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3544, ''OPERACION'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (35657, '' '', 0, ''ORDINAL'', ''ORDINAL'', 6, ''N'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3544, ''ORDINAL'', 0, NULL)
')