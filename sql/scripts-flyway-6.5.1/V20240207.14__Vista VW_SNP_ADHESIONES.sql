EXECUTE('
IF OBJECT_ID (''dbo.VW_SNP_ADHESIONES'') IS NOT NULL
	DROP VIEW dbo.VW_SNP_ADHESIONES
')
EXECUTE('
CREATE VIEW VW_SNP_ADHESIONES
AS
SELECT
	A.CLIENTE_ADHERIDO,
	A.APELLIDO_NOMBRE,
	A.CUIT_EO,
	PE.NOMBRE_EMPRESA,
	A.PRESTACION,
	A.SUCURSAL,
	A.MONEDA,
	A.CUENTA,
	VS.NOMBRE_CUENTA AS DENOMINACION_CUENTA,
	A.PRODUCTO,
	P.C6251 AS DESCRIPCION_PRODUCTO,
	OE.DESCRIPCION AS ESTADO
FROM SNP_ADHESIONES AS A WITH (nolock)
INNER JOIN SALDOS AS S WITH (nolock) ON
	S.SUCURSAL = A.SUCURSAL
	AND S.PRODUCTO = A.PRODUCTO
	AND S.MONEDA = A.MONEDA
	AND S.CUENTA = A.CUENTA
	AND S.OPERACION = 0
	AND S.ORDINAL = 0
	AND ((S.TZ_LOCK < 100000000000000 OR S.TZ_LOCK >= 200000000000000)
		AND (S.TZ_LOCK < 300000000000000 OR S.TZ_LOCK >= 400000000000000)  
	)
INNER JOIN VTA_SALDOS AS VS WITH (nolock) ON
	VS.JTS_OID_SALDO = S.JTS_OID
	AND ((VS.TZ_LOCK < 100000000000000 OR VS.TZ_LOCK >= 200000000000000)
		AND (VS.TZ_LOCK < 300000000000000 OR VS.TZ_LOCK >= 400000000000000)  
	)
INNER JOIN PRODUCTOS AS P WITH (nolock) ON
	P.C6250 = A.PRODUCTO
	AND ((P.TZ_LOCK < 100000000000000 OR P.TZ_LOCK >= 200000000000000)
		AND (P.TZ_LOCK < 300000000000000 OR P.TZ_LOCK >= 400000000000000)  
	)
INNER JOIN SNP_PRESTACIONES_EMPRESAS AS PE WITH (nolock) ON
	PE.CUIT_EO = A.CUIT_EO
	AND PE.PRESTACION = A.PRESTACION
	AND ((PE.TZ_LOCK < 100000000000000 OR PE.TZ_LOCK >= 200000000000000)
		AND (PE.TZ_LOCK < 300000000000000 OR PE.TZ_LOCK >= 400000000000000)  
	)	
LEFT JOIN OPCIONES AS OE WITH (nolock) ON
	OE.NUMERODECAMPO = 44730
	AND OE.IDIOMA = ''E''
	AND OE.OPCIONINTERNA = A.ESTADO
WHERE
	A.TZ_LOCK = 0
')