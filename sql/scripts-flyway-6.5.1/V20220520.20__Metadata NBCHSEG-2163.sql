EXECUTE('

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (45225, '' '', 0, ''Fecha de cobro/pago'', ''Fecha de cobro/pago'', 8, ''F'', 0, ''F'', 0, 0, 0, 0, 0, 0, 0, 4489, ''FECHA_COBRO_PAGO'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (45226, '' '', 0, ''Estado rendicion'', ''Estado rendicion'', 1, ''A'', 0, NULL, 0, 0, 0, 0, 0, 0, 1, 4489, ''ESTADO_REND'', 0, NULL)

INSERT INTO dbo.OPCIONES (NUMERODECAMPO, IDIOMA, DESCRIPCION, OPCIONINTERNA, OPCIONDEPANTALLA)
VALUES (45226, ''E'', ''Pendiente'', ''P'', ''P'')

INSERT INTO dbo.OPCIONES (NUMERODECAMPO, IDIOMA, DESCRIPCION, OPCIONINTERNA, OPCIONDEPANTALLA)
VALUES (45226, ''E'', ''Rendido'', ''R'', ''R'')
--
')
EXECUTE('
--
CREATE VIEW VW_RENDICION_AGENCIEROS as
SELECT a.Id_ConvRec AS ''ID_CONVENIO'', a.NomConvRec AS ''NOMBRE_CONVENIO'', a.Cuit AS ''CUIT'', a.NOMBRECLIENTE AS ''NOMBRE_CLIENTE'',
a.Acreditacion AS ''PLAZO_ACRED'',a.FECHA_COBRO_PAGO AS ''FECHA_COBROPAGO'', 
a.[ESTADO REND] AS ''ESTADO_REND'', A.SIG_IMP_LIQUIDO AS ''SIGNO'',
a.[TOTAL REGISTROS] AS ''TOTAL_REGISTROS'', a.[TOTAL IMPORTE] AS ''TOTAL_IMPORTE'',a.FECHA_REND

FROM 
	-- DEBITOS
	(SELECT C.Id_ConvRec, C.NomConvRec, C.Cuit,
		CLI.NOMBRECLIENTE, C.Acreditacion, A.FECHA_COBRO_PAGO, 
		O.DESCRIPCION AS [ESTADO REND],A.SIG_IMP_LIQUIDO, 
		COUNT(*) AS [TOTAL REGISTROS], SUM(A.IMPORTE_LIQUIDO) AS [TOTAL IMPORTE],
		(CASE WHEN C.Acreditacion = OE.OPCIONINTERNA AND OE.OPCIONINTERNA = ''24H''
			THEN dbo.diaHabil(DATEADD(day,1,a.FECHA_COBRO_PAGO),''A'')
			WHEN C.Acreditacion = OE.OPCIONINTERNA AND 	OE.OPCIONINTERNA = ''48H''
			THEN dbo.diaHabil(DATEADD(day,2,a.FECHA_COBRO_PAGO),''A'') END) AS [FECHA_REND]  
	FROM REC_Agencieros A
		JOIN OPCIONES O ON O.OPCIONINTERNA = A.ESTADO_REND AND O.NUMERODECAMPO = 45226 AND O.IDIOMA = ''E'',
		CONV_CONVENIOS_REC C
		JOIN OPCIONES OE ON OE.OPCIONINTERNA = C.Acreditacion AND OE.NUMERODECAMPO = 44755 AND OE.IDIOMA = ''E''
		LEFT JOIN CLI_CLIENTES CLI ON C.Cliente = CLI.CODIGOCLIENTE AND CLI.TZ_LOCK = 0
		JOIN PARAMETROSGENERALES p ON C.Id_ConvRec = p.NUMERICO AND p.CODIGO IN(300) AND p.TZ_LOCK = 0
	WHERE A.ESTADO = ''P'' AND A.ESTADO_REND = ''P'' AND A.SIG_IMP_LIQUIDO =1
	GROUP BY C.Id_ConvRec, C.NomConvRec, C.Cuit, CLI.NOMBRECLIENTE, C.Acreditacion, A.FECHA_COBRO_PAGO, O.DESCRIPCION, OE.OPCIONINTERNA, A.SIG_IMP_LIQUIDO

union
	-- CREDITOS
	SELECT C.Id_ConvRec, C.NomConvRec, C.Cuit,
		CLI.NOMBRECLIENTE, C.Acreditacion, A.FECHA_COBRO_PAGO, 
		O.DESCRIPCION AS [ESTADO REND], A.SIG_IMP_LIQUIDO,
		COUNT(*) AS [TOTAL REGISTROS], SUM(A.IMPORTE_LIQUIDO) AS [TOTAL IMPORTE],
		(CASE WHEN C.Acreditacion = OE.OPCIONINTERNA AND OE.OPCIONINTERNA = ''24H''
			THEN dbo.diaHabil(DATEADD(day,1,a.FECHA_COBRO_PAGO),''A'')
			WHEN C.Acreditacion = OE.OPCIONINTERNA AND 	OE.OPCIONINTERNA = ''48H''
			THEN dbo.diaHabil(DATEADD(day,2,a.FECHA_COBRO_PAGO),''A'') END) AS [FECHA_REND] 
	FROM REC_Agencieros A
		JOIN OPCIONES O ON O.OPCIONINTERNA = A.ESTADO_REND AND O.NUMERODECAMPO = 45226 AND O.IDIOMA = ''E'',
		CONV_CONVENIOS_REC C
		JOIN OPCIONES OE ON OE.OPCIONINTERNA = C.Acreditacion AND OE.NUMERODECAMPO = 44755 AND OE.IDIOMA = ''E''
		LEFT JOIN CLI_CLIENTES CLI ON C.Cliente = CLI.CODIGOCLIENTE AND CLI.TZ_LOCK = 0
		JOIN PARAMETROSGENERALES p ON C.Id_ConvRec = p.NUMERICO AND p.CODIGO IN(301) AND p.TZ_LOCK = 0
	WHERE A.ESTADO = ''P'' AND A.ESTADO_REND = ''P'' AND A.SIG_IMP_LIQUIDO =2
	GROUP BY C.Id_ConvRec, C.NomConvRec, C.Cuit, CLI.NOMBRECLIENTE, C.Acreditacion, A.FECHA_COBRO_PAGO, O.DESCRIPCION, OE.OPCIONINTERNA, A.SIG_IMP_LIQUIDO) a
GROUP by
a.Id_ConvRec, a.NomConvRec, a.Cuit, a.NOMBRECLIENTE,
a.Acreditacion, a.FECHA_COBRO_PAGO, 
a.[ESTADO REND], a.[TOTAL REGISTROS], a.[TOTAL IMPORTE], a.FECHA_REND, A.SIG_IMP_LIQUIDO
--
')
EXECUTE('
--
INSERT INTO dbo.DESCRIPTORES (TITULO, IDENTIFICACION, TIPODEARCHIVO, DESCRIPCION, GRUPODELMAPA, NOMBREFISICO, TIPODEDBMS, LARGODELREGISTRO, INICIALIZACIONDELREGISTRO, BASE, SELECCION, ACEPTA_MOVS_DIFERIDO)
VALUES (24, 4540, NULL, ''Ayuda Rendicion Agencieros'', 0, ''VW_RENDICION_AGENCIEROS'', ''D'', NULL, NULL, ''Top/Clientes'', NULL, ''N'')

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (45400, '' '', 0, ''Id Convenio'', ''Id Convenio'', 15, ''N'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 4540, ''ID_CONVENIO'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (45401, '' '', 0, ''Nombre Convenio'', ''Nombre Convenio'', 40, ''A'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 4540, ''NOMBRE_CONVENIO'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (45402, '' '', 0, ''Cuit'', ''Cuit'', 11, ''N'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 4540, ''CUIT'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (45403, '' '', 0, ''Nombre Cliente'', ''Nombre Cliente'', 70, ''A'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 4540, ''NOMBRE_CLIENTE'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (45404, '' '', 0, ''Plazo Acreditacion'', ''Plazo Acreditacion'', 3, ''A'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 4540, ''PLAZO_ACRED'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (45405, '' '', 0, ''Fecha Cobro/Pago'', ''Fecha Cobro/Pago'', 8, ''F'', 0, ''F'', 0, 0, 0, 0, 0, 0, 0, 4540, ''FECHA_COBROPAGO'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (45406, '' '', 0, ''Estado rendicion'', ''Estado rendicion'', 40, ''A'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 4540, ''ESTADO_REND'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (45407, '' '', 0, ''Total registros'', ''Total registros'', 6, ''N'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 4540, ''TOTAL_REGISTROS'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (45408, '' '', 0, ''Total importe'', ''Total importe'', 15, ''N'', 2, NULL, 0, 0, 0, 0, 0, 0, 0, 4540, ''TOTAL_IMPORTE'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (45409, '' '', 0, ''Fecha rendicion'', ''Fecha rendicion'', 8, ''F'', 0, ''F'', 0, 0, 0, 0, 0, 0, 0, 4540, ''FECHA_REND'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (45410, '' '', 0, ''Signo cobro/pago'', ''Signo cobro/pago'', 1, ''N'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 4540, ''SIGNO'', 0, NULL)

INSERT INTO dbo.INDICES (NUMERODEARCHIVO, NUMERODEINDICE, DESCRIPCION, CLAVESREPETIDAS, CAMPO1, CAMPO2, CAMPO3, CAMPO4, CAMPO5, CAMPO6, CAMPO7, CAMPO8, CAMPO9, CAMPO10, CAMPO11, CAMPO12, CAMPO13, CAMPO14, CAMPO15, CAMPO16, CAMPO17, CAMPO18, CAMPO19, CAMPO20)
VALUES (4540, 1, ''Indice primario'', 0, 45400, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)

INSERT INTO dbo.AYUDAS (NUMERODEARCHIVO, NUMERODEAYUDA, DESCRIPCION, FILTRO, MOSTRARTODOS, CAMPOS, CAMPOSVISTA, BASEVISTA, NOMBREVISTA, AYUDAGRANDE)
VALUES (4540, 45401, ''Ayuda Rendicion Agencieros'', '''', 0, ''45400R;45401;45410;45407;45408;45409;45404;45406;45402;45403;'', NULL, NULL, NULL, 0)
--
')
EXECUTE('
--
CREATE VIEW VW_RENDICION_ID_AGENCIEROS AS 
SELECT A.ID,  A.FECHA_COBRO_PAGO, A.SIG_IMP_LIQUIDO AS [SIGNO], C.Acreditacion AS [ACREDITACION],
		(CASE WHEN C.Acreditacion = OE.OPCIONINTERNA AND OE.OPCIONINTERNA = ''24H''
			THEN dbo.diaHabil(DATEADD(day,1,a.FECHA_COBRO_PAGO),''A'')
			WHEN C.Acreditacion = OE.OPCIONINTERNA AND 	OE.OPCIONINTERNA = ''48H''
			THEN dbo.diaHabil(DATEADD(day,2,a.FECHA_COBRO_PAGO),''A'') END) AS [FECHA_REND] 
	FROM REC_Agencieros A,
		CONV_CONVENIOS_REC C
		JOIN OPCIONES OE ON OE.OPCIONINTERNA = C.Acreditacion AND OE.NUMERODECAMPO = 44755 AND OE.IDIOMA = ''E''
		JOIN PARAMETROSGENERALES p ON C.Id_ConvRec = p.NUMERICO AND p.CODIGO IN(300,301) AND p.TZ_LOCK = 0
	WHERE A.ESTADO = ''P'' AND A.ESTADO_REND = ''P'' AND A.SIG_IMP_LIQUIDO IN(1,2) 
	
	GROUP BY A.ID, C.Acreditacion, A.FECHA_COBRO_PAGO, OE.OPCIONINTERNA, A.SIG_IMP_LIQUIDO
--
')
EXECUTE('
--
INSERT INTO dbo.DESCRIPTORES (TITULO, IDENTIFICACION, TIPODEARCHIVO, DESCRIPCION, GRUPODELMAPA, NOMBREFISICO, TIPODEDBMS, LARGODELREGISTRO, INICIALIZACIONDELREGISTRO, BASE, SELECCION, ACEPTA_MOVS_DIFERIDO)
VALUES (24, 4541, NULL, ''Vista Id Agencieros Rendicion'', 0, ''VW_RENDICION_ID_AGENCIEROS'', ''D'', NULL, NULL, ''Top/Clientes'', NULL, ''N'')


INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (45415, '' '', 0, ''ID'', ''ID'', 15, ''N'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 4541, ''ID'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (45416, '' '', 0, ''Fecha cobropago'', ''Fecha cobro/pago'', 8, ''F'', 0, ''F'', 0, 0, 0, 0, 0, 0, 0, 4541, ''FECHA_COBRO_PAGO'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (45417, '' '', 0, ''Signo'', ''Signo'', 1, ''N'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 4541, ''SIGNO'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (45418, '' '', 0, ''Acreditacion'', ''Acreditacion'', 3, ''A'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 4541, ''ACREDITACION'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (45419, '' '', 0, ''Fecha rendicion'', ''Fecha rendicion'', 8, ''F'', 0, ''F'', 0, 0, 0, 0, 0, 0, 0, 4541, ''FECHA_REND'', 0, NULL)

INSERT INTO dbo.INDICES (NUMERODEARCHIVO, NUMERODEINDICE, DESCRIPCION, CLAVESREPETIDAS, CAMPO1, CAMPO2, CAMPO3, CAMPO4, CAMPO5, CAMPO6, CAMPO7, CAMPO8, CAMPO9, CAMPO10, CAMPO11, CAMPO12, CAMPO13, CAMPO14, CAMPO15, CAMPO16, CAMPO17, CAMPO18, CAMPO19, CAMPO20)
VALUES (4541, 1, ''Indice primario'', 0, 45415, 45419, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)
')