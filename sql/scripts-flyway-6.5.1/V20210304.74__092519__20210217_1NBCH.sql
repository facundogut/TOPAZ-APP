


-- Parche_NUNBCHACO_201

-- 
-- HM begin sentence
IF NOT EXISTS (
SELECT *
FROM information_schema.columns
WHERE table_name='BS_PLANPAGO_TASAMERCADO')
BEGIN
CREATE TABLE BS_PLANPAGO_TASAMERCADO
(
TZ_LOCK     NUMERIC (15) DEFAULT ((0)),
SALDOS_JTS_OID NUMERIC (10) DEFAULT ((0)) NOT NULL,
NUMERO_DE_CUOTA NUMERIC (3, 0) DEFAULT ((0)) NOT NULL,
FECHA_VENCIMIENTO DATETIME, 
CAPITAL_PRESTAMO NUMERIC (15, 2) DEFAULT ((0)), 
INTERES_PRESTAMO NUMERIC (15, 2) DEFAULT ((0)), 
REMANENTE_PRESTAMO NUMERIC (15, 2) DEFAULT ((0)), 
CAPITAL_TASA_MERCADO NUMERIC (15, 2) DEFAULT ((0)), 
INTERES_TASA_MERCADO NUMERIC (15, 2) DEFAULT ((0)), 
REMANENTE_TASA_MERCADO NUMERIC (15, 2) DEFAULT ((0)),  
CONTABILIZADO VARCHAR (1) DEFAULT (' '),
FECHA_DEVENGADO DATETIME,
CONSTRAINT PK_BS_PLANPAGO_TASAMERCADO PRIMARY KEY (SALDOS_JTS_OID, NUMERO_DE_CUOTA)
)
END
-- HM end sentence;

-- 
-- HM begin sentence
IF NOT EXISTS (
SELECT *
FROM information_schema.columns
WHERE table_name='SALDOS'
AND column_name='TASA_INT_MERCADO')
BEGIN
ALTER TABLE SALDOS ADD TASA_INT_MERCADO NUMERIC (11, 7);

END
-- HM end sentence;

-- Inserta registros en PARAMETROS_JTS
INSERT INTO PARAMETROS_JTS (FUNCIONALIDAD, PARAMETRO, VALOR, TZ_LOCK)
VALUES ('CREA_CRONOGRAMA_DIFERENTE_TASA_INTERES', 'CANAL', '0', 0);

INSERT INTO PARAMETROS_JTS (FUNCIONALIDAD, PARAMETRO, VALOR, TZ_LOCK)
VALUES ('CREA_CRONOGRAMA_DIFERENTE_TASA_INTERES', 'DESCRIPCION', 'Crea cronograma devengado de diferente tasa de interés', 0);

INSERT INTO PARAMETROS_JTS (FUNCIONALIDAD, PARAMETRO, VALOR, TZ_LOCK)
VALUES ('CREA_CRONOGRAMA_DIFERENTE_TASA_INTERES', 'OPERACION', '28', 0);

INSERT INTO PARAMETROS_JTS (FUNCIONALIDAD, PARAMETRO, VALOR, TZ_LOCK)
VALUES ('CREA_CRONOGRAMA_DIFERENTE_TASA_INTERES', 'PIVOT_DIFERENCIA_TOTAL_INTERES', '1', 0);

INSERT INTO PARAMETROS_JTS (FUNCIONALIDAD, PARAMETRO, VALOR, TZ_LOCK)
VALUES ('CREA_CRONOGRAMA_DIFERENTE_TASA_INTERES', 'PRECISION_DIFERENCIA_TOTAL_INTERES', '1', 0);

INSERT INTO OPERACIONES (TITULO, IDENTIFICACION, NOMBRE, DESCRIPCION, MNEMOTECNICO, AUTORIZACION, FORMULARIOPRINCIPAL, PROXOPERACION, ESTADO, TZ_LOCK, COPIAS, SUBOPERACION, PERMITEBAJA, COMPORTAMIENTOENCIERRE, REQUIERECONTRASENA, PERMITECONCURRENTE, PERMITEESTADODIFERIDO)
VALUES ('8600' , '28', 'Deven Dif Int', 'Deven Dif Int', '28', 'N', NULL, NULL, 'P', 0, NULL, 0, 'S', 'N', 'N', 'S', 'S');

INSERT INTO DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES ('43581' , ' ', 0, 'Tasa de Interes Mercado', 'Tasa de Interes Mercado', 11, 'N', 7, 'I', 0, 0, 0, 0, 0, 0, 0, 21, 'TASA_INT_MERCADO', 0, NULL);




INSERT INTO BITACORA_HM (ACTUALIZACION,FECHA_APLICADO,TIPO_ACTUALIZACION,ESTADO,SCRIPT_SQL,SCRIPT_SQL_UNDO,ULT_SENTENCIA_OK)  VALUES ('20210217_1NBCH',NULL,'MANUAL','NO_DEFINIDO','CgoNCi0tIFBhcmNoZV9OVU5CQ0hBQ09fMjAxCg0KLS0gDQotLSBITSBiZWdpbiBzZW50ZW5jZQpJ
RiBOT1QgRVhJU1RTICgKU0VMRUNUICoKRlJPTSBpbmZvcm1hdGlvbl9zY2hlbWEuY29sdW1ucwpX
SEVSRSB0YWJsZV9uYW1lPSdCU19QTEFOUEFHT19UQVNBTUVSQ0FETycpCkJFR0lOCkNSRUFURSBU
QUJMRSBCU19QTEFOUEFHT19UQVNBTUVSQ0FETwooClRaX0xPQ0sgICAgIE5VTUVSSUMgKDE1KSBE
RUZBVUxUICgoMCkpLApTQUxET1NfSlRTX09JRCBOVU1FUklDICgxMCkgREVGQVVMVCAoKDApKSBO
T1QgTlVMTCwKTlVNRVJPX0RFX0NVT1RBIE5VTUVSSUMgKDMsIDApIERFRkFVTFQgKCgwKSkgTk9U
IE5VTEwsCkZFQ0hBX1ZFTkNJTUlFTlRPIERBVEVUSU1FLCAKQ0FQSVRBTF9QUkVTVEFNTyBOVU1F
UklDICgxNSwgMikgREVGQVVMVCAoKDApKSwgCklOVEVSRVNfUFJFU1RBTU8gTlVNRVJJQyAoMTUs
IDIpIERFRkFVTFQgKCgwKSksIApSRU1BTkVOVEVfUFJFU1RBTU8gTlVNRVJJQyAoMTUsIDIpIERF
RkFVTFQgKCgwKSksIApDQVBJVEFMX1RBU0FfTUVSQ0FETyBOVU1FUklDICgxNSwgMikgREVGQVVM
VCAoKDApKSwgCklOVEVSRVNfVEFTQV9NRVJDQURPIE5VTUVSSUMgKDE1LCAyKSBERUZBVUxUICgo
MCkpLCAKUkVNQU5FTlRFX1RBU0FfTUVSQ0FETyBOVU1FUklDICgxNSwgMikgREVGQVVMVCAoKDAp
KSwgIApDT05UQUJJTElaQURPIFZBUkNIQVIgKDEpIERFRkFVTFQgKCcgJyksCkZFQ0hBX0RFVkVO
R0FETyBEQVRFVElNRSwKQ09OU1RSQUlOVCBQS19CU19QTEFOUEFHT19UQVNBTUVSQ0FETyBQUklN
QVJZIEtFWSAoU0FMRE9TX0pUU19PSUQsIE5VTUVST19ERV9DVU9UQSkKKQpFTkQKLS0gSE0gZW5k
IHNlbnRlbmNlOwoNCi0tIA0KLS0gSE0gYmVnaW4gc2VudGVuY2UKSUYgTk9UIEVYSVNUUyAoClNF
TEVDVCAqCkZST00gaW5mb3JtYXRpb25fc2NoZW1hLmNvbHVtbnMKV0hFUkUgdGFibGVfbmFtZT0n
U0FMRE9TJwpBTkQgY29sdW1uX25hbWU9J1RBU0FfSU5UX01FUkNBRE8nKQpCRUdJTgpBTFRFUiBU
QUJMRSBTQUxET1MgQUREIFRBU0FfSU5UX01FUkNBRE8gTlVNRVJJQyAoMTEsIDcpOwoKRU5ECi0t
IEhNIGVuZCBzZW50ZW5jZTsKDQotLSBJbnNlcnRhIHJlZ2lzdHJvcyBlbiBQQVJBTUVUUk9TX0pU
Uw0KSU5TRVJUIElOVE8gUEFSQU1FVFJPU19KVFMgKEZVTkNJT05BTElEQUQsIFBBUkFNRVRSTywg
VkFMT1IsIFRaX0xPQ0spClZBTFVFUyAoJ0NSRUFfQ1JPTk9HUkFNQV9ESUZFUkVOVEVfVEFTQV9J
TlRFUkVTJywgJ0NBTkFMJywgJzAnLCAwKTsKCklOU0VSVCBJTlRPIFBBUkFNRVRST1NfSlRTIChG
VU5DSU9OQUxJREFELCBQQVJBTUVUUk8sIFZBTE9SLCBUWl9MT0NLKQpWQUxVRVMgKCdDUkVBX0NS
T05PR1JBTUFfRElGRVJFTlRFX1RBU0FfSU5URVJFUycsICdERVNDUklQQ0lPTicsICdDcmVhIGNy
b25vZ3JhbWEgZGV2ZW5nYWRvIGRlIGRpZmVyZW50ZSB0YXNhIGRlIGludGVy6XMnLCAwKTsKCklO
U0VSVCBJTlRPIFBBUkFNRVRST1NfSlRTIChGVU5DSU9OQUxJREFELCBQQVJBTUVUUk8sIFZBTE9S
LCBUWl9MT0NLKQpWQUxVRVMgKCdDUkVBX0NST05PR1JBTUFfRElGRVJFTlRFX1RBU0FfSU5URVJF
UycsICdPUEVSQUNJT04nLCAnMjgnLCAwKTsKCklOU0VSVCBJTlRPIFBBUkFNRVRST1NfSlRTIChG
VU5DSU9OQUxJREFELCBQQVJBTUVUUk8sIFZBTE9SLCBUWl9MT0NLKQpWQUxVRVMgKCdDUkVBX0NS
T05PR1JBTUFfRElGRVJFTlRFX1RBU0FfSU5URVJFUycsICdQSVZPVF9ESUZFUkVOQ0lBX1RPVEFM
X0lOVEVSRVMnLCAnMScsIDApOwoKSU5TRVJUIElOVE8gUEFSQU1FVFJPU19KVFMgKEZVTkNJT05B
TElEQUQsIFBBUkFNRVRSTywgVkFMT1IsIFRaX0xPQ0spClZBTFVFUyAoJ0NSRUFfQ1JPTk9HUkFN
QV9ESUZFUkVOVEVfVEFTQV9JTlRFUkVTJywgJ1BSRUNJU0lPTl9ESUZFUkVOQ0lBX1RPVEFMX0lO
VEVSRVMnLCAnMScsIDApOwoKSU5TRVJUIElOVE8gT1BFUkFDSU9ORVMgKFRJVFVMTywgSURFTlRJ
RklDQUNJT04sIE5PTUJSRSwgREVTQ1JJUENJT04sIE1ORU1PVEVDTklDTywgQVVUT1JJWkFDSU9O
LCBGT1JNVUxBUklPUFJJTkNJUEFMLCBQUk9YT1BFUkFDSU9OLCBFU1RBRE8sIFRaX0xPQ0ssIENP
UElBUywgU1VCT1BFUkFDSU9OLCBQRVJNSVRFQkFKQSwgQ09NUE9SVEFNSUVOVE9FTkNJRVJSRSwg
UkVRVUlFUkVDT05UUkFTRU5BLCBQRVJNSVRFQ09OQ1VSUkVOVEUsIFBFUk1JVEVFU1RBRE9ESUZF
UklETykKVkFMVUVTICgnODYwMCcgLCAnMjgnLCAnRGV2ZW4gRGlmIEludCcsICdEZXZlbiBEaWYg
SW50JywgJzI4JywgJ04nLCBOVUxMLCBOVUxMLCAnUCcsIDAsIE5VTEwsIDAsICdTJywgJ04nLCAn
TicsICdTJywgJ1MnKTsKCklOU0VSVCBJTlRPIERJQ0NJT05BUklPIChOVU1FUk9ERUNBTVBPLCBV
U09ERUxDQU1QTywgUkVGRVJFTkNJQSwgREVTQ1JJUENJT04sIFBST01QVCwgTEFSR08sIFRJUE9E
RUNBTVBPLCBERUNJTUFMRVMsIEVESUNJT04sIENPTlRBQklMSVpBLCBDT05DRVBUTywgQ0FMQ1VM
TywgVkFMSURBQ0lPTiwgVEFCTEFERVZBTElEQUNJT04sIFRBQkxBREVBWVVEQSwgT1BDSU9ORVMs
IFRBQkxBLCBDQU1QTywgQkFTSUNPLCBNQVNDQVJBKQpWQUxVRVMgKCcxJyAsICcgJywgMCwgJ1Rh
c2EgZGUgSW50ZXJlcyBNZXJjYWRvJywgJ1Rhc2EgZGUgSW50ZXJlcyBNZXJjYWRvJywgMTEsICdO
JywgNywgJ0knLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAyMSwgJ1RBU0FfSU5UX01FUkNBRE8nLCAw
LCBOVUxMKTsKDQoKCg0K', NULL, 0);
