EXECUTE('
CREATE OR ALTER   PROCEDURE [dbo].[SP_ITF_SOS_PERFILDOC_CONT]
	@FechaIni VARCHAR(8),
	@FechaFin VARCHAR(8)
AS
  DECLARE @PERIODO VARCHAR(6);
  DECLARE @FECHAPROCESO VARCHAR(8);
  
BEGIN
	
  SELECT @FECHAPROCESO = CONVERT(VARCHAR, FECHAPROCESO, 112) FROM PARAMETROS
  
  SET @PERIODO = SUBSTRING(CONVERT(VARCHAR, @FechaIni, 112),1,6);
  
	--Limpiamos por si hay reproceso
	DELETE FROM SOS_PERFILDOC_CONT WHERE PERIODO = @PERIODO;
	
	INSERT INTO SOS_PERFILDOC_CONT
	SELECT distinct
		--1
		EMPRESA, 
		--
		@PERIODO,
		--
		@FECHAPROCESO AS FECHADEINFORMACION,
		--2
		mov.IDENTTRIBUTARIATIPO,
		--3
		MOV.IDENTTRIBUTARIANUMERO,
		--4
	    mov.MONTOPERFIL,                    
		--5
		mov.FECHAALTAPERFIL,
		--8
		mov.OBSERVACIONES
		--SELECT mov.*
	FROM SOS_PERFILDOC MOV
	WHERE mov.FECHADEINFORMACION BETWEEN @FechaIni AND @FechaFin

END
')