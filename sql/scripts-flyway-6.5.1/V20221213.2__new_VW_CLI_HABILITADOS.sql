EXECUTE ('
CREATE OR ALTER  VIEW [dbo].[VW_CLI_HABILITADOS] (
		      						    	[CODIGOCLIENTE],
											[ESTADO_CLIENTE],
											[CODIGOBLOQUEO],
										    [NUMEROPERSONA],
										    [ESTADO_PERSONA],
											[MOTIVO_INHAB_PERSON]
											)
AS 

SELECT 
	cp.CODIGOCLIENTE, 
	c.ESTADO, 
	c.CODIGOBLOQUEO, 
	cp.NUMEROPERSONA, 
	f.ESTADO, 
	f.MOTIVO_INHABILITADO
FROM CLI_PERSONASFISICAS f  
INNER JOIN CLI_ClientePersona cp ON f.NUMEROPERSONAFISICA=cp.NUMEROPERSONA
INNER JOIN CLI_CLIENTES c ON c.CODIGOCLIENTE=cp.CODIGOCLIENTE
	WHERE
		((c.TZ_LOCK < 300000000000000 OR c.TZ_LOCK >= 400000000000000) AND 
		(c.TZ_LOCK < 100000000000000 OR c.TZ_LOCK >= 200000000000000)) AND 
		((cp.TZ_LOCK < 300000000000000 OR cp.TZ_LOCK >= 400000000000000) AND 
		(cp.TZ_LOCK < 100000000000000 OR cp.TZ_LOCK >= 200000000000000)) AND 
		c.ESTADO=0 AND 
		c.CODIGOBLOQUEO=''''

UNION ALL

SELECT 
	cp.CODIGOCLIENTE, 
	c.ESTADO, 
	c.CODIGOBLOQUEO, 
	cp.NUMEROPERSONA, 
	j.ESTADO, 
	j.MOTIVO_INHABILITADO
FROM CLI_PERSONASJURIDICAS j  
INNER JOIN CLI_ClientePersona cp ON j.NUMEROPERSONAJURIDICA=cp.NUMEROPERSONA
INNER JOIN CLI_CLIENTES c ON c.CODIGOCLIENTE=cp.CODIGOCLIENTE
WHERE
		((c.TZ_LOCK < 300000000000000 OR c.TZ_LOCK >= 400000000000000) AND 
		(c.TZ_LOCK < 100000000000000 OR c.TZ_LOCK >= 200000000000000)) AND 
		((cp.TZ_LOCK < 300000000000000 OR cp.TZ_LOCK >= 400000000000000) AND 
		(cp.TZ_LOCK < 100000000000000 OR cp.TZ_LOCK >= 200000000000000)) AND 
		c.ESTADO=0 AND 
		c.CODIGOBLOQUEO=''''

')