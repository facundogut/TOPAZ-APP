EXECUTE ('
CREATE OR ALTER VIEW [dbo].[VW_CLI_LISTA_BLANCA](	[Tipo de Documento],
													[Documento],
													[Apellidos Nombres/Raz√≥n Social],
													[Fecha Ingreso],
													[Usuario])
AS
SELECT
	TIPO_DOCUMENTO,
	DOCUMENTO,
	(CASE 
		WHEN d.TIPOPERSONA=''F'' 
			THEN (	SELECT (p.APELLIDOPATERNO+ '' ''+ p.APELLIDOMATERNO+ '' ''+ p.PRIMERNOMBRE + '' ''+ p.SEGUNDONOMBRE) 
					FROM CLI_PERSONASFISICAS p WITH(NOLOCK) 
					WHERE p.NUMEROPERSONAFISICA=d.NUMEROPERSONAFJ 
					AND (	(p.TZ_LOCK < 300000000000000 OR p.TZ_LOCK >= 400000000000000) 
						AND (p.TZ_LOCK < 100000000000000 OR p.TZ_LOCK >= 200000000000000)) )
		WHEN d.TIPOPERSONA=''J'' 
			THEN (	SELECT j.RAZONSOCIAL 
					FROM CLI_PERSONASJURIDICAS j WITH(NOLOCK) 
					WHERE j.NUMEROPERSONAJURIDICA=d.NUMEROPERSONAFJ 
					AND (	(j.TZ_LOCK < 300000000000000 OR j.TZ_LOCK >= 400000000000000) 
						AND (j.TZ_LOCK < 100000000000000 OR j.TZ_LOCK >= 200000000000000)) )   
		WHEN (i.CUIT<>0) 
			THEN (i.APELLIDOS+'' ''+ i.NOMBRES)
		ELSE '' ''
	END) AS ''NOMBRE/RAZON_SOCIAL'',
	FECHA_INGRESO,
	USUARIO
FROM CLI_LISTA_BLANCA l WITH(NOLOCK) 
LEFT JOIN CLI_DocumentosPFPJ d WITH(NOLOCK) ON l.TIPO_DOCUMENTO=d.TIPODOCUMENTO 
											AND l.DOCUMENTO=d.NUMERODOCUMENTO 
											AND (	(d.TZ_LOCK < 300000000000000 OR d.TZ_LOCK >= 400000000000000) 
												AND (d.TZ_LOCK < 100000000000000 OR d.TZ_LOCK >= 200000000000000))
LEFT JOIN ITF_BCRA_PADFYJ i WITH(NOLOCK)  ON i.CUIT=l.DOCUMENTO
											AND (	(i.TZ_LOCK < 300000000000000 OR i.TZ_LOCK >= 400000000000000) 
												AND (i.TZ_LOCK < 100000000000000 OR i.TZ_LOCK >= 200000000000000))

WHERE ((l.TZ_LOCK < 300000000000000 OR l.TZ_LOCK >= 400000000000000) 
	  AND (l.TZ_LOCK < 100000000000000 OR l.TZ_LOCK >= 200000000000000))

')






