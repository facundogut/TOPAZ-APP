EXECUTE('
---------
IF OBJECT_ID (''dbo.VW_CORRIMIENTO_VTO_DPF'') IS NOT NULL
	DROP VIEW dbo.VW_CORRIMIENTO_VTO_DPF
----
')
EXECUTE('
----
CREATE VIEW [dbo].[VW_CORRIMIENTO_VTO_DPF](
	SUCURSAL,
	CUENTA,
	NOMBRE,
	PRODUCTO,
	DESCRIPCIONPRODUCTO,
	MONEDA,
	DESCRIPCIONMONEDA,
	CLIENTE
) 
AS 
SELECT	
	S.SUCURSAL,
	S.CUENTA,
	CL.NOMBRECLIENTE,
	S.PRODUCTO,
	P.C6251,
	S.MONEDA,
	M.C6400,
	S.C1803
FROM SALDOS AS S WITH (nolock)
INNER JOIN CLI_CLIENTES AS CL WITH (nolock) ON
	CL.CODIGOCLIENTE = S.C1803
	AND CL.TZ_LOCK = 0
INNER JOIN PRODUCTOS AS P WITH (nolock) ON
	P.C6250 = S.PRODUCTO
	AND P.TZ_LOCK = 0
INNER JOIN MONEDAS AS M WITH (nolock) ON
	M.C6399 = S.MONEDA
	AND M.TZ_LOCK = 0
INNER JOIN PAROS AS PA WITH (nolock) ON
	PA.FECHA = S.C1627
WHERE 
	S.C1627>=(SELECT FECHAPROCESO
				FROM PARAMETROS with (nolock))
	AND S.C1785 = 4
	AND S.C1604 > 0
	AND S.C1659 = ''N''
	AND ((PA.SUCURSAL = -1)
		OR (S.SUCURSAL=PA.SUCURSAL AND PA.SUCURSAL <> -1))
	AND S.TZ_LOCK = 0
----
')