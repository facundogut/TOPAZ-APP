EXECUTE('
----------------------------
--VW_CODIGOS_RECHAZO_NACHA--
----------------------------
CREATE VIEW VW_CODIGOS_RECHAZO_NACHA
	(CODIGO,
	DESCRIPCION)
AS
SELECT DISTINCT R.CODIGO_RECHAZO,
	CASE
	WHEN C.DESCRIPCION IS NOT NULL
		THEN C.DESCRIPCION
	ELSE
		''CODIGO SIN TIPO DE CAUSAL''
	END
FROM CLE_RECEPCION_CHEQUES_DEV AS R WITH (nolock)
LEFT JOIN CLE_TIPO_CAUSAL AS C WITH (nolock) ON
	C.CODIGO_NACHA = R.CODIGO_RECHAZO
	AND C.CODIGO_DE_CAUSAL IN (SELECT TOP 1 CODIGO_DE_CAUSAL FROM CLE_TIPO_CAUSAL WITH (nolock)
		WHERE CODIGO_NACHA = C.CODIGO_NACHA AND TZ_LOCK = 0
		ORDER BY CODIGO_DE_CAUSAL)
	AND C.TZ_LOCK = 0
------
')