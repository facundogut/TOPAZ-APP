EXECUTE ('
CREATE OR ALTER VIEW [dbo].[VW_INTEGRANTES_PJ_PIF_ESTADOS] (
											[Numero_PJ],
											[Numero_PHPJ],
											[Estado_PHPJ],
											[Motivo_Inhabilitado],
											[Motivo_Inhab_Integ]
											)
AS 
SELECT 
    	T.NUMEROPERSONAJURIDICA AS NUMEROPERSONA, 
    	IJ.NUMEROPERSONAFISICA AS NUMEROPINTEGRANTE, 
        CASE 
        WHEN (IJ.TIPO_PERSONA = ''J'') THEN 
        (SELECT CASE WHEN jj.ESTADO=0 THEN ''HABILITADO'' ELSE ''INHABILITADO'' END AS ESTADO
            FROM dbo.CLI_PERSONASJURIDICAS  AS JJ WITH (NOLOCK)
            WHERE JJ.NUMEROPERSONAJURIDICA = IJ.NUMEROPERSONAFISICA)
        ELSE 
        CASE WHEN (ij.tipo_persona=''f'') then 
        (SELECT CASE WHEN PF.ESTADO=0 THEN ''HABILITADO'' ELSE ''INHABILITADO'' END AS ESTADO
            FROM dbo.CLI_PERSONASFISICAS  AS PF WITH (NOLOCK)
            WHERE PF.NUMEROPERSONAFISICA = IJ.NUMEROPERSONAFISICA)
        END END AS ESTADO_INTEGRANTE,
        T.MOTIVO_INHABILITADO,
        CASE WHEN (IJ.TIPO_PERSONA = ''J'') THEN 
        (SELECT JJ.MOTIVO_INHABILITADO AS MOTIVO_INHAB_INTEG
            FROM dbo.CLI_PERSONASJURIDICAS  AS JJ WITH (NOLOCK)
            WHERE JJ.NUMEROPERSONAJURIDICA = IJ.NUMEROPERSONAFISICA)
        ELSE 
        CASE WHEN (ij.tipo_persona=''f'') then 
        (SELECT PF.MOTIVO_INHABILITADO AS MOTIVO_INHAB_INTEG
            FROM dbo.CLI_PERSONASFISICAS  AS PF WITH (NOLOCK)
            WHERE PF.NUMEROPERSONAFISICA = IJ.NUMEROPERSONAFISICA)
        END END AS MOTIVO_INHAB_INTEG   
   
FROM dbo.CLI_PERSONASJURIDICAS  AS T WITH (NOLOCK)
INNER JOIN dbo.CLI_INTEGRANTESPJ  AS IJ WITH (NOLOCK)
      												ON T.NUMEROPERSONAJURIDICA = IJ.NUMEROPERSONAJURIDICA
													AND IJ.TZ_LOCK = 0
INNER JOIN dbo.CLI_DOCUMENTOSPFPJ  AS V WITH (NOLOCK)
      								ON T.NUMEROPERSONAJURIDICA = V.NUMEROPERSONAFJ
									AND V.TIPOPERSONA = ''J''
									AND V.TZ_LOCK = 0
INNER JOIN dbo.VW_PFPJ_DOCUMENTOS AS ID WITH (NOLOCK)
									ON IJ.NUMEROPERSONAFISICA = ID.NUMEROPERSONA
LEFT JOIN dbo.CLI_CARGOS_PERSONAS  AS CP WITH (NOLOCK)
      								ON IJ.CODIGOCARGO = CP.CODIGO
LEFT JOIN DJ_ACTORES A WITH (NOLOCK)
      								ON A.Id = IJ.CODIGOCARGO_DJ
WHERE
	(	(t.TZ_LOCK < 300000000000000 OR t.TZ_LOCK >= 400000000000000) 
	AND (t.TZ_LOCK < 100000000000000 OR t.TZ_LOCK >= 200000000000000));

')

EXECUTE('

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (37322, '' '', 0, ''Motivo Inhab Integrante'', ''Motivo Inhab Integrante'', 2, ''N'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3371, ''Motivo_Inhab_Integ'', 0, NULL)

')


