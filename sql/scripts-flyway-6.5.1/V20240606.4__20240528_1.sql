


-- Parche_NUTOPAZ56_123

SELECT 
					s.JTS_OID,
				  	s.C1692 AS RUBRO_ORIGINAL, 
				  	s.C1730 AS RUBRO_CONTABLE, 
				  	s.C1728, 
				  	sd.RUBROCONTABLE AS RUBRO_SALDO_DIARIO
				INTO MODIFICACION_C1692_RSP
				FROM saldos s
				INNER JOIN grl_saldos_diarios sd ON s.JTS_OID = sd.SALDOS_JTS_OID AND s.C1620 = sd.FECHA
				WHERE (s.c1692 = 0 OR s.c1692 IS NULL) AND
				s.TZ_LOCK = 0 AND
				EXISTS (SELECT sd.rubrocontable
					FROM grl_saldos_diarios sd
					WHERE s.JTS_OID = sd.SALDOS_JTS_OID AND s.C1620 = sd.FECHA);

UPDATE s
				SET c1692 = sd.rubrocontable
				FROM saldos s
				INNER JOIN grl_saldos_diarios sd
				ON s.JTS_OID = sd.SALDOS_JTS_OID AND s.C1620 = sd.FECHA
				WHERE (s.c1692 = 0 OR s.c1692 IS NULL)
				AND s.TZ_LOCK = 0
				AND EXISTS (SELECT sd.rubrocontable
									   FROM grl_saldos_diarios sd
									WHERE s.JTS_OID = sd.SALDOS_JTS_OID AND s.C1620 = sd.FECHA);




INSERT INTO BITACORA_HM (ACTUALIZACION,FECHA_APLICADO,TIPO_ACTUALIZACION,ESTADO,SCRIPT_SQL,SCRIPT_SQL_UNDO,ULT_SENTENCIA_OK)  VALUES ('20240528_1',NULL,'MANUAL','NO_DEFINIDO','CgoNCi0tIFBhcmNoZV9OVVRPUEFaNTZfMTIzCg0KU0VMRUNUIAoJCQkJCXMuSlRTX09JRCwKCQkJ
CSAgCXMuQzE2OTIgQVMgUlVCUk9fT1JJR0lOQUwsIAoJCQkJICAJcy5DMTczMCBBUyBSVUJST19D
T05UQUJMRSwgCgkJCQkgIAlzLkMxNzI4LCAKCQkJCSAgCXNkLlJVQlJPQ09OVEFCTEUgQVMgUlVC
Uk9fU0FMRE9fRElBUklPCgkJCQlJTlRPIE1PRElGSUNBQ0lPTl9DMTY5Ml9SU1AKCQkJCUZST00g
c2FsZG9zIHMKCQkJCUlOTkVSIEpPSU4gZ3JsX3NhbGRvc19kaWFyaW9zIHNkIE9OIHMuSlRTX09J
RCA9IHNkLlNBTERPU19KVFNfT0lEIEFORCBzLkMxNjIwID0gc2QuRkVDSEEKCQkJCVdIRVJFIChz
LmMxNjkyID0gMCBPUiBzLmMxNjkyIElTIE5VTEwpIEFORAoJCQkJcy5UWl9MT0NLID0gMCBBTkQK
CQkJCUVYSVNUUyAoU0VMRUNUIHNkLnJ1YnJvY29udGFibGUKCQkJCQlGUk9NIGdybF9zYWxkb3Nf
ZGlhcmlvcyBzZAoJCQkJCVdIRVJFIHMuSlRTX09JRCA9IHNkLlNBTERPU19KVFNfT0lEIEFORCBz
LkMxNjIwID0gc2QuRkVDSEEpOwoNClVQREFURSBzCgkJCQlTRVQgYzE2OTIgPSBzZC5ydWJyb2Nv
bnRhYmxlCgkJCQlGUk9NIHNhbGRvcyBzCgkJCQlJTk5FUiBKT0lOIGdybF9zYWxkb3NfZGlhcmlv
cyBzZAoJCQkJT04gcy5KVFNfT0lEID0gc2QuU0FMRE9TX0pUU19PSUQgQU5EIHMuQzE2MjAgPSBz
ZC5GRUNIQQoJCQkJV0hFUkUgKHMuYzE2OTIgPSAwIE9SIHMuYzE2OTIgSVMgTlVMTCkKCQkJCUFO
RCBzLlRaX0xPQ0sgPSAwCgkJCQlBTkQgRVhJU1RTIChTRUxFQ1Qgc2QucnVicm9jb250YWJsZQoJ
CQkJCQkJCQkgICBGUk9NIGdybF9zYWxkb3NfZGlhcmlvcyBzZAoJCQkJCQkJCQlXSEVSRSBzLkpU
U19PSUQgPSBzZC5TQUxET1NfSlRTX09JRCBBTkQgcy5DMTYyMCA9IHNkLkZFQ0hBKTsKDQoKCg0K', NULL, 0);
