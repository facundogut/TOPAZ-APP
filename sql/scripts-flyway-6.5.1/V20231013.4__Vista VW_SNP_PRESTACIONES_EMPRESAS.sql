EXECUTE('
--
IF OBJECT_ID (''dbo.VW_SNP_PRESTACIONES_EMPRESAS'') IS NOT NULL
	DROP VIEW dbo.VW_SNP_PRESTACIONES_EMPRESAS
--
')
EXECUTE('
--
CREATE VIEW VW_SNP_PRESTACIONES_EMPRESAS
AS
SELECT
	PE.PRESTACION,
	PE.NOMBRE_EMPRESA,
	PE.CUIT_EO,
	PE.ENTIDAD AS ENTIDAD_ORIGINANTE,
	PE.NomEntidad AS NOMBRE_ENTIDAD,
	OE.DESCRIPCION AS ESTADO,
	PE.FECHA_ALTA,
	PE.ID_CONVENIO
FROM
	SNP_PRESTACIONES_EMPRESAS AS PE WITH (nolock)
LEFT JOIN OPCIONES AS OE WITH (nolock) ON
	OE.NUMERODECAMPO = 44515
	AND OE.IDIOMA = ''E''
	AND OE.OPCIONINTERNA = PE.ESTADO
WHERE
	((PE.TZ_LOCK < 100000000000000 OR PE.TZ_LOCK >= 200000000000000)
		AND (PE.TZ_LOCK < 300000000000000 OR PE.TZ_LOCK >= 400000000000000)  
	)
--
')
