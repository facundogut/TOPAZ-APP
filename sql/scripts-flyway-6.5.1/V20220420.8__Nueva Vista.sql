EXECUTE('
IF OBJECT_ID (''VW_FISICAS_JURIDICAS_SIT_JURIDICA'') IS NOT NULL
	DROP VIEW VW_FISICAS_JURIDICAS_SIT_JURIDICA
')


EXECUTE('
CREATE  VIEW VW_FISICAS_JURIDICAS_SIT_JURIDICA (
															   TIPODOC, 
															   NUMERODOC, 
															   NUMEROPERSONA, 
															   NOMBRE,
															   SITUACION_JURIDICA,
															   TIPOPERSONA)
AS 
SELECT 
    V.TIPODOCUMENTO AS TIPODOC, 
    V.NUMERODOCUMENTO AS NUMERODOC, 
    V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
    (U.PRIMERNOMBRE + '' '' +U.SEGUNDONOMBRE+'' '' +U.APELLIDOPATERNO+'' ''+U.APELLIDOMATERNO) AS NOMBRE,
    U.SITUACION_JURIDICA,
	V.TIPOPERSONA
    
FROM dbo.CLI_PERSONASFISICAS  AS U WITH (NOLOCK)
INNER JOIN dbo.CLI_DOCUMENTOSPFPJ  AS V WITH (NOLOCK)ON U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ  
														AND V.TIPOPERSONA = ''F''
														AND U.TZ_LOCK=0
														AND V.TZ_LOCK=0
UNION ALL
SELECT 
    V.TIPODOCUMENTO AS TIPODOC, 
    V.NUMERODOCUMENTO AS NUMERODOC, 
    V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
    T.RAZONSOCIAL AS NOMBRE,
    T.SITUACION_JURIDICA,
	V.TIPOPERSONA
FROM dbo.CLI_PERSONASJURIDICAS  AS T WITH (NOLOCK)
INNER JOIN dbo.CLI_DOCUMENTOSPFPJ  AS V WITH (NOLOCK) ON 
								T.NUMEROPERSONAJURIDICA = V.NUMEROPERSONAFJ 
								AND (V.TIPOPERSONA = ''J'' OR V.TIPOPERSONA = ''I'')
								AND T.TZ_LOCK = 0 
								AND V.TZ_LOCK = 0

')


