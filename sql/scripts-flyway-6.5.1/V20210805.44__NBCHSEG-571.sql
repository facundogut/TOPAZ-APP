EXECUTE('

ALTER VIEW dbo.VW_PF_DOCUMENTOS 
AS 
   /*Generated by SQL Server Migration Assistant for Oracle version 7.9.0.*/
   SELECT TOP 9223372036854775807 WITH TIES 
      V.TIPODOCUMENTO AS ''Tipo Documento Identificativo'', 
      V.NUMERODOCUMENTO AS ''Número Documento Identificativo'',
      V.TIPO_DOC_FISICO AS ''Tipo Documento Físico'',
      V.NUM_DOC_FISICO AS ''Número Documento Físico'',
      concat(U.APELLIDOPATERNO,'' '', U.PRIMERNOMBRE) AS ''Apellido y Nombre'',
      CASE V.TIPOPERSONA 
      	WHEN ''F'' THEN ''Persona Humana'' END AS ''Tipo de Persona'',
      CASE U.NIVEL_APERTURA
         WHEN 0 THEN ''REGISTRO''
         WHEN 1 THEN ''BÁSICO''
         WHEN 2 THEN ''PASIVOS''
         WHEN 3 THEN ''ACTIVOS''
      END AS ''Nivel de Apertura'',
      CASE U.ESTADO 
      WHEN 0 THEN ''HABILITADO''
      WHEN 1 THEN ''INHABILITADO''
      END AS ''Estado de la Persona'',
      CASE U.MOTIVO_INHABILITADO
      WHEN 1 THEN ''INHABILITADO POR EL BCRA''
      WHEN 2 THEN ''INHABILITADO POR FALLECIMIENTO''
      WHEN 3 THEN ''INHABILITADO UIF''
      WHEN 4 THEN ''INHABILITADO TERRORISMO''
      WHEN 5 THEN ''INHABILITACION ADMINISTRATIVA''
      END AS ''Motivo Inhabilitado'',
      V.NUMEROPERSONAFJ AS ''Número de la Persona'',  
      U.EMPLEADO_BC_BANCO
   FROM dbo.CLI_PERSONASFISICAS  AS U, dbo.CLI_DOCUMENTOSPFPJ  AS V
   WHERE 
      U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ AND 
      (V.TIPOPERSONA = ''F'' OR V.TIPOPERSONA = ''U'') AND 
      ((U.TZ_LOCK < 300000000000000 OR U.TZ_LOCK >= 400000000000000) AND (U.TZ_LOCK < 100000000000000 OR U.TZ_LOCK >= 200000000000000)) AND 
      ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000))
   ORDER BY ''Número de la Persona''

')

EXECUTE('
ALTER VIEW dbo.VW_INTEGRANTES_PJ_PIF (
   [Tipo Documento Identificativo],
   [Número Documento Identificativo],
   [Razón Social],
   [Nivel Apertura],
   [Estado],
   [Tipo Documento Identificativo PH/PJ],
   [Número Documento Identificativo PH/PJ],
   [Nombre],
   [Nivel Apertura PH/PJ],
   [Estado PH/PJ],
   [Cargo],
   [Tipo persona],
   [Numero PJ],
   [Numero PH/PJ])
AS
   SELECT 
      V.TIPODOCUMENTO AS TIPODOC, 
      V.NUMERODOCUMENTO AS NUMERODOC, 
      T.RAZONSOCIAL, 
      CASE WHEN T.NIVEL_APERTURA=1 THEN ''BASICO'' ELSE 
      CASE WHEN T.NIVEL_APERTURA=3 THEN ''ACTIVO'' ELSE 
      CASE WHEN T.NIVEL_APERTURA=4 THEN ''INSTITUCION FINANCIERA'' END END END AS NIVEL_APERTURA,
      CASE WHEN T.ESTADO=0 THEN ''HABILITADO'' ELSE ''INHABILITADO'' END AS ESTADO,
      ID.TIPODOC AS TIPODOCINTEGRANTE, 
      ID.NUMERODOC AS NRODOCINTEGRANTE,
      CASE 
         WHEN (IJ.TIPO_PERSONA = ''J'') THEN 
            (
               SELECT JJ.RAZONSOCIAL
               FROM dbo.CLI_PERSONASJURIDICAS  AS JJ
               WHERE JJ.NUMEROPERSONAJURIDICA = IJ.NUMEROPERSONAFISICA
            )
         ELSE 
            (
               SELECT ISNULL(PF.APELLIDOPATERNO, '''') + '' '' + ISNULL(PF.PRIMERNOMBRE, '''') AS expr
               FROM dbo.CLI_PERSONASFISICAS  AS PF
               WHERE PF.NUMEROPERSONAFISICA = IJ.NUMEROPERSONAFISICA
            )
      END AS NOMBRE,   
       CASE 
         WHEN (IJ.TIPO_PERSONA = ''J'') THEN 
          (SELECT CASE WHEN JJ.NIVEL_APERTURA=1 THEN ''BASICO'' ELSE 
      		CASE WHEN JJ.NIVEL_APERTURA=3 THEN ''ACTIVO'' ELSE 
      		CASE WHEN JJ.NIVEL_APERTURA=4 THEN ''INSTITUCION FINANCIERA'' END END END AS NIVEL_APERTURA
               FROM dbo.CLI_PERSONASJURIDICAS  AS JJ
               WHERE JJ.NUMEROPERSONAJURIDICA = IJ.NUMEROPERSONAFISICA)
         ELSE 
         CASE WHEN (ij.tipo_persona=''f'') then 
         (SELECT CASE WHEN PF.NIVEL_APERTURA=1 THEN ''BASICO'' ELSE 
      		CASE WHEN PF.NIVEL_APERTURA=3 THEN ''ACTIVO'' ELSE 
      		CASE WHEN PF.NIVEL_APERTURA=4 THEN ''INSTITUCION FINANCIERA'' END END END AS NIVEL_APERTURA
               FROM dbo.CLI_PERSONASFISICAS  AS PF
               WHERE PF.NUMEROPERSONAFISICA = IJ.NUMEROPERSONAFISICA)
         END END AS NIVEL_APERTURA_INTEGRANTE,  
         CASE 
         WHEN (IJ.TIPO_PERSONA = ''J'') THEN 
          (SELECT CASE WHEN jj.ESTADO=0 THEN ''HABILITADO'' ELSE ''INHABILITADO'' END AS ESTADO
               FROM dbo.CLI_PERSONASJURIDICAS  AS JJ
               WHERE JJ.NUMEROPERSONAJURIDICA = IJ.NUMEROPERSONAFISICA)
         ELSE 
         CASE WHEN (ij.tipo_persona=''f'') then 
         (SELECT CASE WHEN PF.ESTADO=0 THEN ''HABILITADO'' ELSE ''INHABILITADO'' END AS ESTADO
               FROM dbo.CLI_PERSONASFISICAS  AS PF
               WHERE PF.NUMEROPERSONAFISICA = IJ.NUMEROPERSONAFISICA)
         END END AS ESTADO_INTEGRANTE,    
      CASE 
      	WHEN CP.CARGO IS NOT NULL THEN CP.CARGO
      	ELSE A.Descripcion
      END AS CARGO, 
      IJ.TIPO_PERSONA AS TIPOPERSONA, 
      T.NUMEROPERSONAJURIDICA AS NUMEROPERSONA, 
      IJ.NUMEROPERSONAFISICA AS NUMEROPINTEGRANTE    FROM 
      dbo.CLI_PERSONASJURIDICAS  AS T JOIN dbo.CLI_INTEGRANTESPJ  AS IJ
      	ON T.NUMEROPERSONAJURIDICA = IJ.NUMEROPERSONAJURIDICA
      JOIN dbo.CLI_DOCUMENTOSPFPJ  AS V
      	ON T.NUMEROPERSONAJURIDICA = V.NUMEROPERSONAFJ
      JOIN dbo.VW_PFPJ_DOCUMENTOS AS ID 
        ON IJ.NUMEROPERSONAFISICA = ID.NUMEROPERSONA
      LEFT JOIN dbo.CLI_CARGOS_PERSONAS  AS CP
      	ON IJ.CODIGOCARGO = CP.CODIGO AND (CP.TZ_LOCK = 0)
      LEFT JOIN DJ_ACTORES A
      	ON A.Id = IJ.CODIGOCARGO_DJ
   WHERE
      V.TIPOPERSONA = ''J'' AND  
     -- (T.TZ_LOCK = 0) AND 
      ((t.TZ_LOCK < 300000000000000 OR t.TZ_LOCK >= 400000000000000) AND (t.TZ_LOCK < 100000000000000 OR t.TZ_LOCK >= 200000000000000)) AND
      (V.TZ_LOCK = 0) AND 
      (IJ.TZ_LOCK = 0)


')