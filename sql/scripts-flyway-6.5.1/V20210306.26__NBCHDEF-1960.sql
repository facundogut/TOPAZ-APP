EXECUTE('
ALTER VIEW VW_ACT_ECO AS

SELECT
COD_ACTIVIDAD,
DESCRIPCION,
PERIODO_ACTIVIDAD,
TIPO_ACTIVIDAD,
VERIFICADO_AFIP,
FECHA_VERIFICADO,
CODIGO_PERSONA,
TIPO_DOCUMENTO,
NUMERO_DOCUMENTO,
ORDINAL,
ORDEN_AFIP
FROM
(     
SELECT
c.CODIGO_ACTIVIDAD AS COD_ACTIVIDAD,
a.DESCRIPCION,
c.INICIO_ACTIVIDAD AS PERIODO_ACTIVIDAD,
(CASE 
WHEN c.ORDEN_AFIP=1 THEN ''Primaria''
WHEN ((SELECT COUNT(*) FROM CLI_ACTIVIDAD_ECONOMICA a WHERE a.CODIGO_PERSONA_CLIENTE= d.NUMEROPERSONAFJ AND a.ORDEN_AFIP = 99 AND ((a.TZ_LOCK < 300000000000000 OR a.TZ_LOCK >= 400000000000000) AND (a.TZ_LOCK < 100000000000000 OR a.TZ_LOCK >= 200000000000000))) = (SELECT COUNT(*) FROM CLI_ACTIVIDAD_ECONOMICA a WHERE a.CODIGO_PERSONA_CLIENTE= d.NUMEROPERSONAFJ AND ((a.TZ_LOCK < 300000000000000 OR a.TZ_LOCK >= 400000000000000) AND (a.TZ_LOCK < 100000000000000 OR a.TZ_LOCK >= 200000000000000))) AND (SELECT MIN(a.ORDINAL_ACTIVIDAD) FROM CLI_ACTIVIDAD_ECONOMICA a WHERE a.CODIGO_PERSONA_CLIENTE = d.NUMEROPERSONAFJ AND ((a.TZ_LOCK < 300000000000000 OR a.TZ_LOCK >= 400000000000000) AND (a.TZ_LOCK < 100000000000000 OR a.TZ_LOCK >= 200000000000000))) =  c.ORDINAL_ACTIVIDAD ) THEN ''Primaria''
ELSE ''Secundaria''
END) AS TIPO_ACTIVIDAD,
c.VERIFICADO_AFIP AS VERIFICADO_AFIP,
c.FECHA_VERIFICADO,
c.CODIGO_PERSONA_CLIENTE AS CODIGO_PERSONA,
d.TIPODOCUMENTO AS TIPO_DOCUMENTO,
d.NUMERODOCUMENTO AS NUMERO_DOCUMENTO,
c.ORDINAL_ACTIVIDAD AS ORDINAL,
c.ORDEN_AFIP
FROM CLI_ACTIVIDAD_ECONOMICA c INNER JOIN 
CLI_Cod_Act_AFIP a ON c.CODIGO_ACTIVIDAD=a.CODIGO_ACT_AFIP AND 
((c.TZ_LOCK < 300000000000000 OR c.TZ_LOCK >= 400000000000000) AND (c.TZ_LOCK < 100000000000000 OR c.TZ_LOCK >= 200000000000000))
LEFT JOIN CLI_DocumentosPFPJ d ON d.NUMEROPERSONAFJ=c.CODIGO_PERSONA_CLIENTE AND 
((d.TZ_LOCK < 300000000000000 OR d.TZ_LOCK >= 400000000000000) AND (d.TZ_LOCK < 100000000000000 OR d.TZ_LOCK >= 200000000000000))

) X ORDER BY  ORDEN_AFIP, ORDINAL OFFSET 0 ROWS


')

