EXECUTE('
IF OBJECT_ID (''dbo.VW_CLE_PREVALENCIA_CAUSAL_CHEQUES'') IS NOT NULL
	DROP VIEW dbo.VW_CLE_PREVALENCIA_CAUSAL_CHEQUES
')
EXECUTE('
CREATE VIEW VW_CLE_PREVALENCIA_CAUSAL_CHEQUES
AS
SELECT
	P.ORDEN,
	P.CODIGO_NACHA,
	P.CODIGO_CAUSAL AS CAUSAL,
	T.DESCRIPCION AS DESCRIPCION_CAUSAL
FROM CLE_PREVALENCIA_CAUSAL AS P WITH (nolock)
INNER JOIN CLE_TIPO_CAUSAL AS T WITH (nolock) ON
	T.CODIGO_DE_CAUSAL = P.CODIGO_CAUSAL
	AND ((T.TZ_LOCK < 100000000000000 OR T.TZ_LOCK >= 200000000000000)
		AND (T.TZ_LOCK < 300000000000000 OR T.TZ_LOCK >= 400000000000000)  
	)
WHERE
	P.FUNCIONALIDAD = ''CH''
	AND ((P.TZ_LOCK < 100000000000000 OR P.TZ_LOCK >= 200000000000000)
		AND (P.TZ_LOCK < 300000000000000 OR P.TZ_LOCK >= 400000000000000)  
	)
')

