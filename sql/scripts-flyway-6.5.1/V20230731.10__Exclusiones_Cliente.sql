EXECUTE('
IF OBJECT_ID (''dbo.CRE_EXCLUSIONES_CLIENTE'') IS NOT NULL
	DROP TABLE dbo.CRE_EXCLUSIONES_CLIENTES
')

EXECUTE('
CREATE TABLE dbo.CRE_EXCLUSIONES_CLIENTES
	(
	TZ_LOCK                    NUMERIC (15),
	CODIGOCLIENTE              NUMERIC (12) NOT NULL,
	GRADUACION                 VARCHAR (1),
	FRACCIONAMIENTO		       VARCHAR (1),
	CONSTRAINT PK_CRE_EXCLUSIONES_CLIENTES PRIMARY KEY (CODIGOCLIENTE)
	)
')

EXECUTE('
IF OBJECT_ID (''dbo.VW_EXCLUSIONES_CLIENTES'') IS NOT NULL
	DROP VIEW dbo.VW_EXCLUSIONES_CLIENTES
')

EXECUTE('
CREATE   VIEW [dbo].[VW_EXCLUSIONES_CLIENTES]
							([Código de Cliente],
							Nombre,
							[Graduación],
							[Fraccionamiento]
							)
AS
SELECT C.CODIGOCLIENTE,
D.NOMBRECLIENTE,
OP.DESCRIPCION AS GRADUACION,
OP2.DESCRIPCION AS FRACCIONAMIENTO
FROM CRE_EXCLUSIONES_CLIENTES C WITH(NOLOCK)
INNER JOIN VW_CLI_X_DOC D WITH(NOLOCK) ON C.CODIGOCLIENTE = D.CODIGOCLIENTE
LEFT JOIN OPCIONES OP WITH(NOLOCK) ON OP.IDIOMA = ''E'' AND OP.NUMERODECAMPO = 44024
AND OP.OPCIONINTERNA = C.GRADUACION
LEFT JOIN OPCIONES OP2 WITH(NOLOCK) ON OP2.IDIOMA = ''E'' AND OP2.NUMERODECAMPO = 44025
AND OP2.OPCIONINTERNA = C.FRACCIONAMIENTO
WHERE C.TZ_LOCK = 0
')

EXECUTE('
INSERT INTO dbo.AYUDAS (NUMERODEARCHIVO, NUMERODEAYUDA, DESCRIPCION, FILTRO, MOSTRARTODOS, CAMPOS, CAMPOSVISTA, BASEVISTA, NOMBREVISTA, AYUDAGRANDE)
VALUES (0, 4367, ''Exclusiones Clientes'', '''', 0, ''618R;410;537;3842;'', ''Código de Cliente;Nombre;Graduación;Fraccionamiento;'', ''TOP/CLIENTES'', ''VW_EXCLUSIONES_CLIENTES'', 0)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (44026, '' '', 0, ''Exclusiones Clientes'', ''Exclusiones Clientes'', 12, ''N'', 0, NULL, 0, 0, 0, 0, 0, 4367, 0, 0, ''EXCLUSIONES_CLIENTES'', 0, NULL)

INSERT INTO dbo.DESCRIPTORES (TITULO, IDENTIFICACION, TIPODEARCHIVO, DESCRIPCION, GRUPODELMAPA, NOMBREFISICO, TIPODEDBMS, LARGODELREGISTRO, INICIALIZACIONDELREGISTRO, BASE, SELECCION, ACEPTA_MOVS_DIFERIDO)
VALUES (550, 4367, NULL, ''Exclusiones cli. grad y fracc'', 0, ''CRE_EXCLUSIONES_CLIENTES'', ''D'', NULL, NULL, ''Top/Clientes'', NULL, ''N'')

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (44023, '' '', 0, ''Cliente'', ''Cliente'', 12, ''N'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 4367, ''CODIGOCLIENTE'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (44024, '' '', 0, ''Graduación'', ''Aplica a Graduación?'', 1, ''A'', 0, NULL, 0, 0, 0, 0, 0, 0, 1, 4367, ''GRADUACION'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (44025, '' '', 0, ''Fraccionamiento'', ''Aplica a Fraccionamiento?'', 1, ''A'', 0, NULL, 0, 0, 0, 0, 0, 0, 1, 4367, ''FRACCIONAMIENTO'', 0, NULL)

INSERT INTO dbo.INDICES (NUMERODEARCHIVO, NUMERODEINDICE, DESCRIPCION, CLAVESREPETIDAS, CAMPO1, CAMPO2, CAMPO3, CAMPO4, CAMPO5, CAMPO6, CAMPO7, CAMPO8, CAMPO9, CAMPO10, CAMPO11, CAMPO12, CAMPO13, CAMPO14, CAMPO15, CAMPO16, CAMPO17, CAMPO18, CAMPO19, CAMPO20)
VALUES (4367, 1, ''iNDICE'', 0, 44023, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)

INSERT INTO dbo.OPERACIONES (TITULO, IDENTIFICACION, NOMBRE, DESCRIPCION, MNEMOTECNICO, AUTORIZACION, FORMULARIOPRINCIPAL, PROXOPERACION, ESTADO, TZ_LOCK, COPIAS, SUBOPERACION, PERMITEBAJA, COMPORTAMIENTOENCIERRE, REQUIERECONTRASENA, PERMITECONCURRENTE, PERMITEESTADODIFERIDO, ICONO_TITULO, ESTILO)
VALUES (6000, 5917, ''ABMC Exclusiones Clientes'', ''ABMC Exclusiones Clientes'', ''5917'', ''N'', NULL, NULL, ''P'', 0, NULL, 0, ''S'', ''N'', ''N'', ''N'', ''N'', NULL, 0)
')

