EXECUTE('
IF OBJECT_ID (''dbo.VW_CRE_SOL_ASISTENCIAS_REF'') IS NOT NULL
	DROP VIEW dbo.VW_CRE_SOL_ASISTENCIAS_REF
')

EXECUTE('
CREATE VIEW dbo.VW_CRE_SOL_ASISTENCIAS_REF 
AS 
SELECT 
r.NUMERO_SOLICITUD,
p.C6251 AS CONCEPTO,
concat(''NÂº: '', convert(VARCHAR(50),s.OPERACION)) AS OPERACION,
((isnull(r.INTS_REESTRUCTURA,0)+isnull(r.CAP_REESTRUCTURA,0)) - (isnull(r.CAPITAL_BONIFICADO,0)+isnull(r.INTERES_BONIFICADO,0)+isnull(r.MORATORIO_BONIFICADO,0)+isnull(r.PUNITORIO_BONIFICADO,0)+isnull(r.GASTOS_BONIFICADO,0))) AS IMPORTE_CANCELADO
FROM SALDOS s WITH (NOLOCK)
INNER JOIN CRE_DET_REESTRUCTURA r WITH (NOLOCK) ON s.JTS_OID=r.JTS_OID_REESTRUCTURADA AND r.TZ_LOCK=0
INNER JOIN PRODUCTOS p ON p.C6250=s.PRODUCTO AND   ( (p.tz_lock < 300000000000000 OR p.tz_lock >= 400000000000000) AND (p.tz_lock < 100000000000000 OR p.tz_lock >= 200000000000000)  )	
UNION  
SELECT
dext.NUMERO_SOLICITUD,
ext.DESCRIPCION AS CONCEPTO,
concat(ded.ID, '' - '', ded.DESCRIPCION) AS OPERACION,
dext.IMPORTE AS IMPORTE_CANCELADO
FROM CRE_SOL_DEUDA_EXTERNA dext WITH (NOLOCK)
INNER  JOIN CRE_ENTIDADEXTERNA ext ON dext.CODIGO_ENTE=ext.CODIGO
LEFT JOIN CRE_CODIGOS_DEDUCCIONES ded ON ded.ID=ext.COD_ECOM
')

EXECUTE('
IF OBJECT_ID (''dbo.VW_GARANTIASCREDITOS'') IS NOT NULL
	DROP VIEW dbo.VW_GARANTIASCREDITOS
')

EXECUTE('
CREATE     VIEW [dbo].[VW_GARANTIASCREDITOS] (
												   Cliente, 
												   Garantia,
												   Credito_Usuario,
												   Desvinculado,
												   JTS_OID)
AS 
SELECT gc.COD_CLIENTE AS Cliente, 
		gc.NUM_GARANTIA AS Garantia, 
		CASE WHEN s.C1785 = 5 THEN s.OPERACION 
		ELSE s.CUENTA 
		END AS Credito_Usuario, 
		gc.DESVINCULADO AS Desvinculado, 
		s.JTS_OID 
FROM CRE_GARANTIACREDITO gc WITH (NOLOCK)
INNER JOIN SALDOS s  WITH (NOLOCK)ON gc.JTSOID_SALDO = s.JTS_OID 
									AND( (s.tz_lock < 300000000000000 OR s.tz_lock >= 400000000000000) AND (s.tz_lock < 100000000000000 OR s.tz_lock >= 200000000000000)  )
INNER JOIN CRE_GARANTIASRECIBIDAS g  WITH (NOLOCK)ON gc.NUM_GARANTIA = g.NUM_GARANTIA 
													AND ( (g.tz_lock < 300000000000000 OR g.tz_lock >= 400000000000000) AND (g.tz_lock < 100000000000000 OR g.tz_lock >= 200000000000000)  )
WHERE gc.DESVINCULADO = ''N'' 
		AND ( (gc.tz_lock < 300000000000000 OR gc.tz_lock >= 400000000000000) AND (gc.tz_lock < 100000000000000 OR gc.tz_lock >= 200000000000000)  );
')

EXECUTE('
IF OBJECT_ID (''dbo.VW_GARANTIASPRESTAMOS'') IS NOT NULL
	DROP VIEW dbo.VW_GARANTIASPRESTAMOS
')


EXECUTE('
CREATE     VIEW [dbo].[VW_GARANTIASPRESTAMOS] (
												Operacion,
												Linea,
												"Nombre Linea",
												Familia,
												Garantia, 
												Tipo_Garantia,
												SubClass_Garantia,
												Descripcion,
												Moneda, 
												Monto, 
												Monto_Utilizado,
												Vencimiento,
												JTS_OID)
AS 
SELECT 	
	s.OPERACION AS Operacion,
	s.PRODUCTO AS Linea,
	p.C6251 AS Nombre_Linea,
	p.C6283 AS Familia,
	gc.NUM_GARANTIA AS Garantia, 
	g.TIPOGARANTIA AS Tipo_Garantia,
	g.COD_SUBCLAGARANTIA AS SubClass_Garantia,
	c.DSC_CLASIFICACION AS Descripcion,
	m.C6401 AS Moneda, 
	g.IMPORTE_REAL AS Monto, 
	(	SELECT isnull(sum(MONTO_GARANTIZADO_MG),0) 
		FROM CRE_HISTORICO_DEUDA_GARANTIAS WITH (NOLOCK)
		WHERE NRO_GARANTIA = g.NUM_GARANTIA 
				AND SALDO_JTS_OID=s.JTS_OID 
				AND FECHA_PROCESO = (	SELECT FECHAPROCESOANTERIOR 
										FROM PARAMETROS WITH (NOLOCK))) AS MontoUtilizado,
	g.FCHVTO_GARANTIA AS Vencimiento,
	s.JTS_OID AS JTS_OID
FROM CRE_GARANTIACREDITO gc WITH (NOLOCK)
INNER JOIN CRE_GARANTIASRECIBIDAS g WITH (NOLOCK)ON gc.NUM_GARANTIA = g.NUM_GARANTIA AND ( (g.tz_lock < 300000000000000 OR g.tz_lock >= 400000000000000) AND (g.tz_lock < 100000000000000 OR g.tz_lock >= 200000000000000)  )
INNER JOIN MONEDAS m WITH (NOLOCK)ON g.MONEDA_GARANTIA = m.C6399 AND ( (m.tz_lock < 300000000000000 OR m.tz_lock >= 400000000000000) AND (m.tz_lock < 100000000000000 OR m.tz_lock >= 200000000000000)  )
INNER JOIN CRE_CLASGARANTIAS c WITH (NOLOCK)ON g.TIPOGARANTIA = c.TIPOGARANTIA AND ( (c.tz_lock < 300000000000000 OR c.tz_lock >= 400000000000000) AND (c.tz_lock < 100000000000000 OR c.tz_lock >= 200000000000000)  )
INNER JOIN SALDOS s WITH (NOLOCK)ON gc.JTSOID_SALDO = s.JTS_OID AND ( (s.tz_lock < 300000000000000 OR s.tz_lock >= 400000000000000) AND (s.tz_lock < 100000000000000 OR s.tz_lock >= 200000000000000)  )
INNER JOIN PRODUCTOS p WITH (NOLOCK)ON s.PRODUCTO = p.C6250 AND ( (p.tz_lock < 300000000000000 OR p.tz_lock >= 400000000000000) AND (p.tz_lock < 100000000000000 OR p.tz_lock >= 200000000000000)  )
WHERE gc.DESVINCULADO = ''N'' 
	AND ( (gc.tz_lock < 300000000000000 OR gc.tz_lock >= 400000000000000) AND (gc.tz_lock < 100000000000000 OR gc.tz_lock >= 200000000000000)  );
')


EXECUTE('
IF OBJECT_ID (''dbo.VW_ASISTENCIAS'') IS NOT NULL
	DROP VIEW dbo.VW_ASISTENCIAS
')

EXECUTE('
CREATE VIEW [dbo].[VW_ASISTENCIAS] (
									SUCURSAL,    
									NOMBRESUCURSAL, 
									PRODUCTO, 
									NOMBREPRODUCTO, 
									CUENTA, 
									OPERACION,
									DESGLOSE, 
									MONEDA, 
									MONTOORIGEN,
									SALDO,
									VENCIMIENTO,
									CLIENTE,
									TIPO,
									JTS_OID,
									ORDINAL,
									PORCENTAJE_PAGO,
									TASA,
									GARANTIA_DESEMBOLSO,
									SITUACION,
									FAMILIA,
									CLASIFICACION,
									ESTADO)
AS
SELECT	s.SUCURSAL AS SUCURSAL, 
		suc.NOMBRESUCURSAL AS NOMBRESUCURSAL, 
		s.PRODUCTO AS PRODUCTO, 
		p.C6251 AS NOMBREPRODUCTO,
		s.CUENTA AS CUENTA, 
		s.OPERACION AS OPERACION, 
		s.ORDINAL AS DESGLOSE, 
		m.C6401 AS MONEDA, 
		s.C1601 AS MONTOORIGEN, 
		CASE WHEN C1785 = 1 THEN s.C1604 ELSE s.C1604*-1 END AS SALDO, 
		s.C1627 AS VENCIMIENTO, 
		s.C1803 AS CLIENTE, 
		s.C1785 AS TIPO, 
		s.JTS_OID AS JTS_OID, 
		0 AS ORDINAL,
		CASE WHEN s.C1644 > 0 AND s.C1785 = 5 THEN round(s.C1645 * 100 / s.C1644,2) ELSE NULL END AS PORCENTAJE_PAGO,
		s.C1632 AS TASA,
		ext.GARANTIA_DESEMBOLSO,
		c.CATEGORIARESULTANTE AS SITUACION,
		f.FAMILIAPROD AS FAMILIA,
		p.C6800 AS CLASIFICACION,
		CASE WHEN s.C1728 = ''Z'' THEN ''Cedido'' WHEN s.C1728 = ''C'' THEN ''Castigado'' ELSE ''Normal'' END AS ESTADO
FROM SALDOS s WITH(NOLOCK)
INNER JOIN PRODUCTOS p WITH(NOLOCK) ON s.PRODUCTO = p.C6250 
						AND ( (p.tz_lock < 300000000000000 OR p.tz_lock >= 400000000000000) AND (p.tz_lock < 100000000000000 OR p.tz_lock >= 200000000000000)  )
INNER JOIN CRE_FAMILIAS f ON p.C6283 = f.FAMILIAPROD AND ( (f.tz_lock < 300000000000000 OR f.tz_lock >= 400000000000000) AND (f.tz_lock < 100000000000000 OR f.tz_lock >= 200000000000000)  )					
INNER JOIN MONEDAS m WITH(NOLOCK) ON s.MONEDA = m.C6399 
						AND ( (m.tz_lock < 300000000000000 OR m.tz_lock >= 400000000000000) AND (m.tz_lock < 100000000000000 OR m.tz_lock >= 200000000000000)  )
INNER JOIN SUCURSALES suc WITH(NOLOCK) ON s.SUCURSAL = suc.SUCURSAL 
							AND ( (suc.tz_lock < 300000000000000 OR suc.tz_lock >= 400000000000000) AND (suc.tz_lock < 100000000000000 OR suc.tz_lock >= 200000000000000)  )
LEFT JOIN CRE_SALDOS ext WITH(NOLOCK) ON s.JTS_OID = ext.SALDOS_JTS_OID AND ( (ext.tz_lock < 300000000000000 OR ext.tz_lock >= 400000000000000) AND (ext.tz_lock < 100000000000000 OR ext.tz_lock >= 200000000000000)  )						
INNER JOIN CLI_CLIENTES c WITH(NOLOCK) ON s.C1803 = c.CODIGOCLIENTE AND ( (c.tz_lock < 300000000000000 OR c.tz_lock >= 400000000000000) AND (c.tz_lock < 100000000000000 OR c.tz_lock >= 200000000000000)  )	
WHERE (s.C1785 IN (5,6) OR (s.C1785 = 1 AND p.C6800 = ''GO'')) AND ( (s.tz_lock < 300000000000000 OR s.tz_lock >= 400000000000000) AND (s.tz_lock < 100000000000000 OR s.tz_lock >= 200000000000000)  )	
UNION
SELECT	s.SUCURSAL AS SUCURSAL, 
		suc.NOMBRESUCURSAL AS NOMBRESUCURSAL, 
		v.NROLINEA AS PRODUCTO, 
		p.C6251 AS NOMBREPRODUCTO,
		s.CUENTA AS CUENTA, 
		v.NRO_AUTORIZACION AS OPERACION, 
		s.ORDINAL AS DESGLOSE, 
		m.C6401 AS MONEDA, 
		v.IMPORTE AS MONTOORIGEN, 
		v.IMPORTE - v.IMPORTE_CONSUMIDO AS SALDO, 
		v.FECHA_VENCIMIENTO AS VENCIMIENTO, 
		s.C1803 AS CLIENTE, 
		1 AS TIPO, 
		s.JTS_OID AS JTS_OID, 
		v.ORDINAL AS ORDINAL,
		NULL AS PORCENTAJE_PAGO,
		NULL AS TASA,
		NULL AS GARANTIA_DESEMBOLSO,
		NULL AS SITUACION,
		NULL AS FAMILIA,
		p.C6800 AS CLASIFICACION,
		''Normal'' AS ESTADO
FROM VTA_SOBREGIROS v WITH(NOLOCK)
INNER JOIN SALDOS s WITH(NOLOCK) ON v.JTS_OID_SALDO = s.JTS_OID 
					AND ( (s.tz_lock < 300000000000000 OR s.tz_lock >= 400000000000000) AND (s.tz_lock < 100000000000000 OR s.tz_lock >= 200000000000000)  )	
INNER JOIN PRODUCTOS p WITH(NOLOCK) ON v.NROLINEA = p.C6250 
						AND ( (p.tz_lock < 300000000000000 OR p.tz_lock >= 400000000000000) AND (p.tz_lock < 100000000000000 OR p.tz_lock >= 200000000000000)  )						
INNER JOIN MONEDAS m WITH(NOLOCK) ON s.MONEDA = m.C6399 
					AND ( (m.tz_lock < 300000000000000 OR m.tz_lock >= 400000000000000) AND (m.tz_lock < 100000000000000 OR m.tz_lock >= 200000000000000)  )	
INNER JOIN SUCURSALES suc WITH(NOLOCK) ON v.SUCURSAL_ACUERDO = suc.SUCURSAL 
						AND ( (suc.tz_lock < 300000000000000 OR suc.tz_lock >= 400000000000000) AND (suc.tz_lock < 100000000000000 OR suc.tz_lock >= 200000000000000)  )	
WHERE v.ESTADO = 1 AND ( (v.tz_lock < 300000000000000 OR v.tz_lock >= 400000000000000) AND (v.tz_lock < 100000000000000 OR v.tz_lock >= 200000000000000)  )	
UNION
SELECT	s.SUCURSAL AS SUCURSAL, 
		suc.NOMBRESUCURSAL AS NOMBRESUCURSAL, 
		s.PRODUCTO AS PRODUCTO, 
		p.C6251 AS NOMBREPRODUCTO,
		s.CUENTA AS CUENTA, 
		s.OPERACION AS OPERACION, 
		s.ORDINAL AS DESGLOSE, 
		m.C6401 AS MONEDA, 
		s.C1832 AS MONTOORIGEN, 
		s.C1832 AS SALDO, 
		s.C1761 AS VENCIMIENTO, 
		s.C1803 AS CLIENTE, 
		s.C1785 AS TIPO, 
		s.JTS_OID AS JTS_OID, 
		0 AS ORDINAL,
		NULL AS PORCENTAJE_PAGO,
		NULL AS TASA,
		NULL AS GARANTIA_DESEMBOLSO,
		NULL AS SITUACION,
		f.FAMILIAPROD AS FAMILIA,
		p.C6800 AS CLASIFICACION,
		''Normal'' AS ESTADO
FROM SALDOS s WITH(NOLOCK)
INNER JOIN PRODUCTOS p WITH(NOLOCK) ON s.PRODUCTO = p.C6250 
						AND  ( (p.tz_lock < 300000000000000 OR p.tz_lock >= 400000000000000) AND (p.tz_lock < 100000000000000 OR p.tz_lock >= 200000000000000)  )	
						AND p.C6800 = ''T'' 
INNER JOIN CRE_FAMILIAS f ON p.C6283 = f.FAMILIAPROD AND ( (f.tz_lock < 300000000000000 OR f.tz_lock >= 400000000000000) AND (f.tz_lock < 100000000000000 OR f.tz_lock >= 200000000000000)  )						
INNER JOIN MONEDAS m WITH(NOLOCK) ON s.MONEDA = m.C6399 
						AND ( (m.tz_lock < 300000000000000 OR m.tz_lock >= 400000000000000) AND (m.tz_lock < 100000000000000 OR m.tz_lock >= 200000000000000)  )	
INNER JOIN SUCURSALES suc WITH(NOLOCK) ON s.SUCURSAL = suc.SUCURSAL 
							AND ( (suc.tz_lock < 300000000000000 OR suc.tz_lock >= 400000000000000) AND (suc.tz_lock < 100000000000000 OR suc.tz_lock >= 200000000000000)  )						
INNER JOIN CLI_CLIENTES c WITH(NOLOCK) ON s.C1803 = c.CODIGOCLIENTE AND ( (c.tz_lock < 300000000000000 OR c.tz_lock >= 400000000000000) AND (c.tz_lock < 100000000000000 OR c.tz_lock >= 200000000000000)  )	
WHERE s.C1785 = 1 
	AND  ( (s.tz_lock < 300000000000000 OR s.tz_lock >= 400000000000000) AND (s.tz_lock < 100000000000000 OR s.tz_lock >= 200000000000000)  )
')

EXECUTE('
IF OBJECT_ID (''dbo.VW_ASISTENCIAS_COBRADOR'') IS NOT NULL
	DROP VIEW dbo.VW_ASISTENCIAS_COBRADOR
')

EXECUTE('
CREATE   VIEW [dbo].[VW_ASISTENCIAS_COBRADOR] (
									SUCURSAL,    
									NOMBRESUCURSAL, 
									PRODUCTO, 
									NOMBREPRODUCTO, 
									CUENTA, 
									OPERACION,
									DESGLOSE, 
									MONEDA, 
									MONTOORIGEN,
									SALDO,
									VENCIMIENTO,
									CLIENTE,
									TIPO,
									JTS_OID,
									ORDINAL,
									PORCENTAJE_PAGO,
									TASA,
									GARANTIA_DESEMBOLSO,
									SITUACION,
									FAMILIA,
									CLASIFICACION,
									ESTADO)
AS
SELECT	s.SUCURSAL AS SUCURSAL, 
		suc.NOMBRESUCURSAL AS NOMBRESUCURSAL, 
		s.PRODUCTO AS PRODUCTO, 
		p.C6251 AS NOMBREPRODUCTO,
		s.CUENTA AS CUENTA, 
		s.OPERACION AS OPERACION, 
		s.ORDINAL AS DESGLOSE, 
		m.C6401 AS MONEDA, 
		s.C1601 AS MONTOORIGEN, 
		CASE WHEN C1785 = 1 THEN s.C1604 ELSE s.C1604*-1 END AS SALDO, 
		s.C1627 AS VENCIMIENTO, 
		s.C1803 AS CLIENTE, 
		s.C1785 AS TIPO, 
		s.JTS_OID AS JTS_OID, 
		0 AS ORDINAL,
		CASE WHEN s.C1644 > 0 AND s.C1785 = 5 THEN round(s.C1645 * 100 / s.C1644,2) ELSE NULL END AS PORCENTAJE_PAGO,
		s.C1632 AS TASA,
		ext.GARANTIA_DESEMBOLSO,
		c.CATEGORIARESULTANTE AS SITUACION,
		f.FAMILIAPROD AS FAMILIA,
		p.C6800 AS CLASIFICACION,
		CASE WHEN s.C1728 = ''Z'' THEN ''Cedido'' WHEN s.C1728 = ''C'' THEN ''Castigado'' ELSE ''Normal'' END AS ESTADO
FROM SALDOS s WITH(NOLOCK)
INNER JOIN PRODUCTOS p WITH(NOLOCK) ON s.PRODUCTO = p.C6250 
						AND ( (p.tz_lock < 300000000000000 OR p.tz_lock >= 400000000000000) AND (p.tz_lock < 100000000000000 OR p.tz_lock >= 200000000000000)  )
INNER JOIN CRE_FAMILIAS f ON p.C6283 = f.FAMILIAPROD AND ( (f.tz_lock < 300000000000000 OR f.tz_lock >= 400000000000000) AND (f.tz_lock < 100000000000000 OR f.tz_lock >= 200000000000000)  )					
INNER JOIN MONEDAS m WITH(NOLOCK) ON s.MONEDA = m.C6399 
						AND ( (m.tz_lock < 300000000000000 OR m.tz_lock >= 400000000000000) AND (m.tz_lock < 100000000000000 OR m.tz_lock >= 200000000000000)  )
INNER JOIN SUCURSALES suc WITH(NOLOCK) ON s.SUCURSAL = suc.SUCURSAL 
							AND ( (suc.tz_lock < 300000000000000 OR suc.tz_lock >= 400000000000000) AND (suc.tz_lock < 100000000000000 OR suc.tz_lock >= 200000000000000)  )
LEFT JOIN CRE_SALDOS ext WITH(NOLOCK) ON s.JTS_OID = ext.SALDOS_JTS_OID AND ( (ext.tz_lock < 300000000000000 OR ext.tz_lock >= 400000000000000) AND (ext.tz_lock < 100000000000000 OR ext.tz_lock >= 200000000000000)  )						
INNER JOIN CLI_CLIENTES c WITH(NOLOCK) ON s.C1803 = c.CODIGOCLIENTE AND ( (c.tz_lock < 300000000000000 OR c.tz_lock >= 400000000000000) AND (c.tz_lock < 100000000000000 OR c.tz_lock >= 200000000000000)  )	
WHERE (s.C1785 IN (5,6) OR (s.C1785 = 1 AND p.C6800 = ''GO'')) AND ( (s.tz_lock < 300000000000000 OR s.tz_lock >= 400000000000000) AND (s.tz_lock < 100000000000000 OR s.tz_lock >= 200000000000000)  )	
UNION
SELECT	s.SUCURSAL AS SUCURSAL, 
		suc.NOMBRESUCURSAL AS NOMBRESUCURSAL, 
		v.NROLINEA AS PRODUCTO, 
		p.C6251 AS NOMBREPRODUCTO,
		s.CUENTA AS CUENTA, 
		v.NRO_AUTORIZACION AS OPERACION, 
		s.ORDINAL AS DESGLOSE, 
		m.C6401 AS MONEDA, 
		v.IMPORTE AS MONTOORIGEN, 
		v.IMPORTE - v.IMPORTE_CONSUMIDO AS SALDO, 
		v.FECHA_VENCIMIENTO AS VENCIMIENTO, 
		s.C1803 AS CLIENTE, 
		1 AS TIPO, 
		s.JTS_OID AS JTS_OID, 
		v.ORDINAL AS ORDINAL,
		NULL AS PORCENTAJE_PAGO,
		NULL AS TASA,
		NULL AS GARANTIA_DESEMBOLSO,
		NULL AS SITUACION,
		NULL AS FAMILIA,
		p.C6800 AS CLASIFICACION,
		''Normal'' AS ESTADO
FROM VTA_SOBREGIROS v WITH(NOLOCK)
INNER JOIN SALDOS s WITH(NOLOCK) ON v.JTS_OID_SALDO = s.JTS_OID 
					AND ( (s.tz_lock < 300000000000000 OR s.tz_lock >= 400000000000000) AND (s.tz_lock < 100000000000000 OR s.tz_lock >= 200000000000000)  )	
INNER JOIN PRODUCTOS p WITH(NOLOCK) ON v.NROLINEA = p.C6250 
						AND ( (p.tz_lock < 300000000000000 OR p.tz_lock >= 400000000000000) AND (p.tz_lock < 100000000000000 OR p.tz_lock >= 200000000000000)  )						
INNER JOIN MONEDAS m WITH(NOLOCK) ON s.MONEDA = m.C6399 
					AND ( (m.tz_lock < 300000000000000 OR m.tz_lock >= 400000000000000) AND (m.tz_lock < 100000000000000 OR m.tz_lock >= 200000000000000)  )	
INNER JOIN SUCURSALES suc WITH(NOLOCK) ON v.SUCURSAL_ACUERDO = suc.SUCURSAL 
						AND ( (suc.tz_lock < 300000000000000 OR suc.tz_lock >= 400000000000000) AND (suc.tz_lock < 100000000000000 OR suc.tz_lock >= 200000000000000)  )	
WHERE v.ESTADO = 1 AND ( (v.tz_lock < 300000000000000 OR v.tz_lock >= 400000000000000) AND (v.tz_lock < 100000000000000 OR v.tz_lock >= 200000000000000)  )	
UNION
SELECT	s.SUCURSAL AS SUCURSAL, 
		suc.NOMBRESUCURSAL AS NOMBRESUCURSAL, 
		s.PRODUCTO AS PRODUCTO, 
		p.C6251 AS NOMBREPRODUCTO,
		s.CUENTA AS CUENTA, 
		s.OPERACION AS OPERACION, 
		s.ORDINAL AS DESGLOSE, 
		m.C6401 AS MONEDA, 
		s.C1832 AS MONTOORIGEN, 
		s.C1832 AS SALDO, 
		s.C1761 AS VENCIMIENTO, 
		s.C1803 AS CLIENTE, 
		s.C1785 AS TIPO, 
		s.JTS_OID AS JTS_OID, 
		0 AS ORDINAL,
		NULL AS PORCENTAJE_PAGO,
		NULL AS TASA,
		NULL AS GARANTIA_DESEMBOLSO,
		NULL AS SITUACION,
		f.FAMILIAPROD AS FAMILIA,
		p.C6800 AS CLASIFICACION,
		''Normal'' AS ESTADO
FROM SALDOS s WITH(NOLOCK)
INNER JOIN PRODUCTOS p WITH(NOLOCK) ON s.PRODUCTO = p.C6250 
						AND  ( (p.tz_lock < 300000000000000 OR p.tz_lock >= 400000000000000) AND (p.tz_lock < 100000000000000 OR p.tz_lock >= 200000000000000)  )	
						AND p.C6800 = ''T'' 
INNER JOIN CRE_FAMILIAS f ON p.C6283 = f.FAMILIAPROD AND ( (f.tz_lock < 300000000000000 OR f.tz_lock >= 400000000000000) AND (f.tz_lock < 100000000000000 OR f.tz_lock >= 200000000000000)  )						
INNER JOIN MONEDAS m WITH(NOLOCK) ON s.MONEDA = m.C6399 
						AND ( (m.tz_lock < 300000000000000 OR m.tz_lock >= 400000000000000) AND (m.tz_lock < 100000000000000 OR m.tz_lock >= 200000000000000)  )	
INNER JOIN SUCURSALES suc WITH(NOLOCK) ON s.SUCURSAL = suc.SUCURSAL 
							AND ( (suc.tz_lock < 300000000000000 OR suc.tz_lock >= 400000000000000) AND (suc.tz_lock < 100000000000000 OR suc.tz_lock >= 200000000000000)  )						
INNER JOIN CLI_CLIENTES c WITH(NOLOCK) ON s.C1803 = c.CODIGOCLIENTE AND ( (c.tz_lock < 300000000000000 OR c.tz_lock >= 400000000000000) AND (c.tz_lock < 100000000000000 OR c.tz_lock >= 200000000000000)  )	
WHERE s.C1785 = 1 
	AND  ( (s.tz_lock < 300000000000000 OR s.tz_lock >= 400000000000000) AND (s.tz_lock < 100000000000000 OR s.tz_lock >= 200000000000000)  )
')




