
CREATE VIEW dbo.VW_CLI_PERSONAS (
   [Tipo de Documento],
   [Numero de Documento],
   [Numero de Persona],
   [Tipo de Persona],
   [Nombre de Persona],
   [Titularidad],
   [Codigo de Cliente],
   [Nombre de Cliente],
   [Estado],
   [Nivel de Apertura])
 
AS 
   /*Generated by SQL Server Migration Assistant for Oracle version 7.9.0.*/
   SELECT 
      V.TIPODOCUMENTO AS TIPODOC, 
      V.NUMERODOCUMENTO AS NUMERODOC, 
      V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
      V.TIPOPERSONA, 
      ISNULL(U.PRIMERNOMBRE, '') + ' ' + ISNULL(U.APELLIDOPATERNO, '') + ' ' + ISNULL(U.APELLIDOMATERNO, '') AS NOMBRE, 
      T.TITULARIDAD, 
      R.CODIGOCLIENTE, 
      R.NOMBRECLIENTE,
      CASE WHEN r.ESTADO=0 THEN 'HABILITADO' ELSE 'INHABILITADO' END AS ESTADO,
      CASE WHEN r.NIVEL_APERTURA=1 THEN 'BASICO' ELSE 
      CASE WHEN R.NIVEL_APERTURA=3 THEN 'ACTIVO' ELSE 
      CASE WHEN R.NIVEL_APERTURA=4 THEN 'INSTITUCION FINANCIERA' END END END AS NIVEL_APERTURA
   FROM 
      dbo.CLI_CLIENTES  AS R, 
      dbo.CLI_CLIENTEPERSONA  AS T, 
      dbo.CLI_PERSONASFISICAS  AS U, 
      dbo.CLI_DOCUMENTOSPFPJ  AS V
   WHERE 
      (R.CODIGOCLIENTE = T.CODIGOCLIENTE) AND 
      (U.NUMEROPERSONAFISICA = T.NUMEROPERSONA AND U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ) AND 
      ((R.TZ_LOCK < 300000000000000 OR R.TZ_LOCK >= 400000000000000) AND (R.TZ_LOCK < 100000000000000 OR R.TZ_LOCK >= 200000000000000)) AND 
      ((T.TZ_LOCK < 300000000000000 OR T.TZ_LOCK >= 400000000000000) AND (T.TZ_LOCK < 100000000000000 OR T.TZ_LOCK >= 200000000000000)) AND 
      ((U.TZ_LOCK < 300000000000000 OR U.TZ_LOCK >= 400000000000000) AND (U.TZ_LOCK < 100000000000000 OR U.TZ_LOCK >= 200000000000000)) AND 
      ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000))
    UNION ALL
   SELECT 
      V.TIPODOCUMENTO AS TIPODOC, 
      V.NUMERODOCUMENTO AS NUMERODOC, 
      V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
      V.TIPOPERSONA, 
      S.RAZONSOCIAL AS NOMBRE, 
      T.TITULARIDAD, 
      R.CODIGOCLIENTE, 
      R.NOMBRECLIENTE,
      CASE WHEN r.ESTADO=0 THEN 'HABILITADO' ELSE 'INHABILITADO' END AS ESTADO,
      CASE WHEN r.NIVEL_APERTURA=1 THEN 'BASICO' ELSE 
      CASE WHEN R.NIVEL_APERTURA=3 THEN 'ACTIVO' ELSE 
      CASE WHEN R.NIVEL_APERTURA=4 THEN 'INSTITUCION FINANCIERA' END END END AS NIVEL_APERTURA
   FROM 
      dbo.CLI_CLIENTES  AS R, 
      dbo.CLI_PERSONASJURIDICAS  AS S, 
      dbo.CLI_CLIENTEPERSONA  AS T, 
      dbo.CLI_DOCUMENTOSPFPJ  AS V
   WHERE 
      (R.CODIGOCLIENTE = T.CODIGOCLIENTE) AND 
      (S.NUMEROPERSONAJURIDICA = T.NUMEROPERSONA AND S.NUMEROPERSONAJURIDICA = V.NUMEROPERSONAFJ) AND 
      ((R.TZ_LOCK < 300000000000000 OR R.TZ_LOCK >= 400000000000000) AND (R.TZ_LOCK < 100000000000000 OR R.TZ_LOCK >= 200000000000000)) AND 
      ((T.TZ_LOCK < 300000000000000 OR T.TZ_LOCK >= 400000000000000) AND (T.TZ_LOCK < 100000000000000 OR T.TZ_LOCK >= 200000000000000)) AND 
      ((S.TZ_LOCK < 300000000000000 OR S.TZ_LOCK >= 400000000000000) AND (S.TZ_LOCK < 100000000000000 OR S.TZ_LOCK >= 200000000000000)) AND 
      ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000))
GO

