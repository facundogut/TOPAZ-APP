EXECUTE('CREATE OR ALTER VIEW [dbo].[HIST_GRL_SALDOS_DIARIOS]

AS
	SELECT GRL_SALDOS_DIARIOS.SUCURSAL,
		CONVERT(NUMERIC(12),GRL_SALDOS_DIARIOS.SALDOS_JTS_OID) AS NROCUENTA,
		(CASE WHEN SALDOS.C1785 = 2 THEN ''CC'' WHEN SALDOS.C1785 = 3 THEN ''CA'' END) AS MODULO,
		GRL_SALDOS_DIARIOS.MONEDA,
		CONVERT(NUMERIC(8),CONVERT(VARCHAR, GRL_SALDOS_DIARIOS.FECHA, 112)) AS FECHA,
		GRL_SALDOS_DIARIOS.SALDO_AL_CORTE AS SALDOINICIAL,
		CONVERT(NUMERIC(15,2), GRL_SALDOS_DIARIOS.INTERESESCOBRO) AS INTERESDEVENGADO
	FROM GRL_SALDOS_DIARIOS WITH (NOLOCK)
	INNER JOIN SALDOS WITH (NOLOCK) ON GRL_SALDOS_DIARIOS.SALDOS_JTS_OID = SALDOS.JTS_OID
	WHERE SALDOS.C1785 IN (2, 3)
	  AND SALDOS.TZ_LOCK = 0
	  AND GRL_SALDOS_DIARIOS.TZ_LOCK = 0')