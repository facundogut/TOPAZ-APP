EXECUTE('
IF OBJECT_ID (''dbo.VW_DSCCLASETARJETAS'') IS NOT NULL
	DROP VIEW dbo.VW_DSCCLASETARJETAS
')
EXECUTE('
CREATE   VIEW [dbo].[VW_DSCCLASETARJETAS] 
AS
SELECT
	TJD_TARJETAS.TITULARIDAD,
	TJD_TARJETAS.ID_TARJETA,
	TJD_TARJETAS.NRO_CLIENTE,
	TJD_TARJETAS.TIPO_TARJETA,
	TJD_TIPO_TARJETA.DESCRIPCION,
	TJD_CLASE.Descripcion AS CLASE,
	TJD_TARJETAS.NOMBRE_TARJETA,
	TJD_TARJETAS.PERMISO,
	TJD_PERMISOS.DESCRIPCION AS DESCRIPCION_PERMISO,
	TJD_TARJETAS.ESTADO,
	TJD_TARJETAS.COD_PAQUETE,
	TJD_TARJETAS.NRO_PERSONA
FROM TJD_TARJETAS WITH (NOLOCK)
LEFT JOIN TJD_PERMISOS WITH (NOLOCK) ON TJD_TARJETAS.PERMISO = TJD_PERMISOS.SUB_TIPO
INNER JOIN TJD_TIPO_TARJETA WITH (NOLOCK) ON TJD_TARJETAS.TIPO_TARJETA = TJD_TIPO_TARJETA.TIPO_TARJETA									 
										 AND ((TJD_TIPO_TARJETA.tz_lock < 300000000000000 OR TJD_TIPO_TARJETA.tz_lock >= 400000000000000)
										 AND (TJD_TIPO_TARJETA.tz_lock < 100000000000000 OR TJD_TIPO_TARJETA.tz_lock >= 200000000000000))
INNER JOIN TJD_CLASE WITH (NOLOCK) ON TJD_TIPO_TARJETA.CLASE = TJD_CLASE.Clave
WHERE (	(TJD_TARJETAS.tz_lock < 300000000000000 OR TJD_TARJETAS.tz_lock >= 400000000000000)
	AND (TJD_TARJETAS.tz_lock < 100000000000000	OR TJD_TARJETAS.tz_lock >= 200000000000000))
')

