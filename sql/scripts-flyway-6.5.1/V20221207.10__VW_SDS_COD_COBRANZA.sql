EXECUTE('
IF OBJECT_ID (''dbo.VW_SDS_COD_COBRANZA'') IS NOT NULL
	DROP VIEW dbo.VW_SDS_COD_COBRANZA
')

EXECUTE('
CREATE   VIEW dbo.VW_SDS_COD_COBRANZA
AS
SELECT	cd.CODIGO AS ID_CODIGO ,
		cd.DESCRIPCION AS DESCRIPCION,
		cd.SOLO_ACREDITA AS MODALIDAD,
		CASE WHEN cd.SOLO_ACREDITA=''S'' THEN ''SOLO ACREDITACION'' ELSE ''ACREDITACION Y COBRANZA'' END AS MODALIDAD_DESC,
		cd.PARTICULARIDAD,		
		O2.DESCRIPCION AS PARTICULARIDAD_DESC
FROM CRE_COB_CODIGOS cd WITH(NOLOCK)
INNER JOIN OPCIONES O1 WITH (NOLOCK) ON O1.NUMERODECAMPO=45224 AND O1.OPCIONINTERNA=cd.SOLO_ACREDITA
INNER JOIN OPCIONES O2 WITH (NOLOCK) ON O2.NUMERODECAMPO=45227 AND O2.OPCIONINTERNA=cd.PARTICULARIDAD
WHERE cd.TZ_LOCK = 0
')