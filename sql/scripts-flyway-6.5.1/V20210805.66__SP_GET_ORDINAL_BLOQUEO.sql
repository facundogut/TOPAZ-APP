
/****** Object:  StoredProcedure [dbo].[SP_GET_ORDINAL_BLOQUEO]    Script Date: 02/06/2021 18:04:05 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[SP_GET_ORDINAL_BLOQUEO]
@pJtsOid NUMERIC(10),
@pTipoBloq NUMERIC(3),
@pOrdinal NUMERIC(15) OUT
AS
BEGIN
	DECLARE @vMaxBloq NUMERIC(15);
	
	SELECT @vMaxBloq = COALESCE(MAX(ORDINAL_BLOQUEO), 0) 
	FROM GRL_BLOQUEOS WITH (NOLOCK)
	WHERE SALDO_JTS_OID = @pJtsOid 
		AND COD_BLOQUEO = @pTipoBloq;
	
	SET @pOrdinal = @vMaxBloq + 1;
END