EXECUTE('

--OVERBALANCE CAJA DE SEGURIDAD

ALTER VIEW VW_COF_COBRO_CAJA_SEG 
AS
SELECT S.JTS_OID, 
C.FECHA_INICIO, 
C.FECHA_VENCIMIENTO,
S.C1604+S.C1683+S.C1605+S.C2627+S.C50107 AS SALDO_ACTUAL,
S.MONEDA,
C.CODIGO_COFRE,
F.TIPO AS SEGMENTO,
S.C1803 AS CLIENTE,
CC.USF,
''S'' AS COBRA,
S.C1728 AS INMOVILIZADO
FROM SALDOS S
INNER JOIN COF_COFRES_CONTRATOS C ON C.SUCURSAL_DEBITO = S.SUCURSAL AND C.PRODUCTO_DEBITO = S.PRODUCTO
	AND C.MONEDA_DEBITO = S.MONEDA AND C.CUENTA_DEBITO = S.CUENTA AND C.OPERACION_DEBITO = S.OPERACION
   	AND C.ORDINAL_DEBITO = S.ORDINAL
INNER JOIN COF_COFRES F ON F.CODIGO = C.CODIGO_COFRE
INNER JOIN CLI_CLIENTES CC ON CC.CODIGOCLIENTE = S.C1803
INNER JOIN PARAMETROSGENERALES P ON P.CODIGO = 33
WHERE C.ESTADO = (''V'') OR C.ESTADO = (''M'') 
AND S.TZ_LOCK = 0
AND C.TZ_LOCK = 0
AND F.TZ_LOCK = 0
AND (
--C.FECHA_INICIO = (SELECT FECHAPROCESO FROM PARAMETROS) OR
DATEDIFF(dd,C.FECHA_INICIO,(SELECT FECHAPROCESO FROM PARAMETROS) ) = P.NUMERICO
OR DATEDIFF(dd,C.FECHA_INICIO,(SELECT FECHAPROCESO FROM PARAMETROS) ) = P.NUMERICO + P.NUMERICO
OR DATEDIFF(dd,C.FECHA_INICIO,(SELECT FECHAPROCESO FROM PARAMETROS) ) = P.NUMERICO + P.NUMERICO + P.NUMERICO
OR C.FECHA_VENCIMIENTO = (SELECT FECHAPROCESO FROM PARAMETROS))
UNION
SELECT S.JTS_OID, 
C.FECHA_INICIO, 
C.FECHA_VENCIMIENTO,
S.C1604+S.C1683+S.C1605+S.C2627+S.C50107 AS SALDO_ACTUAL,
S.MONEDA,
C.CODIGO_COFRE,
F.TIPO AS SEGMENTO,
S.C1803 AS CLIENTE,
CC.USF,
''N'' AS COBRA,
S.C1728 AS INMOVILIZADO
FROM SALDOS S
INNER JOIN COF_COFRES_CONTRATOS C ON C.SUCURSAL_DEBITO = S.SUCURSAL AND C.PRODUCTO_DEBITO = S.PRODUCTO
	AND C.MONEDA_DEBITO = S.MONEDA AND C.CUENTA_DEBITO = S.CUENTA AND C.OPERACION_DEBITO = S.OPERACION
   	AND C.ORDINAL_DEBITO = S.ORDINAL
INNER JOIN COF_COFRES F ON F.CODIGO = C.CODIGO_COFRE
INNER JOIN CLI_CLIENTES CC ON CC.CODIGOCLIENTE = S.C1803
WHERE C.ESTADO = (''I'')
AND S.TZ_LOCK = 0
AND C.TZ_LOCK = 0
AND F.TZ_LOCK = 0;

')

execute ('




INSERT INTO DICCIONARIO
(NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES(34776, NULL, 0, ''Inmovilizado'', ''Inmovilizado'', 1, ''A'', 0, NULL, 0, 0, 0, 0, 0, 0, 0, 3463, ''INMOVILIZADO'', 0, NULL);


')


