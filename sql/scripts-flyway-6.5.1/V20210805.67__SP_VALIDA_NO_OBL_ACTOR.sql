/****** Object:  StoredProcedure [dbo].[SP_VALIDA_NO_OBL_ACTOR]    Script Date: 02/06/2021 17:36:40 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[SP_VALIDA_NO_OBL_ACTOR]
@pRol VARCHAR(3),
@pValido NUMERIC(1) OUTPUT
AS
DECLARE
	@vContCausas NUMERIC(6)
BEGIN
	SET @pValido = 1
	
	SELECT @vContCausas = COUNT(*)
	FROM DJ_JUZGADOS j WITH (NOLOCK)
	WHERE j.TZ_LOCK = 0
	AND j.NRO_JUZGADO NOT IN (SELECT Ij.NRO_JUZGADO 
								FROM DJ_INTEGRANTES_JUZGADOS Ij WITH (NOLOCK)
								WHERE ij.ACTOR=@pRol AND Ij.TZ_LOCK=0) 
	
	IF @vContCausas > 0
	BEGIN
		SET @pValido = 0
	END
END