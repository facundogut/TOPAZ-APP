EXECUTE('

ALTER   VIEW [dbo].[VW_PFPJ_DOCUMENTOS] (
												   TIPODOC, 
												   NUMERODOC, 
												   NUMEROPERSONA, 
												   NIVELAPERTURA, 
												   TIPOPERSONA, 
												   NOMBRE, 
												   ESTADO,
												   MOTIVO_INHABILITADO)
AS 
   SELECT TOP 9223372036854775807 WITH TIES 
      V.TIPODOCUMENTO AS TIPODOC, 
      V.NUMERODOCUMENTO AS NUMERODOC, 
      V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
      CASE U.NIVEL_APERTURA
         WHEN 0 THEN ''REGISTRO''
         WHEN 1 THEN ''BÁSICO''
         WHEN 3 THEN ''ACTIVOS''
      END AS NIVELAPERTURA, 
      V.TIPOPERSONA, 
      (U.APELLIDOPATERNO+ '' '' +U.PRIMERNOMBRE) AS NOMBRE,
      CASE U.ESTADO
      	 WHEN 0 THEN ''HABILITADO''
         WHEN 1 THEN ''INHABILITADO''
       END AS ESTADO,   
      CASE U.MOTIVO_INHABILITADO
      	 WHEN 1 THEN ''INHABILITADO POR EL BCRA''
         WHEN 2 THEN ''INHABILITADO POR FALLECIMIENTO''
         WHEN 3 THEN ''INHABILITADO UIF''
         WHEN 4 THEN ''INHABILITADO TERRORISMO''
         WHEN 5 THEN ''INHABILITACION ADMINISTRATIVA''
       END AS MOTIVO_INHABILITADO
   FROM dbo.CLI_PERSONASFISICAS  AS U WITH(NOLOCK)
   INNER JOIN  dbo.CLI_DOCUMENTOSPFPJ  AS V WITH(NOLOCK) 
											ON U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ
											AND ((U.TZ_LOCK < 300000000000000 OR U.TZ_LOCK >= 400000000000000) AND (U.TZ_LOCK < 100000000000000 OR U.TZ_LOCK >= 200000000000000))
											AND V.TIPOPERSONA = ''F''
											AND ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000))
   ORDER BY NUMEROPERSONA
UNION ALL
   SELECT TOP 9223372036854775807 WITH TIES 
      V.TIPODOCUMENTO AS TIPODOC, 
      V.NUMERODOCUMENTO AS NUMERODOC, 
      V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
      CASE T.NIVEL_APERTURA
         WHEN 1 THEN ''BÁSICO''
         WHEN 3 THEN ''ACTIVOS''
         WHEN 4 THEN ''INST.FINANCIERA''
      END AS NIVELAPERTURA, 
      V.TIPOPERSONA, 
      T.RAZONSOCIAL AS NOMBRE,  
      CASE T.ESTADO
      	 WHEN 0 THEN ''HABILITADO''
         WHEN 1 THEN ''INHABILITADO''
      END AS ESTADO,   
      CASE T.MOTIVO_INHABILITADO
      	 WHEN 1 THEN ''INHABILITADO POR EL BCRA''
         WHEN 3 THEN ''INHABILITADO UIF''
         WHEN 4 THEN ''INHABILITADO TERRORISMO''
         WHEN 5 THEN ''INHABILITACION ADMINISTRATIVA''
         WHEN 6 THEN ''P/LIQ TOTAL DE LA SOCIEDAD''
      END AS MOTIVO_INHABILITADO
   FROM dbo.CLI_PERSONASJURIDICAS  AS T WITH (NOLOCK)
   INNER JOIN dbo.CLI_DOCUMENTOSPFPJ  AS V WITH (NOLOCK) 
										ON T.NUMEROPERSONAJURIDICA = V.NUMEROPERSONAFJ 
										AND (V.TIPOPERSONA = ''J'' OR V.TIPOPERSONA = ''I'')
										AND ((T.TZ_LOCK < 300000000000000 OR T.TZ_LOCK >= 400000000000000) AND (T.TZ_LOCK < 100000000000000 OR T.TZ_LOCK >= 200000000000000))
										AND ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000))
   ORDER BY NUMEROPERSONA;


')


EXECUTE('


ALTER   VIEW [dbo].[VW_PHUMANA_DOCUMENTOS]
AS 
SELECT --TOP 9223372036854775807 WITH TIES 
      V.TIPODOCUMENTO AS ''Tipo Documento Identificativo'', 
      CONVERT(NUMERIC(11), V.NUMERODOCUMENTO)  AS ''Número Documento Identificativo'',
      V.TIPO_DOC_FISICO AS ''Tipo Documento Físico'',
      V.NUM_DOC_FISICO AS ''Número Documento Físico'',
      concat(U.APELLIDOPATERNO,'' '', U.APELLIDOMATERNO,'' '', U.PRIMERNOMBRE,'' '', U.SEGUNDONOMBRE) AS ''Apellido y Nombre'',
      CASE V.TIPOPERSONA 
      	WHEN ''F'' THEN ''Persona Humana'' END AS ''Tipo de Persona'',
      CASE U.NIVEL_APERTURA
         WHEN 0 THEN ''REGISTRO''
         WHEN 1 THEN ''BÁSICO''
         WHEN 2 THEN ''PASIVOS''
         WHEN 3 THEN ''ACTIVOS''
      END AS ''Nivel de Apertura'',
      CASE U.ESTADO 
      WHEN 0 THEN ''HABILITADO''
      WHEN 1 THEN ''INHABILITADO''
      END AS ''Estado de la Persona'',
      CASE U.MOTIVO_INHABILITADO
      WHEN 1 THEN ''INHABILITADO POR EL BCRA''
      WHEN 2 THEN ''INHABILITADO POR FALLECIMIENTO''
      WHEN 3 THEN ''INHABILITADO UIF''
      WHEN 4 THEN ''INHABILITADO TERRORISMO''
      WHEN 5 THEN ''INHABILITACION ADMINISTRATIVA''
      END AS ''Motivo Inhabilitado'',
      V.NUMEROPERSONAFJ AS ''Número de la Persona'',  
      U.EMPLEADO_BC_BANCO
FROM dbo.CLI_PERSONASFISICAS  AS U WITH (NOLOCK)
INNER JOIN dbo.CLI_DOCUMENTOSPFPJ  AS V WITH (NOLOCK) ON U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ 
														AND (V.TIPOPERSONA = ''F'' OR V.TIPOPERSONA = ''U'')
														AND (	(U.TZ_LOCK < 300000000000000 OR U.TZ_LOCK >= 400000000000000) 
															AND (U.TZ_LOCK < 100000000000000 OR U.TZ_LOCK >= 200000000000000)) 
														AND(	(V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) 
															AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000))
ORDER BY ''Número de la Persona'' OFFSET 0 ROWS


')

EXECUTE('
ALTER   VIEW [dbo].[VW_PF_DOCUMENTOS] 
AS 
SELECT TOP 9223372036854775807 WITH TIES 
    V.TIPODOCUMENTO AS ''Tipo Documento Identificativo'', 
    V.NUMERODOCUMENTO AS ''Número Documento Identificativo'',
    V.TIPO_DOC_FISICO AS ''Tipo Documento Físico'',
    V.NUM_DOC_FISICO AS ''Número Documento Físico'',
    concat(U.APELLIDOPATERNO,'' '', U.PRIMERNOMBRE) AS ''Apellido y Nombre'',
    CASE V.TIPOPERSONA 
    WHEN ''F'' THEN ''Persona Humana'' END AS ''Tipo de Persona'',
    CASE U.NIVEL_APERTURA
        WHEN 0 THEN ''REGISTRO''
        WHEN 1 THEN ''BÁSICO''
        WHEN 2 THEN ''PASIVOS''
        WHEN 3 THEN ''ACTIVOS''
    END AS ''Nivel de Apertura'',
    CASE U.ESTADO 
    WHEN 0 THEN ''HABILITADO''
    WHEN 1 THEN ''INHABILITADO''
    END AS ''Estado de la Persona'',
    CASE U.MOTIVO_INHABILITADO
    WHEN 1 THEN ''INHABILITADO POR EL BCRA''
    WHEN 2 THEN ''INHABILITADO POR FALLECIMIENTO''
    WHEN 3 THEN ''INHABILITADO UIF''
    WHEN 4 THEN ''INHABILITADO TERRORISMO''
    WHEN 5 THEN ''INHABILITACION ADMINISTRATIVA''
    END AS ''Motivo Inhabilitado'',
    V.NUMEROPERSONAFJ AS ''Número de la Persona'',  
    U.EMPLEADO_BC_BANCO
FROM dbo.CLI_PERSONASFISICAS  AS U WITH(NOLOCK) 
INNER JOIN dbo.CLI_DOCUMENTOSPFPJ  AS V WITH(NOLOCK) ON  U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ 
												AND (V.TIPOPERSONA = ''F'' OR V.TIPOPERSONA = ''U'') 
												AND (	(U.TZ_LOCK < 300000000000000 OR U.TZ_LOCK >= 400000000000000) 
													AND (U.TZ_LOCK < 100000000000000 OR U.TZ_LOCK >= 200000000000000)) 
												AND(	(V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) 
													AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000))
ORDER BY ''Número de la Persona''

')


EXECUTE('

ALTER   VIEW [dbo].[VW_FISICAS_JURIDICAS] (
										   TIPODOC, 
										   NUMERODOC, 
										   NUMEROPERSONA, 
										   NIVELAPERTURA, 
										   TIPOPERSONA, 
										   NOMBRE, 
										   ESTADO,
										   MOTIVO_INHABILITADO)
AS 
   SELECT TOP 9223372036854775807 WITH TIES 
      V.TIPODOCUMENTO AS TIPODOC, 
      V.NUMERODOCUMENTO AS NUMERODOC, 
      V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
      CASE U.NIVEL_APERTURA
         WHEN 0 THEN ''REGISTRO''
         WHEN 1 THEN ''BÁSICO''
         WHEN 3 THEN ''ACTIVOS''
      END AS NIVELAPERTURA, 
      V.TIPOPERSONA, 
      (U.PRIMERNOMBRE + '' '' +U.SEGUNDONOMBRE+'' '' +U.APELLIDOPATERNO+'' ''+U.APELLIDOMATERNO) AS NOMBRE,
      CASE U.ESTADO
      	 WHEN 0 THEN ''HABILITADO''
         WHEN 1 THEN ''INHABILITADO''
       END AS ESTADO,   
      CASE U.MOTIVO_INHABILITADO
      	 WHEN 1 THEN ''INHABILITADO POR EL BCRA''
         WHEN 2 THEN ''INHABILITADO POR FALLECIMIENTO''
         WHEN 3 THEN ''INHABILITADO UIF''
         WHEN 4 THEN ''INHABILITADO TERRORISMO''
         WHEN 5 THEN ''INHABILITACION ADMINISTRATIVA''
       END AS MOTIVO_INHABILITADO
   FROM dbo.CLI_PERSONASFISICAS  AS U WITH (NOLOCK)
   INNER JOIN dbo.CLI_DOCUMENTOSPFPJ  AS V WITH (NOLOCK)ON U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ  
														  AND V.TIPOPERSONA = ''F''
														  AND U.TZ_LOCK=0
														  AND V.TZ_LOCK=0
   ORDER BY NUMEROPERSONA
UNION ALL
   SELECT TOP 9223372036854775807 WITH TIES 
      V.TIPODOCUMENTO AS TIPODOC, 
      V.NUMERODOCUMENTO AS NUMERODOC, 
      V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
      CASE T.NIVEL_APERTURA
         WHEN 1 THEN ''BÁSICO''
         WHEN 3 THEN ''ACTIVOS''
         WHEN 4 THEN ''INST.FINANCIERA''
      END AS NIVELAPERTURA, 
      V.TIPOPERSONA, 
      T.RAZONSOCIAL AS NOMBRE,  
      CASE T.ESTADO
      	 WHEN 0 THEN ''HABILITADO''
         WHEN 1 THEN ''INHABILITADO''
      END AS ESTADO,   
      CASE T.MOTIVO_INHABILITADO
      	 WHEN 1 THEN ''INHABILITADO POR EL BCRA''
         WHEN 3 THEN ''INHABILITADO UIF''
         WHEN 4 THEN ''INHABILITADO TERRORISMO''
         WHEN 5 THEN ''INHABILITACION ADMINISTRATIVA''
         WHEN 6 THEN ''P/LIQ TOTAL DE LA SOCIEDAD''
      END AS MOTIVO_INHABILITADO
   FROM dbo.CLI_PERSONASJURIDICAS  AS T WITH (NOLOCK)
   INNER JOIN dbo.CLI_DOCUMENTOSPFPJ  AS V WITH (NOLOCK) ON 
								  T.NUMEROPERSONAJURIDICA = V.NUMEROPERSONAFJ 
								  AND (V.TIPOPERSONA = ''J'' OR V.TIPOPERSONA = ''I'')
								  AND T.TZ_LOCK = 0 
								  AND V.TZ_LOCK = 0
   ORDER BY NUMEROPERSONA;


')

 EXECUTE('
 
 
 
ALTER   VIEW [dbo].[VW_PFPJ_DOCUMENTOS] (
												   TIPODOC, 
												   NUMERODOC, 
												   NUMEROPERSONA, 
												   NIVELAPERTURA, 
												   TIPOPERSONA, 
												   NOMBRE, 
												   ESTADO,
												   MOTIVO_INHABILITADO)
AS 
   SELECT TOP 9223372036854775807 WITH TIES 
      V.TIPODOCUMENTO AS TIPODOC, 
      V.NUMERODOCUMENTO AS NUMERODOC, 
      V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
      CASE U.NIVEL_APERTURA
         WHEN 0 THEN ''REGISTRO''
         WHEN 1 THEN ''BÁSICO''
         WHEN 3 THEN ''ACTIVOS''
      END AS NIVELAPERTURA, 
      V.TIPOPERSONA, 
      (U.APELLIDOPATERNO+ '' '' +U.PRIMERNOMBRE) AS NOMBRE,
      CASE U.ESTADO
      	 WHEN 0 THEN ''HABILITADO''
         WHEN 1 THEN ''INHABILITADO''
       END AS ESTADO,   
      CASE U.MOTIVO_INHABILITADO
      	 WHEN 1 THEN ''INHABILITADO POR EL BCRA''
         WHEN 2 THEN ''INHABILITADO POR FALLECIMIENTO''
         WHEN 3 THEN ''INHABILITADO UIF''
         WHEN 4 THEN ''INHABILITADO TERRORISMO''
         WHEN 5 THEN ''INHABILITACION ADMINISTRATIVA''
       END AS MOTIVO_INHABILITADO
   FROM dbo.CLI_PERSONASFISICAS  AS U WITH(NOLOCK)
   INNER JOIN  dbo.CLI_DOCUMENTOSPFPJ  AS V WITH(NOLOCK) 
											ON U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ
											AND ((U.TZ_LOCK < 300000000000000 OR U.TZ_LOCK >= 400000000000000) AND (U.TZ_LOCK < 100000000000000 OR U.TZ_LOCK >= 200000000000000))
											AND V.TIPOPERSONA = ''F''
											AND ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000))
   ORDER BY NUMEROPERSONA
UNION ALL
   SELECT TOP 9223372036854775807 WITH TIES 
      V.TIPODOCUMENTO AS TIPODOC, 
      V.NUMERODOCUMENTO AS NUMERODOC, 
      V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
      CASE T.NIVEL_APERTURA
         WHEN 1 THEN ''BÁSICO''
         WHEN 3 THEN ''ACTIVOS''
         WHEN 4 THEN ''INST.FINANCIERA''
      END AS NIVELAPERTURA, 
      V.TIPOPERSONA, 
      T.RAZONSOCIAL AS NOMBRE,  
      CASE T.ESTADO
      	 WHEN 0 THEN ''HABILITADO''
         WHEN 1 THEN ''INHABILITADO''
      END AS ESTADO,   
      CASE T.MOTIVO_INHABILITADO
      	 WHEN 1 THEN ''INHABILITADO POR EL BCRA''
         WHEN 3 THEN ''INHABILITADO UIF''
         WHEN 4 THEN ''INHABILITADO TERRORISMO''
         WHEN 5 THEN ''INHABILITACION ADMINISTRATIVA''
         WHEN 6 THEN ''P/LIQ TOTAL DE LA SOCIEDAD''
      END AS MOTIVO_INHABILITADO
   FROM dbo.CLI_PERSONASJURIDICAS  AS T WITH (NOLOCK)
   INNER JOIN dbo.CLI_DOCUMENTOSPFPJ  AS V WITH (NOLOCK) 
										ON T.NUMEROPERSONAJURIDICA = V.NUMEROPERSONAFJ 
										AND (V.TIPOPERSONA = ''J'' OR V.TIPOPERSONA = ''I'')
										AND ((T.TZ_LOCK < 300000000000000 OR T.TZ_LOCK >= 400000000000000) AND (T.TZ_LOCK < 100000000000000 OR T.TZ_LOCK >= 200000000000000))
										AND ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000))
   ORDER BY NUMEROPERSONA;
   
   ')