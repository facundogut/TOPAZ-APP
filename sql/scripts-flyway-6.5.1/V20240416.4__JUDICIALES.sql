EXECUTE('
IF OBJECT_ID (''dbo.VW_VINCULACIONES_JUDICIALES'') IS NOT NULL
	DROP VIEW dbo.VW_VINCULACIONES_JUDICIALES
')

EXECUTE('
CREATE VIEW [dbo].[VW_VINCULACIONES_JUDICIALES] AS (
SELECT 
cau.NRO_CAUSA,
CAU.ANO,
CONVERT(NUMERIC(12),CAU.EXPEDIENTE) AS EXPEDIENTE,
CAU.TIPO_CAUSA,
CAU.JUZGADO,
ISNULL(doc.NUMERODOCUMENTO,0) AS NUMERODOCUMENTO,
ISNULL(ben.ID_BENEFICIARIO,0) AS ID_BENEFICIARIO,
CC.JTS_OID_CUENTA AS JTS_OID_CUENTA,
c.CUENTA,
c.CLIENTE,
cli.NUMERODOC AS DOCTITCTA,
c.MONEDA,
c.SUCURSAL
FROM DJ_CAUSAS cau WITH(NOLOCK)
INNER JOIN DJ_CAUSA_CUENTA CC WITH(NOLOCK) ON CC.NRO_CAUSA = cau.NRO_CAUSA
INNER JOIN VW_CUENTAS c WITH(NOLOCK) ON CC.JTS_OID_CUENTA = c.JTS_OID
INNER JOIN VW_CLI_X_DOC cli WITH(NOLOCK) ON cli.CODIGOCLIENTE = c.CLIENTE
LEFT JOIN DJ_BENEFICIARIOS ben WITH(NOLOCK) ON ben.NRO_CAUSA = cau.NRO_CAUSA 
LEFT JOIN CLI_DOCUMENTOSPFPJ doc WITH(NOLOCK) ON ben.ID_BENEFICIARIO = doc.NUMEROPERSONAFJ
WHERE ((cau.tz_lock < 300000000000000 OR cau.tz_lock >= 400000000000000) AND 
(cau.tz_lock < 100000000000000 OR cau.tz_lock >= 200000000000000)) AND 
((ben.tz_lock < 300000000000000 OR ben.tz_lock >= 400000000000000) AND 
(ben.tz_lock < 100000000000000 OR ben.tz_lock >= 200000000000000)) 
AND ISNUMERIC(CAU.EXPEDIENTE) = 1 
AND ((doc.tz_lock < 300000000000000 OR doc.tz_lock >= 400000000000000) AND 
(doc.tz_lock < 100000000000000 OR doc.tz_lock >= 200000000000000))
AND ((CC.tz_lock < 300000000000000 OR CC.tz_lock >= 400000000000000) AND 
(CC.tz_lock < 100000000000000 OR CC.tz_lock >= 200000000000000))
)
')