EXECUTE ('IF OBJECT_ID (''VW_GRUPO_CLIENTE'') IS NOT NULL
	DROP VIEW VW_GRUPO_CLIENTE')

EXECUTE('
CREATE     VIEW [VW_GRUPO_CLIENTE] (GRUPO, 
												CODIGOCLIENTE, 
												NOMBRECLIENTE)
AS 
SELECT LG.GRUPO, 
		C.CODIGOCLIENTE, 
		C.NOMBRECLIENTE
FROM CRE_LIMITEGRUPO  AS LG WITH(NOLOCK)
INNER JOIN CLI_GRUPOSECONOMICOSCLIENTE  AS GE WITH(NOLOCK) ON LG.GRUPO = GE.CODIGOGRUPOECONOMICO
INNER JOIN CLI_CLIENTES  AS C WITH(NOLOCK) ON GE.CODIGOCLIENTE = C.CODIGOCLIENTE
WHERE 
	(	(LG.TZ_LOCK < 300000000000000 OR LG.TZ_LOCK >= 400000000000000) 
	AND (LG.TZ_LOCK < 100000000000000 OR LG.TZ_LOCK >= 200000000000000)) 
AND (	(GE.TZ_LOCK < 300000000000000 OR GE.TZ_LOCK >= 400000000000000) 
	AND (GE.TZ_LOCK < 100000000000000 OR GE.TZ_LOCK >= 200000000000000)) 
AND (	(C.TZ_LOCK < 300000000000000 OR C.TZ_LOCK >= 400000000000000) 
	AND (C.TZ_LOCK < 100000000000000 OR C.TZ_LOCK >= 200000000000000))')

