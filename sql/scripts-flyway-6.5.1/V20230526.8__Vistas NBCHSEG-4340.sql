EXECUTE('
----
IF OBJECT_ID (''dbo.VW_SUCURSALES'') IS NOT NULL
	DROP VIEW dbo.VW_SUCURSALES
--
IF OBJECT_ID (''dbo.VW_MONEDAS'') IS NOT NULL
	DROP VIEW dbo.VW_MONEDAS
--
IF OBJECT_ID (''dbo.VW_PRODUCTOS'') IS NOT NULL
	DROP VIEW dbo.VW_PRODUCTOS
----
')
EXECUTE('
----
CREATE VIEW VW_SUCURSALES (
		SUCURSAL,
		NOMBRE_SUCURSAL
	)
AS

SELECT
	-1 AS SUCURSAL,
	''TODAS'' AS NOMBRE_SUCURSAL

UNION

SELECT 
	S.SUCURSAL,
	S.NOMBRESUCURSAL
FROM 
	SUCURSALES AS S WITH (nolock)
WHERE
	((	S.TZ_LOCK < 100000000000000 OR S.TZ_LOCK >= 200000000000000 ) 
			AND ( S.TZ_LOCK < 300000000000000 OR S.TZ_LOCK >= 400000000000000 )
	)
--
')
EXECUTE('
--
CREATE VIEW VW_MONEDAS (
		MONEDA,
		NOMBRE_MONEDA,
		SIMBOLO,
		ABREVIATURA,
		TIPO_MONEDA
	)
AS

SELECT
	-1 AS MONEDA,
	''TODAS'' AS NOMBRE_MONEDA,
	'''' AS SIMBOLO,
	'''' AS ABREVIATURA,
	'''' AS TIPO_MONEDA

UNION

SELECT
	M.C6399 AS MONEDA,
	M.C6400 AS NOMBRE_MONEDA,
	M.C6401 AS SIMBOLO,
	M.C6402 AS ABREVIATURA,
	OM.DESCRIPCION AS TIPO_MONEDA
FROM 
	MONEDAS AS M WITH (nolock)
LEFT JOIN OPCIONES AS OM WITH (nolock) ON
	OM.NUMERODECAMPO = 6403
	AND OM.IDIOMA = ''E''
	AND OM.OPCIONINTERNA = M.C6403
WHERE
	((	M.TZ_LOCK < 100000000000000 OR M.TZ_LOCK >= 200000000000000 ) 
			AND ( M.TZ_LOCK < 300000000000000 OR M.TZ_LOCK >= 400000000000000 )
	)
--
')
EXECUTE('
--
CREATE VIEW VW_PRODUCTOS (
		PRODUCTO,
		NOMBRE_PRODUCTO,
		TIPO_PRODUCTO,
		RUBRO_OPERATIVO
	)
AS

SELECT
	-1 AS PRODUCTO,
	''TODOS'' AS NOMBRE_PRODUCTO,
	'''' AS TIPO_PRODUCTO,
	0 AS RUBRO_OPERATIVO

UNION

SELECT
	P.C6250 AS PRODUCTO,
	P.C6251 AS NOMBRE_PRODUCTO,
	OP.DESCRIPCION AS TIPO_PRODUCTO,
	P.C6271 AS RUBRO_OPERATIVO
FROM 
	PRODUCTOS AS P WITH (nolock)
LEFT JOIN OPCIONES AS OP WITH (nolock) ON
	OP.NUMERODECAMPO = 6252
	AND OP.IDIOMA = ''E''
	AND OP.OPCIONINTERNA = P.C6252
WHERE
	((	P.TZ_LOCK < 100000000000000 OR P.TZ_LOCK >= 200000000000000 ) 
			AND ( P.TZ_LOCK < 300000000000000 OR P.TZ_LOCK >= 400000000000000 )
	)
----
')