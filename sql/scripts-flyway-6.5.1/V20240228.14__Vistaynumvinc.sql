EXECUTE('
INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (44379, '' '', 0, ''Numerador CRE_VINCULACIONES'', NULL, 10, ''N'', 0, NULL, 0, 19, 0, 0, 0, 0, 0, 0, ''NUM_CRE_VINCULACIONES'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (44380, '' '', 0, ''Numerador CRE_VINCULA_RELACION'', NULL, 10, ''N'', 0, NULL, 0, 19, 0, 0, 0, 0, 0, 0, ''NUM_VINC_REL'', 0, NULL)
')

EXECUTE('
IF OBJECT_ID (''dbo.VW_CRE_VINCULACIONES'') IS NOT NULL
	DROP VIEW dbo.VW_CRE_VINCULACIONES
')

EXECUTE('
CREATE VIEW [dbo].[VW_CRE_VINCULACIONES] (
											   [Id Vinculo],
											   [Tipo de relacion],
											   [Tipo de vinculo],
											   [Persona vinculada],
											   [CUIT CUIL],
											   [Nombre])
AS 
SELECT CV.ID_VINCULO, OP.DESCRIPCION, CVR.DESCRIPCION_VINCULO, CV.ID_PERSONA_VINCULADA, PFJ.NroDocIdent, PFJ.NOMBRE
FROM CRE_VINCULACIONES CV WITH(NOLOCK)
INNER JOIN VW_PERSONAS_FYJ PFJ WITH(NOLOCK) ON CV.ID_PERSONA_VINCULADA = PFJ.NUMEROPERSONA AND CV.TIPO_PERSONA_VINCULADA = PFJ.TIPOPERSONA
INNER JOIN CRE_VINCULOS_RELACIONES CVR WITH(NOLOCK) ON CVR.TIPO_RELACION = CV.TIPO_RELACION AND CVR.ID_VINCULO = CV.TIPO_VINCULO
LEFT JOIN OPCIONES OP WITH(NOLOCK) ON OP.NUMERODECAMPO = 44360 AND OP.IDIOMA = ''E'' AND OP.OPCIONINTERNA = CVR.TIPO_RELACION
WHERE CV.TZ_LOCK = 0
')

EXECUTE('
IF OBJECT_ID (''dbo.VW_CRE_VINCULACIONES_REL'') IS NOT NULL
	DROP VIEW dbo.VW_CRE_VINCULACIONES_REL
')

EXECUTE('
CREATE VIEW [dbo].[VW_CRE_VINCULACIONES_REL] (
											   [Id Relacion],
											   [Tipo de relacion],
											   [Id Vinculo],
											   [Descripcion vinculo])
AS 
SELECT CVR.TIPO_RELACION, OP.DESCRIPCION, CVR.ID_VINCULO, CVR.DESCRIPCION_VINCULO
FROM CRE_VINCULOS_RELACIONES CVR WITH(NOLOCK)
LEFT JOIN OPCIONES OP WITH(NOLOCK) ON OP.NUMERODECAMPO = 44360 AND OP.IDIOMA = ''E'' AND OP.OPCIONINTERNA = CVR.TIPO_RELACION
WHERE CVR.TZ_LOCK = 0
')

EXECUTE('
INSERT INTO dbo.AYUDAS (NUMERODEARCHIVO, NUMERODEAYUDA, DESCRIPCION, FILTRO, MOSTRARTODOS, CAMPOS, CAMPOSVISTA, BASEVISTA, NOMBREVISTA, AYUDAGRANDE)
VALUES (0, 4435, ''VinculosRelaciones'', '''', 0, ''4129R;118;4355R;9103;'', ''Id Relacion;Tipo de relacion;Id Vinculo;Descripcion vinculo;'', ''TOP/CLIENTES'', ''VW_CRE_VINCULACIONES_REL'', 0)

INSERT INTO dbo.AYUDAS (NUMERODEARCHIVO, NUMERODEAYUDA, DESCRIPCION, FILTRO, MOSTRARTODOS, CAMPOS, CAMPOSVISTA, BASEVISTA, NOMBREVISTA, AYUDAGRANDE)
VALUES (0, 4450, ''VW_CRE_VINCULACIONES'', '''', 0, ''4129R;118;9103;618;1963;9104;'', ''Id Vinculo;Tipo de relacion;Tipo de vinculo;Persona vinculada;CUIT CUIL;Nombre;'', ''TOP/CLIENTES'', ''VW_CRE_VINCULACIONES'', 0)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (44381, '' '', 0, ''Ayuda vinculos relaciones'', NULL, 10, ''N'', 0, NULL, 0, 0, 0, 0, 0, 4435, 0, 0, ''AYUD_VINC_REL'', 0, NULL)

INSERT INTO dbo.DICCIONARIO (NUMERODECAMPO, USODELCAMPO, REFERENCIA, DESCRIPCION, PROMPT, LARGO, TIPODECAMPO, DECIMALES, EDICION, CONTABILIZA, CONCEPTO, CALCULO, VALIDACION, TABLADEVALIDACION, TABLADEAYUDA, OPCIONES, TABLA, CAMPO, BASICO, MASCARA)
VALUES (44382, '' '', 0, ''Ayuda vinculos'', NULL, 10, ''N'', 0, NULL, 0, 0, 0, 0, 0, 4450, 0, 0, ''AYUD_VINC'', 0, NULL)
')
