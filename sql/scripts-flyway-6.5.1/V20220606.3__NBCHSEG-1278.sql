EXECUTE('

ALTER PROCEDURE dbo.SP_ITF_ACTUALIZAPERSONA_LEXDOCTOR 
   @P_CUIT VARCHAR(11),
   @P_TIPO_PERSONA VARCHAR(1),
   @P_NRO_PERSONA NUMERIC(12),
   @P_ASIENTO NUMERIC(12),
   @P_USUARIO VARCHAR(10)
AS 
   BEGIN
   
   DECLARE @flag INT;
  
      IF @P_TIPO_PERSONA = ''F''
      	BEGIN
      		SET @flag = (SELECT COUNT(*) FROM CLI_PERSONASFISICAS WHERE NUMEROPERSONAFISICA = @P_NRO_PERSONA AND ESTADO = 0 AND ((TZ_LOCK < 300000000000000 OR TZ_LOCK >= 400000000000000) AND (TZ_LOCK = 0 OR TZ_LOCK >= 200000000000000)));
      	   
      		IF @flag = 1
      			BEGIN
      				UPDATE CLI_PERSONASFISICAS SET SITUACION_JURIDICA = ''S'' WHERE NUMEROPERSONAFISICA = @P_NRO_PERSONA;
      				
      				/* Dependiendo del tipo de persona grabo Tabla BITACORA_PERSONAS_FISICAS o BITACORA_PERSONAS_JURIDICAS */
	      			EXEC dbo.SP_ITF_GRABO_BITACORA_PERSONAS @P_NRO_PERSONA, @P_TIPO_PERSONA, @P_ASIENTO, @P_USUARIO;
      			END
      		ELSE
      			BEGIN
      				UPDATE ITF_HIST_LEXDOCTOR_SITJUD SET DESCR = ''Persona inhabilitada. Cambio no realizado'' WHERE CUIT = @P_CUIT;
      			END
      		
      		
      	END
      	
      ELSE
      	BEGIN
      		SET @flag = (SELECT COUNT(*) FROM CLI_PERSONASJURIDICAS WHERE NUMEROPERSONAJURIDICA = @P_NRO_PERSONA AND ESTADO = 0 AND ((TZ_LOCK < 300000000000000 OR TZ_LOCK >= 400000000000000) AND (TZ_LOCK = 0 OR TZ_LOCK >= 200000000000000)));
      		
      		IF @flag = 1
      			BEGIN
      				UPDATE CLI_PERSONASJURIDICAS SET SITUACION_JURIDICA = ''S'' WHERE NUMEROPERSONAJURIDICA = @P_NRO_PERSONA;
      				
      				/* Dependiendo del tipo de persona grabo Tabla BITACORA_PERSONAS_FISICAS o BITACORA_PERSONAS_JURIDICAS */
	      			EXEC dbo.SP_ITF_GRABO_BITACORA_PERSONAS @P_NRO_PERSONA, @P_TIPO_PERSONA, @P_ASIENTO, @P_USUARIO;
      			END
      		ELSE
      			BEGIN
      				UPDATE ITF_HIST_LEXDOCTOR_SITJUD SET DESCR = ''Persona inhabilitada. Cambio no realizado'' WHERE CUIT = @P_CUIT;
      			END
      		
			    	
      	END      	
   END;
')