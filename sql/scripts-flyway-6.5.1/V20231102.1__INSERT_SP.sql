EXECUTE('
INSERT INTO dbo.ITF_MASTER (TZ_LOCK, ID, DESCRIPCION, OBJ_KETTLE, P0_MODO, P0_TIPO, P0_CAPTION, P0_CONSTANTE, P1_MODO, P1_TIPO, P1_CAPTION, P1_CONSTANTE, P2_MODO, P2_TIPO, P2_CAPTION, P2_CONSTANTE, P3_MODO, P3_TIPO, P3_CAPTION, P3_CONSTANTE, P4_MODO, P4_TIPO, P4_CAPTION, P4_CONSTANTE, P5_MODO, P5_TIPO, P5_CAPTION, P5_CONSTANTE, P6_MODO, P6_TIPO, P6_CAPTION, P6_CONSTANTE, P7_MODO, P7_TIPO, P7_CAPTION, P7_CONSTANTE, P8_MODO, P8_TIPO, P8_CONSTANTE, P8_CAPTION, P9_MODO, P9_TIPO, P9_CAPTION, P9_CONSTANTE, TIPO_OBJ, COMENTARIO, ID_REPORTE, MODO_EJECUCION)
VALUES (0, 229, ''REPORTE ASIENTO CONTABLE'', ''ITF_ASIENTOS_CONTABLES_REPO.kjb'', '''', '''', '''', '' '', '''', '''', '''', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', '' '', ''J'', '' '', 0, ''M'')

INSERT INTO dbo.ITF_MASTER_PARAMETROS (CODIGO, CODIGO_INTERFACE, FUNCIONALIDAD, ALFA_1, ALFA_2, ALFA_3, NUMERICO_1, NUMERICO_2, FECHA, IMPORTE_1, IMPORTE_2, TZ_LOCK)
VALUES (467, 0, ''RPT ASIENTO CONTABLE'', ''DOS'', ''I2000'', ''I2000\CONTABILIDAD\I2000_BANDEJA_CONTABLE_'', 0, 0, NULL, 0, 0, 0)

INSERT INTO dbo.ITF_MASTER_PARAMETROS (CODIGO, CODIGO_INTERFACE, FUNCIONALIDAD, ALFA_1, ALFA_2, ALFA_3, NUMERICO_1, NUMERICO_2, FECHA, IMPORTE_1, IMPORTE_2, TZ_LOCK)
VALUES (466, 0, ''TNB'', ''TNG_BU'', ''TNG_BU\CONTABILIDAD\'', '''', 0, 0, NULL, 0, 0, 0)

INSERT INTO dbo.ITF_MASTER_PARAMETROS (CODIGO, CODIGO_INTERFACE, FUNCIONALIDAD, ALFA_1, ALFA_2, ALFA_3, NUMERICO_1, NUMERICO_2, FECHA, IMPORTE_1, IMPORTE_2, TZ_LOCK)
VALUES (465, 0, ''TNA'', ''TNG_AJUSTE'', ''TNG_AJUSTE\CONTABILIDAD\'', '''', 0, 0, NULL, 0, 0, 0)

INSERT INTO dbo.ITF_MASTER_PARAMETROS (CODIGO, CODIGO_INTERFACE, FUNCIONALIDAD, ALFA_1, ALFA_2, ALFA_3, NUMERICO_1, NUMERICO_2, FECHA, IMPORTE_1, IMPORTE_2, TZ_LOCK)
VALUES (464, 0, ''UNT'', ''UNITRADE'', ''UNITRADE\CONTABILIDAD\'', '''', 0, 0, NULL, 0, 0, 0)

INSERT INTO dbo.ITF_MASTER_PARAMETROS (CODIGO, CODIGO_INTERFACE, FUNCIONALIDAD, ALFA_1, ALFA_2, ALFA_3, NUMERICO_1, NUMERICO_2, FECHA, IMPORTE_1, IMPORTE_2, TZ_LOCK)
VALUES (463, 0, ''DOS'', ''I2000'', ''I2000\CONTABILIDAD\'', '''', 0, 0, NULL, 0, 0, 0)

INSERT INTO dbo.BANDEJA_ORIGENES (ORIGEN, DESCRIPCION, CANAL, PIVOT_, ESTRATEGIA_CONVERSION)
VALUES (''TNA'', ''TNG AJUSTE ASIENTOS CONTABLES'', 0, 0, 4)

INSERT INTO dbo.BANDEJA_ORIGENES (ORIGEN, DESCRIPCION, CANAL, PIVOT_, ESTRATEGIA_CONVERSION)
VALUES (''TNB'', ''TNG BU ASIENTOS CONTABLES'', 0, 0, 4)
')


EXECUTE('

CREATE OR ALTER  PROCEDURE  SP_ITF_TNG_AJUSTE_CONTABLE
 
AS 
BEGIN 

DECLARE @asiento VARCHAR(10), @fecha_asiento DATETIME; --, @sucursal NUMERIC(5,0), @producto NUMERIC(5,0), @cuenta NUMERIC(12,0), @moneda NUMERIC(4,0), @operacion NUMERIC(12,0), @ordinal NUMERIC(6,0); 
DECLARE @idCount INT = (SELECT MIN(ID) FROM ITF_ASIENTOS_EXTERNOS WHERE SATELITE=''TNG_AJUSTE'' AND ESTADO=''S'');
--recorro padron de entrada
SELECT @asiento = ASIENTO, @fecha_asiento=FECHA_ASIENTO
FROM ITF_ASIENTOS_EXTERNOS (nolock) WHERE ID=@idCount;

	WHILE @asiento IS NOT NULL 
	BEGIN	
	
	
	INSERT INTO dbo.BANDEJA_ASIENTOS_IN (ESTADO, ORIGEN, OPERACION, DESCRIPCION, FECHAPROCESO)
	VALUES (''S'', ''TNA'',  8624, (SELECT DESCRIPCION FROM BANDEJA_ORIGENES WHERE ORIGEN=''TNA''), (SELECT FECHAPROCESO FROM PARAMETROS))
	
	INSERT INTO dbo.BANDEJA_MOVS_IN (JTS_OID_ASIENTO, SUCURSAL, PRODUCTO, CUENTA, MONEDA, OPERACION, ORDINAL, CLIENTE, SIGNO, MONTO, CONCEPTO, RUBRO_CONTABLE, fecha_valor, moneda_monto)
	SELECT  (SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''TNA''), s.SUCURSAL, s.PRODUCTO, s.CUENTA, s.MONEDA, s.OPERACION, s.ORDINAL, 0, a.COD_MOVIMIENTO, (a.IMPORTE_DEBE + a.IMPORTE_HABER), CONCAT(''1.18.8 '',a.CONCEPTO_ASIENTO), CONCAT(a.CAPITULO_CONT,a.RUBRO_CONT,a.MONEDA_CONT,a.CUENTA_CONT,a.SUCUENTA_CONT), (SELECT FECHAPROCESO FROM PARAMETROS), a.MONEDA
	FROM ITF_ASIENTOS_EXTERNOS a INNER JOIN SALDOS s ON s.JTS_OID = (SELECT TOP 1 JTS_OID FROM SALDOS WHERE C1730=(CONCAT(a.CAPITULO_CONT,a.RUBRO_CONT,a.MONEDA_CONT,a.CUENTA_CONT,a.SUCUENTA_CONT)) AND MONEDA=a.MONEDA AND SUCURSAL=(SELECT NUMERICO FROM PARAMETROSGENERALES WHERE CODIGO=21))
	WHERE a.ASIENTO=@asiento AND a.FECHA_ASIENTO=@fecha_asiento AND SATELITE=''TNG_AJUSTE'' AND ESTADO=''S''
	ORDER BY NRO_ORDEN
	
	IF(1<(SELECT COUNT(1) FROM BANDEJA_MOVS_IN WHERE JTS_OID_ASIENTO=(SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''TNA'')))
	BEGIN
	UPDATE dbo.ITF_ASIENTOS_EXTERNOS
	SET ESTADO=''P'', ID_LOTE=(SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''TNA'')
	WHERE SATELITE=''TNG_AJUSTE'' AND ESTADO=''S'' AND ASIENTO=@asiento AND @fecha_asiento=FECHA_ASIENTO ;
	END
	ELSE
	BEGIN
	UPDATE dbo.ITF_ASIENTOS_EXTERNOS
	SET ESTADO=''E'', ID_LOTE=(SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''TNA'')
	WHERE SATELITE=''TNG_AJUSTE'' AND ESTADO=''S'' AND ASIENTO=@asiento AND @fecha_asiento=FECHA_ASIENTO;
	DELETE FROM dbo.BANDEJA_ASIENTOS_IN
	WHERE JTS_OID = (SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''TNA'');
	END
	
	
	SET @idCount = NULL;
	SET @asiento= NULL;
	
	SET @idCount  = (SELECT MIN(ID) FROM ITF_ASIENTOS_EXTERNOS WHERE SATELITE=''TNG_AJUSTE'' AND ESTADO=''S'');
	SELECT @asiento = ASIENTO, @fecha_asiento=FECHA_ASIENTO
	FROM ITF_ASIENTOS_EXTERNOS (nolock) WHERE ID=@idCount;
	
	END


END
')

EXECUTE('
CREATE OR  ALTER  PROCEDURE  SP_ITF_TNG_BU_CONTABLE
 
AS 
BEGIN 

DECLARE @asiento VARCHAR(10), @fecha_asiento DATETIME; --, @sucursal NUMERIC(5,0), @producto NUMERIC(5,0), @cuenta NUMERIC(12,0), @moneda NUMERIC(4,0), @operacion NUMERIC(12,0), @ordinal NUMERIC(6,0); 
DECLARE @idCount INT = (SELECT MIN(ID) FROM ITF_ASIENTOS_EXTERNOS WHERE SATELITE=''TNG_BU'' AND ESTADO=''S'');
--recorro padron de entrada
SELECT @asiento = ASIENTO, @fecha_asiento=FECHA_ASIENTO
FROM ITF_ASIENTOS_EXTERNOS (nolock) WHERE ID=@idCount;

	WHILE @asiento IS NOT NULL 
	BEGIN	
	
	
	INSERT INTO dbo.BANDEJA_ASIENTOS_IN (ESTADO, ORIGEN, OPERACION, DESCRIPCION, FECHAPROCESO)
	VALUES (''S'', ''TNB'',  8624, (SELECT DESCRIPCION FROM BANDEJA_ORIGENES WHERE ORIGEN=''TNB''), (SELECT FECHAPROCESO FROM PARAMETROS))
	
	INSERT INTO dbo.BANDEJA_MOVS_IN (JTS_OID_ASIENTO, SUCURSAL, PRODUCTO, CUENTA, MONEDA, OPERACION, ORDINAL, CLIENTE, SIGNO, MONTO, CONCEPTO, RUBRO_CONTABLE, fecha_valor, moneda_monto)
	SELECT  (SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''TNB''), s.SUCURSAL, s.PRODUCTO, s.CUENTA, s.MONEDA, s.OPERACION, s.ORDINAL, 0, a.COD_MOVIMIENTO, (a.IMPORTE_DEBE + a.IMPORTE_HABER), CONCAT(''1.18.7 '',a.CONCEPTO_ASIENTO), CONCAT(a.CAPITULO_CONT,a.RUBRO_CONT,a.MONEDA_CONT,a.CUENTA_CONT,a.SUCUENTA_CONT), (SELECT FECHAPROCESO FROM PARAMETROS), a.MONEDA
	FROM ITF_ASIENTOS_EXTERNOS a INNER JOIN SALDOS s ON s.JTS_OID = (SELECT TOP 1 JTS_OID FROM SALDOS WHERE C1730=(CONCAT(a.CAPITULO_CONT,a.RUBRO_CONT,a.MONEDA_CONT,a.CUENTA_CONT,a.SUCUENTA_CONT)) AND MONEDA=a.MONEDA AND SUCURSAL=(SELECT NUMERICO FROM PARAMETROSGENERALES WHERE CODIGO=21))
	WHERE a.ASIENTO=@asiento AND a.FECHA_ASIENTO=@fecha_asiento AND SATELITE=''TNG_BU'' AND ESTADO=''S''
	ORDER BY NRO_ORDEN
	
	IF(1<(SELECT COUNT(1) FROM BANDEJA_MOVS_IN WHERE JTS_OID_ASIENTO=(SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''TNA'')))
	BEGIN
	UPDATE dbo.ITF_ASIENTOS_EXTERNOS
	SET ESTADO=''P'', ID_LOTE=(SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''TNB'')
	WHERE SATELITE=''TNG_BU'' AND ESTADO=''S'' AND ASIENTO=@asiento AND @fecha_asiento=FECHA_ASIENTO ;
	END
	ELSE
	BEGIN
	UPDATE dbo.ITF_ASIENTOS_EXTERNOS
	SET ESTADO=''E'', ID_LOTE=(SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''TNB'')
	WHERE SATELITE=''TNG_BU'' AND ESTADO=''S'' AND ASIENTO=@asiento AND @fecha_asiento=FECHA_ASIENTO;
	DELETE FROM dbo.BANDEJA_ASIENTOS_IN
	WHERE JTS_OID = (SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''TNB'');
	END
	
	
	SET @idCount = NULL;
	SET @asiento= NULL;
	
	SET @idCount  = (SELECT MIN(ID) FROM ITF_ASIENTOS_EXTERNOS WHERE SATELITE=''TNG_BU'' AND ESTADO=''S'');
	SELECT @asiento = ASIENTO, @fecha_asiento=FECHA_ASIENTO
	FROM ITF_ASIENTOS_EXTERNOS (nolock) WHERE ID=@idCount;
	
	END


END
')

EXECUTE('
CREATE OR ALTER   PROCEDURE SP_ITF_UNTD_ASIENTOS_CONTABLES
 
AS 
BEGIN 

DECLARE @asiento VARCHAR(10), @fecha_asiento DATETIME; --, @sucursal NUMERIC(5,0), @producto NUMERIC(5,0), @cuenta NUMERIC(12,0), @moneda NUMERIC(4,0), @operacion NUMERIC(12,0), @ordinal NUMERIC(6,0); 
DECLARE @idCount INT = (SELECT MIN(ID) FROM ITF_ASIENTOS_EXTERNOS WHERE SATELITE=''UNITRADE'' AND ESTADO=''S'');
--recorro padron de entrada
SELECT @asiento = ASIENTO, @fecha_asiento=FECHA_ASIENTO
FROM ITF_ASIENTOS_EXTERNOS (nolock) WHERE ID=@idCount;

	WHILE @asiento IS NOT NULL 
	BEGIN	
	
	
	INSERT INTO dbo.BANDEJA_ASIENTOS_IN (ESTADO, ORIGEN, OPERACION, DESCRIPCION, FECHAPROCESO)
	VALUES (''S'', ''UNT'',  8624, (SELECT DESCRIPCION FROM BANDEJA_ORIGENES WHERE ORIGEN=''UNT''), (SELECT FECHAPROCESO FROM PARAMETROS))
	
	INSERT INTO dbo.BANDEJA_MOVS_IN (JTS_OID_ASIENTO, SUCURSAL, PRODUCTO, CUENTA, MONEDA, OPERACION, ORDINAL, CLIENTE, SIGNO, MONTO, CONCEPTO, RUBRO_CONTABLE, fecha_valor, moneda_monto)
	SELECT  (SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''UNT''), s.SUCURSAL, s.PRODUCTO, s.CUENTA, s.MONEDA, s.OPERACION, s.ORDINAL, 0, a.COD_MOVIMIENTO, (a.IMPORTE_DEBE + a.IMPORTE_HABER), CONCAT(''1.19.6 TG '',a.CONCEPTO_ASIENTO), CONCAT(a.CAPITULO_CONT,a.RUBRO_CONT,a.MONEDA_CONT,a.CUENTA_CONT,a.SUCUENTA_CONT), (SELECT FECHAPROCESO FROM PARAMETROS), a.MONEDA
	FROM ITF_ASIENTOS_EXTERNOS a INNER JOIN SALDOS s ON s.JTS_OID = (SELECT TOP 1 JTS_OID FROM SALDOS WHERE C1730=(CONCAT(a.CAPITULO_CONT,a.RUBRO_CONT,a.MONEDA_CONT,a.CUENTA_CONT,a.SUCUENTA_CONT)) AND MONEDA=a.MONEDA AND SUCURSAL=(SELECT NUMERICO FROM PARAMETROSGENERALES WHERE CODIGO=21))
	WHERE a.ASIENTO=@asiento AND a.FECHA_ASIENTO=@fecha_asiento AND SATELITE=''UNITRADE'' AND ESTADO=''S''
	ORDER BY NRO_ORDEN
	
	IF(1<(SELECT COUNT(1) FROM BANDEJA_MOVS_IN WHERE JTS_OID_ASIENTO=(SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''UNT'')))
	BEGIN
	UPDATE dbo.ITF_ASIENTOS_EXTERNOS
	SET ESTADO=''P'', ID_LOTE=(SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''UNT'')
	WHERE SATELITE=''UNITRADE'' AND ESTADO=''S'' AND ASIENTO=@asiento AND @fecha_asiento=FECHA_ASIENTO ;
	END
	ELSE
	BEGIN
	UPDATE dbo.ITF_ASIENTOS_EXTERNOS
	SET ESTADO=''E'', ID_LOTE=(SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''UNT'')
	WHERE SATELITE=''UNITRADE'' AND ESTADO=''S'' AND ASIENTO=@asiento AND @fecha_asiento=FECHA_ASIENTO;
	DELETE FROM dbo.BANDEJA_ASIENTOS_IN
	WHERE JTS_OID = (SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''UNT'');
	END
	
	
	SET @idCount = NULL;
	SET @asiento= NULL;
	
	SET @idCount  = (SELECT MIN(ID) FROM ITF_ASIENTOS_EXTERNOS WHERE SATELITE=''UNITRADE'' AND ESTADO=''S'');
	SELECT @asiento = ASIENTO, @fecha_asiento=FECHA_ASIENTO
	FROM ITF_ASIENTOS_EXTERNOS (nolock) WHERE ID=@idCount;
	
	END
	
END
')

EXECUTE('
CREATE OR ALTER   PROCEDURE SP_ITF_I2000_ASIENTOS_CONTABLES
 
AS 
BEGIN 

DECLARE @asiento VARCHAR(10), @fecha_asiento DATETIME; --, @sucursal NUMERIC(5,0), @producto NUMERIC(5,0), @cuenta NUMERIC(12,0), @moneda NUMERIC(4,0), @operacion NUMERIC(12,0), @ordinal NUMERIC(6,0); 
DECLARE @idCount INT = (SELECT MIN(ID) FROM ITF_ASIENTOS_EXTERNOS WHERE SATELITE=''I2000'' AND ESTADO=''S'');
--recorro padron de entrada
SELECT @asiento = ASIENTO, @fecha_asiento=FECHA_ASIENTO
FROM ITF_ASIENTOS_EXTERNOS (nolock) WHERE ID=@idCount;

	WHILE @asiento IS NOT NULL 
	BEGIN	
	
	
	INSERT INTO dbo.BANDEJA_ASIENTOS_IN (ESTADO, ORIGEN, OPERACION, DESCRIPCION, FECHAPROCESO)
	VALUES (''S'', ''DOS'',  8624, (SELECT DESCRIPCION FROM BANDEJA_ORIGENES WHERE ORIGEN=''DOS''), (SELECT FECHAPROCESO FROM PARAMETROS))
	
	INSERT INTO dbo.BANDEJA_MOVS_IN (JTS_OID_ASIENTO, SUCURSAL, PRODUCTO, CUENTA, MONEDA, OPERACION, ORDINAL, CLIENTE, SIGNO, MONTO, CONCEPTO, RUBRO_CONTABLE, fecha_valor, moneda_monto)
	SELECT  (SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''DOS''), s.SUCURSAL, s.PRODUCTO, s.CUENTA, s.MONEDA, s.OPERACION, s.ORDINAL, 0, a.COD_MOVIMIENTO, (a.IMPORTE_DEBE + a.IMPORTE_HABER), CONCAT(''1.11.8 '',a.CONCEPTO_ASIENTO), CONCAT(a.CAPITULO_CONT,a.RUBRO_CONT,a.MONEDA_CONT,a.CUENTA_CONT,a.SUCUENTA_CONT), (SELECT FECHAPROCESO FROM PARAMETROS), a.MONEDA
	FROM ITF_ASIENTOS_EXTERNOS a INNER JOIN SALDOS s ON s.JTS_OID = (SELECT TOP 1 JTS_OID FROM SALDOS WHERE C1730=(CONCAT(a.CAPITULO_CONT,a.RUBRO_CONT,a.MONEDA_CONT,a.CUENTA_CONT,a.SUCUENTA_CONT)) AND MONEDA=a.MONEDA AND SUCURSAL=(SELECT NUMERICO FROM PARAMETROSGENERALES WHERE CODIGO=21))
	WHERE a.ASIENTO=@asiento AND a.FECHA_ASIENTO=@fecha_asiento AND SATELITE=''I2000'' AND ESTADO=''S''
	ORDER BY NRO_ORDEN
	
	IF(1<(SELECT COUNT(1) FROM BANDEJA_MOVS_IN WHERE JTS_OID_ASIENTO=(SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''DOS'')))
	BEGIN
	UPDATE dbo.ITF_ASIENTOS_EXTERNOS
	SET ESTADO=''P'', ID_LOTE=(SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''DOS'')
	WHERE SATELITE=''I2000'' AND ESTADO=''S'' AND ASIENTO=@asiento AND @fecha_asiento=FECHA_ASIENTO ;
	END
	ELSE
	BEGIN
	UPDATE dbo.ITF_ASIENTOS_EXTERNOS
	SET ESTADO=''E'', ID_LOTE=(SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''DOS'')
	WHERE SATELITE=''I2000'' AND ESTADO=''S'' AND ASIENTO=@asiento AND @fecha_asiento=FECHA_ASIENTO;
	DELETE FROM dbo.BANDEJA_ASIENTOS_IN
	WHERE JTS_OID = (SELECT MAX(JTS_OID) FROM BANDEJA_ASIENTOS_IN WHERE ESTADO=''S'' AND ORIGEN=''DOS'');
	END
	
	
	SET @idCount = NULL;
	SET @asiento= NULL;
	
	SET @idCount  = (SELECT MIN(ID) FROM ITF_ASIENTOS_EXTERNOS WHERE SATELITE=''I2000'' AND ESTADO=''S'');
	SELECT @asiento = ASIENTO, @fecha_asiento=FECHA_ASIENTO
	FROM ITF_ASIENTOS_EXTERNOS (nolock) WHERE ID=@idCount;
	
	END
  
END
')