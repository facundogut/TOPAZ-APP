EXECUTE('
IF OBJECT_ID (''dbo.VW_SOLICITUD_CUENTAS_LINK'') IS NOT NULL
	DROP VIEW dbo.VW_SOLICITUD_CUENTAS_LINK
')

EXECUTE('
CREATE   VIEW [dbo].[VW_SOLICITUD_CUENTAS_LINK] AS
SELECT  DISTINCT
		TC.ID_SOLICITUD AS [Id Solicitud],
		SL.NRO_TARJETA_BASE AS [Tarjeta Base],
		SL.NRO_TARJETA_COMPLETA AS [Tarjeta Completa],
		TC.NRO_CUENTA AS [Cuenta],
		VS.NOMBRE_CUENTA AS [Denominación Cuenta], 
		TC.TIPO_CUENTA AS [Tipo Cuenta PBF],
		TC.NUMERO_CUENTA_PBF AS [Número cuenta PBF],
		ET.DESCRIPCION AS [Estado] 
FROM TJD_SOLICITUD_CUENTAS_LINK TC WITH(nolock) 
INNER JOIN TJD_SOLICITUD_LINK SL WITH(nolock) ON TC.ID_SOLICITUD = SL.ID_SOLICITUD
INNER JOIN VTA_SALDOS VS WITH(nolock) ON TC.NUMERO_CUENTA_PBF = VS.CTA_REDLINK 
INNER JOIN TJD_ESTADO_TARJETA_CUENTA ET WITH(nolock) ON TC.ESTADO_CUENTA = ET.ESTADO
')

