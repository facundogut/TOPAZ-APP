EXECUTE('
IF OBJECT_ID (''dbo.VW_DSCCLASETARJETAS'') IS NOT NULL
	DROP VIEW dbo.VW_DSCCLASETARJETAS
')
EXECUTE('
CREATE   VIEW [dbo].[VW_DSCCLASETARJETAS] 
AS
SELECT
	T.TITULARIDAD,
	T.ID_TARJETA,
	T.NRO_CLIENTE,
	T.TIPO_TARJETA,
	TI.DESCRIPCION,
	C.Descripcion AS CLASE,
	T.NOMBRE_TARJETA,
	T.PERMISO,
	P.DESCRIPCION AS DESCRIPCION_PERMISO,
	T.ESTADO,
	T.COD_PAQUETE,
	T.NRO_PERSONA
FROM TJD_TARJETAS AS T WITH (NOLOCK)
LEFT JOIN TJD_PERMISOS AS P WITH (NOLOCK) ON 
	P.SUB_TIPO = T.PERMISO
	AND ((P.tz_lock < 300000000000000 OR P.tz_lock >= 400000000000000)
	AND (P.tz_lock < 100000000000000 OR P.tz_lock >= 200000000000000)) 
INNER JOIN TJD_TIPO_TARJETA AS TI WITH (NOLOCK) ON 
	TI.TIPO_TARJETA = T.TIPO_TARJETA
	AND ((TI.tz_lock < 300000000000000 OR TI.tz_lock >= 400000000000000)
	AND (TI.tz_lock < 100000000000000 OR TI.tz_lock >= 200000000000000))
INNER JOIN TJD_CLASE AS C WITH (NOLOCK) ON 
	C.Clave = TI.CLASE
	AND ((C.tz_lock < 300000000000000 OR C.tz_lock >= 400000000000000)
	AND (C.tz_lock < 100000000000000 OR C.tz_lock >= 200000000000000))
WHERE 
	(	(T.tz_lock < 300000000000000 OR T.tz_lock >= 400000000000000)
	AND (T.tz_lock < 100000000000000	OR T.tz_lock >= 200000000000000))
')



