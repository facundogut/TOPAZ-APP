EXECUTE('
CREATE OR ALTER FUNCTION dbo.saldoAFechaINFORME_LELIQ (@informe VARCHAR(15), @fch DATETIME, @codigo VARCHAR(15)) 
RETURNS NUMERIC(15,2)
AS
BEGIN
	
	DECLARE @fch_proceso DATETIME = @fch
	DECLARE @saldo NUMERIC(15,2) = 0		
	
	DECLARE @mes INT  = month(@fch_proceso);
	DECLARE @anio INT = year(@fch_proceso);

	SET @saldo = (SELECT SUM(cbr.SALDOFINMESMN) 
					FROM CO_BALANCE_RESULTADOS cbr
	--				INNER JOIN CO_BALANCE_ESTRUCTURA CBE ON 
	--				cbr.CODIGO_INTERNO = CBE.CODIGO_INTERNO
	--SUBSTRING(CAST(GR.RUBROCONTABLE AS VARCHAR(15)), 1, (len(CBE.CODIGO_INTERNO)))  = CBE.CODIGO_INTERNO 		
					WHERE cbr.FECHA = @fch_proceso AND cbr.CODIGO_INTERNO = @codigo 
				);
	--AND CBE.ID_BCE = 2
	--AND RIP.INFORME = @informe 
	
	--SET @saldo = (SELECT SUM(GR.SALDO_AJUSTADO) FROM GRL_SALDOS_DIARIOS GR 
	--INNER JOIN CODIGOAGRUPADOR CA ON 
	--SUBSTRING(CAST(GR.RUBROCONTABLE AS VARCHAR(15)), 1, (len(CA.AGRUPADOR))) = SUBSTRING(CAST(CA.AGRUPADOR AS VARCHAR(15)), 1, (len(CA.AGRUPADOR)))		
	--WHERE GR.FECHA = @fch_proceso AND CA.INFORME = @informe AND CA.codigo=@codigo);	
	
	--SET @saldo = (SELECT SUM(RB.IMPORTE) FROM RRII_BALANCE RB INNER JOIN CODIGOAGRUPADOR CA ON 
	--SUBSTRING(CAST(RB.CUENTA AS VARCHAR(15)), 1, (len(CA.AGRUPADOR))) = SUBSTRING(CAST(CA.AGRUPADOR AS VARCHAR(15)), 1, (len(CA.AGRUPADOR)))			
	--WHERE RB.NOMBRE_REPORTE = ''BALANCE'' AND RB.FECHA = @fch_proceso AND CA.INFORME=''ESTADO_SIT'' AND CA.codigo=@codigo);
	
	RETURN @saldo
END
')