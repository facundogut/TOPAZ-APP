EXECUTE ('
CREATE OR ALTER VIEW [dbo].[VW_PFPJ_DOCUMENTOS] (
												   TIPODOC, 
												   NUMERODOC, 
												   NUMEROPERSONA, 
												   NIVELAPERTURA, 
												   TIPOPERSONA, 
												   NOMBRE, 
												   ESTADO,
												   MOTIVO_INHABILITADO)
AS 
SELECT TOP 9223372036854775807 WITH TIES 
    V.TIPODOCUMENTO AS TIPODOC, 
    V.NUMERODOCUMENTO AS NUMERODOC, 
    V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
    CASE U.NIVEL_APERTURA
        WHEN 0 THEN ''REGISTRO''
        WHEN 1 THEN ''BÁSICO''
        WHEN 3 THEN ''ACTIVOS''
    END AS NIVELAPERTURA, 
    V.TIPOPERSONA, 
    (U.APELLIDOPATERNO+ '' '' +U.PRIMERNOMBRE) AS NOMBRE,
    CASE U.ESTADO
      	WHEN 0 THEN ''HABILITADO''
        WHEN 1 THEN ''INHABILITADO''
    END AS ESTADO,   
    CASE U.MOTIVO_INHABILITADO
      	WHEN 1 THEN ''INHABILITADO POR EL BCRA''
        WHEN 2 THEN ''INHABILITADO POR FALLECIMIENTO''
        WHEN 3 THEN ''INHABILITADO UIF''
        WHEN 4 THEN ''INHABILITADO TERRORISMO''
        WHEN 5 THEN ''INHABILITACION ADMINISTRATIVA''
        WHEN 7 THEN ''INHABILITACION SANCIONADOS BCRA''
        WHEN 8 THEN ''INHABILITACION RIESGO ALTO IGR''
    END AS MOTIVO_INHABILITADO
FROM dbo.CLI_PERSONASFISICAS  AS U WITH(NOLOCK)
INNER JOIN  dbo.CLI_DOCUMENTOSPFPJ  AS V WITH(NOLOCK) 
										ON U.NUMEROPERSONAFISICA = V.NUMEROPERSONAFJ
										AND ((U.TZ_LOCK < 300000000000000 OR U.TZ_LOCK >= 400000000000000) AND (U.TZ_LOCK < 100000000000000 OR U.TZ_LOCK >= 200000000000000))
										AND V.TIPOPERSONA = ''F''
										AND ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000))
ORDER BY NUMEROPERSONA
UNION ALL
SELECT TOP 9223372036854775807 WITH TIES 
    V.TIPODOCUMENTO AS TIPODOC, 
    V.NUMERODOCUMENTO AS NUMERODOC, 
    V.NUMEROPERSONAFJ AS NUMEROPERSONA, 
    CASE T.NIVEL_APERTURA
        WHEN 1 THEN ''BÁSICO''
        WHEN 3 THEN ''ACTIVOS''
        WHEN 4 THEN ''INST.FINANCIERA''
    END AS NIVELAPERTURA, 
    V.TIPOPERSONA, 
    T.RAZONSOCIAL AS NOMBRE,  
    CASE T.ESTADO
      	WHEN 0 THEN ''HABILITADO''
        WHEN 1 THEN ''INHABILITADO''
    END AS ESTADO,   
    CASE T.MOTIVO_INHABILITADO
      	WHEN 1 THEN ''INHABILITADO POR EL BCRA''
        WHEN 3 THEN ''INHABILITADO UIF''
        WHEN 4 THEN ''INHABILITADO TERRORISMO''
        WHEN 5 THEN ''INHABILITACION ADMINISTRATIVA''
        WHEN 6 THEN ''P/LIQ TOTAL DE LA SOCIEDAD''
        WHEN 7 THEN ''INHABILITACION SANCIONADOS BCRA''
        WHEN 8 THEN ''INHABILITACION RIESGO ALTO IGR''
    END AS MOTIVO_INHABILITADO
FROM dbo.CLI_PERSONASJURIDICAS  AS T WITH (NOLOCK)
INNER JOIN dbo.CLI_DOCUMENTOSPFPJ  AS V WITH (NOLOCK) 
									ON T.NUMEROPERSONAJURIDICA = V.NUMEROPERSONAFJ 
									AND (V.TIPOPERSONA = ''J'' OR V.TIPOPERSONA = ''I'')
									AND ((T.TZ_LOCK < 300000000000000 OR T.TZ_LOCK >= 400000000000000) AND (T.TZ_LOCK < 100000000000000 OR T.TZ_LOCK >= 200000000000000))
									AND ((V.TZ_LOCK < 300000000000000 OR V.TZ_LOCK >= 400000000000000) AND (V.TZ_LOCK < 100000000000000 OR V.TZ_LOCK >= 200000000000000))
ORDER BY NUMEROPERSONA;


')