EXECUTE('
CREATE OR ALTER      PROCEDURE [dbo].[SP_ITF_SOS_CLIENTES_CONT]
	@FechaIni VARCHAR(8),
	@FechaFin VARCHAR(8)
AS
  DECLARE @PERIODO VARCHAR(6);
  DECLARE @FECHAPROCESO VARCHAR(8);
   
BEGIN

  SELECT @FECHAPROCESO = CONVERT(VARCHAR, FECHAPROCESO, 112) FROM PARAMETROS
  
  SET @PERIODO = SUBSTRING(CONVERT(VARCHAR, @FechaIni, 112),1,6);
  
	--Limpiamos por si hay reproceso
	DELETE FROM SOS_CLIENTES_CONT
	WHERE PERIODO = @PERIODO;

	INSERT INTO SOS_CLIENTES_CONT
	--NATURAL
	SELECT DISTINCT EMPRESA,
	@PERIODO AS PERIODO,
	@FECHAPROCESO AS FECHADEINFORMACION,
	IDENTTRIBUTARIATIPO,
	IDENTTRIBUTARIANUMERO,
	DOCIDENTIFICATORIATIPO,
	DOCIDENTIFICATORIANUMERO,
	DENOMINACION,
	DOMICILIOCALLE,
	DOMICILIONUMERO,
	DOMICILIOPISO,
	DOMICILIODPTOOFICINA,
	DOMICILIOCODIGOPOSTAL,
	DOMICILIOLOCALIDAD,
	DOMICILIOPROVINCIA,
	DOMICIOLIOPAISSWFIT,
	CODIGOACTIVIDAD,
	CODIGOACTIVIDADSEC,
	RESIDENCIA,
	CODIGOAREATEL,
	CARACTERISTICATEL,
	TELEFONO,
	FAX,
	TELEX,
	EMAIL,
	SEXO,
	ESTADOCIVIL,
	CODIGOACTIVIDADINTERNO,
	FECHAALTA,
	FECHABAJA,
	SUC_ALTA,
	CODIGOPAIS,
	TIPOCLIENTE,
	MARCAEMPLEADO,
	PEP,
	SUJETOOBLIGADO,
	CONST_INSCRIP_SSOO,
	CODIGOACTIVIDADAFIP,
	CODIGOACTIVIDADAFIPSEC,
	FORMAJURIDICA,
	SECTORBCRA,
	APELLIDO,
	NOMBRE,
	FECHACONSTITUCIONSOCIEDAD,
	TIPOSSOO,
	DECJURSSOO,
	CATEGORIAIVA,
	MARCASUELDO,
	TAMANIOEMPRESA,
	CLIMONTRIBIVA,
	CODCLIENTE
	FROM SOS_CLIENTES
	WHERE FECHADEINFORMACION BETWEEN @FechaIni AND @FechaFin
	
END
')