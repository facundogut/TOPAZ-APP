EXECUTE('
IF OBJECT_ID (''dbo.VW_RRII_TOTALES_ANEXO_12'') IS NOT NULL
	DROP VIEW dbo.VW_RRII_TOTALES_ANEXO_12
')
EXECUTE('
CREATE     VIEW [dbo].[VW_RRII_TOTALES_ANEXO_12] AS
--4)
SELECT 4 AS NRO_CAMPO, 
	SUM(VR1.MONTODEPOSITO) AS SUM_CONT,
	VR1.FECHA AS FECHA
	FROM VW_RRII_ANEXO_12_RENGLON1 VR1 
GROUP BY 
	VR1.FECHA
	
UNION ALL
--5)
SELECT 5 AS NRO_CAMPO, 
		SUM(GS.SALDO_AJUSTADO) AS SUM_CONT, 
		GS.FECHA AS FECHA
FROM GRL_SALDOS_DIARIOS GS WITH(NOLOCK) 
INNER JOIN SALDOS S WITH(NOLOCK) ON 
	GS.SALDOS_JTS_OID = S.JTS_OID 
INNER JOIN VTA_SALDOS VS WITH(NOLOCK) ON S.JTS_OID = VS.JTS_OID_SALDO 
WHERE S.C1785 = 4 AND
	GS.SALDO_AJUSTADO!=0
	AND VS.FONDOGARANTIA = ''S''
GROUP BY 
	GS.FECHA

UNION ALL
--8)
SELECT
 	8 AS NRO_CAMPO,
	SUM(GS.SALDO_AJUSTADO) AS SUM_CONT,
	GS.FECHA AS FECHA
FROM
	GRL_SALDOS_DIARIOS GS WITH(NOLOCK)
INNER JOIN SALDOS S WITH(NOLOCK) ON
	GS.SALDOS_JTS_OID = S.JTS_OID 
	AND S.C1785 IN (2, 3, 4)
	AND GS.TZ_LOCK = S.TZ_LOCK
INNER JOIN VTA_SALDOS VS WITH(NOLOCK) ON
	S.JTS_OID = VS.JTS_OID_SALDO
	AND VS.FONDOGARANTIA !=''S''
	AND GS.TZ_LOCK = VS.TZ_LOCK
WHERE 
	GS.TZ_LOCK=0 AND
	GS.SALDO_AJUSTADO!=0
GROUP BY 
	GS.FECHA
	
UNION ALL
--10) 
SELECT
	10 AS NRO_CAMPO,
	COUNT(GS.SALDOS_JTS_OID) AS SUM_CONT,
	GS.FECHA AS FECHA
FROM
	GRL_SALDOS_DIARIOS GS WITH(NOLOCK)
INNER JOIN SALDOS S WITH(NOLOCK) ON
	GS.SALDOS_JTS_OID = S.JTS_OID AND
	GS.MONEDA = S.MONEDA AND
	GS.TZ_LOCK=S.TZ_LOCK
WHERE
	GS.TZ_LOCK=0
	AND S.C1785 = 4
	AND GS.MONEDA =(SELECT MONNAC FROM PARAMETROS WITH (NOLOCK)) AND
	GS.SALDO_AJUSTADO!=0
GROUP BY 
	GS.FECHA

UNION ALL
--11)
SELECT
	11 AS NRO_CAMPO,
	COUNT(GS.SALDOS_JTS_OID) AS SUM_CONT,
	GS.FECHA AS FECHA
FROM
	GRL_SALDOS_DIARIOS GS WITH(NOLOCK)
INNER JOIN SALDOS S WITH(NOLOCK) ON
	GS.SALDOS_JTS_OID = S.JTS_OID AND
	GS.MONEDA = S.MONEDA AND
	GS.TZ_LOCK=S.TZ_LOCK 
WHERE
	GS.TZ_LOCK=0
	AND S.C1785 = 4
	AND GS.MONEDA NOT IN (988,999,(SELECT MONNAC FROM PARAMETROS WITH (NOLOCK))) AND
	GS.SALDO_AJUSTADO!=0
GROUP BY 
	GS.FECHA
')