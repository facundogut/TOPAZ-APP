


-- Parche_NUNBCHACO_195

create table CON_DETALLES_UVA_UVI
 	 	(TZ_LOCK NUMERIC (15) DEFAULT ((0)) NOT NULL,
 	 	 NUMERAL NUMERIC(15,0),
 SALDO_JTS_OID     NUMERIC(10,0)  NOT NULL,
 ASIENTO NUMERIC(10,0) DEFAULT ((0)),
 FECHAPROCESO DATETIME NOT NULL,
 ORDINAL NUMERIC (10,0),
 SUBASIENTO NUMERIC (10,0),
 SUCURSAL NUMERIC (5,0),
 TRREAL NUMERIC (5,0),
 	 	 DEBITO     NUMERIC(15,2)	DEFAULT ((0)),
 CREDITO     NUMERIC(15,2)	DEFAULT ((0)),
 REMANENTE NUMERIC(15,2) DEFAULT ((0)),
 FECHA_ACTUALIZADO DATETIME
 CONSTRAINT PK_CON_DETALLES_UVA_UVI PRIMARY KEY (NUMERAL, SALDO_JTS_OID, FECHAPROCESO));

create table CON_PROCESADO_UVA_UVI
 	 	(SALDO_JTS_OID NUMERIC(10,0) NOT NULL,
 FECHAPROCESO DATETIME NOT NULL
CONSTRAINT PK_CON_PROCESADO_UVA_UVI PRIMARY KEY (SALDO_JTS_OID, FECHAPROCESO));

create table CON_HISTORICO_UVA_UVI
(TZ_LOCK NUMERIC (15) DEFAULT ((0)) NOT NULL,
 NUMERAL NUMERIC(15,0)  NOT NULL,
   SALDO_JTS_OID     NUMERIC(10,0) NOT NULL,
   ASIENTO NUMERIC(10,0) DEFAULT ((0)),
   FECHAPROCESO DATETIME NOT NULL,
   ORDINAL NUMERIC (10,0),
   SUBASIENTO NUMERIC (10,0),
   SUCURSAL NUMERIC (5,0),
   TRREAL NUMERIC (5,0),
 DEBITO     NUMERIC(15,2)	DEFAULT ((0)),
   CREDITO     NUMERIC(15,2)	DEFAULT ((0)),
   REMANENTE NUMERIC(15,2) DEFAULT ((0)),
   FECHA_ACTUALIZADO DATETIME,
   FECHA_FIN_MES DATETIME NOT NULL
  CONSTRAINT PK_CON_HISTORICO_UVA_UVI PRIMARY KEY (NUMERAL, SALDO_JTS_OID, FECHAPROCESO, FECHA_FIN_MES));

-- Depura e Inserta registros en PARAMETROS_JTS
DELETE PARAMETROS_JTS WHERE FUNCIONALIDAD = 'AJUSTE_Y_REGISTRO_UVA_UVI';

INSERT INTO dbo.PARAMETROS_JTS (FUNCIONALIDAD, PARAMETRO, VALOR, TZ_LOCK)
VALUES ('AJUSTE_Y_REGISTRO_UVA_UVI', 'DESCRIPCION', 'Actualizacion de registro historico UVA UVI', 0);

INSERT INTO dbo.PARAMETROS_JTS (FUNCIONALIDAD, PARAMETRO, VALOR, TZ_LOCK)
VALUES ('AJUSTE_Y_REGISTRO_UVA_UVI', 'OPERACION', '25', 0);

INSERT INTO dbo.PARAMETROS_JTS (FUNCIONALIDAD, PARAMETRO, VALOR, TZ_LOCK)
VALUES ('AJUSTE_Y_REGISTRO_UVA_UVI', 'CANAL', '0', 0);

INSERT INTO parametros_jts (FUNCIONALIDAD, PARAMETRO, VALOR, TZ_LOCK) 
VALUES ('AJUSTE_Y_REGISTRO_UVA_UVI', 'NUMERADOR', '1', 0);

DELETE OPERACIONES WHERE NOMBRE = 'Registro Movim UVA UVI';

INSERT INTO OPERACIONES (TITULO, IDENTIFICACION, NOMBRE, DESCRIPCION, MNEMOTECNICO, AUTORIZACION, FORMULARIOPRINCIPAL, PROXOPERACION, ESTADO, TZ_LOCK, COPIAS, SUBOPERACION, PERMITEBAJA, COMPORTAMIENTOENCIERRE, REQUIERECONTRASENA, PERMITECONCURRENTE, PERMITEESTADODIFERIDO)
VALUES (8600 , 25 , 'Registro Movim UVA UVI', 'Registro uva uvi', 25, 'N', NULL, NULL, 'P', 0, NULL, 0, 'S', 'N', 'N', 'S', 'S');

DELETE PARAMETROS_JTS WHERE FUNCIONALIDAD = 'CONTABILIDAD_AJUSTES_UVA_UVI';

INSERT INTO dbo.PARAMETROS_JTS (FUNCIONALIDAD, PARAMETRO, VALOR, TZ_LOCK)
VALUES ('CONTABILIDAD_AJUSTES_UVA_UVI', 'DESCRIPCION', 'Contabilizacion de ajustes UVA UVI', 0);

INSERT INTO dbo.PARAMETROS_JTS (FUNCIONALIDAD, PARAMETRO, VALOR, TZ_LOCK)
VALUES ('CONTABILIDAD_AJUSTES_UVA_UVI', 'OPERACION', '26', 0);

INSERT INTO dbo.PARAMETROS_JTS (FUNCIONALIDAD, PARAMETRO, VALOR, TZ_LOCK)
VALUES ('CONTABILIDAD_AJUSTES_UVA_UVI', 'CANAL', '0', 0);

INSERT INTO parametros_jts (FUNCIONALIDAD, PARAMETRO, VALOR, TZ_LOCK) 
VALUES ('CONTABILIDAD_AJUSTES_UVA_UVI', 'PIVOT_AJUSTE_UVA_UVI', '1', 0);

DELETE OPERACIONES WHERE NOMBRE = 'Cont de ajustes UVA UVI';

INSERT INTO OPERACIONES (TITULO, IDENTIFICACION, NOMBRE, DESCRIPCION, MNEMOTECNICO, AUTORIZACION, FORMULARIOPRINCIPAL, PROXOPERACION, ESTADO, TZ_LOCK, COPIAS, SUBOPERACION, PERMITEBAJA, COMPORTAMIENTOENCIERRE, REQUIERECONTRASENA, PERMITECONCURRENTE, PERMITEESTADODIFERIDO)
VALUES (8600 , 26 , 'Cont de ajustes UVA UVI', 'Contab uva uvi', 26, 'N', NULL, NULL, 'P', 0, NULL, 0, 'S', 'N', 'N', 'S', 'S');

DELETE PARAMETROS_JTS WHERE FUNCIONALIDAD = 'REGISTRO_HISTORICO_FIN_MES_UVA_UVI';

INSERT INTO dbo.PARAMETROS_JTS (FUNCIONALIDAD, PARAMETRO, VALOR, TZ_LOCK)
VALUES ('REGISTRO_HISTORICO_FIN_MES_UVA_UVI', 'DESCRIPCION', 'Registro Historico Fin Mes UVA UVI', 0);

INSERT INTO dbo.PARAMETROS_JTS (FUNCIONALIDAD, PARAMETRO, VALOR, TZ_LOCK)
VALUES ('REGISTRO_HISTORICO_FIN_MES_UVA_UVI', 'OPERACION', '27', 0);

INSERT INTO dbo.PARAMETROS_JTS (FUNCIONALIDAD, PARAMETRO, VALOR, TZ_LOCK)
VALUES ('REGISTRO_HISTORICO_FIN_MES_UVA_UVI', 'CANAL', '0', 0);

INSERT INTO OPERACIONES (TITULO, IDENTIFICACION, NOMBRE, DESCRIPCION, MNEMOTECNICO, AUTORIZACION, FORMULARIOPRINCIPAL, PROXOPERACION, ESTADO, TZ_LOCK, COPIAS, SUBOPERACION, PERMITEBAJA, COMPORTAMIENTOENCIERRE, REQUIERECONTRASENA, PERMITECONCURRENTE, PERMITEESTADODIFERIDO)
VALUES (8600 , 27 , 'Oper Hist UVA UVI', 'Oper Hist uva uvi', 27, 'N', NULL, NULL, 'P', 0, NULL, 0, 'S', 'N', 'N', 'S', 'S');




INSERT INTO BITACORA_HM (ACTUALIZACION,FECHA_APLICADO,TIPO_ACTUALIZACION,ESTADO,SCRIPT_SQL,SCRIPT_SQL_UNDO,ULT_SENTENCIA_OK)  VALUES ('20201230_4NBCH',NULL,'MANUAL','NO_DEFINIDO','CgoNCi0tIFBhcmNoZV9OVU5CQ0hBQ09fMTk1Cg0KY3JlYXRlIHRhYmxlIENPTl9ERVRBTExFU19V
VkFfVVZJCiAJIAkoVFpfTE9DSyBOVU1FUklDICgxNSkgREVGQVVMVCAoKDApKSBOT1QgTlVMTCwK
IAkgCSBOVU1FUkFMIE5VTUVSSUMoMTUsMCksCiBTQUxET19KVFNfT0lEICAgICBOVU1FUklDKDEw
LDApICBOT1QgTlVMTCwKIEFTSUVOVE8gTlVNRVJJQygxMCwwKSBERUZBVUxUICgoMCkpLAogRkVD
SEFQUk9DRVNPIERBVEVUSU1FIE5PVCBOVUxMLAogT1JESU5BTCBOVU1FUklDICgxMCwwKSwKIFNV
QkFTSUVOVE8gTlVNRVJJQyAoMTAsMCksCiBTVUNVUlNBTCBOVU1FUklDICg1LDApLAogVFJSRUFM
IE5VTUVSSUMgKDUsMCksCiAJIAkgREVCSVRPICAgICBOVU1FUklDKDE1LDIpCURFRkFVTFQgKCgw
KSksCiBDUkVESVRPICAgICBOVU1FUklDKDE1LDIpCURFRkFVTFQgKCgwKSksCiBSRU1BTkVOVEUg
TlVNRVJJQygxNSwyKSBERUZBVUxUICgoMCkpLAogRkVDSEFfQUNUVUFMSVpBRE8gREFURVRJTUUK
IENPTlNUUkFJTlQgUEtfQ09OX0RFVEFMTEVTX1VWQV9VVkkgUFJJTUFSWSBLRVkgKE5VTUVSQUws
IFNBTERPX0pUU19PSUQsIEZFQ0hBUFJPQ0VTTykpOwoNCmNyZWF0ZSB0YWJsZSBDT05fUFJPQ0VT
QURPX1VWQV9VVkkKIAkgCShTQUxET19KVFNfT0lEIE5VTUVSSUMoMTAsMCkgTk9UIE5VTEwsCiBG
RUNIQVBST0NFU08gREFURVRJTUUgTk9UIE5VTEwKQ09OU1RSQUlOVCBQS19DT05fUFJPQ0VTQURP
X1VWQV9VVkkgUFJJTUFSWSBLRVkgKFNBTERPX0pUU19PSUQsIEZFQ0hBUFJPQ0VTTykpOwoNCmNy
ZWF0ZSB0YWJsZSBDT05fSElTVE9SSUNPX1VWQV9VVkkKKFRaX0xPQ0sgTlVNRVJJQyAoMTUpIERF
RkFVTFQgKCgwKSkgTk9UIE5VTEwsCiBOVU1FUkFMIE5VTUVSSUMoMTUsMCkgIE5PVCBOVUxMLAog
ICBTQUxET19KVFNfT0lEICAgICBOVU1FUklDKDEwLDApIE5PVCBOVUxMLAogICBBU0lFTlRPIE5V
TUVSSUMoMTAsMCkgREVGQVVMVCAoKDApKSwKICAgRkVDSEFQUk9DRVNPIERBVEVUSU1FIE5PVCBO
VUxMLAogICBPUkRJTkFMIE5VTUVSSUMgKDEwLDApLAogICBTVUJBU0lFTlRPIE5VTUVSSUMgKDEw
LDApLAogICBTVUNVUlNBTCBOVU1FUklDICg1LDApLAogICBUUlJFQUwgTlVNRVJJQyAoNSwwKSwK
IERFQklUTyAgICAgTlVNRVJJQygxNSwyKQlERUZBVUxUICgoMCkpLAogICBDUkVESVRPICAgICBO
VU1FUklDKDE1LDIpCURFRkFVTFQgKCgwKSksCiAgIFJFTUFORU5URSBOVU1FUklDKDE1LDIpIERF
RkFVTFQgKCgwKSksCiAgIEZFQ0hBX0FDVFVBTElaQURPIERBVEVUSU1FLAogICBGRUNIQV9GSU5f
TUVTIERBVEVUSU1FIE5PVCBOVUxMCiAgQ09OU1RSQUlOVCBQS19DT05fSElTVE9SSUNPX1VWQV9V
VkkgUFJJTUFSWSBLRVkgKE5VTUVSQUwsIFNBTERPX0pUU19PSUQsIEZFQ0hBUFJPQ0VTTywgRkVD
SEFfRklOX01FUykpOwoNCi0tIERlcHVyYSBlIEluc2VydGEgcmVnaXN0cm9zIGVuIFBBUkFNRVRS
T1NfSlRTDQpERUxFVEUgUEFSQU1FVFJPU19KVFMgV0hFUkUgRlVOQ0lPTkFMSURBRCA9ICdBSlVT
VEVfWV9SRUdJU1RST19VVkFfVVZJJzsKCklOU0VSVCBJTlRPIGRiby5QQVJBTUVUUk9TX0pUUyAo
RlVOQ0lPTkFMSURBRCwgUEFSQU1FVFJPLCBWQUxPUiwgVFpfTE9DSykKVkFMVUVTICgnQUpVU1RF
X1lfUkVHSVNUUk9fVVZBX1VWSScsICdERVNDUklQQ0lPTicsICdBY3R1YWxpemFjaW9uIGRlIHJl
Z2lzdHJvIGhpc3RvcmljbyBVVkEgVVZJJywgMCk7CgpJTlNFUlQgSU5UTyBkYm8uUEFSQU1FVFJP
U19KVFMgKEZVTkNJT05BTElEQUQsIFBBUkFNRVRSTywgVkFMT1IsIFRaX0xPQ0spClZBTFVFUyAo
J0FKVVNURV9ZX1JFR0lTVFJPX1VWQV9VVkknLCAnT1BFUkFDSU9OJywgJzI1JywgMCk7CgpJTlNF
UlQgSU5UTyBkYm8uUEFSQU1FVFJPU19KVFMgKEZVTkNJT05BTElEQUQsIFBBUkFNRVRSTywgVkFM
T1IsIFRaX0xPQ0spClZBTFVFUyAoJ0FKVVNURV9ZX1JFR0lTVFJPX1VWQV9VVkknLCAnQ0FOQUwn
LCAnMCcsIDApOwoKSU5TRVJUIElOVE8gcGFyYW1ldHJvc19qdHMgKEZVTkNJT05BTElEQUQsIFBB
UkFNRVRSTywgVkFMT1IsIFRaX0xPQ0spIApWQUxVRVMgKCdBSlVTVEVfWV9SRUdJU1RST19VVkFf
VVZJJywgJ05VTUVSQURPUicsICcxJywgMCk7CgpERUxFVEUgT1BFUkFDSU9ORVMgV0hFUkUgTk9N
QlJFID0gJ1JlZ2lzdHJvIE1vdmltIFVWQSBVVkknOwoKSU5TRVJUIElOVE8gT1BFUkFDSU9ORVMg
KFRJVFVMTywgSURFTlRJRklDQUNJT04sIE5PTUJSRSwgREVTQ1JJUENJT04sIE1ORU1PVEVDTklD
TywgQVVUT1JJWkFDSU9OLCBGT1JNVUxBUklPUFJJTkNJUEFMLCBQUk9YT1BFUkFDSU9OLCBFU1RB
RE8sIFRaX0xPQ0ssIENPUElBUywgU1VCT1BFUkFDSU9OLCBQRVJNSVRFQkFKQSwgQ09NUE9SVEFN
SUVOVE9FTkNJRVJSRSwgUkVRVUlFUkVDT05UUkFTRU5BLCBQRVJNSVRFQ09OQ1VSUkVOVEUsIFBF
Uk1JVEVFU1RBRE9ESUZFUklETykKVkFMVUVTICg4NjAwICwgMjUgLCAnUmVnaXN0cm8gTW92aW0g
VVZBIFVWSScsICdSZWdpc3RybyB1dmEgdXZpJywgMjUsICdOJywgTlVMTCwgTlVMTCwgJ1AnLCAw
LCBOVUxMLCAwLCAnUycsICdOJywgJ04nLCAnUycsICdTJyk7CgpERUxFVEUgUEFSQU1FVFJPU19K
VFMgV0hFUkUgRlVOQ0lPTkFMSURBRCA9ICdDT05UQUJJTElEQURfQUpVU1RFU19VVkFfVVZJJzsK
CklOU0VSVCBJTlRPIGRiby5QQVJBTUVUUk9TX0pUUyAoRlVOQ0lPTkFMSURBRCwgUEFSQU1FVFJP
LCBWQUxPUiwgVFpfTE9DSykKVkFMVUVTICgnQ09OVEFCSUxJREFEX0FKVVNURVNfVVZBX1VWSScs
ICdERVNDUklQQ0lPTicsICdDb250YWJpbGl6YWNpb24gZGUgYWp1c3RlcyBVVkEgVVZJJywgMCk7
CgpJTlNFUlQgSU5UTyBkYm8uUEFSQU1FVFJPU19KVFMgKEZVTkNJT05BTElEQUQsIFBBUkFNRVRS
TywgVkFMT1IsIFRaX0xPQ0spClZBTFVFUyAoJ0NPTlRBQklMSURBRF9BSlVTVEVTX1VWQV9VVkkn
LCAnT1BFUkFDSU9OJywgJzI2JywgMCk7CgpJTlNFUlQgSU5UTyBkYm8uUEFSQU1FVFJPU19KVFMg
KEZVTkNJT05BTElEQUQsIFBBUkFNRVRSTywgVkFMT1IsIFRaX0xPQ0spClZBTFVFUyAoJ0NPTlRB
QklMSURBRF9BSlVTVEVTX1VWQV9VVkknLCAnQ0FOQUwnLCAnMCcsIDApOwoKSU5TRVJUIElOVE8g
cGFyYW1ldHJvc19qdHMgKEZVTkNJT05BTElEQUQsIFBBUkFNRVRSTywgVkFMT1IsIFRaX0xPQ0sp
IApWQUxVRVMgKCdDT05UQUJJTElEQURfQUpVU1RFU19VVkFfVVZJJywgJ1BJVk9UX0FKVVNURV9V
VkFfVVZJJywgJzEnLCAwKTsKCkRFTEVURSBPUEVSQUNJT05FUyBXSEVSRSBOT01CUkUgPSAnQ29u
dCBkZSBhanVzdGVzIFVWQSBVVkknOwoKSU5TRVJUIElOVE8gT1BFUkFDSU9ORVMgKFRJVFVMTywg
SURFTlRJRklDQUNJT04sIE5PTUJSRSwgREVTQ1JJUENJT04sIE1ORU1PVEVDTklDTywgQVVUT1JJ
WkFDSU9OLCBGT1JNVUxBUklPUFJJTkNJUEFMLCBQUk9YT1BFUkFDSU9OLCBFU1RBRE8sIFRaX0xP
Q0ssIENPUElBUywgU1VCT1BFUkFDSU9OLCBQRVJNSVRFQkFKQSwgQ09NUE9SVEFNSUVOVE9FTkNJ
RVJSRSwgUkVRVUlFUkVDT05UUkFTRU5BLCBQRVJNSVRFQ09OQ1VSUkVOVEUsIFBFUk1JVEVFU1RB
RE9ESUZFUklETykKVkFMVUVTICg4NjAwICwgMjYgLCAnQ29udCBkZSBhanVzdGVzIFVWQSBVVkkn
LCAnQ29udGFiIHV2YSB1dmknLCAyNiwgJ04nLCBOVUxMLCBOVUxMLCAnUCcsIDAsIE5VTEwsIDAs
ICdTJywgJ04nLCAnTicsICdTJywgJ1MnKTsKCkRFTEVURSBQQVJBTUVUUk9TX0pUUyBXSEVSRSBG
VU5DSU9OQUxJREFEID0gJ1JFR0lTVFJPX0hJU1RPUklDT19GSU5fTUVTX1VWQV9VVkknOwoKSU5T
RVJUIElOVE8gZGJvLlBBUkFNRVRST1NfSlRTIChGVU5DSU9OQUxJREFELCBQQVJBTUVUUk8sIFZB
TE9SLCBUWl9MT0NLKQpWQUxVRVMgKCdSRUdJU1RST19ISVNUT1JJQ09fRklOX01FU19VVkFfVVZJ
JywgJ0RFU0NSSVBDSU9OJywgJ1JlZ2lzdHJvIEhpc3RvcmljbyBGaW4gTWVzIFVWQSBVVkknLCAw
KTsKCklOU0VSVCBJTlRPIGRiby5QQVJBTUVUUk9TX0pUUyAoRlVOQ0lPTkFMSURBRCwgUEFSQU1F
VFJPLCBWQUxPUiwgVFpfTE9DSykKVkFMVUVTICgnUkVHSVNUUk9fSElTVE9SSUNPX0ZJTl9NRVNf
VVZBX1VWSScsICdPUEVSQUNJT04nLCAnMjcnLCAwKTsKCklOU0VSVCBJTlRPIGRiby5QQVJBTUVU
Uk9TX0pUUyAoRlVOQ0lPTkFMSURBRCwgUEFSQU1FVFJPLCBWQUxPUiwgVFpfTE9DSykKVkFMVUVT
ICgnUkVHSVNUUk9fSElTVE9SSUNPX0ZJTl9NRVNfVVZBX1VWSScsICdDQU5BTCcsICcwJywgMCk7
CgpJTlNFUlQgSU5UTyBPUEVSQUNJT05FUyAoVElUVUxPLCBJREVOVElGSUNBQ0lPTiwgTk9NQlJF
LCBERVNDUklQQ0lPTiwgTU5FTU9URUNOSUNPLCBBVVRPUklaQUNJT04sIEZPUk1VTEFSSU9QUklO
Q0lQQUwsIFBST1hPUEVSQUNJT04sIEVTVEFETywgVFpfTE9DSywgQ09QSUFTLCBTVUJPUEVSQUNJ
T04sIFBFUk1JVEVCQUpBLCBDT01QT1JUQU1JRU5UT0VOQ0lFUlJFLCBSRVFVSUVSRUNPTlRSQVNF
TkEsIFBFUk1JVEVDT05DVVJSRU5URSwgUEVSTUlURUVTVEFET0RJRkVSSURPKQpWQUxVRVMgKDg2
MDAgLCAyNyAsICdPcGVyIEhpc3QgVVZBIFVWSScsICdPcGVyIEhpc3QgdXZhIHV2aScsIDI3LCAn
TicsIE5VTEwsIE5VTEwsICdQJywgMCwgTlVMTCwgMCwgJ1MnLCAnTicsICdOJywgJ1MnLCAnUycp
OwoNCgoKDQo=', NULL, 0);
